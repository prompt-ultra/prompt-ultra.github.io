var Bo=Object.defineProperty;var jo=(t,e,n)=>e in t?Bo(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Vr=(t,e,n)=>jo(t,typeof e!="symbol"?e+"":e,n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function ye(){}function xa(t){return t()}function pi(){return Object.create(null)}function Ue(t){t.forEach(xa)}function ka(t){return typeof t=="function"}function et(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function Wo(t){return Object.keys(t).length===0}function Ca(t,...e){if(t==null){for(const r of e)r(void 0);return ye}const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function mi(t){let e;return Ca(t,n=>e=n)(),e}function Xo(t,e,n){t.$$.on_destroy.push(Ca(e,n))}function Uo(t,e,n){return t.set(n),e}function g(t,e){t.appendChild(e)}function oe(t,e,n){t.insertBefore(e,n||null)}function ae(t){t.parentNode&&t.parentNode.removeChild(t)}function Pn(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function A(t){return document.createElement(t)}function fe(t){return document.createTextNode(t)}function B(){return fe(" ")}function Ho(){return fe("")}function le(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function y(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function be(t){return t===""?null:+t}function zo(t){return Array.from(t.childNodes)}function Ce(t,e){e=""+e,t.data!==e&&(t.data=e)}function se(t,e){t.value=e??""}function je(t,e,n,r){n==null?t.style.removeProperty(e):t.style.setProperty(e,n,"")}function Ut(t,e,n){for(let r=0;r<t.options.length;r+=1){const s=t.options[r];if(s.__value===e){s.selected=!0;return}}(!n||e!==void 0)&&(t.selectedIndex=-1)}function ns(t){const e=t.querySelector(":checked");return e&&e.__value}function he(t,e,n){t.classList.toggle(e,!!n)}function _i(t,e){return new t(e)}let bn;function wn(t){bn=t}function Vo(){if(!bn)throw new Error("Function called outside component initialization");return bn}function Jo(t){Vo().$$.on_mount.push(t)}const Bt=[],we=[];let zt=[];const rs=[],Ko=Promise.resolve();let ss=!1;function Go(){ss||(ss=!0,Ko.then(Qe))}function Yt(t){zt.push(t)}function qe(t){rs.push(t)}const Jr=new Set;let Lt=0;function Qe(){if(Lt!==0)return;const t=bn;do{try{for(;Lt<Bt.length;){const e=Bt[Lt];Lt++,wn(e),Qo(e.$$)}}catch(e){throw Bt.length=0,Lt=0,e}for(wn(null),Bt.length=0,Lt=0;we.length;)we.pop()();for(let e=0;e<zt.length;e+=1){const n=zt[e];Jr.has(n)||(Jr.add(n),n())}zt.length=0}while(Bt.length);for(;rs.length;)rs.pop()();ss=!1,Jr.clear(),wn(t)}function Qo(t){if(t.fragment!==null){t.update(),Ue(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Yt)}}function Yo(t){const e=[],n=[];zt.forEach(r=>t.indexOf(r)===-1?e.push(r):n.push(r)),n.forEach(r=>r()),zt=e}const Wn=new Set;let Rt;function Zo(){Rt={r:0,c:[],p:Rt}}function el(){Rt.r||Ue(Rt.c),Rt=Rt.p}function Re(t,e){t&&t.i&&(Wn.delete(t),t.i(e))}function Ne(t,e,n,r){if(t&&t.o){if(Wn.has(t))return;Wn.add(t),Rt.c.push(()=>{Wn.delete(t),r&&(n&&t.d(1),r())}),t.o(e)}else r&&r()}function bt(t){return(t==null?void 0:t.length)!==void 0?t:Array.from(t)}function Be(t,e,n){const r=t.$$.props[e];r!==void 0&&(t.$$.bound[r]=n,n(t.$$.ctx[r]))}function $e(t){t&&t.c()}function Pe(t,e,n){const{fragment:r,after_update:s}=t.$$;r&&r.m(e,n),Yt(()=>{const i=t.$$.on_mount.map(xa).filter(ka);t.$$.on_destroy?t.$$.on_destroy.push(...i):Ue(i),t.$$.on_mount=[]}),s.forEach(Yt)}function Ie(t,e){const n=t.$$;n.fragment!==null&&(Yo(n.after_update),Ue(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function tl(t,e){t.$$.dirty[0]===-1&&(Bt.push(t),Go(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function lt(t,e,n,r,s,i,o=null,l=[-1]){const a=bn;wn(t);const u=t.$$={fragment:null,ctx:[],props:i,update:ye,not_equal:s,bound:pi(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(a?a.$$.context:[])),callbacks:pi(),dirty:l,skip_bound:!1,root:e.target||a.$$.root};o&&o(u.root);let c=!1;if(u.ctx=n?n(t,e.props||{},(f,h,...d)=>{const p=d.length?d[0]:h;return u.ctx&&s(u.ctx[f],u.ctx[f]=p)&&(!u.skip_bound&&u.bound[f]&&u.bound[f](p),c&&tl(t,f)),h}):[],u.update(),c=!0,Ue(u.before_update),u.fragment=r?r(u.ctx):!1,e.target){if(e.hydrate){const f=zo(e.target);u.fragment&&u.fragment.l(f),f.forEach(ae)}else u.fragment&&u.fragment.c();e.intro&&Re(t.$$.fragment),Pe(t,e.target,e.anchor),Qe()}wn(a)}class ut{constructor(){Vr(this,"$$");Vr(this,"$$set")}$destroy(){Ie(this,1),this.$destroy=ye}$on(e,n){if(!ka(n))return ye;const r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(n),()=>{const s=r.indexOf(n);s!==-1&&r.splice(s,1)}}$set(e){this.$$set&&!Wo(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const nl="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(nl);function rl(t,e){let n;for(const r of t)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);return n}function sl(t,e){let n;for(const r of t)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);return n}var il={value:()=>{}};function Aa(){for(var t=0,e=arguments.length,n={},r;t<e;++t){if(!(r=arguments[t]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new Xn(n)}function Xn(t){this._=t}function al(t,e){return t.trim().split(/^|\s+/).map(function(n){var r="",s=n.indexOf(".");if(s>=0&&(r=n.slice(s+1),n=n.slice(0,s)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}Xn.prototype=Aa.prototype={constructor:Xn,on:function(t,e){var n=this._,r=al(t+"",n),s,i=-1,o=r.length;if(arguments.length<2){for(;++i<o;)if((s=(t=r[i]).type)&&(s=ol(n[s],t.name)))return s;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++i<o;)if(s=(t=r[i]).type)n[s]=gi(n[s],t.name,e);else if(e==null)for(s in n)n[s]=gi(n[s],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Xn(t)},call:function(t,e){if((s=arguments.length-2)>0)for(var n=new Array(s),r=0,s,i;r<s;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(i=this._[t],r=0,s=i.length;r<s;++r)i[r].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],s=0,i=r.length;s<i;++s)r[s].value.apply(e,n)}};function ol(t,e){for(var n=0,r=t.length,s;n<r;++n)if((s=t[n]).name===e)return s.value}function gi(t,e,n){for(var r=0,s=t.length;r<s;++r)if(t[r].name===e){t[r]=il,t=t.slice(0,r).concat(t.slice(r+1));break}return n!=null&&t.push({name:e,value:n}),t}var is="http://www.w3.org/1999/xhtml";const wi={svg:"http://www.w3.org/2000/svg",xhtml:is,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Br(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),wi.hasOwnProperty(e)?{space:wi[e],local:t}:t}function ll(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===is&&e.documentElement.namespaceURI===is?e.createElement(t):e.createElementNS(n,t)}}function ul(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Sa(t){var e=Br(t);return(e.local?ul:ll)(e)}function cl(){}function Ds(t){return t==null?cl:function(){return this.querySelector(t)}}function fl(t){typeof t!="function"&&(t=Ds(t));for(var e=this._groups,n=e.length,r=new Array(n),s=0;s<n;++s)for(var i=e[s],o=i.length,l=r[s]=new Array(o),a,u,c=0;c<o;++c)(a=i[c])&&(u=t.call(a,a.__data__,c,i))&&("__data__"in a&&(u.__data__=a.__data__),l[c]=u);return new Me(r,this._parents)}function Ea(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function hl(){return[]}function Ra(t){return t==null?hl:function(){return this.querySelectorAll(t)}}function dl(t){return function(){return Ea(t.apply(this,arguments))}}function pl(t){typeof t=="function"?t=dl(t):t=Ra(t);for(var e=this._groups,n=e.length,r=[],s=[],i=0;i<n;++i)for(var o=e[i],l=o.length,a,u=0;u<l;++u)(a=o[u])&&(r.push(t.call(a,a.__data__,u,o)),s.push(a));return new Me(r,s)}function Pa(t){return function(){return this.matches(t)}}function Ia(t){return function(e){return e.matches(t)}}var ml=Array.prototype.find;function _l(t){return function(){return ml.call(this.children,t)}}function gl(){return this.firstElementChild}function wl(t){return this.select(t==null?gl:_l(typeof t=="function"?t:Ia(t)))}var yl=Array.prototype.filter;function vl(){return Array.from(this.children)}function bl(t){return function(){return yl.call(this.children,t)}}function xl(t){return this.selectAll(t==null?vl:bl(typeof t=="function"?t:Ia(t)))}function kl(t){typeof t!="function"&&(t=Pa(t));for(var e=this._groups,n=e.length,r=new Array(n),s=0;s<n;++s)for(var i=e[s],o=i.length,l=r[s]=[],a,u=0;u<o;++u)(a=i[u])&&t.call(a,a.__data__,u,i)&&l.push(a);return new Me(r,this._parents)}function Ma(t){return new Array(t.length)}function Cl(){return new Me(this._enter||this._groups.map(Ma),this._parents)}function ir(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}ir.prototype={constructor:ir,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function Al(t){return function(){return t}}function Sl(t,e,n,r,s,i){for(var o=0,l,a=e.length,u=i.length;o<u;++o)(l=e[o])?(l.__data__=i[o],r[o]=l):n[o]=new ir(t,i[o]);for(;o<a;++o)(l=e[o])&&(s[o]=l)}function El(t,e,n,r,s,i,o){var l,a,u=new Map,c=e.length,f=i.length,h=new Array(c),d;for(l=0;l<c;++l)(a=e[l])&&(h[l]=d=o.call(a,a.__data__,l,e)+"",u.has(d)?s[l]=a:u.set(d,a));for(l=0;l<f;++l)d=o.call(t,i[l],l,i)+"",(a=u.get(d))?(r[l]=a,a.__data__=i[l],u.delete(d)):n[l]=new ir(t,i[l]);for(l=0;l<c;++l)(a=e[l])&&u.get(h[l])===a&&(s[l]=a)}function Rl(t){return t.__data__}function Pl(t,e){if(!arguments.length)return Array.from(this,Rl);var n=e?El:Sl,r=this._parents,s=this._groups;typeof t!="function"&&(t=Al(t));for(var i=s.length,o=new Array(i),l=new Array(i),a=new Array(i),u=0;u<i;++u){var c=r[u],f=s[u],h=f.length,d=Il(t.call(c,c&&c.__data__,u,r)),p=d.length,w=l[u]=new Array(p),v=o[u]=new Array(p),x=a[u]=new Array(h);n(c,f,w,v,x,d,e);for(var k=0,R=0,M,E;k<p;++k)if(M=w[k]){for(k>=R&&(R=k+1);!(E=v[R])&&++R<p;);M._next=E||null}}return o=new Me(o,r),o._enter=l,o._exit=a,o}function Il(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Ml(){return new Me(this._exit||this._groups.map(Ma),this._parents)}function Ol(t,e,n){var r=this.enter(),s=this,i=this.exit();return typeof t=="function"?(r=t(r),r&&(r=r.selection())):r=r.append(t+""),e!=null&&(s=e(s),s&&(s=s.selection())),n==null?i.remove():n(i),r&&s?r.merge(s).order():s}function Nl(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,s=n.length,i=r.length,o=Math.min(s,i),l=new Array(s),a=0;a<o;++a)for(var u=n[a],c=r[a],f=u.length,h=l[a]=new Array(f),d,p=0;p<f;++p)(d=u[p]||c[p])&&(h[p]=d);for(;a<s;++a)l[a]=n[a];return new Me(l,this._parents)}function $l(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r=t[e],s=r.length-1,i=r[s],o;--s>=0;)(o=r[s])&&(i&&o.compareDocumentPosition(i)^4&&i.parentNode.insertBefore(o,i),i=o);return this}function Tl(t){t||(t=Fl);function e(f,h){return f&&h?t(f.__data__,h.__data__):!f-!h}for(var n=this._groups,r=n.length,s=new Array(r),i=0;i<r;++i){for(var o=n[i],l=o.length,a=s[i]=new Array(l),u,c=0;c<l;++c)(u=o[c])&&(a[c]=u);a.sort(e)}return new Me(s,this._parents).order()}function Fl(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Ll(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function Dl(){return Array.from(this)}function ql(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],s=0,i=r.length;s<i;++s){var o=r[s];if(o)return o}return null}function Bl(){let t=0;for(const e of this)++t;return t}function jl(){return!this.node()}function Wl(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var s=e[n],i=0,o=s.length,l;i<o;++i)(l=s[i])&&t.call(l,l.__data__,i,s);return this}function Xl(t){return function(){this.removeAttribute(t)}}function Ul(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Hl(t,e){return function(){this.setAttribute(t,e)}}function zl(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function Vl(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function Jl(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function Kl(t,e){var n=Br(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((e==null?n.local?Ul:Xl:typeof e=="function"?n.local?Jl:Vl:n.local?zl:Hl)(n,e))}function Oa(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Gl(t){return function(){this.style.removeProperty(t)}}function Ql(t,e,n){return function(){this.style.setProperty(t,e,n)}}function Yl(t,e,n){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function Zl(t,e,n){return arguments.length>1?this.each((e==null?Gl:typeof e=="function"?Yl:Ql)(t,e,n??"")):Zt(this.node(),t)}function Zt(t,e){return t.style.getPropertyValue(e)||Oa(t).getComputedStyle(t,null).getPropertyValue(e)}function eu(t){return function(){delete this[t]}}function tu(t,e){return function(){this[t]=e}}function nu(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function ru(t,e){return arguments.length>1?this.each((e==null?eu:typeof e=="function"?nu:tu)(t,e)):this.node()[t]}function Na(t){return t.trim().split(/^|\s+/)}function qs(t){return t.classList||new $a(t)}function $a(t){this._node=t,this._names=Na(t.getAttribute("class")||"")}$a.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function Ta(t,e){for(var n=qs(t),r=-1,s=e.length;++r<s;)n.add(e[r])}function Fa(t,e){for(var n=qs(t),r=-1,s=e.length;++r<s;)n.remove(e[r])}function su(t){return function(){Ta(this,t)}}function iu(t){return function(){Fa(this,t)}}function au(t,e){return function(){(e.apply(this,arguments)?Ta:Fa)(this,t)}}function ou(t,e){var n=Na(t+"");if(arguments.length<2){for(var r=qs(this.node()),s=-1,i=n.length;++s<i;)if(!r.contains(n[s]))return!1;return!0}return this.each((typeof e=="function"?au:e?su:iu)(n,e))}function lu(){this.textContent=""}function uu(t){return function(){this.textContent=t}}function cu(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function fu(t){return arguments.length?this.each(t==null?lu:(typeof t=="function"?cu:uu)(t)):this.node().textContent}function hu(){this.innerHTML=""}function du(t){return function(){this.innerHTML=t}}function pu(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function mu(t){return arguments.length?this.each(t==null?hu:(typeof t=="function"?pu:du)(t)):this.node().innerHTML}function _u(){this.nextSibling&&this.parentNode.appendChild(this)}function gu(){return this.each(_u)}function wu(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function yu(){return this.each(wu)}function vu(t){var e=typeof t=="function"?t:Sa(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function bu(){return null}function xu(t,e){var n=typeof t=="function"?t:Sa(t),r=e==null?bu:typeof e=="function"?e:Ds(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function ku(){var t=this.parentNode;t&&t.removeChild(this)}function Cu(){return this.each(ku)}function Au(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Su(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Eu(t){return this.select(t?Su:Au)}function Ru(t){return arguments.length?this.property("__data__",t):this.node().__data__}function Pu(t){return function(e){t.call(this,e,this.__data__)}}function Iu(t){return t.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");return r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),{type:e,name:n}})}function Mu(t){return function(){var e=this.__on;if(e){for(var n=0,r=-1,s=e.length,i;n<s;++n)i=e[n],(!t.type||i.type===t.type)&&i.name===t.name?this.removeEventListener(i.type,i.listener,i.options):e[++r]=i;++r?e.length=r:delete this.__on}}}function Ou(t,e,n){return function(){var r=this.__on,s,i=Pu(e);if(r){for(var o=0,l=r.length;o<l;++o)if((s=r[o]).type===t.type&&s.name===t.name){this.removeEventListener(s.type,s.listener,s.options),this.addEventListener(s.type,s.listener=i,s.options=n),s.value=e;return}}this.addEventListener(t.type,i,n),s={type:t.type,name:t.name,value:e,listener:i,options:n},r?r.push(s):this.__on=[s]}}function Nu(t,e,n){var r=Iu(t+""),s,i=r.length,o;if(arguments.length<2){var l=this.node().__on;if(l){for(var a=0,u=l.length,c;a<u;++a)for(s=0,c=l[a];s<i;++s)if((o=r[s]).type===c.type&&o.name===c.name)return c.value}return}for(l=e?Ou:Mu,s=0;s<i;++s)this.each(l(r[s],e,n));return this}function La(t,e,n){var r=Oa(t),s=r.CustomEvent;typeof s=="function"?s=new s(e,n):(s=r.document.createEvent("Event"),n?(s.initEvent(e,n.bubbles,n.cancelable),s.detail=n.detail):s.initEvent(e,!1,!1)),t.dispatchEvent(s)}function $u(t,e){return function(){return La(this,t,e)}}function Tu(t,e){return function(){return La(this,t,e.apply(this,arguments))}}function Fu(t,e){return this.each((typeof e=="function"?Tu:$u)(t,e))}function*Lu(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],s=0,i=r.length,o;s<i;++s)(o=r[s])&&(yield o)}var Bs=[null];function Me(t,e){this._groups=t,this._parents=e}function In(){return new Me([[document.documentElement]],Bs)}function Du(){return this}Me.prototype=In.prototype={constructor:Me,select:fl,selectAll:pl,selectChild:wl,selectChildren:xl,filter:kl,data:Pl,enter:Cl,exit:Ml,join:Ol,merge:Nl,selection:Du,order:$l,sort:Tl,call:Ll,nodes:Dl,node:ql,size:Bl,empty:jl,each:Wl,attr:Kl,style:Zl,property:ru,classed:ou,text:fu,html:mu,raise:gu,lower:yu,append:vu,insert:xu,remove:Cu,clone:Eu,datum:Ru,on:Nu,dispatch:Fu,[Symbol.iterator]:Lu};function tn(t){return typeof t=="string"?new Me([[document.querySelector(t)]],[document.documentElement]):new Me([[t]],Bs)}function qu(t){return typeof t=="string"?new Me([document.querySelectorAll(t)],[document.documentElement]):new Me([Ea(t)],Bs)}function js(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Da(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Mn(){}var xn=.7,ar=1/xn,Vt="\\s*([+-]?\\d+)\\s*",kn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ot="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Bu=/^#([0-9a-f]{3,8})$/,ju=new RegExp(`^rgb\\(${Vt},${Vt},${Vt}\\)$`),Wu=new RegExp(`^rgb\\(${ot},${ot},${ot}\\)$`),Xu=new RegExp(`^rgba\\(${Vt},${Vt},${Vt},${kn}\\)$`),Uu=new RegExp(`^rgba\\(${ot},${ot},${ot},${kn}\\)$`),Hu=new RegExp(`^hsl\\(${kn},${ot},${ot}\\)$`),zu=new RegExp(`^hsla\\(${kn},${ot},${ot},${kn}\\)$`),yi={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};js(Mn,Cn,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:vi,formatHex:vi,formatHex8:Vu,formatHsl:Ju,formatRgb:bi,toString:bi});function vi(){return this.rgb().formatHex()}function Vu(){return this.rgb().formatHex8()}function Ju(){return qa(this).formatHsl()}function bi(){return this.rgb().formatRgb()}function Cn(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Bu.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?xi(e):n===3?new Te(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?$n(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?$n(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=ju.exec(t))?new Te(e[1],e[2],e[3],1):(e=Wu.exec(t))?new Te(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=Xu.exec(t))?$n(e[1],e[2],e[3],e[4]):(e=Uu.exec(t))?$n(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=Hu.exec(t))?Ai(e[1],e[2]/100,e[3]/100,1):(e=zu.exec(t))?Ai(e[1],e[2]/100,e[3]/100,e[4]):yi.hasOwnProperty(t)?xi(yi[t]):t==="transparent"?new Te(NaN,NaN,NaN,0):null}function xi(t){return new Te(t>>16&255,t>>8&255,t&255,1)}function $n(t,e,n,r){return r<=0&&(t=e=n=NaN),new Te(t,e,n,r)}function Ku(t){return t instanceof Mn||(t=Cn(t)),t?(t=t.rgb(),new Te(t.r,t.g,t.b,t.opacity)):new Te}function as(t,e,n,r){return arguments.length===1?Ku(t):new Te(t,e,n,r??1)}function Te(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}js(Te,as,Da(Mn,{brighter(t){return t=t==null?ar:Math.pow(ar,t),new Te(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?xn:Math.pow(xn,t),new Te(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Te(Ot(this.r),Ot(this.g),Ot(this.b),or(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:ki,formatHex:ki,formatHex8:Gu,formatRgb:Ci,toString:Ci}));function ki(){return`#${Pt(this.r)}${Pt(this.g)}${Pt(this.b)}`}function Gu(){return`#${Pt(this.r)}${Pt(this.g)}${Pt(this.b)}${Pt((isNaN(this.opacity)?1:this.opacity)*255)}`}function Ci(){const t=or(this.opacity);return`${t===1?"rgb(":"rgba("}${Ot(this.r)}, ${Ot(this.g)}, ${Ot(this.b)}${t===1?")":`, ${t})`}`}function or(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Ot(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Pt(t){return t=Ot(t),(t<16?"0":"")+t.toString(16)}function Ai(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Ye(t,e,n,r)}function qa(t){if(t instanceof Ye)return new Ye(t.h,t.s,t.l,t.opacity);if(t instanceof Mn||(t=Cn(t)),!t)return new Ye;if(t instanceof Ye)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,s=Math.min(e,n,r),i=Math.max(e,n,r),o=NaN,l=i-s,a=(i+s)/2;return l?(e===i?o=(n-r)/l+(n<r)*6:n===i?o=(r-e)/l+2:o=(e-n)/l+4,l/=a<.5?i+s:2-i-s,o*=60):l=a>0&&a<1?0:o,new Ye(o,l,a,t.opacity)}function Qu(t,e,n,r){return arguments.length===1?qa(t):new Ye(t,e,n,r??1)}function Ye(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}js(Ye,Qu,Da(Mn,{brighter(t){return t=t==null?ar:Math.pow(ar,t),new Ye(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?xn:Math.pow(xn,t),new Ye(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,s=2*n-r;return new Te(Kr(t>=240?t-240:t+120,s,r),Kr(t,s,r),Kr(t<120?t+240:t-120,s,r),this.opacity)},clamp(){return new Ye(Si(this.h),Tn(this.s),Tn(this.l),or(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=or(this.opacity);return`${t===1?"hsl(":"hsla("}${Si(this.h)}, ${Tn(this.s)*100}%, ${Tn(this.l)*100}%${t===1?")":`, ${t})`}`}}));function Si(t){return t=(t||0)%360,t<0?t+360:t}function Tn(t){return Math.max(0,Math.min(1,t||0))}function Kr(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const Ba=t=>()=>t;function Yu(t,e){return function(n){return t+n*e}}function Zu(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function ec(t){return(t=+t)==1?ja:function(e,n){return n-e?Zu(e,n,t):Ba(isNaN(e)?n:e)}}function ja(t,e){var n=e-t;return n?Yu(t,n):Ba(isNaN(t)?e:t)}const Ei=function t(e){var n=ec(e);function r(s,i){var o=n((s=as(s)).r,(i=as(i)).r),l=n(s.g,i.g),a=n(s.b,i.b),u=ja(s.opacity,i.opacity);return function(c){return s.r=o(c),s.g=l(c),s.b=a(c),s.opacity=u(c),s+""}}return r.gamma=t,r}(1);function vt(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}var os=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Gr=new RegExp(os.source,"g");function tc(t){return function(){return t}}function nc(t){return function(e){return t(e)+""}}function rc(t,e){var n=os.lastIndex=Gr.lastIndex=0,r,s,i,o=-1,l=[],a=[];for(t=t+"",e=e+"";(r=os.exec(t))&&(s=Gr.exec(e));)(i=s.index)>n&&(i=e.slice(n,i),l[o]?l[o]+=i:l[++o]=i),(r=r[0])===(s=s[0])?l[o]?l[o]+=s:l[++o]=s:(l[++o]=null,a.push({i:o,x:vt(r,s)})),n=Gr.lastIndex;return n<e.length&&(i=e.slice(n),l[o]?l[o]+=i:l[++o]=i),l.length<2?a[0]?nc(a[0].x):tc(e):(e=a.length,function(u){for(var c=0,f;c<e;++c)l[(f=a[c]).i]=f.x(u);return l.join("")})}var Ri=180/Math.PI,ls={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Wa(t,e,n,r,s,i){var o,l,a;return(o=Math.sqrt(t*t+e*e))&&(t/=o,e/=o),(a=t*n+e*r)&&(n-=t*a,r-=e*a),(l=Math.sqrt(n*n+r*r))&&(n/=l,r/=l,a/=l),t*r<e*n&&(t=-t,e=-e,a=-a,o=-o),{translateX:s,translateY:i,rotate:Math.atan2(e,t)*Ri,skewX:Math.atan(a)*Ri,scaleX:o,scaleY:l}}var Fn;function sc(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?ls:Wa(e.a,e.b,e.c,e.d,e.e,e.f)}function ic(t){return t==null||(Fn||(Fn=document.createElementNS("http://www.w3.org/2000/svg","g")),Fn.setAttribute("transform",t),!(t=Fn.transform.baseVal.consolidate()))?ls:(t=t.matrix,Wa(t.a,t.b,t.c,t.d,t.e,t.f))}function Xa(t,e,n,r){function s(u){return u.length?u.pop()+" ":""}function i(u,c,f,h,d,p){if(u!==f||c!==h){var w=d.push("translate(",null,e,null,n);p.push({i:w-4,x:vt(u,f)},{i:w-2,x:vt(c,h)})}else(f||h)&&d.push("translate("+f+e+h+n)}function o(u,c,f,h){u!==c?(u-c>180?c+=360:c-u>180&&(u+=360),h.push({i:f.push(s(f)+"rotate(",null,r)-2,x:vt(u,c)})):c&&f.push(s(f)+"rotate("+c+r)}function l(u,c,f,h){u!==c?h.push({i:f.push(s(f)+"skewX(",null,r)-2,x:vt(u,c)}):c&&f.push(s(f)+"skewX("+c+r)}function a(u,c,f,h,d,p){if(u!==f||c!==h){var w=d.push(s(d)+"scale(",null,",",null,")");p.push({i:w-4,x:vt(u,f)},{i:w-2,x:vt(c,h)})}else(f!==1||h!==1)&&d.push(s(d)+"scale("+f+","+h+")")}return function(u,c){var f=[],h=[];return u=t(u),c=t(c),i(u.translateX,u.translateY,c.translateX,c.translateY,f,h),o(u.rotate,c.rotate,f,h),l(u.skewX,c.skewX,f,h),a(u.scaleX,u.scaleY,c.scaleX,c.scaleY,f,h),u=c=null,function(d){for(var p=-1,w=h.length,v;++p<w;)f[(v=h[p]).i]=v.x(d);return f.join("")}}}var ac=Xa(sc,"px, ","px)","deg)"),oc=Xa(ic,", ",")",")"),en=0,rn=0,nn=0,Ua=1e3,lr,sn,ur=0,Nt=0,jr=0,An=typeof performance=="object"&&performance.now?performance:Date,Ha=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Ws(){return Nt||(Ha(lc),Nt=An.now()+jr)}function lc(){Nt=0}function cr(){this._call=this._time=this._next=null}cr.prototype=za.prototype={constructor:cr,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?Ws():+n)+(e==null?0:+e),!this._next&&sn!==this&&(sn?sn._next=this:lr=this,sn=this),this._call=t,this._time=n,us()},stop:function(){this._call&&(this._call=null,this._time=1/0,us())}};function za(t,e,n){var r=new cr;return r.restart(t,e,n),r}function uc(){Ws(),++en;for(var t=lr,e;t;)(e=Nt-t._time)>=0&&t._call.call(void 0,e),t=t._next;--en}function Pi(){Nt=(ur=An.now())+jr,en=rn=0;try{uc()}finally{en=0,fc(),Nt=0}}function cc(){var t=An.now(),e=t-ur;e>Ua&&(jr-=e,ur=t)}function fc(){for(var t,e=lr,n,r=1/0;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:lr=n);sn=t,us(r)}function us(t){if(!en){rn&&(rn=clearTimeout(rn));var e=t-Nt;e>24?(t<1/0&&(rn=setTimeout(Pi,t-An.now()-jr)),nn&&(nn=clearInterval(nn))):(nn||(ur=An.now(),nn=setInterval(cc,Ua)),en=1,Ha(Pi))}}function Ii(t,e,n){var r=new cr;return e=e==null?0:+e,r.restart(s=>{r.stop(),t(s+e)},e,n),r}var hc=Aa("start","end","cancel","interrupt"),dc=[],Va=0,Mi=1,cs=2,Un=3,Oi=4,fs=5,Hn=6;function Wr(t,e,n,r,s,i){var o=t.__transition;if(!o)t.__transition={};else if(n in o)return;pc(t,n,{name:e,index:r,group:s,on:hc,tween:dc,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:Va})}function Xs(t,e){var n=tt(t,e);if(n.state>Va)throw new Error("too late; already scheduled");return n}function ct(t,e){var n=tt(t,e);if(n.state>Un)throw new Error("too late; already running");return n}function tt(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function pc(t,e,n){var r=t.__transition,s;r[e]=n,n.timer=za(i,0,n.time);function i(u){n.state=Mi,n.timer.restart(o,n.delay,n.time),n.delay<=u&&o(u-n.delay)}function o(u){var c,f,h,d;if(n.state!==Mi)return a();for(c in r)if(d=r[c],d.name===n.name){if(d.state===Un)return Ii(o);d.state===Oi?(d.state=Hn,d.timer.stop(),d.on.call("interrupt",t,t.__data__,d.index,d.group),delete r[c]):+c<e&&(d.state=Hn,d.timer.stop(),d.on.call("cancel",t,t.__data__,d.index,d.group),delete r[c])}if(Ii(function(){n.state===Un&&(n.state=Oi,n.timer.restart(l,n.delay,n.time),l(u))}),n.state=cs,n.on.call("start",t,t.__data__,n.index,n.group),n.state===cs){for(n.state=Un,s=new Array(h=n.tween.length),c=0,f=-1;c<h;++c)(d=n.tween[c].value.call(t,t.__data__,n.index,n.group))&&(s[++f]=d);s.length=f+1}}function l(u){for(var c=u<n.duration?n.ease.call(null,u/n.duration):(n.timer.restart(a),n.state=fs,1),f=-1,h=s.length;++f<h;)s[f].call(t,c);n.state===fs&&(n.on.call("end",t,t.__data__,n.index,n.group),a())}function a(){n.state=Hn,n.timer.stop(),delete r[e];for(var u in r)return;delete t.__transition}}function mc(t,e){var n=t.__transition,r,s,i=!0,o;if(n){e=e==null?null:e+"";for(o in n){if((r=n[o]).name!==e){i=!1;continue}s=r.state>cs&&r.state<fs,r.state=Hn,r.timer.stop(),r.on.call(s?"interrupt":"cancel",t,t.__data__,r.index,r.group),delete n[o]}i&&delete t.__transition}}function _c(t){return this.each(function(){mc(this,t)})}function gc(t,e){var n,r;return function(){var s=ct(this,t),i=s.tween;if(i!==n){r=n=i;for(var o=0,l=r.length;o<l;++o)if(r[o].name===e){r=r.slice(),r.splice(o,1);break}}s.tween=r}}function wc(t,e,n){var r,s;if(typeof n!="function")throw new Error;return function(){var i=ct(this,t),o=i.tween;if(o!==r){s=(r=o).slice();for(var l={name:e,value:n},a=0,u=s.length;a<u;++a)if(s[a].name===e){s[a]=l;break}a===u&&s.push(l)}i.tween=s}}function yc(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r=tt(this.node(),n).tween,s=0,i=r.length,o;s<i;++s)if((o=r[s]).name===t)return o.value;return null}return this.each((e==null?gc:wc)(n,t,e))}function Us(t,e,n){var r=t._id;return t.each(function(){var s=ct(this,r);(s.value||(s.value={}))[e]=n.apply(this,arguments)}),function(s){return tt(s,r).value[e]}}function Ja(t,e){var n;return(typeof e=="number"?vt:e instanceof Cn?Ei:(n=Cn(e))?(e=n,Ei):rc)(t,e)}function vc(t){return function(){this.removeAttribute(t)}}function bc(t){return function(){this.removeAttributeNS(t.space,t.local)}}function xc(t,e,n){var r,s=n+"",i;return function(){var o=this.getAttribute(t);return o===s?null:o===r?i:i=e(r=o,n)}}function kc(t,e,n){var r,s=n+"",i;return function(){var o=this.getAttributeNS(t.space,t.local);return o===s?null:o===r?i:i=e(r=o,n)}}function Cc(t,e,n){var r,s,i;return function(){var o,l=n(this),a;return l==null?void this.removeAttribute(t):(o=this.getAttribute(t),a=l+"",o===a?null:o===r&&a===s?i:(s=a,i=e(r=o,l)))}}function Ac(t,e,n){var r,s,i;return function(){var o,l=n(this),a;return l==null?void this.removeAttributeNS(t.space,t.local):(o=this.getAttributeNS(t.space,t.local),a=l+"",o===a?null:o===r&&a===s?i:(s=a,i=e(r=o,l)))}}function Sc(t,e){var n=Br(t),r=n==="transform"?oc:Ja;return this.attrTween(t,typeof e=="function"?(n.local?Ac:Cc)(n,r,Us(this,"attr."+t,e)):e==null?(n.local?bc:vc)(n):(n.local?kc:xc)(n,r,e))}function Ec(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function Rc(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function Pc(t,e){var n,r;function s(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&Rc(t,i)),n}return s._value=e,s}function Ic(t,e){var n,r;function s(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&Ec(t,i)),n}return s._value=e,s}function Mc(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var r=Br(t);return this.tween(n,(r.local?Pc:Ic)(r,e))}function Oc(t,e){return function(){Xs(this,t).delay=+e.apply(this,arguments)}}function Nc(t,e){return e=+e,function(){Xs(this,t).delay=e}}function $c(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?Oc:Nc)(e,t)):tt(this.node(),e).delay}function Tc(t,e){return function(){ct(this,t).duration=+e.apply(this,arguments)}}function Fc(t,e){return e=+e,function(){ct(this,t).duration=e}}function Lc(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?Tc:Fc)(e,t)):tt(this.node(),e).duration}function Dc(t,e){if(typeof e!="function")throw new Error;return function(){ct(this,t).ease=e}}function qc(t){var e=this._id;return arguments.length?this.each(Dc(e,t)):tt(this.node(),e).ease}function Bc(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;ct(this,t).ease=n}}function jc(t){if(typeof t!="function")throw new Error;return this.each(Bc(this._id,t))}function Wc(t){typeof t!="function"&&(t=Pa(t));for(var e=this._groups,n=e.length,r=new Array(n),s=0;s<n;++s)for(var i=e[s],o=i.length,l=r[s]=[],a,u=0;u<o;++u)(a=i[u])&&t.call(a,a.__data__,u,i)&&l.push(a);return new mt(r,this._parents,this._name,this._id)}function Xc(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,s=n.length,i=Math.min(r,s),o=new Array(r),l=0;l<i;++l)for(var a=e[l],u=n[l],c=a.length,f=o[l]=new Array(c),h,d=0;d<c;++d)(h=a[d]||u[d])&&(f[d]=h);for(;l<r;++l)o[l]=e[l];return new mt(o,this._parents,this._name,this._id)}function Uc(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function Hc(t,e,n){var r,s,i=Uc(e)?Xs:ct;return function(){var o=i(this,t),l=o.on;l!==r&&(s=(r=l).copy()).on(e,n),o.on=s}}function zc(t,e){var n=this._id;return arguments.length<2?tt(this.node(),n).on.on(t):this.each(Hc(n,t,e))}function Vc(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function Jc(){return this.on("end.remove",Vc(this._id))}function Kc(t){var e=this._name,n=this._id;typeof t!="function"&&(t=Ds(t));for(var r=this._groups,s=r.length,i=new Array(s),o=0;o<s;++o)for(var l=r[o],a=l.length,u=i[o]=new Array(a),c,f,h=0;h<a;++h)(c=l[h])&&(f=t.call(c,c.__data__,h,l))&&("__data__"in c&&(f.__data__=c.__data__),u[h]=f,Wr(u[h],e,n,h,u,tt(c,n)));return new mt(i,this._parents,e,n)}function Gc(t){var e=this._name,n=this._id;typeof t!="function"&&(t=Ra(t));for(var r=this._groups,s=r.length,i=[],o=[],l=0;l<s;++l)for(var a=r[l],u=a.length,c,f=0;f<u;++f)if(c=a[f]){for(var h=t.call(c,c.__data__,f,a),d,p=tt(c,n),w=0,v=h.length;w<v;++w)(d=h[w])&&Wr(d,e,n,w,h,p);i.push(h),o.push(c)}return new mt(i,o,e,n)}var Qc=In.prototype.constructor;function Yc(){return new Qc(this._groups,this._parents)}function Zc(t,e){var n,r,s;return function(){var i=Zt(this,t),o=(this.style.removeProperty(t),Zt(this,t));return i===o?null:i===n&&o===r?s:s=e(n=i,r=o)}}function Ka(t){return function(){this.style.removeProperty(t)}}function ef(t,e,n){var r,s=n+"",i;return function(){var o=Zt(this,t);return o===s?null:o===r?i:i=e(r=o,n)}}function tf(t,e,n){var r,s,i;return function(){var o=Zt(this,t),l=n(this),a=l+"";return l==null&&(a=l=(this.style.removeProperty(t),Zt(this,t))),o===a?null:o===r&&a===s?i:(s=a,i=e(r=o,l))}}function nf(t,e){var n,r,s,i="style."+e,o="end."+i,l;return function(){var a=ct(this,t),u=a.on,c=a.value[i]==null?l||(l=Ka(e)):void 0;(u!==n||s!==c)&&(r=(n=u).copy()).on(o,s=c),a.on=r}}function rf(t,e,n){var r=(t+="")=="transform"?ac:Ja;return e==null?this.styleTween(t,Zc(t,r)).on("end.style."+t,Ka(t)):typeof e=="function"?this.styleTween(t,tf(t,r,Us(this,"style."+t,e))).each(nf(this._id,t)):this.styleTween(t,ef(t,r,e),n).on("end.style."+t,null)}function sf(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function af(t,e,n){var r,s;function i(){var o=e.apply(this,arguments);return o!==s&&(r=(s=o)&&sf(t,o,n)),r}return i._value=e,i}function of(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;return this.tween(r,af(t,e,n??""))}function lf(t){return function(){this.textContent=t}}function uf(t){return function(){var e=t(this);this.textContent=e??""}}function cf(t){return this.tween("text",typeof t=="function"?uf(Us(this,"text",t)):lf(t==null?"":t+""))}function ff(t){return function(e){this.textContent=t.call(this,e)}}function hf(t){var e,n;function r(){var s=t.apply(this,arguments);return s!==n&&(e=(n=s)&&ff(s)),e}return r._value=t,r}function df(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,hf(t))}function pf(){for(var t=this._name,e=this._id,n=Ga(),r=this._groups,s=r.length,i=0;i<s;++i)for(var o=r[i],l=o.length,a,u=0;u<l;++u)if(a=o[u]){var c=tt(a,e);Wr(a,t,n,u,o,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new mt(r,this._parents,t,n)}function mf(){var t,e,n=this,r=n._id,s=n.size();return new Promise(function(i,o){var l={value:o},a={value:function(){--s===0&&i()}};n.each(function(){var u=ct(this,r),c=u.on;c!==t&&(e=(t=c).copy(),e._.cancel.push(l),e._.interrupt.push(l),e._.end.push(a)),u.on=e}),s===0&&i()})}var _f=0;function mt(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function Ga(){return++_f}var ht=In.prototype;mt.prototype={constructor:mt,select:Kc,selectAll:Gc,selectChild:ht.selectChild,selectChildren:ht.selectChildren,filter:Wc,merge:Xc,selection:Yc,transition:pf,call:ht.call,nodes:ht.nodes,node:ht.node,size:ht.size,empty:ht.empty,each:ht.each,on:zc,attr:Sc,attrTween:Mc,style:rf,styleTween:of,text:cf,textTween:df,remove:Jc,tween:yc,delay:$c,duration:Lc,ease:qc,easeVarying:jc,end:mf,[Symbol.iterator]:ht[Symbol.iterator]};function gf(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var wf={time:null,delay:0,duration:250,ease:gf};function yf(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function vf(t){var e,n;t instanceof mt?(e=t._id,t=t._name):(e=Ga(),(n=wf).time=Ws(),t=t==null?null:t+"");for(var r=this._groups,s=r.length,i=0;i<s;++i)for(var o=r[i],l=o.length,a,u=0;u<l;++u)(a=o[u])&&Wr(a,t,e,u,o,n||yf(a,e));return new mt(r,this._parents,t,e)}In.prototype.interrupt=_c;In.prototype.transition=vf;const hs=Math.PI,ds=2*hs,St=1e-6,bf=ds-St;function Qa(t){this._+=t[0];for(let e=1,n=t.length;e<n;++e)this._+=arguments[e]+t[e]}function xf(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return Qa;const n=10**e;return function(r){this._+=r[0];for(let s=1,i=r.length;s<i;++s)this._+=Math.round(arguments[s]*n)/n+r[s]}}class kf{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?Qa:xf(e)}moveTo(e,n){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,n){this._append`L${this._x1=+e},${this._y1=+n}`}quadraticCurveTo(e,n,r,s){this._append`Q${+e},${+n},${this._x1=+r},${this._y1=+s}`}bezierCurveTo(e,n,r,s,i,o){this._append`C${+e},${+n},${+r},${+s},${this._x1=+i},${this._y1=+o}`}arcTo(e,n,r,s,i){if(e=+e,n=+n,r=+r,s=+s,i=+i,i<0)throw new Error(`negative radius: ${i}`);let o=this._x1,l=this._y1,a=r-e,u=s-n,c=o-e,f=l-n,h=c*c+f*f;if(this._x1===null)this._append`M${this._x1=e},${this._y1=n}`;else if(h>St)if(!(Math.abs(f*a-u*c)>St)||!i)this._append`L${this._x1=e},${this._y1=n}`;else{let d=r-o,p=s-l,w=a*a+u*u,v=d*d+p*p,x=Math.sqrt(w),k=Math.sqrt(h),R=i*Math.tan((hs-Math.acos((w+h-v)/(2*x*k)))/2),M=R/k,E=R/x;Math.abs(M-1)>St&&this._append`L${e+M*c},${n+M*f}`,this._append`A${i},${i},0,0,${+(f*d>c*p)},${this._x1=e+E*a},${this._y1=n+E*u}`}}arc(e,n,r,s,i,o){if(e=+e,n=+n,r=+r,o=!!o,r<0)throw new Error(`negative radius: ${r}`);let l=r*Math.cos(s),a=r*Math.sin(s),u=e+l,c=n+a,f=1^o,h=o?s-i:i-s;this._x1===null?this._append`M${u},${c}`:(Math.abs(this._x1-u)>St||Math.abs(this._y1-c)>St)&&this._append`L${u},${c}`,r&&(h<0&&(h=h%ds+ds),h>bf?this._append`A${r},${r},0,1,${f},${e-l},${n-a}A${r},${r},0,1,${f},${this._x1=u},${this._y1=c}`:h>St&&this._append`A${r},${r},0,${+(h>=hs)},${f},${this._x1=e+r*Math.cos(i)},${this._y1=n+r*Math.sin(i)}`)}rect(e,n,r,s){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}h${r=+r}v${+s}h${-r}Z`}toString(){return this._}}function Dt(t){return function(){return t}}function Cf(t){let e=3;return t.digits=function(n){if(!arguments.length)return e;if(n==null)e=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);e=r}return t},()=>new kf(e)}function Af(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Ya(t){this._context=t}Ya.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function Sf(t){return new Ya(t)}function Ef(t){return t[0]}function Rf(t){return t[1]}function Pf(t,e){var n=Dt(!0),r=null,s=Sf,i=null,o=Cf(l);t=typeof t=="function"?t:t===void 0?Ef:Dt(t),e=typeof e=="function"?e:e===void 0?Rf:Dt(e);function l(a){var u,c=(a=Af(a)).length,f,h=!1,d;for(r==null&&(i=s(d=o())),u=0;u<=c;++u)!(u<c&&n(f=a[u],u,a))===h&&((h=!h)?i.lineStart():i.lineEnd()),h&&i.point(+t(f,u,a),+e(f,u,a));if(d)return i=null,d+""||null}return l.x=function(a){return arguments.length?(t=typeof a=="function"?a:Dt(+a),l):t},l.y=function(a){return arguments.length?(e=typeof a=="function"?a:Dt(+a),l):e},l.defined=function(a){return arguments.length?(n=typeof a=="function"?a:Dt(!!a),l):n},l.curve=function(a){return arguments.length?(s=a,r!=null&&(i=s(r)),l):s},l.context=function(a){return arguments.length?(a==null?r=i=null:i=s(r=a),l):r},l}function Ni(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function Za(t){this._context=t}Za.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Ni(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Ni(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function If(t){return new Za(t)}function an(t,e,n){this.k=t,this.x=e,this.y=n}an.prototype={constructor:an,scale:function(t){return t===1?this:new an(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new an(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};an.prototype;var xt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function eo(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Mf(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var s=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,s.get?s:{enumerable:!0,get:function(){return t[r]}})}),n}var to={exports:{}};/* @license
Papa Parse
v5.4.1
https://github.com/mholt/PapaParse
License: MIT
*/(function(t,e){(function(n,r){t.exports=r()})(xt,function n(){var r=typeof self<"u"?self:typeof window<"u"?window:r!==void 0?r:{},s=!r.document&&!!r.postMessage,i=r.IS_PAPA_WORKER||!1,o={},l=0,a={parse:function(_,m){var C=(m=m||{}).dynamicTyping||!1;if(b(C)&&(m.dynamicTypingFunction=C,C={}),m.dynamicTyping=C,m.transform=!!b(m.transform)&&m.transform,m.worker&&a.WORKERS_SUPPORTED){var S=function(){if(!a.WORKERS_SUPPORTED)return!1;var N=(U=r.URL||r.webkitURL||null,X=n.toString(),a.BLOB_URL||(a.BLOB_URL=U.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",X,")();"],{type:"text/javascript"})))),L=new r.Worker(N),U,X;return L.onmessage=k,L.id=l++,o[L.id]=L}();return S.userStep=m.step,S.userChunk=m.chunk,S.userComplete=m.complete,S.userError=m.error,m.step=b(m.step),m.chunk=b(m.chunk),m.complete=b(m.complete),m.error=b(m.error),delete m.worker,void S.postMessage({input:_,config:m,workerId:S.id})}var O=null;return a.NODE_STREAM_INPUT,typeof _=="string"?(_=function(N){return N.charCodeAt(0)===65279?N.slice(1):N}(_),O=m.download?new f(m):new d(m)):_.readable===!0&&b(_.read)&&b(_.on)?O=new p(m):(r.File&&_ instanceof File||_ instanceof Object)&&(O=new h(m)),O.stream(_)},unparse:function(_,m){var C=!1,S=!0,O=",",N=`\r
`,L='"',U=L+L,X=!1,D=null,j=!1;(function(){if(typeof m=="object"){if(typeof m.delimiter!="string"||a.BAD_DELIMITERS.filter(function(F){return m.delimiter.indexOf(F)!==-1}).length||(O=m.delimiter),(typeof m.quotes=="boolean"||typeof m.quotes=="function"||Array.isArray(m.quotes))&&(C=m.quotes),typeof m.skipEmptyLines!="boolean"&&typeof m.skipEmptyLines!="string"||(X=m.skipEmptyLines),typeof m.newline=="string"&&(N=m.newline),typeof m.quoteChar=="string"&&(L=m.quoteChar),typeof m.header=="boolean"&&(S=m.header),Array.isArray(m.columns)){if(m.columns.length===0)throw new Error("Option columns is empty");D=m.columns}m.escapeChar!==void 0&&(U=m.escapeChar+L),(typeof m.escapeFormulae=="boolean"||m.escapeFormulae instanceof RegExp)&&(j=m.escapeFormulae instanceof RegExp?m.escapeFormulae:/^[=+\-@\t\r].*$/)}})();var $=new RegExp(v(L),"g");if(typeof _=="string"&&(_=JSON.parse(_)),Array.isArray(_)){if(!_.length||Array.isArray(_[0]))return W(null,_,X);if(typeof _[0]=="object")return W(D||Object.keys(_[0]),_,X)}else if(typeof _=="object")return typeof _.data=="string"&&(_.data=JSON.parse(_.data)),Array.isArray(_.data)&&(_.fields||(_.fields=_.meta&&_.meta.fields||D),_.fields||(_.fields=Array.isArray(_.data[0])?_.fields:typeof _.data[0]=="object"?Object.keys(_.data[0]):[]),Array.isArray(_.data[0])||typeof _.data[0]=="object"||(_.data=[_.data])),W(_.fields||[],_.data||[],X);throw new Error("Unable to serialize unrecognized input");function W(F,ne,G){var z="";typeof F=="string"&&(F=JSON.parse(F)),typeof ne=="string"&&(ne=JSON.parse(ne));var ee=Array.isArray(F)&&0<F.length,K=!Array.isArray(ne[0]);if(ee&&S){for(var q=0;q<F.length;q++)0<q&&(z+=O),z+=J(F[q],q);0<ne.length&&(z+=N)}for(var T=0;T<ne.length;T++){var Y=ee?F.length:ne[T].length,Z=!1,re=ee?Object.keys(ne[T]).length===0:ne[T].length===0;if(G&&!ee&&(Z=G==="greedy"?ne[T].join("").trim()==="":ne[T].length===1&&ne[T][0].length===0),G==="greedy"&&ee){for(var te=[],ue=0;ue<Y;ue++){var V=K?F[ue]:ue;te.push(ne[T][V])}Z=te.join("").trim()===""}if(!Z){for(var I=0;I<Y;I++){0<I&&!re&&(z+=O);var Q=ee&&K?F[I]:I;z+=J(ne[T][Q],I)}T<ne.length-1&&(!G||0<Y&&!re)&&(z+=N)}}return z}function J(F,ne){if(F==null)return"";if(F.constructor===Date)return JSON.stringify(F).slice(1,25);var G=!1;j&&typeof F=="string"&&j.test(F)&&(F="'"+F,G=!0);var z=F.toString().replace($,U);return(G=G||C===!0||typeof C=="function"&&C(F,ne)||Array.isArray(C)&&C[ne]||function(ee,K){for(var q=0;q<K.length;q++)if(-1<ee.indexOf(K[q]))return!0;return!1}(z,a.BAD_DELIMITERS)||-1<z.indexOf(O)||z.charAt(0)===" "||z.charAt(z.length-1)===" ")?L+z+L:z}}};if(a.RECORD_SEP="",a.UNIT_SEP="",a.BYTE_ORDER_MARK="\uFEFF",a.BAD_DELIMITERS=["\r",`
`,'"',a.BYTE_ORDER_MARK],a.WORKERS_SUPPORTED=!s&&!!r.Worker,a.NODE_STREAM_INPUT=1,a.LocalChunkSize=10485760,a.RemoteChunkSize=5242880,a.DefaultDelimiter=",",a.Parser=x,a.ParserHandle=w,a.NetworkStreamer=f,a.FileStreamer=h,a.StringStreamer=d,a.ReadableStreamStreamer=p,r.jQuery){var u=r.jQuery;u.fn.parse=function(_){var m=_.config||{},C=[];return this.each(function(N){if(!(u(this).prop("tagName").toUpperCase()==="INPUT"&&u(this).attr("type").toLowerCase()==="file"&&r.FileReader)||!this.files||this.files.length===0)return!0;for(var L=0;L<this.files.length;L++)C.push({file:this.files[L],inputElem:this,instanceConfig:u.extend({},m)})}),S(),this;function S(){if(C.length!==0){var N,L,U,X,D=C[0];if(b(_.before)){var j=_.before(D.file,D.inputElem);if(typeof j=="object"){if(j.action==="abort")return N="AbortError",L=D.file,U=D.inputElem,X=j.reason,void(b(_.error)&&_.error({name:N},L,U,X));if(j.action==="skip")return void O();typeof j.config=="object"&&(D.instanceConfig=u.extend(D.instanceConfig,j.config))}else if(j==="skip")return void O()}var $=D.instanceConfig.complete;D.instanceConfig.complete=function(W){b($)&&$(W,D.file,D.inputElem),O()},a.parse(D.file,D.instanceConfig)}else b(_.complete)&&_.complete()}function O(){C.splice(0,1),S()}}}function c(_){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(m){var C=E(m);C.chunkSize=parseInt(C.chunkSize),m.step||m.chunk||(C.chunkSize=null),this._handle=new w(C),(this._handle.streamer=this)._config=C}).call(this,_),this.parseChunk=function(m,C){if(this.isFirstChunk&&b(this._config.beforeFirstChunk)){var S=this._config.beforeFirstChunk(m);S!==void 0&&(m=S)}this.isFirstChunk=!1,this._halted=!1;var O=this._partialLine+m;this._partialLine="";var N=this._handle.parse(O,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var L=N.meta.cursor;this._finished||(this._partialLine=O.substring(L-this._baseIndex),this._baseIndex=L),N&&N.data&&(this._rowCount+=N.data.length);var U=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(i)r.postMessage({results:N,workerId:a.WORKER_ID,finished:U});else if(b(this._config.chunk)&&!C){if(this._config.chunk(N,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);N=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(N.data),this._completeResults.errors=this._completeResults.errors.concat(N.errors),this._completeResults.meta=N.meta),this._completed||!U||!b(this._config.complete)||N&&N.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),U||N&&N.meta.paused||this._nextChunk(),N}this._halted=!0},this._sendError=function(m){b(this._config.error)?this._config.error(m):i&&this._config.error&&r.postMessage({workerId:a.WORKER_ID,error:m,finished:!1})}}function f(_){var m;(_=_||{}).chunkSize||(_.chunkSize=a.RemoteChunkSize),c.call(this,_),this._nextChunk=s?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(C){this._input=C,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(m=new XMLHttpRequest,this._config.withCredentials&&(m.withCredentials=this._config.withCredentials),s||(m.onload=P(this._chunkLoaded,this),m.onerror=P(this._chunkError,this)),m.open(this._config.downloadRequestBody?"POST":"GET",this._input,!s),this._config.downloadRequestHeaders){var C=this._config.downloadRequestHeaders;for(var S in C)m.setRequestHeader(S,C[S])}if(this._config.chunkSize){var O=this._start+this._config.chunkSize-1;m.setRequestHeader("Range","bytes="+this._start+"-"+O)}try{m.send(this._config.downloadRequestBody)}catch(N){this._chunkError(N.message)}s&&m.status===0&&this._chunkError()}},this._chunkLoaded=function(){m.readyState===4&&(m.status<200||400<=m.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:m.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(C){var S=C.getResponseHeader("Content-Range");return S===null?-1:parseInt(S.substring(S.lastIndexOf("/")+1))}(m),this.parseChunk(m.responseText)))},this._chunkError=function(C){var S=m.statusText||C;this._sendError(new Error(S))}}function h(_){var m,C;(_=_||{}).chunkSize||(_.chunkSize=a.LocalChunkSize),c.call(this,_);var S=typeof FileReader<"u";this.stream=function(O){this._input=O,C=O.slice||O.webkitSlice||O.mozSlice,S?((m=new FileReader).onload=P(this._chunkLoaded,this),m.onerror=P(this._chunkError,this)):m=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var O=this._input;if(this._config.chunkSize){var N=Math.min(this._start+this._config.chunkSize,this._input.size);O=C.call(O,this._start,N)}var L=m.readAsText(O,this._config.encoding);S||this._chunkLoaded({target:{result:L}})},this._chunkLoaded=function(O){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(O.target.result)},this._chunkError=function(){this._sendError(m.error)}}function d(_){var m;c.call(this,_=_||{}),this.stream=function(C){return m=C,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var C,S=this._config.chunkSize;return S?(C=m.substring(0,S),m=m.substring(S)):(C=m,m=""),this._finished=!m,this.parseChunk(C)}}}function p(_){c.call(this,_=_||{});var m=[],C=!0,S=!1;this.pause=function(){c.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){c.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(O){this._input=O,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){S&&m.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),m.length?this.parseChunk(m.shift()):C=!0},this._streamData=P(function(O){try{m.push(typeof O=="string"?O:O.toString(this._config.encoding)),C&&(C=!1,this._checkIsFinished(),this.parseChunk(m.shift()))}catch(N){this._streamError(N)}},this),this._streamError=P(function(O){this._streamCleanUp(),this._sendError(O)},this),this._streamEnd=P(function(){this._streamCleanUp(),S=!0,this._streamData("")},this),this._streamCleanUp=P(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function w(_){var m,C,S,O=Math.pow(2,53),N=-O,L=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,U=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,X=this,D=0,j=0,$=!1,W=!1,J=[],F={data:[],errors:[],meta:{}};if(b(_.step)){var ne=_.step;_.step=function(T){if(F=T,ee())z();else{if(z(),F.data.length===0)return;D+=T.data.length,_.preview&&D>_.preview?C.abort():(F.data=F.data[0],ne(F,X))}}}function G(T){return _.skipEmptyLines==="greedy"?T.join("").trim()==="":T.length===1&&T[0].length===0}function z(){return F&&S&&(q("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+a.DefaultDelimiter+"'"),S=!1),_.skipEmptyLines&&(F.data=F.data.filter(function(T){return!G(T)})),ee()&&function(){if(!F)return;function T(Z,re){b(_.transformHeader)&&(Z=_.transformHeader(Z,re)),J.push(Z)}if(Array.isArray(F.data[0])){for(var Y=0;ee()&&Y<F.data.length;Y++)F.data[Y].forEach(T);F.data.splice(0,1)}else F.data.forEach(T)}(),function(){if(!F||!_.header&&!_.dynamicTyping&&!_.transform)return F;function T(Z,re){var te,ue=_.header?{}:[];for(te=0;te<Z.length;te++){var V=te,I=Z[te];_.header&&(V=te>=J.length?"__parsed_extra":J[te]),_.transform&&(I=_.transform(I,V)),I=K(V,I),V==="__parsed_extra"?(ue[V]=ue[V]||[],ue[V].push(I)):ue[V]=I}return _.header&&(te>J.length?q("FieldMismatch","TooManyFields","Too many fields: expected "+J.length+" fields but parsed "+te,j+re):te<J.length&&q("FieldMismatch","TooFewFields","Too few fields: expected "+J.length+" fields but parsed "+te,j+re)),ue}var Y=1;return!F.data.length||Array.isArray(F.data[0])?(F.data=F.data.map(T),Y=F.data.length):F.data=T(F.data,0),_.header&&F.meta&&(F.meta.fields=J),j+=Y,F}()}function ee(){return _.header&&J.length===0}function K(T,Y){return Z=T,_.dynamicTypingFunction&&_.dynamicTyping[Z]===void 0&&(_.dynamicTyping[Z]=_.dynamicTypingFunction(Z)),(_.dynamicTyping[Z]||_.dynamicTyping)===!0?Y==="true"||Y==="TRUE"||Y!=="false"&&Y!=="FALSE"&&(function(re){if(L.test(re)){var te=parseFloat(re);if(N<te&&te<O)return!0}return!1}(Y)?parseFloat(Y):U.test(Y)?new Date(Y):Y===""?null:Y):Y;var Z}function q(T,Y,Z,re){var te={type:T,code:Y,message:Z};re!==void 0&&(te.row=re),F.errors.push(te)}this.parse=function(T,Y,Z){var re=_.quoteChar||'"';if(_.newline||(_.newline=function(V,I){V=V.substring(0,1048576);var Q=new RegExp(v(I)+"([^]*?)"+v(I),"gm"),ge=(V=V.replace(Q,"")).split("\r"),Oe=V.split(`
`),Fe=1<Oe.length&&Oe[0].length<ge[0].length;if(ge.length===1||Fe)return`
`;for(var Ee=0,me=0;me<ge.length;me++)ge[me][0]===`
`&&Ee++;return Ee>=ge.length/2?`\r
`:"\r"}(T,re)),S=!1,_.delimiter)b(_.delimiter)&&(_.delimiter=_.delimiter(T),F.meta.delimiter=_.delimiter);else{var te=function(V,I,Q,ge,Oe){var Fe,Ee,me,ve;Oe=Oe||[",","	","|",";",a.RECORD_SEP,a.UNIT_SEP];for(var Ct=0;Ct<Oe.length;Ct++){var de=Oe[Ct],Ft=0,ft=0,At=0;me=void 0;for(var _t=new x({comments:ge,delimiter:de,newline:I,preview:10}).parse(V),gt=0;gt<_t.data.length;gt++)if(Q&&G(_t.data[gt]))At++;else{var wt=_t.data[gt].length;ft+=wt,me!==void 0?0<wt&&(Ft+=Math.abs(wt-me),me=wt):me=wt}0<_t.data.length&&(ft/=_t.data.length-At),(Ee===void 0||Ft<=Ee)&&(ve===void 0||ve<ft)&&1.99<ft&&(Ee=Ft,Fe=de,ve=ft)}return{successful:!!(_.delimiter=Fe),bestDelimiter:Fe}}(T,_.newline,_.skipEmptyLines,_.comments,_.delimitersToGuess);te.successful?_.delimiter=te.bestDelimiter:(S=!0,_.delimiter=a.DefaultDelimiter),F.meta.delimiter=_.delimiter}var ue=E(_);return _.preview&&_.header&&ue.preview++,m=T,C=new x(ue),F=C.parse(m,Y,Z),z(),$?{meta:{paused:!0}}:F||{meta:{paused:!1}}},this.paused=function(){return $},this.pause=function(){$=!0,C.abort(),m=b(_.chunk)?"":m.substring(C.getCharIndex())},this.resume=function(){X.streamer._halted?($=!1,X.streamer.parseChunk(m,!0)):setTimeout(X.resume,3)},this.aborted=function(){return W},this.abort=function(){W=!0,C.abort(),F.meta.aborted=!0,b(_.complete)&&_.complete(F),m=""}}function v(_){return _.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function x(_){var m,C=(_=_||{}).delimiter,S=_.newline,O=_.comments,N=_.step,L=_.preview,U=_.fastMode,X=m=_.quoteChar===void 0||_.quoteChar===null?'"':_.quoteChar;if(_.escapeChar!==void 0&&(X=_.escapeChar),(typeof C!="string"||-1<a.BAD_DELIMITERS.indexOf(C))&&(C=","),O===C)throw new Error("Comment character same as delimiter");O===!0?O="#":(typeof O!="string"||-1<a.BAD_DELIMITERS.indexOf(O))&&(O=!1),S!==`
`&&S!=="\r"&&S!==`\r
`&&(S=`
`);var D=0,j=!1;this.parse=function($,W,J){if(typeof $!="string")throw new Error("Input must be a string");var F=$.length,ne=C.length,G=S.length,z=O.length,ee=b(N),K=[],q=[],T=[],Y=D=0;if(!$)return He();if(_.header&&!W){var Z=$.split(S)[0].split(C),re=[],te={},ue=!1;for(var V in Z){var I=Z[V];b(_.transformHeader)&&(I=_.transformHeader(I,V));var Q=I,ge=te[I]||0;for(0<ge&&(ue=!0,Q=I+"_"+ge),te[I]=ge+1;re.includes(Q);)Q=Q+"_"+ge;re.push(Q)}if(ue){var Oe=$.split(S);Oe[0]=re.join(C),$=Oe.join(S)}}if(U||U!==!1&&$.indexOf(m)===-1){for(var Fe=$.split(S),Ee=0;Ee<Fe.length;Ee++){if(T=Fe[Ee],D+=T.length,Ee!==Fe.length-1)D+=S.length;else if(J)return He();if(!O||T.substring(0,z)!==O){if(ee){if(K=[],At(T.split(C)),Nn(),j)return He()}else At(T.split(C));if(L&&L<=Ee)return K=K.slice(0,L),He(!0)}}return He()}for(var me=$.indexOf(C,D),ve=$.indexOf(S,D),Ct=new RegExp(v(X)+v(m),"g"),de=$.indexOf(m,D);;)if($[D]!==m)if(O&&T.length===0&&$.substring(D,D+z)===O){if(ve===-1)return He();D=ve+G,ve=$.indexOf(S,D),me=$.indexOf(C,D)}else if(me!==-1&&(me<ve||ve===-1))T.push($.substring(D,me)),D=me+ne,me=$.indexOf(C,D);else{if(ve===-1)break;if(T.push($.substring(D,ve)),wt(ve+G),ee&&(Nn(),j))return He();if(L&&K.length>=L)return He(!0)}else for(de=D,D++;;){if((de=$.indexOf(m,de+1))===-1)return J||q.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:K.length,index:D}),gt();if(de===F-1)return gt($.substring(D,de).replace(Ct,m));if(m!==X||$[de+1]!==X){if(m===X||de===0||$[de-1]!==X){me!==-1&&me<de+1&&(me=$.indexOf(C,de+1)),ve!==-1&&ve<de+1&&(ve=$.indexOf(S,de+1));var Ft=_t(ve===-1?me:Math.min(me,ve));if($.substr(de+1+Ft,ne)===C){T.push($.substring(D,de).replace(Ct,m)),$[D=de+1+Ft+ne]!==m&&(de=$.indexOf(m,D)),me=$.indexOf(C,D),ve=$.indexOf(S,D);break}var ft=_t(ve);if($.substring(de+1+ft,de+1+ft+G)===S){if(T.push($.substring(D,de).replace(Ct,m)),wt(de+1+ft+G),me=$.indexOf(C,D),de=$.indexOf(m,D),ee&&(Nn(),j))return He();if(L&&K.length>=L)return He(!0);break}q.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:K.length,index:D}),de++}}else de++}return gt();function At(ze){K.push(ze),Y=D}function _t(ze){var di=0;if(ze!==-1){var zr=$.substring(de+1,ze);zr&&zr.trim()===""&&(di=zr.length)}return di}function gt(ze){return J||(ze===void 0&&(ze=$.substring(D)),T.push(ze),D=F,At(T),ee&&Nn()),He()}function wt(ze){D=ze,At(T),T=[],ve=$.indexOf(S,D)}function He(ze){return{data:K,errors:q,meta:{delimiter:C,linebreak:S,aborted:j,truncated:!!ze,cursor:Y+(W||0)}}}function Nn(){N(He()),K=[],q=[]}},this.abort=function(){j=!0},this.getCharIndex=function(){return D}}function k(_){var m=_.data,C=o[m.workerId],S=!1;if(m.error)C.userError(m.error,m.file);else if(m.results&&m.results.data){var O={abort:function(){S=!0,R(m.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:M,resume:M};if(b(C.userStep)){for(var N=0;N<m.results.data.length&&(C.userStep({data:m.results.data[N],errors:m.results.errors,meta:m.results.meta},O),!S);N++);delete m.results}else b(C.userChunk)&&(C.userChunk(m.results,O,m.file),delete m.results)}m.finished&&!S&&R(m.workerId,m.results)}function R(_,m){var C=o[_];b(C.userComplete)&&C.userComplete(m),C.terminate(),delete o[_]}function M(){throw new Error("Not implemented.")}function E(_){if(typeof _!="object"||_===null)return _;var m=Array.isArray(_)?[]:{};for(var C in _)m[C]=E(_[C]);return m}function P(_,m){return function(){_.apply(m,arguments)}}function b(_){return typeof _=="function"}return i&&(r.onmessage=function(_){var m=_.data;if(a.WORKER_ID===void 0&&m&&(a.WORKER_ID=m.workerId),typeof m.input=="string")r.postMessage({workerId:a.WORKER_ID,results:a.parse(m.input,m.config),finished:!0});else if(r.File&&m.input instanceof File||m.input instanceof Object){var C=a.parse(m.input,m.config);C&&r.postMessage({workerId:a.WORKER_ID,results:C,finished:!0})}}),(f.prototype=Object.create(c.prototype)).constructor=f,(h.prototype=Object.create(c.prototype)).constructor=h,(d.prototype=Object.create(d.prototype)).constructor=d,(p.prototype=Object.create(c.prototype)).constructor=p,a})})(to);var Of=to.exports;function $i(t,e,n){const r=t.slice();return r[14]=e[n],r}function Ti(t){let e,n,r,s,i,o,l,a,u=t[1]&&Fi(),c=bt(t[0]),f=[];for(let h=0;h<c.length;h+=1)f[h]=Di($i(t,c,h));return{c(){e=A("div"),n=A("table"),r=A("thead"),s=A("tr"),i=A("th"),i.textContent="Text",o=B(),u&&u.c(),l=B(),a=A("tbody");for(let h=0;h<f.length;h+=1)f[h].c();y(i,"class","svelte-1eathy1"),y(r,"class","svelte-1eathy1"),y(n,"class","svelte-1eathy1"),y(e,"class","table svelte-1eathy1")},m(h,d){oe(h,e,d),g(e,n),g(n,r),g(r,s),g(s,i),g(s,o),u&&u.m(s,null),g(n,l),g(n,a);for(let p=0;p<f.length;p+=1)f[p]&&f[p].m(a,null)},p(h,d){if(h[1]?u||(u=Fi(),u.c(),u.m(s,null)):u&&(u.d(1),u=null),d&3){c=bt(h[0]);let p;for(p=0;p<c.length;p+=1){const w=$i(h,c,p);f[p]?f[p].p(w,d):(f[p]=Di(w),f[p].c(),f[p].m(a,null))}for(;p<f.length;p+=1)f[p].d(1);f.length=c.length}},d(h){h&&ae(e),u&&u.d(),Pn(f,h)}}}function Fi(t){let e;return{c(){e=A("th"),e.textContent="Label",y(e,"class","svelte-1eathy1")},m(n,r){oe(n,e,r)},d(n){n&&ae(e)}}}function Li(t){let e,n=t[14].label+"",r;return{c(){e=A("td"),r=fe(n),y(e,"class","svelte-1eathy1")},m(s,i){oe(s,e,i),g(e,r)},p(s,i){i&1&&n!==(n=s[14].label+"")&&Ce(r,n)},d(s){s&&ae(e)}}}function Di(t){let e,n,r=t[14].text+"",s,i,o,l=t[1]&&Li(t);return{c(){e=A("tr"),n=A("td"),s=fe(r),i=B(),l&&l.c(),o=B(),y(n,"class","svelte-1eathy1"),y(e,"class","svelte-1eathy1")},m(a,u){oe(a,e,u),g(e,n),g(n,s),g(e,i),l&&l.m(e,null),g(e,o)},p(a,u){u&1&&r!==(r=a[14].text+"")&&Ce(s,r),a[1]?l?l.p(a,u):(l=Li(a),l.c(),l.m(e,o)):l&&(l.d(1),l=null)},d(a){a&&ae(e),l&&l.d()}}}function Nf(t){let e,n,r,s,i,o,l,a,u=t[3]?"Hide":"Show",c,f,h,d,p,w,v,x,k=t[3]&&Ti(t);return{c(){e=A("section"),n=A("div"),n.textContent="Data",r=B(),s=A("input"),i=B(),o=A("button"),o.textContent="Upload",l=B(),a=A("button"),c=fe(u),h=B(),d=A("div"),p=fe(t[4]),w=B(),k&&k.c(),y(n,"class","section-title svelte-1eathy1"),y(s,"type","file"),y(s,"id","fileInput"),je(s,"display","none"),y(s,"accept",".csv, .tsv, .json, .jsonl"),y(s,"class","svelte-1eathy1"),y(o,"class","button svelte-1eathy1"),y(o,"id","data-upload"),y(a,"class","button svelte-1eathy1"),y(a,"id","data-show"),a.disabled=f=!(t[3]||t[0].length),y(d,"class","message svelte-1eathy1"),y(e,"class","svelte-1eathy1")},m(R,M){oe(R,e,M),g(e,n),g(e,r),g(e,s),t[10](s),g(e,i),g(e,o),g(e,l),g(e,a),g(a,c),g(e,h),g(e,d),g(d,p),g(e,w),k&&k.m(e,null),v||(x=[le(s,"change",t[5]),le(o,"click",t[11]),le(a,"click",t[12])],v=!0)},p(R,[M]){M&8&&u!==(u=R[3]?"Hide":"Show")&&Ce(c,u),M&9&&f!==(f=!(R[3]||R[0].length))&&(a.disabled=f),M&16&&Ce(p,R[4]),R[3]?k?k.p(R,M):(k=Ti(R),k.c(),k.m(e,null)):k&&(k.d(1),k=null)},i:ye,o:ye,d(R){R&&ae(e),t[10](null),k&&k.d(),v=!1,Ue(x)}}}function $f(t,e,n){let r,{fileName:s=""}=e,{hasLabel:i=!1}=e,{data:o=[]}=e,{requireLabel:l=!1}=e,{isFake:a=!1}=e;const u=async()=>{let x=await fetch("./cache.json"),k=JSON.parse(await x.text());Object.keys(k).forEach(function(P){localStorage.setItem(P,k[P])}),x=await fetch("./tweet_eval_emotion_test.jsonl");let R=await x.text(),M=new File([R],"tweet_eval_emotion_test.jsonl",{type:"text/plain"}),E=new DataTransfer;E.items.add(M),n(2,c.files=E.files,c),c.dispatchEvent(new Event("change")),n(7,a=!0)};let c,f=!1,h;const d=x=>{n(7,a=!1);const k=x.target;if(k.files&&k.files[0]){const R=k.files[0],M=new FileReader;M.onload=E=>{if(!E.target||(h=E.target.result,!h))return;let P;try{R.name.endsWith(".csv")||R.name.endsWith(".tsv")?P=Of.parse(h,{delimiter:R.name.endsWith(".csv")?",":"	",header:!0}).data:(R.name.endsWith(".json")||R.name.endsWith(".jsonl"))&&(R.name.endsWith(".json")?P=JSON.parse(h):P=h.split(`
`).filter(_=>_.trim()).map(_=>JSON.parse(_)))}catch(b){n(4,r=`Error: ${b}`);return}if(!P){n(4,r="Error: empty file");return}if(!P[0].text){n(4,r='Error: CSV file must have a "text" column');return}if(n(1,i=P[0].label!==void 0),i)n(0,o=P.map(b=>({text:b.text,label:b.label})));else{if(l){n(4,r='Error: CSV file must have a "label" column');return}n(0,o=P.map(b=>({text:b.text})))}n(6,s=R.name)},M.readAsText(R)}};function p(x){we[x?"unshift":"push"](()=>{c=x,n(2,c)})}const w=()=>{c.click()},v=()=>{(f||o.length)&&n(3,f=!f)};return t.$$set=x=>{"fileName"in x&&n(6,s=x.fileName),"hasLabel"in x&&n(1,i=x.hasLabel),"data"in x&&n(0,o=x.data),"requireLabel"in x&&n(8,l=x.requireLabel),"isFake"in x&&n(7,a=x.isFake)},t.$$.update=()=>{t.$$.dirty&321&&n(4,r=s?`${o.length} records read from ${s}`:`No file uploaded, please upload a CSV, TSV, JSON, or JSONL file with a "text" and ${l?"a":"an optional"} "label" column.`)},[o,i,c,f,r,d,s,a,l,u,p,w,v]}class Hs extends ut{constructor(e){super(),lt(this,e,$f,Nf,et,{fileName:6,hasLabel:1,data:0,requireLabel:8,isFake:7,loadExample:9})}get fileName(){return this.$$.ctx[6]}set fileName(e){this.$$set({fileName:e}),Qe()}get hasLabel(){return this.$$.ctx[1]}set hasLabel(e){this.$$set({hasLabel:e}),Qe()}get data(){return this.$$.ctx[0]}set data(e){this.$$set({data:e}),Qe()}get requireLabel(){return this.$$.ctx[8]}set requireLabel(e){this.$$set({requireLabel:e}),Qe()}get isFake(){return this.$$.ctx[7]}set isFake(e){this.$$set({isFake:e}),Qe()}get loadExample(){return this.$$.ctx[9]}}const jt="4.51.0";let qi=!1,yn,no,ro,ps,so,io,ao,oo,lo;function Tf(t,e={auto:!1}){if(qi)throw new Error(`you must \`import 'openai/shims/${t.kind}'\` before importing anything else from openai`);if(yn)throw new Error(`can't \`import 'openai/shims/${t.kind}'\` after \`import 'openai/shims/${yn}'\``);qi=e.auto,yn=t.kind,no=t.fetch,ro=t.FormData,ps=t.File,so=t.ReadableStream,io=t.getMultipartRequestOptions,ao=t.getDefaultAgent,oo=t.fileFromPath,lo=t.isFsReadStream}class Ff{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}}function Lf({manuallyImported:t}={}){const e=t?"You may need to use polyfills":"Add one of these imports before your first `import  from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let n,r,s,i;try{n=fetch,r=Request,s=Response,i=Headers}catch(o){throw new Error(`this environment is missing the following Web Fetch API type: ${o.message}. ${e}`)}return{kind:"web",fetch:n,Request:r,Response:s,Headers:i,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${e}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${e}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${e}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${e}`)}},getMultipartRequestOptions:async(o,l)=>({...l,body:new Ff(o)}),getDefaultAgent:o=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:o=>!1}}yn||Tf(Lf(),{auto:!0});class ce extends Error{}class Ae extends ce{constructor(e,n,r,s){super(`${Ae.makeMessage(e,n,r)}`),this.status=e,this.headers=s,this.request_id=s==null?void 0:s["x-request-id"];const i=n;this.error=i,this.code=i==null?void 0:i.code,this.param=i==null?void 0:i.param,this.type=i==null?void 0:i.type}static makeMessage(e,n,r){const s=n!=null&&n.message?typeof n.message=="string"?n.message:JSON.stringify(n.message):n?JSON.stringify(n):r;return e&&s?`${e} ${s}`:e?`${e} status code (no body)`:s||"(no status code or body)"}static generate(e,n,r,s){if(!e)return new Xr({cause:_s(n)});const i=n==null?void 0:n.error;return e===400?new uo(e,i,r,s):e===401?new co(e,i,r,s):e===403?new fo(e,i,r,s):e===404?new ho(e,i,r,s):e===409?new po(e,i,r,s):e===422?new mo(e,i,r,s):e===429?new _o(e,i,r,s):e>=500?new go(e,i,r,s):new Ae(e,i,r,s)}}class We extends Ae{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0),this.status=void 0}}class Xr extends Ae{constructor({message:e,cause:n}){super(void 0,void 0,e||"Connection error.",void 0),this.status=void 0,n&&(this.cause=n)}}class zs extends Xr{constructor({message:e}={}){super({message:e??"Request timed out."})}}class uo extends Ae{constructor(){super(...arguments),this.status=400}}class co extends Ae{constructor(){super(...arguments),this.status=401}}class fo extends Ae{constructor(){super(...arguments),this.status=403}}class ho extends Ae{constructor(){super(...arguments),this.status=404}}class po extends Ae{constructor(){super(...arguments),this.status=409}}class mo extends Ae{constructor(){super(...arguments),this.status=422}}class _o extends Ae{constructor(){super(...arguments),this.status=429}}class go extends Ae{}class at{constructor(e,n){this.iterator=e,this.controller=n}static fromSSEResponse(e,n){let r=!1;async function*s(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let i=!1;try{for await(const o of Df(e,n))if(!i){if(o.data.startsWith("[DONE]")){i=!0;continue}if(o.event===null){let l;try{l=JSON.parse(o.data)}catch(a){throw console.error("Could not parse message into JSON:",o.data),console.error("From chunk:",o.raw),a}if(l&&l.error)throw new Ae(void 0,l.error,void 0,void 0);yield l}else{let l;try{l=JSON.parse(o.data)}catch(a){throw console.error("Could not parse message into JSON:",o.data),console.error("From chunk:",o.raw),a}if(o.event=="error")throw new Ae(void 0,l.error,l.message,void 0);yield{event:o.event,data:l}}}i=!0}catch(o){if(o instanceof Error&&o.name==="AbortError")return;throw o}finally{i||n.abort()}}return new at(s,n)}static fromReadableStream(e,n){let r=!1;async function*s(){const o=new $t,l=wo(e);for await(const a of l)for(const u of o.decode(a))yield u;for(const a of o.flush())yield a}async function*i(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let o=!1;try{for await(const l of s())o||l&&(yield JSON.parse(l));o=!0}catch(l){if(l instanceof Error&&l.name==="AbortError")return;throw l}finally{o||n.abort()}}return new at(i,n)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],n=[],r=this.iterator(),s=i=>({next:()=>{if(i.length===0){const o=r.next();e.push(o),n.push(o)}return i.shift()}});return[new at(()=>s(e),this.controller),new at(()=>s(n),this.controller)]}toReadableStream(){const e=this;let n;const r=new TextEncoder;return new so({async start(){n=e[Symbol.asyncIterator]()},async pull(s){try{const{value:i,done:o}=await n.next();if(o)return s.close();const l=r.encode(JSON.stringify(i)+`
`);s.enqueue(l)}catch(i){s.error(i)}},async cancel(){var s;await((s=n.return)==null?void 0:s.call(n))}})}}async function*Df(t,e){if(!t.body)throw e.abort(),new ce("Attempted to iterate over a response with no body");const n=new jf,r=new $t,s=wo(t.body);for await(const i of qf(s))for(const o of r.decode(i)){const l=n.decode(o);l&&(yield l)}for(const i of r.flush()){const o=n.decode(i);o&&(yield o)}}async function*qf(t){let e=new Uint8Array;for await(const n of t){if(n==null)continue;const r=n instanceof ArrayBuffer?new Uint8Array(n):typeof n=="string"?new TextEncoder().encode(n):n;let s=new Uint8Array(e.length+r.length);s.set(e),s.set(r,e.length),e=s;let i;for(;(i=Bf(e))!==-1;)yield e.slice(0,i),e=e.slice(i)}e.length>0&&(yield e)}function Bf(t){for(let r=0;r<t.length-2;r++){if(t[r]===10&&t[r+1]===10||t[r]===13&&t[r+1]===13)return r+2;if(t[r]===13&&t[r+1]===10&&r+3<t.length&&t[r+2]===13&&t[r+3]===10)return r+4}return-1}class jf{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const i={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],i}if(this.chunks.push(e),e.startsWith(":"))return null;let[n,r,s]=Wf(e,":");return s.startsWith(" ")&&(s=s.substring(1)),n==="event"?this.event=s:n==="data"&&this.data.push(s),null}}class $t{constructor(){this.buffer=[],this.trailingCR=!1}decode(e){let n=this.decodeText(e);if(this.trailingCR&&(n="\r"+n,this.trailingCR=!1),n.endsWith("\r")&&(this.trailingCR=!0,n=n.slice(0,-1)),!n)return[];const r=$t.NEWLINE_CHARS.has(n[n.length-1]||"");let s=n.split($t.NEWLINE_REGEXP);return r&&s.pop(),s.length===1&&!r?(this.buffer.push(s[0]),[]):(this.buffer.length>0&&(s=[this.buffer.join("")+s[0],...s.slice(1)],this.buffer=[]),r||(this.buffer=[s.pop()||""]),s)}decodeText(e){if(e==null)return"";if(typeof e=="string")return e;if(typeof Buffer<"u"){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new ce(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new ce(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new ce("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){if(!this.buffer.length&&!this.trailingCR)return[];const e=[this.buffer.join("")];return this.buffer=[],this.trailingCR=!1,e}}$t.NEWLINE_CHARS=new Set([`
`,"\r"]);$t.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function Wf(t,e){const n=t.indexOf(e);return n!==-1?[t.substring(0,n),e,t.substring(n+e.length)]:[t,"",""]}function wo(t){if(t[Symbol.asyncIterator])return t;const e=t.getReader();return{async next(){try{const n=await e.read();return n!=null&&n.done&&e.releaseLock(),n}catch(n){throw e.releaseLock(),n}},async return(){const n=e.cancel();return e.releaseLock(),await n,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}const yo=t=>t!=null&&typeof t=="object"&&typeof t.url=="string"&&typeof t.blob=="function",vo=t=>t!=null&&typeof t=="object"&&typeof t.name=="string"&&typeof t.lastModified=="number"&&Vs(t),Vs=t=>t!=null&&typeof t=="object"&&typeof t.size=="number"&&typeof t.type=="string"&&typeof t.text=="function"&&typeof t.slice=="function"&&typeof t.arrayBuffer=="function",Xf=t=>vo(t)||yo(t)||lo(t);async function bo(t,e,n){var s;if(t=await t,n??(n=vo(t)?{lastModified:t.lastModified,type:t.type}:{}),yo(t)){const i=await t.blob();return e||(e=new URL(t.url).pathname.split(/[\\/]/).pop()??"unknown_file"),new ps([i],e,n)}const r=await Uf(t);if(e||(e=zf(t)??"unknown_file"),!n.type){const i=(s=r[0])==null?void 0:s.type;typeof i=="string"&&(n={...n,type:i})}return new ps(r,e,n)}async function Uf(t){var n;let e=[];if(typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer)e.push(t);else if(Vs(t))e.push(await t.arrayBuffer());else if(Vf(t))for await(const r of t)e.push(r);else throw new Error(`Unexpected data type: ${typeof t}; constructor: ${(n=t==null?void 0:t.constructor)==null?void 0:n.name}; props: ${Hf(t)}`);return e}function Hf(t){return`[${Object.getOwnPropertyNames(t).map(n=>`"${n}"`).join(", ")}]`}function zf(t){var e;return Qr(t.name)||Qr(t.filename)||((e=Qr(t.path))==null?void 0:e.split(/[\\/]/).pop())}const Qr=t=>{if(typeof t=="string")return t;if(typeof Buffer<"u"&&t instanceof Buffer)return String(t)},Vf=t=>t!=null&&typeof t=="object"&&typeof t[Symbol.asyncIterator]=="function",Bi=t=>t&&typeof t=="object"&&t.body&&t[Symbol.toStringTag]==="MultipartBody",Sn=async t=>{const e=await Jf(t.body);return io(e,t)},Jf=async t=>{const e=new ro;return await Promise.all(Object.entries(t||{}).map(([n,r])=>ms(e,n,r))),e},ms=async(t,e,n)=>{if(n!==void 0){if(n==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")t.append(e,String(n));else if(Xf(n)){const r=await bo(n);t.append(e,r)}else if(Array.isArray(n))await Promise.all(n.map(r=>ms(t,e+"[]",r)));else if(typeof n=="object")await Promise.all(Object.entries(n).map(([r,s])=>ms(t,`${e}[${r}]`,s)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${n} instead`)}};var Jt={},Kf=function(t,e,n,r,s){if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(t,n),n},Gf=function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},Ln;async function xo(t){const{response:e}=t;if(t.options.stream)return Kt("response",e.status,e.url,e.headers,e.body),t.options.__streamClass?t.options.__streamClass.fromSSEResponse(e,t.controller):at.fromSSEResponse(e,t.controller);if(e.status===204)return null;if(t.options.__binaryResponse)return e;const n=e.headers.get("content-type");if((n==null?void 0:n.includes("application/json"))||(n==null?void 0:n.includes("application/vnd.api+json"))){const i=await e.json();return Kt("response",e.status,e.url,e.headers,i),i}const s=await e.text();return Kt("response",e.status,e.url,e.headers,s),s}class Ur extends Promise{constructor(e,n=xo){super(r=>{r(null)}),this.responsePromise=e,this.parseResponse=n}_thenUnwrap(e){return new Ur(this.responsePromise,async n=>e(await this.parseResponse(n)))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,n]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:n}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,n){return this.parse().then(e,n)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}class Qf{constructor({baseURL:e,maxRetries:n=2,timeout:r=6e5,httpAgent:s,fetch:i}){this.baseURL=e,this.maxRetries=Yr("maxRetries",n),this.timeout=Yr("timeout",r),this.httpAgent=s,this.fetch=i??no}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...rh(),...this.authHeaders(e)}}validateHeaders(e,n){}defaultIdempotencyKey(){return`stainless-node-retry-${oh()}`}get(e,n){return this.methodRequest("get",e,n)}post(e,n){return this.methodRequest("post",e,n)}patch(e,n){return this.methodRequest("patch",e,n)}put(e,n){return this.methodRequest("put",e,n)}delete(e,n){return this.methodRequest("delete",e,n)}methodRequest(e,n,r){return this.request(Promise.resolve(r).then(async s=>{const i=s&&Vs(s==null?void 0:s.body)?new DataView(await s.body.arrayBuffer()):(s==null?void 0:s.body)instanceof DataView?s.body:(s==null?void 0:s.body)instanceof ArrayBuffer?new DataView(s.body):s&&ArrayBuffer.isView(s==null?void 0:s.body)?new DataView(s.body.buffer):s==null?void 0:s.body;return{method:e,path:n,...s,body:i}}))}getAPIList(e,n,r){return this.requestAPIList(n,{method:"get",path:e,...r})}calculateContentLength(e){if(typeof e=="string"){if(typeof Buffer<"u")return Buffer.byteLength(e,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(e).length.toString()}else if(ArrayBuffer.isView(e))return e.byteLength.toString();return null}buildRequest(e){var p;const{method:n,path:r,query:s,headers:i={}}=e,o=ArrayBuffer.isView(e.body)||e.__binaryRequest&&typeof e.body=="string"?e.body:Bi(e.body)?e.body.body:e.body?JSON.stringify(e.body,null,2):null,l=this.calculateContentLength(o),a=this.buildURL(r,s);"timeout"in e&&Yr("timeout",e.timeout);const u=e.timeout??this.timeout,c=e.httpAgent??this.httpAgent??ao(a),f=u+1e3;typeof((p=c==null?void 0:c.options)==null?void 0:p.timeout)=="number"&&f>(c.options.timeout??0)&&(c.options.timeout=f),this.idempotencyHeader&&n!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),i[this.idempotencyHeader]=e.idempotencyKey);const h=this.buildHeaders({options:e,headers:i,contentLength:l});return{req:{method:n,...o&&{body:o},headers:h,...c&&{agent:c},signal:e.signal??null},url:a,timeout:u}}buildHeaders({options:e,headers:n,contentLength:r}){const s={};r&&(s["content-length"]=r);const i=this.defaultHeaders(e);return Ui(s,i),Ui(s,n),Bi(e.body)&&yn!=="node"&&delete s["content-type"],this.validateHeaders(s,n),s}async prepareOptions(e){}async prepareRequest(e,{url:n,options:r}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map(n=>[...n])):{...e}:{}}makeStatusError(e,n,r,s){return Ae.generate(e,n,r,s)}request(e,n=null){return new Ur(this.makeRequest(e,n))}async makeRequest(e,n){var c,f;const r=await e;n==null&&(n=r.maxRetries??this.maxRetries),await this.prepareOptions(r);const{req:s,url:i,timeout:o}=this.buildRequest(r);if(await this.prepareRequest(s,{url:i,options:r}),Kt("request",i,r,s.headers),(c=r.signal)!=null&&c.aborted)throw new We;const l=new AbortController,a=await this.fetchWithTimeout(i,s,o,l).catch(_s);if(a instanceof Error){if((f=r.signal)!=null&&f.aborted)throw new We;if(n)return this.retryRequest(r,n);throw a.name==="AbortError"?new zs:new Xr({cause:a})}const u=Zf(a.headers);if(!a.ok){if(n&&this.shouldRetry(a)){const x=`retrying, ${n} attempts remaining`;return Kt(`response (error; ${x})`,a.status,i,u),this.retryRequest(r,n,u)}const h=await a.text().catch(x=>_s(x).message),d=sh(h),p=d?void 0:h;throw Kt(`response (error; ${n?"(error; no more retries left)":"(error; not retryable)"})`,a.status,i,u,p),this.makeStatusError(a.status,d,p,u)}return{response:a,options:r,controller:l}}requestAPIList(e,n){const r=this.makeRequest(n,null);return new Yf(this,r,e)}buildURL(e,n){const r=ah(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),s=this.defaultQuery();return Co(s)||(n={...s,...n}),typeof n=="object"&&n&&!Array.isArray(n)&&(r.search=this.stringifyQuery(n)),r.toString()}stringifyQuery(e){return Object.entries(e).filter(([n,r])=>typeof r<"u").map(([n,r])=>{if(typeof r=="string"||typeof r=="number"||typeof r=="boolean")return`${encodeURIComponent(n)}=${encodeURIComponent(r)}`;if(r===null)return`${encodeURIComponent(n)}=`;throw new ce(`Cannot stringify type ${typeof r}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(e,n,r,s){const{signal:i,...o}=n||{};i&&i.addEventListener("abort",()=>s.abort());const l=setTimeout(()=>s.abort(),r);return this.getRequestClient().fetch.call(void 0,e,{signal:s.signal,...o}).finally(()=>{clearTimeout(l)})}getRequestClient(){return{fetch:this.fetch}}shouldRetry(e){const n=e.headers.get("x-should-retry");return n==="true"?!0:n==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,n,r){let s;const i=r==null?void 0:r["retry-after-ms"];if(i){const l=parseFloat(i);Number.isNaN(l)||(s=l)}const o=r==null?void 0:r["retry-after"];if(o&&!s){const l=parseFloat(o);Number.isNaN(l)?s=Date.parse(o)-Date.now():s=l*1e3}if(!(s&&0<=s&&s<60*1e3)){const l=e.maxRetries??this.maxRetries;s=this.calculateDefaultRetryTimeoutMillis(n,l)}return await On(s),this.makeRequest(e,n-1)}calculateDefaultRetryTimeoutMillis(e,n){const i=n-e,o=Math.min(.5*Math.pow(2,i),8),l=1-Math.random()*.25;return o*l*1e3}getUserAgent(){return`${this.constructor.name}/JS ${jt}`}}class ko{constructor(e,n,r,s){Ln.set(this,void 0),Kf(this,Ln,e),this.options=s,this.response=n,this.body=r}hasNextPage(){return this.getPaginatedItems().length?this.nextPageInfo()!=null:!1}async getNextPage(){const e=this.nextPageInfo();if(!e)throw new ce("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const n={...this.options};if("params"in e&&typeof n.query=="object")n.query={...n.query,...e.params};else if("url"in e){const r=[...Object.entries(n.query||{}),...e.url.searchParams.entries()];for(const[s,i]of r)e.url.searchParams.set(s,i);n.query=void 0,n.path=e.url.toString()}return await Gf(this,Ln,"f").requestAPIList(this.constructor,n)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(Ln=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const n of e.getPaginatedItems())yield n}}class Yf extends Ur{constructor(e,n,r){super(n,async s=>new r(e,s.response,await xo(s),s.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const n of e)yield n}}const Zf=t=>new Proxy(Object.fromEntries(t.entries()),{get(e,n){const r=n.toString();return e[r.toLowerCase()]||e[r]}}),eh={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},Xe=t=>typeof t=="object"&&t!==null&&!Co(t)&&Object.keys(t).every(e=>Ao(eh,e)),th=()=>{var e;if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":jt,"X-Stainless-OS":Wi(Deno.build.os),"X-Stainless-Arch":ji(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((e=Deno.version)==null?void 0:e.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":jt,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if(Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":jt,"X-Stainless-OS":Wi(process.platform),"X-Stainless-Arch":ji(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const t=nh();return t?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":jt,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${t.browser}`,"X-Stainless-Runtime-Version":t.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":jt,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function nh(){if(typeof navigator>"u"||!navigator)return null;const t=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:n}of t){const r=n.exec(navigator.userAgent);if(r){const s=r[1]||0,i=r[2]||0,o=r[3]||0;return{browser:e,version:`${s}.${i}.${o}`}}}return null}const ji=t=>t==="x32"?"x32":t==="x86_64"||t==="x64"?"x64":t==="arm"?"arm":t==="aarch64"||t==="arm64"?"arm64":t?`other:${t}`:"unknown",Wi=t=>(t=t.toLowerCase(),t.includes("ios")?"iOS":t==="android"?"Android":t==="darwin"?"MacOS":t==="win32"?"Windows":t==="freebsd"?"FreeBSD":t==="openbsd"?"OpenBSD":t==="linux"?"Linux":t?`Other:${t}`:"Unknown");let Xi;const rh=()=>Xi??(Xi=th()),sh=t=>{try{return JSON.parse(t)}catch{return}},ih=new RegExp("^(?:[a-z]+:)?//","i"),ah=t=>ih.test(t),On=t=>new Promise(e=>setTimeout(e,t)),Yr=(t,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new ce(`${t} must be an integer`);if(e<0)throw new ce(`${t} must be a positive integer`);return e},_s=t=>t instanceof Error?t:new Error(t),Dn=t=>{var e,n,r,s;if(typeof process<"u")return((e=Jt==null?void 0:Jt[t])==null?void 0:e.trim())??void 0;if(typeof Deno<"u")return(s=(r=(n=Deno.env)==null?void 0:n.get)==null?void 0:r.call(n,t))==null?void 0:s.trim()};function Co(t){if(!t)return!0;for(const e in t)return!1;return!0}function Ao(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Ui(t,e){for(const n in e){if(!Ao(e,n))continue;const r=n.toLowerCase();if(!r)continue;const s=e[n];s===null?delete t[r]:s!==void 0&&(t[r]=s)}}function Kt(t,...e){typeof process<"u"&&(Jt==null?void 0:Jt.DEBUG)==="true"&&console.log(`OpenAI:DEBUG:${t}`,...e)}const oh=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)}),lh=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u";function Hi(t){return t!=null&&typeof t=="object"&&!Array.isArray(t)}class Js extends ko{constructor(e,n,r,s){super(e,n,r,s),this.data=r.data||[],this.object=r.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}}class nt extends ko{constructor(e,n,r,s){super(e,n,r,s),this.data=r.data||[]}getPaginatedItems(){return this.data??[]}nextPageParams(){const e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;const n=Object.fromEntries(e.url.searchParams);return Object.keys(n).length?n:null}nextPageInfo(){var r;const e=this.getPaginatedItems();if(!e.length)return null;const n=(r=e[e.length-1])==null?void 0:r.id;return n?{params:{after:n}}:null}}class pe{constructor(e){this._client=e}}let fr=class extends pe{create(e,n){return this._client.post("/chat/completions",{body:e,...n,stream:e.stream??!1})}};fr||(fr={});let hr=class extends pe{constructor(){super(...arguments),this.completions=new fr(this._client)}};(function(t){t.Completions=fr})(hr||(hr={}));class dr extends pe{create(e,n){return this._client.post("/audio/speech",{body:e,...n,__binaryResponse:!0})}}dr||(dr={});class pr extends pe{create(e,n){return this._client.post("/audio/transcriptions",Sn({body:e,...n}))}}pr||(pr={});class mr extends pe{create(e,n){return this._client.post("/audio/translations",Sn({body:e,...n}))}}mr||(mr={});class _r extends pe{constructor(){super(...arguments),this.transcriptions=new pr(this._client),this.translations=new mr(this._client),this.speech=new dr(this._client)}}(function(t){t.Transcriptions=pr,t.Translations=mr,t.Speech=dr})(_r||(_r={}));class gr extends pe{create(e,n){return this._client.post("/batches",{body:e,...n})}retrieve(e,n){return this._client.get(`/batches/${e}`,n)}list(e={},n){return Xe(e)?this.list({},e):this._client.getAPIList("/batches",Ks,{query:e,...n})}cancel(e,n){return this._client.post(`/batches/${e}/cancel`,n)}}class Ks extends nt{}(function(t){t.BatchesPage=Ks})(gr||(gr={}));class wr extends pe{create(e,n){return this._client.post("/assistants",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,n){return this._client.get(`/assistants/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(e,n,r){return this._client.post(`/assistants/${e}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(e={},n){return Xe(e)?this.list({},e):this._client.getAPIList("/assistants",Gs,{query:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,n){return this._client.delete(`/assistants/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class Gs extends nt{}(function(t){t.AssistantsPage=Gs})(wr||(wr={}));function zi(t){return typeof t.parse=="function"}const Gt=t=>(t==null?void 0:t.role)==="assistant",So=t=>(t==null?void 0:t.role)==="function",Eo=t=>(t==null?void 0:t.role)==="tool";var Ve=function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},ie=function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},Se,zn,Vn,on,ln,Jn,un,dt,cn,Kn,Gn,Wt,gs,yr,ws,ys,vs,bs,Ro,xs;const Vi=10;class Po{constructor(){Se.add(this),this.controller=new AbortController,zn.set(this,void 0),Vn.set(this,()=>{}),on.set(this,()=>{}),ln.set(this,void 0),Jn.set(this,()=>{}),un.set(this,()=>{}),dt.set(this,{}),this._chatCompletions=[],this.messages=[],cn.set(this,!1),Kn.set(this,!1),Gn.set(this,!1),Wt.set(this,!1),bs.set(this,e=>{if(Ve(this,Kn,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new We),e instanceof We)return Ve(this,Gn,!0,"f"),this._emit("abort",e);if(e instanceof ce)return this._emit("error",e);if(e instanceof Error){const n=new ce(e.message);return n.cause=e,this._emit("error",n)}return this._emit("error",new ce(String(e)))}),Ve(this,zn,new Promise((e,n)=>{Ve(this,Vn,e,"f"),Ve(this,on,n,"f")}),"f"),Ve(this,ln,new Promise((e,n)=>{Ve(this,Jn,e,"f"),Ve(this,un,n,"f")}),"f"),ie(this,zn,"f").catch(()=>{}),ie(this,ln,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},ie(this,bs,"f"))},0)}_addChatCompletion(e){var r;this._chatCompletions.push(e),this._emit("chatCompletion",e);const n=(r=e.choices[0])==null?void 0:r.message;return n&&this._addMessage(n),e}_addMessage(e,n=!0){if("content"in e||(e.content=null),this.messages.push(e),n){if(this._emit("message",e),(So(e)||Eo(e))&&e.content)this._emit("functionCallResult",e.content);else if(Gt(e)&&e.function_call)this._emit("functionCall",e.function_call);else if(Gt(e)&&e.tool_calls)for(const r of e.tool_calls)r.type==="function"&&this._emit("functionCall",r.function)}}_connected(){this.ended||(ie(this,Vn,"f").call(this),this._emit("connect"))}get ended(){return ie(this,cn,"f")}get errored(){return ie(this,Kn,"f")}get aborted(){return ie(this,Gn,"f")}abort(){this.controller.abort()}on(e,n){return(ie(this,dt,"f")[e]||(ie(this,dt,"f")[e]=[])).push({listener:n}),this}off(e,n){const r=ie(this,dt,"f")[e];if(!r)return this;const s=r.findIndex(i=>i.listener===n);return s>=0&&r.splice(s,1),this}once(e,n){return(ie(this,dt,"f")[e]||(ie(this,dt,"f")[e]=[])).push({listener:n,once:!0}),this}emitted(e){return new Promise((n,r)=>{Ve(this,Wt,!0,"f"),e!=="error"&&this.once("error",r),this.once(e,n)})}async done(){Ve(this,Wt,!0,"f"),await ie(this,ln,"f")}async finalChatCompletion(){await this.done();const e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new ce("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),ie(this,Se,"m",gs).call(this)}async finalMessage(){return await this.done(),ie(this,Se,"m",yr).call(this)}async finalFunctionCall(){return await this.done(),ie(this,Se,"m",ws).call(this)}async finalFunctionCallResult(){return await this.done(),ie(this,Se,"m",ys).call(this)}async totalUsage(){return await this.done(),ie(this,Se,"m",vs).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emit(e,...n){if(ie(this,cn,"f"))return;e==="end"&&(Ve(this,cn,!0,"f"),ie(this,Jn,"f").call(this));const r=ie(this,dt,"f")[e];if(r&&(ie(this,dt,"f")[e]=r.filter(s=>!s.once),r.forEach(({listener:s})=>s(...n))),e==="abort"){const s=n[0];!ie(this,Wt,"f")&&!(r!=null&&r.length)&&Promise.reject(s),ie(this,on,"f").call(this,s),ie(this,un,"f").call(this,s),this._emit("end");return}if(e==="error"){const s=n[0];!ie(this,Wt,"f")&&!(r!=null&&r.length)&&Promise.reject(s),ie(this,on,"f").call(this,s),ie(this,un,"f").call(this,s),this._emit("end")}}_emitFinal(){const e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);const n=ie(this,Se,"m",yr).call(this);n&&this._emit("finalMessage",n);const r=ie(this,Se,"m",gs).call(this);r&&this._emit("finalContent",r);const s=ie(this,Se,"m",ws).call(this);s&&this._emit("finalFunctionCall",s);const i=ie(this,Se,"m",ys).call(this);i!=null&&this._emit("finalFunctionCallResult",i),this._chatCompletions.some(o=>o.usage)&&this._emit("totalUsage",ie(this,Se,"m",vs).call(this))}async _createChatCompletion(e,n,r){const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),ie(this,Se,"m",Ro).call(this,n);const i=await e.create({...n,stream:!1},{...r,signal:this.controller.signal});return this._connected(),this._addChatCompletion(i)}async _runChatCompletion(e,n,r){for(const s of n.messages)this._addMessage(s,!1);return await this._createChatCompletion(e,n,r)}async _runFunctions(e,n,r){var h;const s="function",{function_call:i="auto",stream:o,...l}=n,a=typeof i!="string"&&(i==null?void 0:i.name),{maxChatCompletions:u=Vi}=r||{},c={};for(const d of n.functions)c[d.name||d.function.name]=d;const f=n.functions.map(d=>({name:d.name||d.function.name,parameters:d.parameters,description:d.description}));for(const d of n.messages)this._addMessage(d,!1);for(let d=0;d<u;++d){const w=(h=(await this._createChatCompletion(e,{...l,function_call:i,functions:f,messages:[...this.messages]},r)).choices[0])==null?void 0:h.message;if(!w)throw new ce("missing message in ChatCompletion response");if(!w.function_call)return;const{name:v,arguments:x}=w.function_call,k=c[v];if(k){if(a&&a!==v){const P=`Invalid function_call: ${JSON.stringify(v)}. ${JSON.stringify(a)} requested. Please try again`;this._addMessage({role:s,name:v,content:P});continue}}else{const P=`Invalid function_call: ${JSON.stringify(v)}. Available options are: ${f.map(b=>JSON.stringify(b.name)).join(", ")}. Please try again`;this._addMessage({role:s,name:v,content:P});continue}let R;try{R=zi(k)?await k.parse(x):x}catch(P){this._addMessage({role:s,name:v,content:P instanceof Error?P.message:String(P)});continue}const M=await k.function(R,this),E=ie(this,Se,"m",xs).call(this,M);if(this._addMessage({role:s,name:v,content:E}),a)return}}async _runTools(e,n,r){var h,d;const s="tool",{tool_choice:i="auto",stream:o,...l}=n,a=typeof i!="string"&&((h=i==null?void 0:i.function)==null?void 0:h.name),{maxChatCompletions:u=Vi}=r||{},c={};for(const p of n.tools)p.type==="function"&&(c[p.function.name||p.function.function.name]=p.function);const f="tools"in n?n.tools.map(p=>p.type==="function"?{type:"function",function:{name:p.function.name||p.function.function.name,parameters:p.function.parameters,description:p.function.description}}:p):void 0;for(const p of n.messages)this._addMessage(p,!1);for(let p=0;p<u;++p){const v=(d=(await this._createChatCompletion(e,{...l,tool_choice:i,tools:f,messages:[...this.messages]},r)).choices[0])==null?void 0:d.message;if(!v)throw new ce("missing message in ChatCompletion response");if(!v.tool_calls)return;for(const x of v.tool_calls){if(x.type!=="function")continue;const k=x.id,{name:R,arguments:M}=x.function,E=c[R];if(E){if(a&&a!==R){const m=`Invalid tool_call: ${JSON.stringify(R)}. ${JSON.stringify(a)} requested. Please try again`;this._addMessage({role:s,tool_call_id:k,content:m});continue}}else{const m=`Invalid tool_call: ${JSON.stringify(R)}. Available options are: ${f.map(C=>JSON.stringify(C.function.name)).join(", ")}. Please try again`;this._addMessage({role:s,tool_call_id:k,content:m});continue}let P;try{P=zi(E)?await E.parse(M):M}catch(m){const C=m instanceof Error?m.message:String(m);this._addMessage({role:s,tool_call_id:k,content:C});continue}const b=await E.function(P,this),_=ie(this,Se,"m",xs).call(this,b);if(this._addMessage({role:s,tool_call_id:k,content:_}),a)return}}}}zn=new WeakMap,Vn=new WeakMap,on=new WeakMap,ln=new WeakMap,Jn=new WeakMap,un=new WeakMap,dt=new WeakMap,cn=new WeakMap,Kn=new WeakMap,Gn=new WeakMap,Wt=new WeakMap,bs=new WeakMap,Se=new WeakSet,gs=function(){return ie(this,Se,"m",yr).call(this).content??null},yr=function(){let e=this.messages.length;for(;e-- >0;){const n=this.messages[e];if(Gt(n)){const{function_call:r,...s}=n,i={...s,content:n.content??null};return r&&(i.function_call=r),i}}throw new ce("stream ended without producing a ChatCompletionMessage with role=assistant")},ws=function(){var e,n;for(let r=this.messages.length-1;r>=0;r--){const s=this.messages[r];if(Gt(s)&&(s!=null&&s.function_call))return s.function_call;if(Gt(s)&&((e=s==null?void 0:s.tool_calls)!=null&&e.length))return(n=s.tool_calls.at(-1))==null?void 0:n.function}},ys=function(){for(let e=this.messages.length-1;e>=0;e--){const n=this.messages[e];if(So(n)&&n.content!=null||Eo(n)&&n.content!=null&&this.messages.some(r=>{var s;return r.role==="assistant"&&((s=r.tool_calls)==null?void 0:s.some(i=>i.type==="function"&&i.id===n.tool_call_id))}))return n.content}},vs=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:n}of this._chatCompletions)n&&(e.completion_tokens+=n.completion_tokens,e.prompt_tokens+=n.prompt_tokens,e.total_tokens+=n.total_tokens);return e},Ro=function(e){if(e.n!=null&&e.n>1)throw new ce("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},xs=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};class En extends Po{static runFunctions(e,n,r){const s=new En,i={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runFunctions"}};return s._run(()=>s._runFunctions(e,n,i)),s}static runTools(e,n,r){const s=new En,i={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runTools"}};return s._run(()=>s._runTools(e,n,i)),s}_addMessage(e){super._addMessage(e),Gt(e)&&e.content&&this._emit("content",e.content)}}var Je=function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},Zr=function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},rt,yt,es,ts,qn,Ji;class Rn extends Po{constructor(){super(...arguments),rt.add(this),yt.set(this,void 0)}get currentChatCompletionSnapshot(){return Je(this,yt,"f")}static fromReadableStream(e){const n=new Rn;return n._run(()=>n._fromReadableStream(e)),n}static createChatCompletion(e,n,r){const s=new Rn;return s._run(()=>s._runChatCompletion(e,{...n,stream:!0},{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),s}async _createChatCompletion(e,n,r){var o;const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),Je(this,rt,"m",es).call(this);const i=await e.create({...n,stream:!0},{...r,signal:this.controller.signal});this._connected();for await(const l of i)Je(this,rt,"m",ts).call(this,l);if((o=i.controller.signal)!=null&&o.aborted)throw new We;return this._addChatCompletion(Je(this,rt,"m",qn).call(this))}async _fromReadableStream(e,n){var o;const r=n==null?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),Je(this,rt,"m",es).call(this),this._connected();const s=at.fromReadableStream(e,this.controller);let i;for await(const l of s)i&&i!==l.id&&this._addChatCompletion(Je(this,rt,"m",qn).call(this)),Je(this,rt,"m",ts).call(this,l),i=l.id;if((o=s.controller.signal)!=null&&o.aborted)throw new We;return this._addChatCompletion(Je(this,rt,"m",qn).call(this))}[(yt=new WeakMap,rt=new WeakSet,es=function(){this.ended||Zr(this,yt,void 0,"f")},ts=function(n){var o,l,a;if(this.ended)return;const r=Je(this,rt,"m",Ji).call(this,n);this._emit("chunk",n,r);const s=(l=(o=n.choices[0])==null?void 0:o.delta)==null?void 0:l.content,i=(a=r.choices[0])==null?void 0:a.message;s!=null&&(i==null?void 0:i.role)==="assistant"&&(i!=null&&i.content)&&this._emit("content",s,i.content)},qn=function(){if(this.ended)throw new ce("stream has ended, this shouldn't happen");const n=Je(this,yt,"f");if(!n)throw new ce("request ended without sending any chunks");return Zr(this,yt,void 0,"f"),uh(n)},Ji=function(n){var r,s,i;let o=Je(this,yt,"f");const{choices:l,...a}=n;o?Object.assign(o,a):o=Zr(this,yt,{...a,choices:[]},"f");for(const{delta:u,finish_reason:c,index:f,logprobs:h=null,...d}of n.choices){let p=o.choices[f];if(p||(p=o.choices[f]={finish_reason:c,index:f,message:{},logprobs:h,...d}),h)if(!p.logprobs)p.logprobs=Object.assign({},h);else{const{content:M,...E}=h;Object.assign(p.logprobs,E),M&&((r=p.logprobs).content??(r.content=[]),p.logprobs.content.push(...M))}if(c&&(p.finish_reason=c),Object.assign(p,d),!u)continue;const{content:w,function_call:v,role:x,tool_calls:k,...R}=u;if(Object.assign(p.message,R),w&&(p.message.content=(p.message.content||"")+w),x&&(p.message.role=x),v&&(p.message.function_call?(v.name&&(p.message.function_call.name=v.name),v.arguments&&((s=p.message.function_call).arguments??(s.arguments=""),p.message.function_call.arguments+=v.arguments)):p.message.function_call=v),k){p.message.tool_calls||(p.message.tool_calls=[]);for(const{index:M,id:E,type:P,function:b,..._}of k){const m=(i=p.message.tool_calls)[M]??(i[M]={});Object.assign(m,_),E&&(m.id=E),P&&(m.type=P),b&&(m.function??(m.function={arguments:""})),b!=null&&b.name&&(m.function.name=b.name),b!=null&&b.arguments&&(m.function.arguments+=b.arguments)}}}return o},Symbol.asyncIterator)](){const e=[],n=[];let r=!1;return this.on("chunk",s=>{const i=n.shift();i?i.resolve(s):e.push(s)}),this.on("end",()=>{r=!0;for(const s of n)s.resolve(void 0);n.length=0}),this.on("abort",s=>{r=!0;for(const i of n)i.reject(s);n.length=0}),this.on("error",s=>{r=!0;for(const i of n)i.reject(s);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((i,o)=>n.push({resolve:i,reject:o})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new at(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function uh(t){const{id:e,choices:n,created:r,model:s,system_fingerprint:i,...o}=t;return{...o,id:e,choices:n.map(({message:l,finish_reason:a,index:u,logprobs:c,...f})=>{if(!a)throw new ce(`missing finish_reason for choice ${u}`);const{content:h=null,function_call:d,tool_calls:p,...w}=l,v=l.role;if(!v)throw new ce(`missing role for choice ${u}`);if(d){const{arguments:x,name:k}=d;if(x==null)throw new ce(`missing function_call.arguments for choice ${u}`);if(!k)throw new ce(`missing function_call.name for choice ${u}`);return{...f,message:{content:h,function_call:{arguments:x,name:k},role:v},finish_reason:a,index:u,logprobs:c}}return p?{...f,index:u,finish_reason:a,logprobs:c,message:{...w,role:v,content:h,tool_calls:p.map((x,k)=>{const{function:R,type:M,id:E,...P}=x,{arguments:b,name:_,...m}=R||{};if(E==null)throw new ce(`missing choices[${u}].tool_calls[${k}].id
${Bn(t)}`);if(M==null)throw new ce(`missing choices[${u}].tool_calls[${k}].type
${Bn(t)}`);if(_==null)throw new ce(`missing choices[${u}].tool_calls[${k}].function.name
${Bn(t)}`);if(b==null)throw new ce(`missing choices[${u}].tool_calls[${k}].function.arguments
${Bn(t)}`);return{...P,id:E,type:M,function:{...m,name:_,arguments:b}}})}}:{...f,message:{...w,content:h,role:v},finish_reason:a,index:u,logprobs:c}}),created:r,model:s,object:"chat.completion",...i?{system_fingerprint:i}:{}}}function Bn(t){return JSON.stringify(t)}class Qt extends Rn{static fromReadableStream(e){const n=new Qt;return n._run(()=>n._fromReadableStream(e)),n}static runFunctions(e,n,r){const s=new Qt,i={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runFunctions"}};return s._run(()=>s._runFunctions(e,n,i)),s}static runTools(e,n,r){const s=new Qt,i={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runTools"}};return s._run(()=>s._runTools(e,n,i)),s}}let Io=class extends pe{runFunctions(e,n){return e.stream?Qt.runFunctions(this._client.chat.completions,e,n):En.runFunctions(this._client.chat.completions,e,n)}runTools(e,n){return e.stream?Qt.runTools(this._client.chat.completions,e,n):En.runTools(this._client.chat.completions,e,n)}stream(e,n){return Rn.createChatCompletion(this._client.chat.completions,e,n)}};class vr extends pe{constructor(){super(...arguments),this.completions=new Io(this._client)}}(function(t){t.Completions=Io})(vr||(vr={}));var Ke=function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},_e=function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},Qn,Yn,fn,hn,Zn,dn,pt,pn,er,tr,Xt,ks;class ch{constructor(){this.controller=new AbortController,Qn.set(this,void 0),Yn.set(this,()=>{}),fn.set(this,()=>{}),hn.set(this,void 0),Zn.set(this,()=>{}),dn.set(this,()=>{}),pt.set(this,{}),pn.set(this,!1),er.set(this,!1),tr.set(this,!1),Xt.set(this,!1),ks.set(this,e=>{if(Ke(this,er,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new We),e instanceof We)return Ke(this,tr,!0,"f"),this._emit("abort",e);if(e instanceof ce)return this._emit("error",e);if(e instanceof Error){const n=new ce(e.message);return n.cause=e,this._emit("error",n)}return this._emit("error",new ce(String(e)))}),Ke(this,Qn,new Promise((e,n)=>{Ke(this,Yn,e,"f"),Ke(this,fn,n,"f")}),"f"),Ke(this,hn,new Promise((e,n)=>{Ke(this,Zn,e,"f"),Ke(this,dn,n,"f")}),"f"),_e(this,Qn,"f").catch(()=>{}),_e(this,hn,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emit("end")},_e(this,ks,"f"))},0)}_addRun(e){return e}_connected(){this.ended||(_e(this,Yn,"f").call(this),this._emit("connect"))}get ended(){return _e(this,pn,"f")}get errored(){return _e(this,er,"f")}get aborted(){return _e(this,tr,"f")}abort(){this.controller.abort()}on(e,n){return(_e(this,pt,"f")[e]||(_e(this,pt,"f")[e]=[])).push({listener:n}),this}off(e,n){const r=_e(this,pt,"f")[e];if(!r)return this;const s=r.findIndex(i=>i.listener===n);return s>=0&&r.splice(s,1),this}once(e,n){return(_e(this,pt,"f")[e]||(_e(this,pt,"f")[e]=[])).push({listener:n,once:!0}),this}emitted(e){return new Promise((n,r)=>{Ke(this,Xt,!0,"f"),e!=="error"&&this.once("error",r),this.once(e,n)})}async done(){Ke(this,Xt,!0,"f"),await _e(this,hn,"f")}_emit(e,...n){if(_e(this,pn,"f"))return;e==="end"&&(Ke(this,pn,!0,"f"),_e(this,Zn,"f").call(this));const r=_e(this,pt,"f")[e];if(r&&(_e(this,pt,"f")[e]=r.filter(s=>!s.once),r.forEach(({listener:s})=>s(...n))),e==="abort"){const s=n[0];!_e(this,Xt,"f")&&!(r!=null&&r.length)&&Promise.reject(s),_e(this,fn,"f").call(this,s),_e(this,dn,"f").call(this,s),this._emit("end");return}if(e==="error"){const s=n[0];!_e(this,Xt,"f")&&!(r!=null&&r.length)&&Promise.reject(s),_e(this,fn,"f").call(this,s),_e(this,dn,"f").call(this,s),this._emit("end")}}async _threadAssistantStream(e,n,r){return await this._createThreadAssistantStream(n,e,r)}async _runAssistantStream(e,n,r,s){return await this._createAssistantStream(n,e,r,s)}async _runToolAssistantStream(e,n,r,s,i){return await this._createToolAssistantStream(r,e,n,s,i)}async _createThreadAssistantStream(e,n,r){const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort()));const i=await e.createAndRun({...n,stream:!1},{...r,signal:this.controller.signal});return this._connected(),this._addRun(i)}async _createToolAssistantStream(e,n,r,s,i){const o=i==null?void 0:i.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",()=>this.controller.abort()));const l=await e.submitToolOutputs(n,r,{...s,stream:!1},{...i,signal:this.controller.signal});return this._connected(),this._addRun(l)}async _createAssistantStream(e,n,r,s){const i=s==null?void 0:s.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));const o=await e.create(n,{...r,stream:!1},{...s,signal:this.controller.signal});return this._connected(),this._addRun(o)}}Qn=new WeakMap,Yn=new WeakMap,fn=new WeakMap,hn=new WeakMap,Zn=new WeakMap,dn=new WeakMap,pt=new WeakMap,pn=new WeakMap,er=new WeakMap,tr=new WeakMap,Xt=new WeakMap,ks=new WeakMap;var H=function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},Le=function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},ke,Cs,it,nr,Ge,It,Ht,Et,br,De,rr,sr,vn,mn,_n,Ki,Gi,Qi,Yi,Zi,ea,ta;class Ze extends ch{constructor(){super(...arguments),ke.add(this),Cs.set(this,[]),it.set(this,{}),nr.set(this,{}),Ge.set(this,void 0),It.set(this,void 0),Ht.set(this,void 0),Et.set(this,void 0),br.set(this,void 0),De.set(this,void 0),rr.set(this,void 0),sr.set(this,void 0),vn.set(this,void 0)}[(Cs=new WeakMap,it=new WeakMap,nr=new WeakMap,Ge=new WeakMap,It=new WeakMap,Ht=new WeakMap,Et=new WeakMap,br=new WeakMap,De=new WeakMap,rr=new WeakMap,sr=new WeakMap,vn=new WeakMap,ke=new WeakSet,Symbol.asyncIterator)](){const e=[],n=[];let r=!1;return this.on("event",s=>{const i=n.shift();i?i.resolve(s):e.push(s)}),this.on("end",()=>{r=!0;for(const s of n)s.resolve(void 0);n.length=0}),this.on("abort",s=>{r=!0;for(const i of n)i.reject(s);n.length=0}),this.on("error",s=>{r=!0;for(const i of n)i.reject(s);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((i,o)=>n.push({resolve:i,reject:o})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){const n=new Ze;return n._run(()=>n._fromReadableStream(e)),n}async _fromReadableStream(e,n){var i;const r=n==null?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),this._connected();const s=at.fromReadableStream(e,this.controller);for await(const o of s)H(this,ke,"m",mn).call(this,o);if((i=s.controller.signal)!=null&&i.aborted)throw new We;return this._addRun(H(this,ke,"m",_n).call(this))}toReadableStream(){return new at(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,n,r,s,i){const o=new Ze;return o._run(()=>o._runToolAssistantStream(e,n,r,s,{...i,headers:{...i==null?void 0:i.headers,"X-Stainless-Helper-Method":"stream"}})),o}async _createToolAssistantStream(e,n,r,s,i){var u;const o=i==null?void 0:i.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",()=>this.controller.abort()));const l={...s,stream:!0},a=await e.submitToolOutputs(n,r,l,{...i,signal:this.controller.signal});this._connected();for await(const c of a)H(this,ke,"m",mn).call(this,c);if((u=a.controller.signal)!=null&&u.aborted)throw new We;return this._addRun(H(this,ke,"m",_n).call(this))}static createThreadAssistantStream(e,n,r){const s=new Ze;return s._run(()=>s._threadAssistantStream(e,n,{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),s}static createAssistantStream(e,n,r,s){const i=new Ze;return i._run(()=>i._runAssistantStream(e,n,r,{...s,headers:{...s==null?void 0:s.headers,"X-Stainless-Helper-Method":"stream"}})),i}currentEvent(){return H(this,rr,"f")}currentRun(){return H(this,sr,"f")}currentMessageSnapshot(){return H(this,Ge,"f")}currentRunStepSnapshot(){return H(this,vn,"f")}async finalRunSteps(){return await this.done(),Object.values(H(this,it,"f"))}async finalMessages(){return await this.done(),Object.values(H(this,nr,"f"))}async finalRun(){if(await this.done(),!H(this,It,"f"))throw Error("Final run was not received.");return H(this,It,"f")}async _createThreadAssistantStream(e,n,r){var l;const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort()));const i={...n,stream:!0},o=await e.createAndRun(i,{...r,signal:this.controller.signal});this._connected();for await(const a of o)H(this,ke,"m",mn).call(this,a);if((l=o.controller.signal)!=null&&l.aborted)throw new We;return this._addRun(H(this,ke,"m",_n).call(this))}async _createAssistantStream(e,n,r,s){var a;const i=s==null?void 0:s.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));const o={...r,stream:!0},l=await e.create(n,o,{...s,signal:this.controller.signal});this._connected();for await(const u of l)H(this,ke,"m",mn).call(this,u);if((a=l.controller.signal)!=null&&a.aborted)throw new We;return this._addRun(H(this,ke,"m",_n).call(this))}static accumulateDelta(e,n){for(const[r,s]of Object.entries(n)){if(!e.hasOwnProperty(r)){e[r]=s;continue}let i=e[r];if(i==null){e[r]=s;continue}if(r==="index"||r==="type"){e[r]=s;continue}if(typeof i=="string"&&typeof s=="string")i+=s;else if(typeof i=="number"&&typeof s=="number")i+=s;else if(Hi(i)&&Hi(s))i=this.accumulateDelta(i,s);else if(Array.isArray(i)&&Array.isArray(s)){if(i.every(o=>typeof o=="string"||typeof o=="number")){i.push(...s);continue}}else throw Error(`Unhandled record type: ${r}, deltaValue: ${s}, accValue: ${i}`);e[r]=i}return e}}mn=function(e){if(!this.ended)switch(Le(this,rr,e,"f"),H(this,ke,"m",Qi).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":H(this,ke,"m",ta).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":H(this,ke,"m",Gi).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":H(this,ke,"m",Ki).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},_n=function(){if(this.ended)throw new ce("stream has ended, this shouldn't happen");if(!H(this,It,"f"))throw Error("Final run has not been received");return H(this,It,"f")},Ki=function(e){const[n,r]=H(this,ke,"m",Zi).call(this,e,H(this,Ge,"f"));Le(this,Ge,n,"f"),H(this,nr,"f")[n.id]=n;for(const s of r){const i=n.content[s.index];(i==null?void 0:i.type)=="text"&&this._emit("textCreated",i.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,n),e.data.delta.content)for(const s of e.data.delta.content){if(s.type=="text"&&s.text){let i=s.text,o=n.content[s.index];if(o&&o.type=="text")this._emit("textDelta",i,o.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(s.index!=H(this,Ht,"f")){if(H(this,Et,"f"))switch(H(this,Et,"f").type){case"text":this._emit("textDone",H(this,Et,"f").text,H(this,Ge,"f"));break;case"image_file":this._emit("imageFileDone",H(this,Et,"f").image_file,H(this,Ge,"f"));break}Le(this,Ht,s.index,"f")}Le(this,Et,n.content[s.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(H(this,Ht,"f")!==void 0){const s=e.data.content[H(this,Ht,"f")];if(s)switch(s.type){case"image_file":this._emit("imageFileDone",s.image_file,H(this,Ge,"f"));break;case"text":this._emit("textDone",s.text,H(this,Ge,"f"));break}}H(this,Ge,"f")&&this._emit("messageDone",e.data),Le(this,Ge,void 0,"f")}},Gi=function(e){const n=H(this,ke,"m",Yi).call(this,e);switch(Le(this,vn,n,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const r=e.data.delta;if(r.step_details&&r.step_details.type=="tool_calls"&&r.step_details.tool_calls&&n.step_details.type=="tool_calls")for(const i of r.step_details.tool_calls)i.index==H(this,br,"f")?this._emit("toolCallDelta",i,n.step_details.tool_calls[i.index]):(H(this,De,"f")&&this._emit("toolCallDone",H(this,De,"f")),Le(this,br,i.index,"f"),Le(this,De,n.step_details.tool_calls[i.index],"f"),H(this,De,"f")&&this._emit("toolCallCreated",H(this,De,"f")));this._emit("runStepDelta",e.data.delta,n);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":Le(this,vn,void 0,"f"),e.data.step_details.type=="tool_calls"&&H(this,De,"f")&&(this._emit("toolCallDone",H(this,De,"f")),Le(this,De,void 0,"f")),this._emit("runStepDone",e.data,n);break}},Qi=function(e){H(this,Cs,"f").push(e),this._emit("event",e)},Yi=function(e){switch(e.event){case"thread.run.step.created":return H(this,it,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let n=H(this,it,"f")[e.data.id];if(!n)throw Error("Received a RunStepDelta before creation of a snapshot");let r=e.data;if(r.delta){const s=Ze.accumulateDelta(n,r.delta);H(this,it,"f")[e.data.id]=s}return H(this,it,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":H(this,it,"f")[e.data.id]=e.data;break}if(H(this,it,"f")[e.data.id])return H(this,it,"f")[e.data.id];throw new Error("No snapshot available")},Zi=function(e,n){let r=[];switch(e.event){case"thread.message.created":return[e.data,r];case"thread.message.delta":if(!n)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let s=e.data;if(s.delta.content)for(const i of s.delta.content)if(i.index in n.content){let o=n.content[i.index];n.content[i.index]=H(this,ke,"m",ea).call(this,i,o)}else n.content[i.index]=i,r.push(i);return[n,r];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(n)return[n,r];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},ea=function(e,n){return Ze.accumulateDelta(n,e)},ta=function(e){switch(Le(this,sr,e.data,"f"),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":Le(this,It,e.data,"f"),H(this,De,"f")&&(this._emit("toolCallDone",H(this,De,"f")),Le(this,De,void 0,"f"));break}};class xr extends pe{create(e,n,r){return this._client.post(`/threads/${e}/messages`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,n,r){return this._client.get(`/threads/${e}/messages/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(e,n,r,s){return this._client.post(`/threads/${e}/messages/${n}`,{body:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}list(e,n={},r){return Xe(n)?this.list(e,{},n):this._client.getAPIList(`/threads/${e}/messages`,Qs,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(e,n,r){return this._client.delete(`/threads/${e}/messages/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}}class Qs extends nt{}(function(t){t.MessagesPage=Qs})(xr||(xr={}));class kr extends pe{retrieve(e,n,r,s){return this._client.get(`/threads/${e}/runs/${n}/steps/${r}`,{...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}list(e,n,r={},s){return Xe(r)?this.list(e,n,{},r):this._client.getAPIList(`/threads/${e}/runs/${n}/steps`,Ys,{query:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}}class Ys extends nt{}(function(t){t.RunStepsPage=Ys})(kr||(kr={}));class Cr extends pe{constructor(){super(...arguments),this.steps=new kr(this._client)}create(e,n,r){return this._client.post(`/threads/${e}/runs`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers},stream:n.stream??!1})}retrieve(e,n,r){return this._client.get(`/threads/${e}/runs/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(e,n,r,s){return this._client.post(`/threads/${e}/runs/${n}`,{body:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}list(e,n={},r){return Xe(n)?this.list(e,{},n):this._client.getAPIList(`/threads/${e}/runs`,Zs,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}cancel(e,n,r){return this._client.post(`/threads/${e}/runs/${n}/cancel`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(e,n,r){const s=await this.create(e,n,r);return await this.poll(e,s.id,r)}createAndStream(e,n,r){return Ze.createAssistantStream(e,this._client.beta.threads.runs,n,r)}async poll(e,n,r){const s={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for(r!=null&&r.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const{data:i,response:o}=await this.retrieve(e,n,{...r,headers:{...r==null?void 0:r.headers,...s}}).withResponse();switch(i.status){case"queued":case"in_progress":case"cancelling":let l=5e3;if(r!=null&&r.pollIntervalMs)l=r.pollIntervalMs;else{const a=o.headers.get("openai-poll-after-ms");if(a){const u=parseInt(a);isNaN(u)||(l=u)}}await On(l);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return i}}}stream(e,n,r){return Ze.createAssistantStream(e,this._client.beta.threads.runs,n,r)}submitToolOutputs(e,n,r,s){return this._client.post(`/threads/${e}/runs/${n}/submit_tool_outputs`,{body:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers},stream:r.stream??!1})}async submitToolOutputsAndPoll(e,n,r,s){const i=await this.submitToolOutputs(e,n,r,s);return await this.poll(e,i.id,s)}submitToolOutputsStream(e,n,r,s){return Ze.createToolAssistantStream(e,n,this._client.beta.threads.runs,r,s)}}class Zs extends nt{}(function(t){t.RunsPage=Zs,t.Steps=kr,t.RunStepsPage=Ys})(Cr||(Cr={}));class Ar extends pe{constructor(){super(...arguments),this.runs=new Cr(this._client),this.messages=new xr(this._client)}create(e={},n){return Xe(e)?this.create({},e):this._client.post("/threads",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,n){return this._client.get(`/threads/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(e,n,r){return this._client.post(`/threads/${e}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(e,n){return this._client.delete(`/threads/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}createAndRun(e,n){return this._client.post("/threads/runs",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers},stream:e.stream??!1})}async createAndRunPoll(e,n){const r=await this.createAndRun(e,n);return await this.runs.poll(r.thread_id,r.id,n)}createAndRunStream(e,n){return Ze.createThreadAssistantStream(e,this._client.beta.threads,n)}}(function(t){t.Runs=Cr,t.RunsPage=Zs,t.Messages=xr,t.MessagesPage=Qs})(Ar||(Ar={}));const fh=async t=>{const e=await Promise.allSettled(t),n=e.filter(s=>s.status==="rejected");if(n.length){for(const s of n)console.error(s.reason);throw new Error(`${n.length} promise(s) failed - see the above errors`)}const r=[];for(const s of e)s.status==="fulfilled"&&r.push(s.value);return r};let Sr=class extends pe{create(e,n,r){return this._client.post(`/vector_stores/${e}/files`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,n,r){return this._client.get(`/vector_stores/${e}/files/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(e,n={},r){return Xe(n)?this.list(e,{},n):this._client.getAPIList(`/vector_stores/${e}/files`,Hr,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(e,n,r){return this._client.delete(`/vector_stores/${e}/files/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(e,n,r){const s=await this.create(e,n,r);return await this.poll(e,s.id,r)}async poll(e,n,r){const s={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for(r!=null&&r.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const i=await this.retrieve(e,n,{...r,headers:s}).withResponse(),o=i.data;switch(o.status){case"in_progress":let l=5e3;if(r!=null&&r.pollIntervalMs)l=r.pollIntervalMs;else{const a=i.response.headers.get("openai-poll-after-ms");if(a){const u=parseInt(a);isNaN(u)||(l=u)}}await On(l);break;case"failed":case"completed":return o}}}async upload(e,n,r){const s=await this._client.files.create({file:n,purpose:"assistants"},r);return this.create(e,{file_id:s.id},r)}async uploadAndPoll(e,n,r){const s=await this.upload(e,n,r);return await this.poll(e,s.id,r)}};class Hr extends nt{}(function(t){t.VectorStoreFilesPage=Hr})(Sr||(Sr={}));class Er extends pe{create(e,n,r){return this._client.post(`/vector_stores/${e}/file_batches`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,n,r){return this._client.get(`/vector_stores/${e}/file_batches/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}cancel(e,n,r){return this._client.post(`/vector_stores/${e}/file_batches/${n}/cancel`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(e,n,r){const s=await this.create(e,n);return await this.poll(e,s.id,r)}listFiles(e,n,r={},s){return Xe(r)?this.listFiles(e,n,{},r):this._client.getAPIList(`/vector_stores/${e}/file_batches/${n}/files`,Hr,{query:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}async poll(e,n,r){const s={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for(r!=null&&r.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const{data:i,response:o}=await this.retrieve(e,n,{...r,headers:s}).withResponse();switch(i.status){case"in_progress":let l=5e3;if(r!=null&&r.pollIntervalMs)l=r.pollIntervalMs;else{const a=o.headers.get("openai-poll-after-ms");if(a){const u=parseInt(a);isNaN(u)||(l=u)}}await On(l);break;case"failed":case"cancelled":case"completed":return i}}}async uploadAndPoll(e,{files:n,fileIds:r=[]},s){if(n===null||n.length==0)throw new Error("No files provided to process.");const i=(s==null?void 0:s.maxConcurrency)??5,o=Math.min(i,n.length),l=this._client,a=n.values(),u=[...r];async function c(h){for(let d of h){const p=await l.files.create({file:d,purpose:"assistants"},s);u.push(p.id)}}const f=Array(o).fill(a).map(c);return await fh(f),await this.createAndPoll(e,{file_ids:u})}}Er||(Er={});class Rr extends pe{constructor(){super(...arguments),this.files=new Sr(this._client),this.fileBatches=new Er(this._client)}create(e,n){return this._client.post("/vector_stores",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,n){return this._client.get(`/vector_stores/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(e,n,r){return this._client.post(`/vector_stores/${e}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(e={},n){return Xe(e)?this.list({},e):this._client.getAPIList("/vector_stores",ei,{query:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,n){return this._client.delete(`/vector_stores/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class ei extends nt{}(function(t){t.VectorStoresPage=ei,t.Files=Sr,t.VectorStoreFilesPage=Hr,t.FileBatches=Er})(Rr||(Rr={}));class Pr extends pe{constructor(){super(...arguments),this.vectorStores=new Rr(this._client),this.chat=new vr(this._client),this.assistants=new wr(this._client),this.threads=new Ar(this._client)}}(function(t){t.VectorStores=Rr,t.VectorStoresPage=ei,t.Chat=vr,t.Assistants=wr,t.AssistantsPage=Gs,t.Threads=Ar})(Pr||(Pr={}));class Ir extends pe{create(e,n){return this._client.post("/completions",{body:e,...n,stream:e.stream??!1})}}Ir||(Ir={});class Mr extends pe{create(e,n){return this._client.post("/embeddings",{body:e,...n})}}Mr||(Mr={});class Or extends pe{create(e,n){return this._client.post("/files",Sn({body:e,...n}))}retrieve(e,n){return this._client.get(`/files/${e}`,n)}list(e={},n){return Xe(e)?this.list({},e):this._client.getAPIList("/files",ti,{query:e,...n})}del(e,n){return this._client.delete(`/files/${e}`,n)}content(e,n){return this._client.get(`/files/${e}/content`,{...n,__binaryResponse:!0})}retrieveContent(e,n){return this._client.get(`/files/${e}/content`,{...n,headers:{Accept:"application/json",...n==null?void 0:n.headers}})}async waitForProcessing(e,{pollInterval:n=5e3,maxWait:r=30*60*1e3}={}){const s=new Set(["processed","error","deleted"]),i=Date.now();let o=await this.retrieve(e);for(;!o.status||!s.has(o.status);)if(await On(n),o=await this.retrieve(e),Date.now()-i>r)throw new zs({message:`Giving up on waiting for file ${e} to finish processing after ${r} milliseconds.`});return o}}class ti extends Js{}(function(t){t.FileObjectsPage=ti})(Or||(Or={}));class Nr extends pe{list(e,n={},r){return Xe(n)?this.list(e,{},n):this._client.getAPIList(`/fine_tuning/jobs/${e}/checkpoints`,ni,{query:n,...r})}}class ni extends nt{}(function(t){t.FineTuningJobCheckpointsPage=ni})(Nr||(Nr={}));class $r extends pe{constructor(){super(...arguments),this.checkpoints=new Nr(this._client)}create(e,n){return this._client.post("/fine_tuning/jobs",{body:e,...n})}retrieve(e,n){return this._client.get(`/fine_tuning/jobs/${e}`,n)}list(e={},n){return Xe(e)?this.list({},e):this._client.getAPIList("/fine_tuning/jobs",ri,{query:e,...n})}cancel(e,n){return this._client.post(`/fine_tuning/jobs/${e}/cancel`,n)}listEvents(e,n={},r){return Xe(n)?this.listEvents(e,{},n):this._client.getAPIList(`/fine_tuning/jobs/${e}/events`,si,{query:n,...r})}}class ri extends nt{}class si extends nt{}(function(t){t.FineTuningJobsPage=ri,t.FineTuningJobEventsPage=si,t.Checkpoints=Nr,t.FineTuningJobCheckpointsPage=ni})($r||($r={}));class Tr extends pe{constructor(){super(...arguments),this.jobs=new $r(this._client)}}(function(t){t.Jobs=$r,t.FineTuningJobsPage=ri,t.FineTuningJobEventsPage=si})(Tr||(Tr={}));class Fr extends pe{createVariation(e,n){return this._client.post("/images/variations",Sn({body:e,...n}))}edit(e,n){return this._client.post("/images/edits",Sn({body:e,...n}))}generate(e,n){return this._client.post("/images/generations",{body:e,...n})}}Fr||(Fr={});class Lr extends pe{retrieve(e,n){return this._client.get(`/models/${e}`,n)}list(e){return this._client.getAPIList("/models",ii,e)}del(e,n){return this._client.delete(`/models/${e}`,n)}}class ii extends Js{}(function(t){t.ModelsPage=ii})(Lr||(Lr={}));class Dr extends pe{create(e,n){return this._client.post("/moderations",{body:e,...n})}}Dr||(Dr={});var Mo;class xe extends Qf{constructor({baseURL:e=Dn("OPENAI_BASE_URL"),apiKey:n=Dn("OPENAI_API_KEY"),organization:r=Dn("OPENAI_ORG_ID")??null,project:s=Dn("OPENAI_PROJECT_ID")??null,...i}={}){if(n===void 0)throw new ce("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const o={apiKey:n,organization:r,project:s,...i,baseURL:e||"https://api.openai.com/v1"};if(!o.dangerouslyAllowBrowser&&lh())throw new ce(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);super({baseURL:o.baseURL,timeout:o.timeout??6e5,httpAgent:o.httpAgent,maxRetries:o.maxRetries,fetch:o.fetch}),this.completions=new Ir(this),this.chat=new hr(this),this.embeddings=new Mr(this),this.files=new Or(this),this.images=new Fr(this),this.audio=new _r(this),this.moderations=new Dr(this),this.models=new Lr(this),this.fineTuning=new Tr(this),this.beta=new Pr(this),this.batches=new gr(this),this._options=o,this.apiKey=n,this.organization=r,this.project=s}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project,...this._options.defaultHeaders}}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}}Mo=xe;xe.OpenAI=Mo;xe.OpenAIError=ce;xe.APIError=Ae;xe.APIConnectionError=Xr;xe.APIConnectionTimeoutError=zs;xe.APIUserAbortError=We;xe.NotFoundError=ho;xe.ConflictError=po;xe.RateLimitError=_o;xe.BadRequestError=uo;xe.AuthenticationError=co;xe.InternalServerError=go;xe.PermissionDeniedError=fo;xe.UnprocessableEntityError=mo;xe.toFile=bo;xe.fileFromPath=oo;(function(t){t.Page=Js,t.CursorPage=nt,t.Completions=Ir,t.Chat=hr,t.Embeddings=Mr,t.Files=Or,t.FileObjectsPage=ti,t.Images=Fr,t.Audio=_r,t.Moderations=Dr,t.Models=Lr,t.ModelsPage=ii,t.FineTuning=Tr,t.Beta=Pr,t.Batches=gr,t.BatchesPage=Ks})(xe||(xe={}));const qt=[];function hh(t,e=ye){let n;const r=new Set;function s(l){if(et(t,l)&&(t=l,n)){const a=!qt.length;for(const u of r)u[1](),qt.push(u,t);if(a){for(let u=0;u<qt.length;u+=2)qt[u][0](qt[u+1]);qt.length=0}}}function i(l){s(l(t))}function o(l,a=ye){const u=[l,a];return r.add(u),r.size===1&&(n=e(s,i)||ye),l(t),()=>{r.delete(u),r.size===0&&n&&(n(),n=null)}}return{set:s,update:i,subscribe:o}}let Mt=hh(localStorage.getItem("apiKey")||"");Mt.subscribe(t=>localStorage.setItem("apiKey",t));let qr;const Oo=async()=>{if(mi(Mt)===""){let t=window.prompt("Please enter your OpenAI API key");if(t===null)return!1;Mt.set(t)}return qr=new xe({apiKey:mi(Mt),dangerouslyAllowBrowser:!0}),await qr.models.list().then(t=>!0).catch(t=>t.status===401?(Mt.set(""),alert("Invalid API key"),!1):(alert("Error: "+t.response.data.error.message),!1))};let No=["gpt-4-turbo-2024-04-09","gpt-4-turbo","gpt-3.5-turbo-1106","gpt-4-0613","gpt-4o-2024-05-13","gpt-4-0125-preview","gpt-4o","gpt-4-turbo-preview","gpt-4","gpt-3.5-turbo-16k","gpt-4-1106-preview","gpt-3.5-turbo-0125","gpt-3.5-turbo","gpt-3.5-turbo-instruct","gpt-3.5-turbo-instruct-0914"];function dh(t,e,n){const r=t.slice();return r[37]=e[n],r}function ph(t){let e;return{c(){e=A("option"),e.textContent=`${t[37]}`,e.__value=t[37],se(e,e.__value),y(e,"class","svelte-5xdvm4")},m(n,r){oe(n,e,r)},p:ye,d(n){n&&ae(e)}}}function na(t){let e,n,r;return{c(){e=A("textarea"),y(e,"id","post-processing"),y(e,"class","svelte-5xdvm4"),he(e,"invalid",t[15]===null)},m(s,i){oe(s,e,i),se(e,t[5]),n||(r=[le(e,"input",t[28]),le(e,"input",t[29])],n=!0)},p(s,i){i[0]&32&&se(e,s[5]),i[0]&32768&&he(e,"invalid",s[15]===null)},d(s){s&&ae(e),n=!1,Ue(r)}}}function ra(t){let e,n,r,s;return{c(){e=fe(`(one label per line)
      `),n=A("textarea"),y(n,"id","whitelist"),y(n,"class","svelte-5xdvm4"),he(n,"invalid",t[14])},m(i,o){oe(i,e,o),oe(i,n,o),se(n,t[9]),r||(s=le(n,"input",t[32]),r=!0)},p(i,o){o[0]&512&&se(n,i[9]),o[0]&16384&&he(n,"invalid",i[14])},d(i){i&&(ae(e),ae(n)),r=!1,s()}}}function mh(t){let e,n,r,s,i,o,l,a,u,c,f,h,d,p,w,v,x,k,R,M,E,P,b,_,m,C,S,O,N,L,U,X,D,j,$,W,J,F,ne,G,z,ee,K,q,T,Y,Z,re=bt(No),te=[];for(let I=0;I<re.length;I+=1)te[I]=ph(dh(t,re,I));let ue=t[4]!=="none"&&na(t),V=t[8]&&ra(t);return{c(){e=A("section"),n=A("div"),n.textContent="Prompt",r=B(),s=A("div"),i=A("label"),i.textContent="Prompt",o=B(),l=A("textarea"),a=B(),u=A("div"),c=A("label"),c.textContent="Model name",f=A("select");for(let I=0;I<te.length;I+=1)te[I].c();h=B(),d=A("div"),p=A("label"),p.textContent="Max tokens",w=A("input"),v=B(),x=A("div"),k=A("label"),k.textContent="Temperature",R=A("input"),M=B(),E=A("div"),P=A("label"),P.textContent="Post processing function",b=A("select"),_=A("option"),_.textContent="None",m=A("option"),m.textContent="Trim",C=A("option"),C.textContent="Last word",S=A("option"),S.textContent="Custom",O=B(),ue&&ue.c(),N=B(),L=A("div"),U=A("label"),U.textContent="Default class",X=A("input"),D=B(),j=A("div"),$=A("label"),$.textContent="Label whitelist ",W=A("input"),J=B(),V&&V.c(),F=B(),ne=A("div"),G=A("label"),G.textContent="Retries",z=A("input"),ee=B(),K=A("div"),q=A("label"),q.textContent="Threads",T=A("input"),y(n,"class","section-title svelte-5xdvm4"),y(i,"for","prompt"),y(i,"class","svelte-5xdvm4"),y(l,"id","prompt"),y(l,"placeholder","Classify this text as ..."),y(l,"class","svelte-5xdvm4"),he(l,"invalid",!t[0]),y(s,"class","prompt svelte-5xdvm4"),y(c,"for","model"),je(c,"display","inline-block"),y(c,"class","svelte-5xdvm4"),y(f,"id","model"),y(f,"class","svelte-5xdvm4"),t[2]===void 0&&Yt(()=>t[23].call(f)),y(p,"for","max-tokens"),y(p,"class","svelte-5xdvm4"),y(w,"type","number"),y(w,"id","max-tokens"),y(w,"class","svelte-5xdvm4"),he(w,"invalid",!Number.isInteger(t[1])||t[1]<1),y(k,"for","temperature"),y(k,"class","svelte-5xdvm4"),y(R,"type","number"),y(R,"id","temperature"),y(R,"class","svelte-5xdvm4"),he(R,"invalid",t[16]),y(P,"for","post-processing"),je(P,"display","inline-block"),y(P,"class","svelte-5xdvm4"),_.__value="none",se(_,_.__value),y(_,"class","svelte-5xdvm4"),m.__value="trim",se(m,m.__value),y(m,"class","svelte-5xdvm4"),C.__value="last",se(C,C.__value),y(C,"class","svelte-5xdvm4"),S.__value="custom",se(S,S.__value),y(S,"class","svelte-5xdvm4"),y(b,"id","postprocessing"),y(b,"class","svelte-5xdvm4"),t[4]===void 0&&Yt(()=>t[26].call(b)),y(U,"for","default-class"),y(U,"class","svelte-5xdvm4"),y(X,"type","text"),y(X,"id","default-class"),je(X,"width","6em"),y(X,"class","svelte-5xdvm4"),y(L,"class","default-class"),y($,"for","enable-wl"),y($,"class","svelte-5xdvm4"),y(W,"type","checkbox"),y(W,"id","enable-wl"),y(W,"class","svelte-5xdvm4"),y(j,"class","whitelist svelte-5xdvm4"),je(j,"user-select","none"),y(G,"for","retries"),y(G,"class","svelte-5xdvm4"),y(z,"type","number"),y(z,"id","retries"),y(z,"class","svelte-5xdvm4"),he(z,"invalid",t[13]),y(q,"for","threads"),y(q,"class","svelte-5xdvm4"),y(T,"type","number"),y(T,"id","threads"),y(T,"class","svelte-5xdvm4"),he(T,"invalid",t[12]),y(e,"class","svelte-5xdvm4")},m(I,Q){oe(I,e,Q),g(e,n),g(e,r),g(e,s),g(s,i),g(s,o),g(s,l),se(l,t[0]),g(e,a),g(e,u),g(u,c),g(u,f);for(let ge=0;ge<te.length;ge+=1)te[ge]&&te[ge].m(f,null);Ut(f,t[2],!0),g(e,h),g(e,d),g(d,p),g(d,w),se(w,t[1]),g(e,v),g(e,x),g(x,k),g(x,R),se(R,t[3]),g(e,M),g(e,E),g(E,P),g(E,b),g(b,_),g(b,m),g(b,C),g(b,S),Ut(b,t[4],!0),g(E,O),ue&&ue.m(E,null),g(e,N),g(e,L),g(L,U),g(L,X),se(X,t[7]),g(e,D),g(e,j),g(j,$),g(j,W),W.checked=t[8],g(j,J),V&&V.m(j,null),g(e,F),g(e,ne),g(ne,G),g(ne,z),se(z,t[10]),g(e,ee),g(e,K),g(K,q),g(K,T),se(T,t[11]),Y||(Z=[le(l,"input",t[22]),le(f,"change",t[23]),le(w,"input",t[24]),le(R,"input",t[25]),le(b,"change",t[26]),le(b,"input",t[27]),le(X,"input",t[30]),le(W,"change",t[31]),le(z,"input",t[33]),le(T,"input",t[34])],Y=!0)},p(I,Q){Q[0]&1&&se(l,I[0]),Q[0]&1&&he(l,"invalid",!I[0]),Q[0]&4&&Ut(f,I[2]),Q[0]&2&&be(w.value)!==I[1]&&se(w,I[1]),Q[0]&2&&he(w,"invalid",!Number.isInteger(I[1])||I[1]<1),Q[0]&8&&be(R.value)!==I[3]&&se(R,I[3]),Q[0]&65536&&he(R,"invalid",I[16]),Q[0]&16&&Ut(b,I[4]),I[4]!=="none"?ue?ue.p(I,Q):(ue=na(I),ue.c(),ue.m(E,null)):ue&&(ue.d(1),ue=null),Q[0]&128&&X.value!==I[7]&&se(X,I[7]),Q[0]&256&&(W.checked=I[8]),I[8]?V?V.p(I,Q):(V=ra(I),V.c(),V.m(j,null)):V&&(V.d(1),V=null),Q[0]&1024&&be(z.value)!==I[10]&&se(z,I[10]),Q[0]&8192&&he(z,"invalid",I[13]),Q[0]&2048&&be(T.value)!==I[11]&&se(T,I[11]),Q[0]&4096&&he(T,"invalid",I[12])},i:ye,o:ye,d(I){I&&ae(e),Pn(te,I),ue&&ue.d(),V&&V.d(),Y=!1,Ue(Z)}}}function _h(t,e,n){let r,s,i,o,l,a,u,c="";const f=()=>{n(0,c="Describe the emotion expressed in the following message as joy, anger, sadness or optimism. Output only joy, anger, sadness or optimism without quotes.")};let h=20,d="gpt-3.5-turbo",p=.1,w="none",v={none:"return s;",trim:"return s.trim();",last:`// get last word
s = s.split(/\\s+/).slice(-1)[0];
// convert to lowercase
s = s.toLowerCase();
// remove punctuation at the end
s = s.replace(/[.,;]+$/g, "");
return s;`,custom:`// your code here
// return null to note an invalid input
return s;`},x=v[w],k=!1;const R=G=>{let z;try{z=new Function("s",G)}catch{return null}return z};let M="",E=!1,P="",b=1,_=4,{params:m}=e,{valid:C}=e;function S(){c=this.value,n(0,c)}function O(){d=ns(this),n(2,d)}function N(){h=be(this.value),n(1,h)}function L(){p=be(this.value),n(3,p)}function U(){w=ns(this),n(4,w)}const X=()=>{n(6,k=!0)};function D(){x=this.value,n(5,x),n(6,k),n(35,v),n(4,w)}const j=()=>{let G=x;n(4,w="custom"),n(5,x=G)};function $(){M=this.value,n(7,M)}function W(){E=this.checked,n(8,E)}function J(){P=this.value,n(9,P)}function F(){b=be(this.value),n(10,b)}function ne(){_=be(this.value),n(11,_)}return t.$$set=G=>{"params"in G&&n(17,m=G.params),"valid"in G&&n(18,C=G.valid)},t.$$.update=()=>{t.$$.dirty[0]&2&&n(20,r=!Number.isInteger(h)||h<1),t.$$.dirty[0]&8&&n(16,s=p<0||p>1),t.$$.dirty[0]&80&&(k&&n(5,x=v[w]),n(6,k=!1)),t.$$.dirty[0]&32&&n(15,i=R(x)),t.$$.dirty[0]&512&&n(21,o=P?P.split(`
`).map(G=>G.trim()):null),t.$$.dirty[0]&2097408&&n(14,l=E&&o===null),t.$$.dirty[0]&1024&&n(13,a=!Number.isInteger(b)||b<1),t.$$.dirty[0]&2048&&n(12,u=!Number.isInteger(_)||_<1),t.$$.dirty[0]&2133135&&n(17,m={prompt:c,model:d,maxTokens:h,temperature:p,postprocess_fun:i,default_class:M,whitelist:o,retries:b,threads:_}),t.$$.dirty[0]&1175553&&n(18,C=c!==""&&!r&&!s&&i!==null&&!l&&!a&&!u)},[c,h,d,p,w,x,k,M,E,P,b,_,u,a,l,i,s,m,C,f,r,o,S,O,N,L,U,X,D,j,$,W,J,F,ne]}class $o extends ut{constructor(e){super(),lt(this,e,_h,mh,et,{loadExample:19,params:17,valid:18},null,[-1,-1])}get loadExample(){return this.$$.ctx[19]}get params(){return this.$$.ctx[17]}set params(e){this.$$set({params:e}),Qe()}get valid(){return this.$$.ctx[18]}set valid(e){this.$$set({valid:e}),Qe()}}function sa(t,e,n){const r=t.slice();return r[8]=e[n],r}function ia(t){let e,n,r,s,i,o,l=t[3]?"Hide":"Show",a,u,c,f,h,d,p=t[1].length+"",w,v,x,k,R,M,E=t[3]&&aa(t);return{c(){e=A("section"),n=A("button"),r=fe("Download"),i=B(),o=A("button"),a=fe(l),c=B(),f=A("span"),h=fe(t[0]),d=fe(": "),w=fe(p),v=fe(" records"),x=B(),E&&E.c(),k=Ho(),n.disabled=s=!t[2],y(n,"class","svelte-1bp5ste"),y(o,"class","button svelte-1bp5ste"),y(o,"id","data-show"),o.disabled=u=!(t[3]||t[1].length),y(f,"class","svelte-1bp5ste"),y(e,"class","download svelte-1bp5ste")},m(P,b){oe(P,e,b),g(e,n),g(n,r),g(e,i),g(e,o),g(o,a),g(e,c),g(e,f),g(f,h),g(f,d),g(f,w),g(f,v),oe(P,x,b),E&&E.m(P,b),oe(P,k,b),R||(M=[le(n,"click",t[6]),le(o,"click",t[7])],R=!0)},p(P,b){b&4&&s!==(s=!P[2])&&(n.disabled=s),b&8&&l!==(l=P[3]?"Hide":"Show")&&Ce(a,l),b&10&&u!==(u=!(P[3]||P[1].length))&&(o.disabled=u),b&1&&Ce(h,P[0]),b&2&&p!==(p=P[1].length+"")&&Ce(w,p),P[3]?E?E.p(P,b):(E=aa(P),E.c(),E.m(k.parentNode,k)):E&&(E.d(1),E=null)},d(P){P&&(ae(e),ae(x),ae(k)),E&&E.d(P),R=!1,Ue(M)}}}function aa(t){let e,n,r,s,i,o,l,a,u,c=t[5]&&oa(),f=t[4]&&la(),h=bt(t[1]),d=[];for(let p=0;p<h.length;p+=1)d[p]=fa(sa(t,h,p));return{c(){e=A("div"),n=A("table"),r=A("thead"),s=A("tr"),i=A("th"),i.textContent="Text",o=B(),c&&c.c(),l=B(),f&&f.c(),a=B(),u=A("tbody");for(let p=0;p<d.length;p+=1)d[p].c();y(i,"class","svelte-1bp5ste"),y(r,"class","svelte-1bp5ste"),y(n,"class","svelte-1bp5ste"),y(e,"class","table svelte-1bp5ste")},m(p,w){oe(p,e,w),g(e,n),g(n,r),g(r,s),g(s,i),g(s,o),c&&c.m(s,null),g(s,l),f&&f.m(s,null),g(n,a),g(n,u);for(let v=0;v<d.length;v+=1)d[v]&&d[v].m(u,null)},p(p,w){if(p[5]?c||(c=oa(),c.c(),c.m(s,l)):c&&(c.d(1),c=null),p[4]?f||(f=la(),f.c(),f.m(s,null)):f&&(f.d(1),f=null),w&50){h=bt(p[1]);let v;for(v=0;v<h.length;v+=1){const x=sa(p,h,v);d[v]?d[v].p(x,w):(d[v]=fa(x),d[v].c(),d[v].m(u,null))}for(;v<d.length;v+=1)d[v].d(1);d.length=h.length}},d(p){p&&ae(e),c&&c.d(),f&&f.d(),Pn(d,p)}}}function oa(t){let e;return{c(){e=A("th"),e.textContent="Label",y(e,"class","svelte-1bp5ste")},m(n,r){oe(n,e,r)},d(n){n&&ae(e)}}}function la(t){let e;return{c(){e=A("th"),e.textContent="Prediction",y(e,"class","svelte-1bp5ste")},m(n,r){oe(n,e,r)},d(n){n&&ae(e)}}}function ua(t){let e,n=t[8].label+"",r;return{c(){e=A("td"),r=fe(n),y(e,"class","svelte-1bp5ste")},m(s,i){oe(s,e,i),g(e,r)},p(s,i){i&2&&n!==(n=s[8].label+"")&&Ce(r,n)},d(s){s&&ae(e)}}}function ca(t){let e,n=t[8].prediction+"",r;return{c(){e=A("td"),r=fe(n),y(e,"class","svelte-1bp5ste")},m(s,i){oe(s,e,i),g(e,r)},p(s,i){i&2&&n!==(n=s[8].prediction+"")&&Ce(r,n)},d(s){s&&ae(e)}}}function fa(t){let e,n,r=t[8].text+"",s,i,o,l,a=t[5]&&ua(t),u=t[4]&&ca(t);return{c(){e=A("tr"),n=A("td"),s=fe(r),i=B(),a&&a.c(),o=B(),u&&u.c(),l=B(),y(n,"class","svelte-1bp5ste"),y(e,"class","svelte-1bp5ste")},m(c,f){oe(c,e,f),g(e,n),g(n,s),g(e,i),a&&a.m(e,null),g(e,o),u&&u.m(e,null),g(e,l)},p(c,f){f&2&&r!==(r=c[8].text+"")&&Ce(s,r),c[5]?a?a.p(c,f):(a=ua(c),a.c(),a.m(e,o)):a&&(a.d(1),a=null),c[4]?u?u.p(c,f):(u=ca(c),u.c(),u.m(e,l)):u&&(u.d(1),u=null)},d(c){c&&ae(e),a&&a.d(),u&&u.d()}}}function gh(t){let e,n=t[1].length&&ia(t);return{c(){e=A("main"),n&&n.c()},m(r,s){oe(r,e,s),n&&n.m(e,null)},p(r,[s]){r[1].length?n?n.p(r,s):(n=ia(r),n.c(),n.m(e,null)):n&&(n.d(1),n=null)},i:ye,o:ye,d(r){r&&ae(e),n&&n.d()}}}function wh(t,e,n){let r,s,{fileName:i=""}=e,{data:o=[]}=e,{canDownload:l=!0}=e,a=!1;const u=()=>{const f=new Blob([o.map(p=>JSON.stringify(p)).join(`
`)],{type:"text/plain"}),h=URL.createObjectURL(f),d=document.createElement("a");d.href=h,d.download=i,d.click(),URL.revokeObjectURL(h)},c=()=>{(a||o.length)&&n(3,a=!a)};return t.$$set=f=>{"fileName"in f&&n(0,i=f.fileName),"data"in f&&n(1,o=f.data),"canDownload"in f&&n(2,l=f.canDownload)},t.$$.update=()=>{t.$$.dirty&2&&n(5,r=o.length>0&&"label"in o[0]),t.$$.dirty&2&&n(4,s=o.length>0&&"prediction"in o[0])},[i,o,l,a,s,r,u,c]}class As extends ut{constructor(e){super(),lt(this,e,wh,gh,et,{fileName:0,data:1,canDownload:2})}}var Ss={exports:{}},Es={exports:{}},st={},jn={exports:{}},Rs={exports:{}};(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(n){return function(...r){var s=r.pop();return n.call(this,r,s)}},t.exports=e.default})(Rs,Rs.exports);var yh=Rs.exports,kt={};Object.defineProperty(kt,"__esModule",{value:!0});kt.fallback=To;kt.wrap=Fo;var vh=kt.hasQueueMicrotask=typeof queueMicrotask=="function"&&queueMicrotask,bh=kt.hasSetImmediate=typeof setImmediate=="function"&&setImmediate,xh=kt.hasNextTick=typeof process=="object"&&typeof process.nextTick=="function";function To(t){setTimeout(t,0)}function Fo(t){return(e,...n)=>t(()=>e(...n))}var gn;vh?gn=queueMicrotask:bh?gn=setImmediate:xh?gn=process.nextTick:gn=To;kt.default=Fo(gn);var ha;function kh(){return ha||(ha=1,function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=a;var n=yh,r=l(n),s=kt,i=l(s),o=ai();function l(f){return f&&f.__esModule?f:{default:f}}function a(f){return(0,o.isAsync)(f)?function(...h){const d=h.pop(),p=f.apply(this,h);return u(p,d)}:(0,r.default)(function(h,d){var p;try{p=f.apply(this,h)}catch(w){return d(w)}if(p&&typeof p.then=="function")return u(p,d);d(null,p)})}function u(f,h){return f.then(d=>{c(h,null,d)},d=>{c(h,d&&(d instanceof Error||d.message)?d:new Error(d))})}function c(f,h,d){try{f(h,d)}catch(p){(0,i.default)(w=>{throw w},p)}}t.exports=e.default}(jn,jn.exports)),jn.exports}var da;function ai(){if(da)return st;da=1,Object.defineProperty(st,"__esModule",{value:!0}),st.isAsyncIterable=st.isAsyncGenerator=st.isAsync=void 0;var t=kh(),e=n(t);function n(l){return l&&l.__esModule?l:{default:l}}function r(l){return l[Symbol.toStringTag]==="AsyncFunction"}function s(l){return l[Symbol.toStringTag]==="AsyncGenerator"}function i(l){return typeof l[Symbol.asyncIterator]=="function"}function o(l){if(typeof l!="function")throw new Error("expected a function");return r(l)?(0,e.default)(l):l}return st.default=o,st.isAsync=r,st.isAsyncGenerator=s,st.isAsyncIterable=i,st}(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=i;var n=ai(),r=s(n);function s(o){return o&&o.__esModule?o:{default:o}}function i(o,l,a,u){l=l||[];var c=[],f=0,h=(0,r.default)(a);return o(l,(d,p,w)=>{var v=f++;h(d,(x,k)=>{c[v]=k,w(x)})},d=>{u(d,c)})}t.exports=e.default})(Es,Es.exports);var Ch=Es.exports,Ps={exports:{}},Is={exports:{}};(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=n;function n(r){function s(...i){if(r!==null){var o=r;r=null,o.apply(this,i)}}return Object.assign(s,r),s}t.exports=e.default})(Is,Is.exports);var Ah=Is.exports,Ms={exports:{}},Os={exports:{}};(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=n;function n(r){return r&&typeof r.length=="number"&&r.length>=0&&r.length%1===0}t.exports=e.default})(Os,Os.exports);var Sh=Os.exports,Ns={exports:{}};(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(n){return n[Symbol.iterator]&&n[Symbol.iterator]()},t.exports=e.default})(Ns,Ns.exports);var Eh=Ns.exports;(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=c;var n=Sh,r=o(n),s=Eh,i=o(s);function o(f){return f&&f.__esModule?f:{default:f}}function l(f){var h=-1,d=f.length;return function(){return++h<d?{value:f[h],key:h}:null}}function a(f){var h=-1;return function(){var p=f.next();return p.done?null:(h++,{value:p.value,key:h})}}function u(f){var h=f?Object.keys(f):[],d=-1,p=h.length;return function w(){var v=h[++d];return v==="__proto__"?w():d<p?{value:f[v],key:v}:null}}function c(f){if((0,r.default)(f))return l(f);var h=(0,i.default)(f);return h?a(h):u(f)}t.exports=e.default})(Ms,Ms.exports);var Rh=Ms.exports,$s={exports:{}};(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=n;function n(r){return function(...s){if(r===null)throw new Error("Callback was already called.");var i=r;r=null,i.apply(this,s)}}t.exports=e.default})($s,$s.exports);var Ph=$s.exports,Ts={exports:{}},Fs={exports:{}};(function(t,e){Object.defineProperty(e,"__esModule",{value:!0});const n={};e.default=n,t.exports=e.default})(Fs,Fs.exports);var Lo=Fs.exports;(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=i;var n=Lo,r=s(n);function s(o){return o&&o.__esModule?o:{default:o}}function i(o,l,a,u){let c=!1,f=!1,h=!1,d=0,p=0;function w(){d>=l||h||c||(h=!0,o.next().then(({value:k,done:R})=>{if(!(f||c)){if(h=!1,R){c=!0,d<=0&&u(null);return}d++,a(k,p,v),p++,w()}}).catch(x))}function v(k,R){if(d-=1,!f){if(k)return x(k);if(k===!1){c=!0,f=!0;return}if(R===r.default||c&&d<=0)return c=!0,u(null);w()}}function x(k){f||(h=!1,c=!0,u(k))}w()}t.exports=e.default})(Ts,Ts.exports);var Ih=Ts.exports;(function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=Ah,r=d(n),s=Rh,i=d(s),o=Ph,l=d(o),a=ai(),u=Ih,c=d(u),f=Lo,h=d(f);function d(p){return p&&p.__esModule?p:{default:p}}e.default=p=>(w,v,x)=>{if(x=(0,r.default)(x),p<=0)throw new RangeError("concurrency limit cannot be less than 1");if(!w)return x(null);if((0,a.isAsyncGenerator)(w))return(0,c.default)(w,p,v,x);if((0,a.isAsyncIterable)(w))return(0,c.default)(w[Symbol.asyncIterator](),p,v,x);var k=(0,i.default)(w),R=!1,M=!1,E=0,P=!1;function b(m,C){if(!M)if(E-=1,m)R=!0,x(m);else if(m===!1)R=!0,M=!0;else{if(C===h.default||R&&E<=0)return R=!0,x(null);P||_()}}function _(){for(P=!0;E<p&&!R;){var m=k();if(m===null){R=!0,E<=0&&x(null);return}E+=1,v(m.value,m.key,(0,l.default)(b))}P=!1}_()},t.exports=e.default})(Ps,Ps.exports);var Mh=Ps.exports,Ls={exports:{}};(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=n;function n(r,s){if(s||(s=r.length),!s)throw new Error("arity is undefined");function i(...o){return typeof o[s-1]=="function"?r.apply(this,o):new Promise((l,a)=>{o[s-1]=(u,...c)=>{if(u)return a(u);l(c.length>1?c:c[0])},r.apply(this,o)})}return i}t.exports=e.default})(Ls,Ls.exports);var Oh=Ls.exports;(function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=Ch,r=a(n),s=Mh,i=a(s),o=Oh,l=a(o);function a(c){return c&&c.__esModule?c:{default:c}}function u(c,f,h,d){return(0,r.default)((0,i.default)(f),c,h,d)}e.default=(0,l.default)(u,4),t.exports=e.default})(Ss,Ss.exports);var Nh=Ss.exports;const $h=eo(Nh);function Th(t,e,n){let{results:r=[]}=e,{running:s=!1}=e;const i=async(a,{prompt:u,model:c="gpt-3.5-turbo",max_tokens:f=20,temperature:h=.1,postprocess_fun:d=k=>k,default_class:p="",whitelist:w=null,retries:v=1},x=!1)=>{const k=JSON.stringify({text:a,prompt:u,model:c,max_tokens:f,temperature:h,postprocess_fun:d.toString(),default_class:p,whitelist:w,retries:v}),R=localStorage.getItem(k);if(R!==null)return x&&await new Promise(b=>setTimeout(b,10)),JSON.parse(R);let M=0,E=null;for(let b=0;b<v;b++){M+=1,E=(await qr.chat.completions.create({messages:[{role:"system",content:u},{role:"user",content:a}],model:c,max_tokens:f,temperature:h})).choices[0].message.content||"";const m=d(E);if(m===null||w!==null&&!w.includes(m))continue;const C={raw_prediction:E,prediction:m,requests:M};return localStorage.setItem(k,JSON.stringify(C)),C}const P={raw_prediction:E,prediction:p.length>0?p:null,requests:M};return localStorage.setItem(k,JSON.stringify(P)),P},o=a=>{let u=0,c=0;for(let f of a)f.prediction===f.label&&(u+=1),c+=1;return u/c},l=async(a,{prompt:u,model:c,max_tokens:f=20,temperature:h=.1,postprocess_fun:d=R=>R,default_class:p="",whitelist:w=null,retries:v=1,threads:x=4},k=!1)=>{if(!k&&!await Oo())return;n(1,s=!0);const R=a.map((E,P)=>({row:E,index:P})),M=new Map;return n(0,r=[]),new Promise((E,P)=>{$h(R,x,async({row:b,index:_})=>{try{let m=await i(b.text,{prompt:u,model:c,max_tokens:f,temperature:h,postprocess_fun:d,default_class:p,whitelist:w,retries:v},k);for(M.set(_,{...b,...m});M.has(r.length);){const C=r.length,S=M.get(C);n(0,r=[...r,S]),M.delete(C)}}catch(m){console.error(m),P(m)}},b=>{n(1,s=!1),b?(alert(b),P(b)):E(r)})})};return t.$$set=a=>{"results"in a&&n(0,r=a.results),"running"in a&&n(1,s=a.running)},[r,s,o,l]}class Do extends ut{constructor(e){super(),lt(this,e,Th,null,et,{results:0,running:1,accuracy:2,process:3})}get results(){return this.$$.ctx[0]}set results(e){this.$$set({results:e}),Qe()}get running(){return this.$$.ctx[1]}set running(e){this.$$set({running:e}),Qe()}get accuracy(){return this.$$.ctx[2]}get process(){return this.$$.ctx[3]}}function pa(t){let e,n,r,s,i,o,l=t[2].length+"",a,u,c=t[1].length+"",f;return{c(){e=A("div"),n=A("progress"),i=B(),o=A("div"),a=fe(l),u=fe("/"),f=fe(c),y(n,"id","progress-bar"),n.value=r=t[2].length,y(n,"max",s=t[1].length),y(n,"class","svelte-1i7p3hk"),y(o,"class","progress-message svelte-1i7p3hk"),y(e,"class","progress svelte-1i7p3hk")},m(h,d){oe(h,e,d),g(e,n),g(e,i),g(e,o),g(o,a),g(o,u),g(o,f)},p(h,d){d&4&&r!==(r=h[2].length)&&(n.value=r),d&2&&s!==(s=h[1].length)&&y(n,"max",s),d&4&&l!==(l=h[2].length+"")&&Ce(a,l),d&2&&c!==(c=h[1].length+"")&&Ce(f,c)},d(h){h&&ae(e)}}}function ma(t){let e,n,r=t[7].accuracy(t[2])+"",s;return{c(){e=A("div"),n=fe("Accuracy: "),s=fe(r),y(e,"class","results svelte-1i7p3hk")},m(i,o){oe(i,e,o),g(e,n),g(e,s)},p(i,o){o&132&&r!==(r=i[7].accuracy(i[2])+"")&&Ce(s,r)},d(i){i&&ae(e)}}}function Fh(t){let e,n,r,s,i,o,l,a,u,c,f,h,d,p,w,v,x,k,R,M,E,P,b,_,m,C,S,O,N,L,U,X,D;function j(q){t[11](q)}function $(q){t[12](q)}let W={};t[0]!==void 0&&(W.fileName=t[0]),t[1]!==void 0&&(W.data=t[1]),l=new Hs({props:W}),we.push(()=>Be(l,"fileName",j)),we.push(()=>Be(l,"data",$)),t[13](l);function J(q){t[14](q)}function F(q){t[15](q)}let ne={};t[5]!==void 0&&(ne.params=t[5]),t[6]!==void 0&&(ne.valid=t[6]),f=new $o({props:ne}),we.push(()=>Be(f,"params",J)),we.push(()=>Be(f,"valid",F)),t[16](f);function G(q){t[19](q)}let z={};t[2]!==void 0&&(z.results=t[2]),P=new Do({props:z}),t[18](P),we.push(()=>Be(P,"results",G));let ee=(t[7]&&t[7].running||t[8])&&pa(t);N=new As({props:{fileName:`${t[9]}-results.jsonl`,data:t[2],canDownload:t[8]}});let K=t[8]&&ma(t);return{c(){e=A("main"),n=A("section"),r=A("b"),r.textContent="New here?",s=B(),i=A("button"),i.textContent="Load Example",o=B(),$e(l.$$.fragment),c=B(),$e(f.$$.fragment),p=B(),w=A("section"),v=A("div"),v.textContent="Process",x=B(),k=A("button"),R=fe("Run"),E=B(),$e(P.$$.fragment),_=B(),ee&&ee.c(),m=B(),C=A("section"),S=A("div"),S.textContent="Results",O=B(),$e(N.$$.fragment),L=B(),K&&K.c(),y(i,"class","smallbutton svelte-1i7p3hk"),y(n,"class","svelte-1i7p3hk"),y(v,"class","section-title svelte-1i7p3hk"),y(k,"class","button svelte-1i7p3hk"),y(k,"id","process-run"),k.disabled=M=t[0]===""||!t[6]||t[7].running,y(w,"class","svelte-1i7p3hk"),y(S,"class","section-title svelte-1i7p3hk"),y(C,"class","svelte-1i7p3hk")},m(q,T){oe(q,e,T),g(e,n),g(n,r),g(n,s),g(n,i),g(e,o),Pe(l,e,null),g(e,c),Pe(f,e,null),g(e,p),g(e,w),g(w,v),g(w,x),g(w,k),g(k,R),g(w,E),Pe(P,w,null),g(w,_),ee&&ee.m(w,null),g(e,m),g(e,C),g(C,S),g(C,O),Pe(N,C,null),g(C,L),K&&K.m(C,null),U=!0,X||(D=[le(i,"click",t[10]),le(k,"click",t[17])],X=!0)},p(q,[T]){const Y={};!a&&T&1&&(a=!0,Y.fileName=q[0],qe(()=>a=!1)),!u&&T&2&&(u=!0,Y.data=q[1],qe(()=>u=!1)),l.$set(Y);const Z={};!h&&T&32&&(h=!0,Z.params=q[5],qe(()=>h=!1)),!d&&T&64&&(d=!0,Z.valid=q[6],qe(()=>d=!1)),f.$set(Z),(!U||T&193&&M!==(M=q[0]===""||!q[6]||q[7].running))&&(k.disabled=M);const re={};!b&&T&4&&(b=!0,re.results=q[2],qe(()=>b=!1)),P.$set(re),q[7]&&q[7].running||q[8]?ee?ee.p(q,T):(ee=pa(q),ee.c(),ee.m(w,null)):ee&&(ee.d(1),ee=null);const te={};T&512&&(te.fileName=`${q[9]}-results.jsonl`),T&4&&(te.data=q[2]),T&256&&(te.canDownload=q[8]),N.$set(te),q[8]?K?K.p(q,T):(K=ma(q),K.c(),K.m(C,null)):K&&(K.d(1),K=null)},i(q){U||(Re(l.$$.fragment,q),Re(f.$$.fragment,q),Re(P.$$.fragment,q),Re(N.$$.fragment,q),U=!0)},o(q){Ne(l.$$.fragment,q),Ne(f.$$.fragment,q),Ne(P.$$.fragment,q),Ne(N.$$.fragment,q),U=!1},d(q){q&&ae(e),t[13](null),Ie(l),t[16](null),Ie(f),t[18](null),Ie(P),ee&&ee.d(),Ie(N),K&&K.d(),X=!1,Ue(D)}}}function Lh(t,e,n){let r,s,i,o,l="",a,u,c,f,h;const d=()=>{i.loadExample(),o.loadExample()};function p(b){l=b,n(0,l)}function w(b){a=b,n(1,a)}function v(b){we[b?"unshift":"push"](()=>{i=b,n(3,i)})}function x(b){u=b,n(5,u)}function k(b){c=b,n(6,c)}function R(b){we[b?"unshift":"push"](()=>{o=b,n(4,o)})}const M=()=>h.process(a,u,i.isFake);function E(b){we[b?"unshift":"push"](()=>{h=b,n(7,h)})}function P(b){f=b,n(2,f)}return t.$$.update=()=>{t.$$.dirty&1&&n(9,r=l.split(".")[0]),t.$$.dirty&6&&n(8,s=a&&a.length>0&&f.length==a.length)},[l,a,f,i,o,u,c,h,s,r,d,p,w,v,x,k,R,M,E,P]}class Dh extends ut{constructor(e){super(),lt(this,e,Lh,Fh,et,{})}}function qh(t){let e;return{c(){e=A("main"),e.innerHTML='<svg width="100%" height="400px"></svg> <div class="popup svelte-4flyhw"></div>'},m(n,r){oe(n,e,r)},p:ye,i:ye,o:ye,d(n){n&&ae(e)}}}function Bh(t,e,n){let{population:r}=e,s,i=2;const o=a=>{let u=a.map((p,w)=>w).sort((p,w)=>a[p].score-a[w].score);a.forEach((p,w)=>a[u[w]].scoreIndex=w);let c=rl(a.map(p=>p.level))-sl(a.map(p=>p.level)),f=Math.max(5,c)/1e3,h=Math.max(2,a.length-1)/300;a.forEach(p=>(p.x=p.level/f+100,p.y=p.scoreIndex/h+50)),s=a.filter(p=>p.parent!==null).map(p=>({source:p.parent,target:p.id}));let d=Math.min(...a.map(p=>Math.min(...a.map(w=>Math.abs(p.score-w.score)+(Math.abs(p.score-w.score)<1e-9?1:0)))));i=Math.max(2,Math.ceil(Math.log10(1/d)))},l=a=>{const u=tn(".popup"),c=tn("svg");qu("svg > *").remove(),u.style("display","none");const f=Pf().x(w=>w.x).y(w=>w.y).curve(If);c.selectAll("path").data(s).enter().append("path").attr("d",w=>{const v=a.find(k=>k.id===w.source),x=a.find(k=>k.id===w.target);if(!(!v||!x))return f([{x:v.x,y:v.y},{x:(v.x+x.x)/2,y:(v.y+x.y)/2},{x:x.x,y:x.y}])}).attr("fill","none").attr("stroke","#ccc").attr("stroke-width",2),c.selectAll("circle").data(a).enter().append("circle").attr("cx",w=>w.x).attr("cy",w=>w.y).attr("r",10).attr("class","node"),c.selectAll("text").data(a).enter().append("text").attr("x",w=>w.x+15).attr("y",w=>w.y+5).attr("class","label").text(w=>w.score.toFixed(i));let h=!1,d=null;function p(w,v){const x=c.node().getBoundingClientRect(),k=window.scrollX+x.left+v.x+15,R=window.scrollY+x.top+v.y;u.style("left",k+"px").style("top",R+"px")}c.selectAll("circle").on("mouseover",function(w,v){if(!h){p(w,v),u.style("display","block");const x=v.text.replace(/</g,"&lt;").replace(/>/g,"&gt;");u.html(`Generation: ${v.level} <br>Score: ${v.score.toFixed(i)} <br>Prompt: <br>${x}`)}}).on("mouseout",function(w,v){h||u.style("display","none")}).on("mousedown",function(w,v){w.stopPropagation();const x=k=>k._groups[0][0].__data__.id;if(d){if(d.classed("selected",!1),h=!1,u.style("display","none"),x(tn(this))==x(d)){d=null;return}d=null}h=!0,d=tn(this),d.classed("selected",!0),p(w,v),u.style("display","block")}),tn("body").on("mousedown",function(){d&&(d.classed("selected",!1),d=null),h&&(h=!1,u.style("display","none"))}),u.on("mousedown",function(w){w.stopPropagation()})};return Jo(()=>{n(0,r)}),t.$$set=a=>{"population"in a&&n(0,r=a.population)},t.$$.update=()=>{t.$$.dirty&1&&o(r),t.$$.dirty&1&&l(r)},[r]}class jh extends ut{constructor(e){super(),lt(this,e,Bh,qh,et,{population:0})}}function Wh(t,e,n){const r=t.slice();return r[22]=e[n],r}function Xh(t){let e;return{c(){e=A("option"),e.textContent=`${t[22]}`,e.__value=t[22],se(e,e.__value),y(e,"class","svelte-17smvch")},m(n,r){oe(n,e,r)},p:ye,d(n){n&&ae(e)}}}function Uh(t){let e,n,r,s,i,o,l,a,u,c,f,h,d,p,w,v,x,k,R,M,E,P,b,_,m,C,S,O,N,L,U,X,D,j=bt(No),$=[];for(let W=0;W<j.length;W+=1)$[W]=Xh(Wh(t,j,W));return{c(){e=A("main"),n=A("section"),r=A("div"),r.textContent="Parameters",s=B(),i=A("label"),i.textContent="Metaprompt",o=B(),l=A("textarea"),a=B(),u=A("div"),c=A("label"),c.textContent="Model name",f=A("select");for(let W=0;W<$.length;W+=1)$[W].c();h=B(),d=A("div"),p=A("label"),p.textContent="Max prompt tokens",w=A("input"),v=B(),x=A("div"),k=A("label"),k.textContent="Population size",R=A("input"),M=B(),E=A("div"),P=A("label"),P.textContent="Generation multiplier",b=A("input"),_=B(),m=A("div"),C=A("label"),C.textContent="Generations",S=A("input"),O=B(),N=A("div"),L=A("label"),L.textContent="Temperature",U=A("input"),y(r,"class","section-title svelte-17smvch"),y(i,"for","metaprompt"),y(i,"class","svelte-17smvch"),y(l,"id","metaprompt"),y(l,"class","svelte-17smvch"),he(l,"invalid",!t[12]),y(c,"for","model"),je(c,"display","inline-block"),y(c,"class","svelte-17smvch"),y(f,"id","model"),y(f,"class","svelte-17smvch"),t[1]===void 0&&Yt(()=>t[16].call(f)),y(p,"for","max-prompt-tokens"),y(p,"class","svelte-17smvch"),y(w,"type","number"),y(w,"id","max-prompt-tokens"),y(w,"class","svelte-17smvch"),he(w,"invalid",t[11]),y(d,"class","input"),y(k,"for","popsize"),y(k,"class","svelte-17smvch"),y(R,"type","number"),y(R,"id","popsize"),y(R,"class","svelte-17smvch"),he(R,"invalid",t[10]),y(x,"class","input"),y(P,"for","genmultiplier"),y(P,"class","svelte-17smvch"),y(b,"type","number"),y(b,"id","genmultiplier"),y(b,"class","svelte-17smvch"),he(b,"invalid",t[9]),y(E,"class","input"),y(C,"for","generations"),y(C,"class","svelte-17smvch"),y(S,"type","number"),y(S,"id","generations"),y(S,"class","svelte-17smvch"),he(S,"invalid",t[8]),y(m,"class","input"),y(L,"for","temperature"),y(L,"class","svelte-17smvch"),y(U,"type","number"),y(U,"id","temperature"),y(U,"class","svelte-17smvch"),he(U,"invalid",t[7]),y(N,"class","input"),y(n,"id","parameters"),y(n,"class","svelte-17smvch")},m(W,J){oe(W,e,J),g(e,n),g(n,r),g(n,s),g(n,i),g(n,o),g(n,l),se(l,t[0]),g(n,a),g(n,u),g(u,c),g(u,f);for(let F=0;F<$.length;F+=1)$[F]&&$[F].m(f,null);Ut(f,t[1],!0),g(n,h),g(n,d),g(d,p),g(d,w),se(w,t[2]),g(n,v),g(n,x),g(x,k),g(x,R),se(R,t[3]),g(n,M),g(n,E),g(E,P),g(E,b),se(b,t[4]),g(n,_),g(n,m),g(m,C),g(m,S),se(S,t[5]),g(n,O),g(n,N),g(N,L),g(N,U),se(U,t[6]),X||(D=[le(l,"input",t[15]),le(f,"change",t[16]),le(w,"input",t[17]),le(R,"input",t[18]),le(b,"input",t[19]),le(S,"input",t[20]),le(U,"input",t[21])],X=!0)},p(W,[J]){J&1&&se(l,W[0]),J&4096&&he(l,"invalid",!W[12]),J&2&&Ut(f,W[1]),J&4&&be(w.value)!==W[2]&&se(w,W[2]),J&2048&&he(w,"invalid",W[11]),J&8&&be(R.value)!==W[3]&&se(R,W[3]),J&1024&&he(R,"invalid",W[10]),J&16&&be(b.value)!==W[4]&&se(b,W[4]),J&512&&he(b,"invalid",W[9]),J&32&&be(S.value)!==W[5]&&se(S,W[5]),J&256&&he(S,"invalid",W[8]),J&64&&be(U.value)!==W[6]&&se(U,W[6]),J&128&&he(U,"invalid",W[7])},i:ye,o:ye,d(W){W&&ae(e),Pn($,W),X=!1,Ue(D)}}}function Hh(t,e,n){let r,s,i,o,l,a,u=`Generate a variation of the following instruction while keeping the semantic meaning and the output format:

{prompt}

Output only the new instruction.`,c="gpt-3.5-turbo",f=100,h=2,d=3,p=8,w=1,{params:v}=e,{valid:x}=e;function k(){u=this.value,n(0,u)}function R(){c=ns(this),n(1,c)}function M(){f=be(this.value),n(2,f)}function E(){h=be(this.value),n(3,h)}function P(){d=be(this.value),n(4,d)}function b(){p=be(this.value),n(5,p)}function _(){w=be(this.value),n(6,w)}return t.$$set=m=>{"params"in m&&n(13,v=m.params),"valid"in m&&n(14,x=m.valid)},t.$$.update=()=>{t.$$.dirty&1&&n(12,r=u.includes("{prompt}")),t.$$.dirty&4&&n(11,s=!Number.isInteger(f)||f<0),t.$$.dirty&8&&n(10,i=!Number.isInteger(h)||h<0),t.$$.dirty&16&&n(9,o=!Number.isInteger(d)||d<0),t.$$.dirty&32&&n(8,l=!Number.isInteger(p)||p<0),t.$$.dirty&64&&n(7,a=w<0||w>1),t.$$.dirty&127&&n(13,v={metaprompt:u,model:c,max_prompt_tokens:f,pop_size:h,gen_multiplier:d,generations:p,temperature:w}),t.$$.dirty&8064&&n(14,x=r&&!s&&!i&&!o&&!l&&!a)},[u,c,f,h,d,p,w,a,l,o,i,s,r,v,x,k,R,M,E,P,b,_]}class zh extends ut{constructor(e){super(),lt(this,e,Hh,Uh,et,{params:13,valid:14})}}function _a(t){let e;return{c(){e=A("div"),e.textContent="The process will be stopped after the current evaluation.",y(e,"class","message svelte-xsn3yq")},m(n,r){oe(n,e,r)},d(n){n&&ae(e)}}}function ga(t){let e,n,r,s,i,o,l=t[8].length+"",a,u,c=t[2].length+"",f;return{c(){e=A("div"),n=A("progress"),i=B(),o=A("div"),a=fe(l),u=fe("/"),f=fe(c),y(n,"id","progress-bar"),n.value=r=t[8].length,y(n,"max",s=t[2].length),y(n,"class","svelte-xsn3yq"),y(o,"class","progress-message svelte-xsn3yq"),y(e,"class","progress svelte-xsn3yq")},m(h,d){oe(h,e,d),g(e,n),g(e,i),g(e,o),g(o,a),g(o,u),g(o,f)},p(h,d){d&256&&r!==(r=h[8].length)&&(n.value=r),d&4&&s!==(s=h[2].length)&&y(n,"max",s),d&256&&l!==(l=h[8].length+"")&&Ce(a,l),d&4&&c!==(c=h[2].length+"")&&Ce(f,c)},d(h){h&&ae(e)}}}function wa(t){let e,n,r,s,i,o=t[11].text+"",l,a,u,c,f=t[11].score+"",h;return{c(){e=A("div"),n=fe(`Best prompt:
        `),r=A("br"),s=B(),i=A("span"),l=fe(o),a=B(),u=A("br"),c=fe(`
        Score: `),h=fe(f),je(i,"font-family","Courier New, Courier, monospace"),je(i,"font-weight","normal"),y(e,"class","results svelte-xsn3yq")},m(d,p){oe(d,e,p),g(e,n),g(e,r),g(e,s),g(e,i),g(i,l),g(e,a),g(e,u),g(e,c),g(e,h)},p(d,p){p&2048&&o!==(o=d[11].text+"")&&Ce(l,o),p&2048&&f!==(f=d[11].score+"")&&Ce(h,f)},d(d){d&&ae(e)}}}function Vh(t){let e,n,r,s,i,o,l,a,u,c,f,h,d,p,w,v,x,k,R,M,E,P,b,_,m,C,S,O,N,L,U,X,D,j,$,W,J;function F(I){t[13](I)}function ne(I){t[14](I)}let G={requireLabel:!0};t[1]!==void 0&&(G.fileName=t[1]),t[2]!==void 0&&(G.data=t[2]),n=new Hs({props:G}),we.push(()=>Be(n,"fileName",F)),we.push(()=>Be(n,"data",ne));function z(I){t[15](I)}function ee(I){t[16](I)}let K={};t[3]!==void 0&&(K.params=t[3]),t[4]!==void 0&&(K.valid=t[4]),o=new $o({props:K}),we.push(()=>Be(o,"params",z)),we.push(()=>Be(o,"valid",ee));function q(I){t[17](I)}function T(I){t[18](I)}let Y={};t[5]!==void 0&&(Y.params=t[5]),t[6]!==void 0&&(Y.valid=t[6]),c=new zh({props:Y}),we.push(()=>Be(c,"params",q)),we.push(()=>Be(c,"valid",T));let Z=t[10]&&t[9]&&_a(),re=t[9]&&t[8]&&ga(t);function te(I){t[22](I)}let ue={};t[8]!==void 0&&(ue.results=t[8]),S=new Do({props:ue}),t[21](S),we.push(()=>Be(S,"results",te)),L=new jh({props:{population:t[0]}});let V=t[0].length>0&&wa(t);return{c(){e=A("main"),$e(n.$$.fragment),i=B(),$e(o.$$.fragment),u=B(),$e(c.$$.fragment),d=B(),p=A("section"),w=A("div"),w.textContent="Optimize",v=B(),x=A("button"),k=fe("Run"),M=B(),E=A("button"),P=fe("Stop"),_=B(),Z&&Z.c(),m=B(),re&&re.c(),C=B(),$e(S.$$.fragment),N=B(),$e(L.$$.fragment),U=B(),X=A("section"),D=A("div"),D.textContent="Results",j=B(),V&&V.c(),y(w,"class","section-title svelte-xsn3yq"),y(x,"class","button svelte-xsn3yq"),y(x,"id","process-run"),x.disabled=R=t[1]===""||!t[4]||!t[6]||t[9],y(E,"class","button svelte-xsn3yq"),y(E,"id","process-stop"),E.disabled=b=!t[9]||t[10],y(p,"class","svelte-xsn3yq"),y(D,"class","section-title svelte-xsn3yq"),y(X,"class","svelte-xsn3yq")},m(I,Q){oe(I,e,Q),Pe(n,e,null),g(e,i),Pe(o,e,null),g(e,u),Pe(c,e,null),g(e,d),g(e,p),g(p,w),g(p,v),g(p,x),g(x,k),g(p,M),g(p,E),g(E,P),g(p,_),Z&&Z.m(p,null),g(p,m),re&&re.m(p,null),g(e,C),Pe(S,e,null),g(e,N),Pe(L,e,null),g(e,U),g(e,X),g(X,D),g(X,j),V&&V.m(X,null),$=!0,W||(J=[le(x,"click",t[19]),le(E,"click",t[20])],W=!0)},p(I,[Q]){const ge={};!r&&Q&2&&(r=!0,ge.fileName=I[1],qe(()=>r=!1)),!s&&Q&4&&(s=!0,ge.data=I[2],qe(()=>s=!1)),n.$set(ge);const Oe={};!l&&Q&8&&(l=!0,Oe.params=I[3],qe(()=>l=!1)),!a&&Q&16&&(a=!0,Oe.valid=I[4],qe(()=>a=!1)),o.$set(Oe);const Fe={};!f&&Q&32&&(f=!0,Fe.params=I[5],qe(()=>f=!1)),!h&&Q&64&&(h=!0,Fe.valid=I[6],qe(()=>h=!1)),c.$set(Fe),(!$||Q&594&&R!==(R=I[1]===""||!I[4]||!I[6]||I[9]))&&(x.disabled=R),(!$||Q&1536&&b!==(b=!I[9]||I[10]))&&(E.disabled=b),I[10]&&I[9]?Z||(Z=_a(),Z.c(),Z.m(p,m)):Z&&(Z.d(1),Z=null),I[9]&&I[8]?re?re.p(I,Q):(re=ga(I),re.c(),re.m(p,null)):re&&(re.d(1),re=null);const Ee={};!O&&Q&256&&(O=!0,Ee.results=I[8],qe(()=>O=!1)),S.$set(Ee);const me={};Q&1&&(me.population=I[0]),L.$set(me),I[0].length>0?V?V.p(I,Q):(V=wa(I),V.c(),V.m(X,null)):V&&(V.d(1),V=null)},i(I){$||(Re(n.$$.fragment,I),Re(o.$$.fragment,I),Re(c.$$.fragment,I),Re(S.$$.fragment,I),Re(L.$$.fragment,I),$=!0)},o(I){Ne(n.$$.fragment,I),Ne(o.$$.fragment,I),Ne(c.$$.fragment,I),Ne(S.$$.fragment,I),Ne(L.$$.fragment,I),$=!1},d(I){I&&ae(e),Ie(n),Ie(o),Ie(c),Z&&Z.d(),re&&re.d(),t[21](null),Ie(S),Ie(L),V&&V.d(),W=!1,Ue(J)}}}function Jh(t,e,n){let r,s="",i,o=[],l,a,u,c,f,h;const d=async({metaprompt:S,model:O,max_prompt_tokens:N,temperature:L},U)=>(await qr.chat.completions.create({messages:[{role:"user",content:S.replace("{prompt}",U)}],model:O,max_tokens:N,temperature:L})).choices[0].message.content||"";let p=!1,w=!1;const v=async(S,{metaprompt:O,model:N,max_prompt_tokens:L,pop_size:U,gen_multiplier:X,generations:D,temperature:j},$)=>{if(p||!await Oo())return;n(9,p=!0),n(0,o=[]);const W=S.prompt;let J={...S};delete J.prompt;const F=new Map,ne=async z=>{if(F.has(z))return F.get(z);let ee={...J,prompt:z};return await f.process($,ee),f.accuracy(h)};n(0,o=[{id:0,text:W,score:await ne(W),parent:null,generation:0,level:0}]);let G=[o[0]];for(let z=1;z<=D;z++){let ee=G.slice();for(let K of G)for(let q=0;q<X;q++){let T=await d({metaprompt:O,model:N,max_prompt_tokens:L,temperature:j},K.text),Y={id:o.length+1,text:T,score:await ne(T),parent:K.id,generation:z,level:z};if(ee.push(Y),n(0,o=[...o,Y]),w){n(10,w=!1),n(9,p=!1);return}}G=ee,G.sort((K,q)=>K.score-q.score),G=G.slice(-U)}};function x(S){s=S,n(1,s)}function k(S){i=S,n(2,i)}function R(S){l=S,n(3,l)}function M(S){a=S,n(4,a)}function E(S){u=S,n(5,u)}function P(S){c=S,n(6,c)}const b=()=>v(l,u,i),_=()=>{n(10,w=!0)};function m(S){we[S?"unshift":"push"](()=>{f=S,n(7,f)})}function C(S){h=S,n(8,h)}return t.$$.update=()=>{t.$$.dirty&1&&n(11,r=o.reduce((S,O)=>S.score>O.score?S:O,{score:-1/0}))},[o,s,i,l,a,u,c,f,h,p,w,r,v,x,k,R,M,E,P,b,_,m,C]}class Kh extends ut{constructor(e){super(),lt(this,e,Jh,Vh,et,{})}}var oi={exports:{}};oi.exports;(function(t){(function(e,n,r){function s(a){var u=this,c=l();u.next=function(){var f=2091639*u.s0+u.c*23283064365386963e-26;return u.s0=u.s1,u.s1=u.s2,u.s2=f-(u.c=f|0)},u.c=1,u.s0=c(" "),u.s1=c(" "),u.s2=c(" "),u.s0-=c(a),u.s0<0&&(u.s0+=1),u.s1-=c(a),u.s1<0&&(u.s1+=1),u.s2-=c(a),u.s2<0&&(u.s2+=1),c=null}function i(a,u){return u.c=a.c,u.s0=a.s0,u.s1=a.s1,u.s2=a.s2,u}function o(a,u){var c=new s(a),f=u&&u.state,h=c.next;return h.int32=function(){return c.next()*4294967296|0},h.double=function(){return h()+(h()*2097152|0)*11102230246251565e-32},h.quick=h,f&&(typeof f=="object"&&i(f,c),h.state=function(){return i(c,{})}),h}function l(){var a=4022871197,u=function(c){c=String(c);for(var f=0;f<c.length;f++){a+=c.charCodeAt(f);var h=.02519603282416938*a;a=h>>>0,h-=a,h*=a,a=h>>>0,h-=a,a+=h*4294967296}return(a>>>0)*23283064365386963e-26};return u}n&&n.exports?n.exports=o:this.alea=o})(xt,t)})(oi);var Gh=oi.exports,li={exports:{}};li.exports;(function(t){(function(e,n,r){function s(l){var a=this,u="";a.x=0,a.y=0,a.z=0,a.w=0,a.next=function(){var f=a.x^a.x<<11;return a.x=a.y,a.y=a.z,a.z=a.w,a.w^=a.w>>>19^f^f>>>8},l===(l|0)?a.x=l:u+=l;for(var c=0;c<u.length+64;c++)a.x^=u.charCodeAt(c)|0,a.next()}function i(l,a){return a.x=l.x,a.y=l.y,a.z=l.z,a.w=l.w,a}function o(l,a){var u=new s(l),c=a&&a.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var h=u.next()>>>11,d=(u.next()>>>0)/4294967296,p=(h+d)/(1<<21);while(p===0);return p},f.int32=u.next,f.quick=f,c&&(typeof c=="object"&&i(c,u),f.state=function(){return i(u,{})}),f}n&&n.exports?n.exports=o:this.xor128=o})(xt,t)})(li);var Qh=li.exports,ui={exports:{}};ui.exports;(function(t){(function(e,n,r){function s(l){var a=this,u="";a.next=function(){var f=a.x^a.x>>>2;return a.x=a.y,a.y=a.z,a.z=a.w,a.w=a.v,(a.d=a.d+362437|0)+(a.v=a.v^a.v<<4^(f^f<<1))|0},a.x=0,a.y=0,a.z=0,a.w=0,a.v=0,l===(l|0)?a.x=l:u+=l;for(var c=0;c<u.length+64;c++)a.x^=u.charCodeAt(c)|0,c==u.length&&(a.d=a.x<<10^a.x>>>4),a.next()}function i(l,a){return a.x=l.x,a.y=l.y,a.z=l.z,a.w=l.w,a.v=l.v,a.d=l.d,a}function o(l,a){var u=new s(l),c=a&&a.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var h=u.next()>>>11,d=(u.next()>>>0)/4294967296,p=(h+d)/(1<<21);while(p===0);return p},f.int32=u.next,f.quick=f,c&&(typeof c=="object"&&i(c,u),f.state=function(){return i(u,{})}),f}n&&n.exports?n.exports=o:this.xorwow=o})(xt,t)})(ui);var Yh=ui.exports,ci={exports:{}};ci.exports;(function(t){(function(e,n,r){function s(l){var a=this;a.next=function(){var c=a.x,f=a.i,h,d;return h=c[f],h^=h>>>7,d=h^h<<24,h=c[f+1&7],d^=h^h>>>10,h=c[f+3&7],d^=h^h>>>3,h=c[f+4&7],d^=h^h<<7,h=c[f+7&7],h=h^h<<13,d^=h^h<<9,c[f]=d,a.i=f+1&7,d};function u(c,f){var h,d=[];if(f===(f|0))d[0]=f;else for(f=""+f,h=0;h<f.length;++h)d[h&7]=d[h&7]<<15^f.charCodeAt(h)+d[h+1&7]<<13;for(;d.length<8;)d.push(0);for(h=0;h<8&&d[h]===0;++h);for(h==8?d[7]=-1:d[h],c.x=d,c.i=0,h=256;h>0;--h)c.next()}u(a,l)}function i(l,a){return a.x=l.x.slice(),a.i=l.i,a}function o(l,a){l==null&&(l=+new Date);var u=new s(l),c=a&&a.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var h=u.next()>>>11,d=(u.next()>>>0)/4294967296,p=(h+d)/(1<<21);while(p===0);return p},f.int32=u.next,f.quick=f,c&&(c.x&&i(c,u),f.state=function(){return i(u,{})}),f}n&&n.exports?n.exports=o:this.xorshift7=o})(xt,t)})(ci);var Zh=ci.exports,fi={exports:{}};fi.exports;(function(t){(function(e,n,r){function s(l){var a=this;a.next=function(){var c=a.w,f=a.X,h=a.i,d,p;return a.w=c=c+1640531527|0,p=f[h+34&127],d=f[h=h+1&127],p^=p<<13,d^=d<<17,p^=p>>>15,d^=d>>>12,p=f[h]=p^d,a.i=h,p+(c^c>>>16)|0};function u(c,f){var h,d,p,w,v,x=[],k=128;for(f===(f|0)?(d=f,f=null):(f=f+"\0",d=0,k=Math.max(k,f.length)),p=0,w=-32;w<k;++w)f&&(d^=f.charCodeAt((w+32)%f.length)),w===0&&(v=d),d^=d<<10,d^=d>>>15,d^=d<<4,d^=d>>>13,w>=0&&(v=v+1640531527|0,h=x[w&127]^=d+v,p=h==0?p+1:0);for(p>=128&&(x[(f&&f.length||0)&127]=-1),p=127,w=4*128;w>0;--w)d=x[p+34&127],h=x[p=p+1&127],d^=d<<13,h^=h<<17,d^=d>>>15,h^=h>>>12,x[p]=d^h;c.w=v,c.X=x,c.i=p}u(a,l)}function i(l,a){return a.i=l.i,a.w=l.w,a.X=l.X.slice(),a}function o(l,a){l==null&&(l=+new Date);var u=new s(l),c=a&&a.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var h=u.next()>>>11,d=(u.next()>>>0)/4294967296,p=(h+d)/(1<<21);while(p===0);return p},f.int32=u.next,f.quick=f,c&&(c.X&&i(c,u),f.state=function(){return i(u,{})}),f}n&&n.exports?n.exports=o:this.xor4096=o})(xt,t)})(fi);var ed=fi.exports,hi={exports:{}};hi.exports;(function(t){(function(e,n,r){function s(l){var a=this,u="";a.next=function(){var f=a.b,h=a.c,d=a.d,p=a.a;return f=f<<25^f>>>7^h,h=h-d|0,d=d<<24^d>>>8^p,p=p-f|0,a.b=f=f<<20^f>>>12^h,a.c=h=h-d|0,a.d=d<<16^h>>>16^p,a.a=p-f|0},a.a=0,a.b=0,a.c=-1640531527,a.d=1367130551,l===Math.floor(l)?(a.a=l/4294967296|0,a.b=l|0):u+=l;for(var c=0;c<u.length+20;c++)a.b^=u.charCodeAt(c)|0,a.next()}function i(l,a){return a.a=l.a,a.b=l.b,a.c=l.c,a.d=l.d,a}function o(l,a){var u=new s(l),c=a&&a.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var h=u.next()>>>11,d=(u.next()>>>0)/4294967296,p=(h+d)/(1<<21);while(p===0);return p},f.int32=u.next,f.quick=f,c&&(typeof c=="object"&&i(c,u),f.state=function(){return i(u,{})}),f}n&&n.exports?n.exports=o:this.tychei=o})(xt,t)})(hi);var td=hi.exports,qo={exports:{}};const nd={},rd=Object.freeze(Object.defineProperty({__proto__:null,default:nd},Symbol.toStringTag,{value:"Module"})),sd=Mf(rd);(function(t){(function(e,n,r){var s=256,i=6,o=52,l="random",a=r.pow(s,i),u=r.pow(2,o),c=u*2,f=s-1,h;function d(M,E,P){var b=[];E=E==!0?{entropy:!0}:E||{};var _=x(v(E.entropy?[M,R(n)]:M??k(),3),b),m=new p(b),C=function(){for(var S=m.g(i),O=a,N=0;S<u;)S=(S+N)*s,O*=s,N=m.g(1);for(;S>=c;)S/=2,O/=2,N>>>=1;return(S+N)/O};return C.int32=function(){return m.g(4)|0},C.quick=function(){return m.g(4)/4294967296},C.double=C,x(R(m.S),n),(E.pass||P||function(S,O,N,L){return L&&(L.S&&w(L,m),S.state=function(){return w(m,{})}),N?(r[l]=S,O):S})(C,_,"global"in E?E.global:this==r,E.state)}function p(M){var E,P=M.length,b=this,_=0,m=b.i=b.j=0,C=b.S=[];for(P||(M=[P++]);_<s;)C[_]=_++;for(_=0;_<s;_++)C[_]=C[m=f&m+M[_%P]+(E=C[_])],C[m]=E;(b.g=function(S){for(var O,N=0,L=b.i,U=b.j,X=b.S;S--;)O=X[L=f&L+1],N=N*s+X[f&(X[L]=X[U=f&U+O])+(X[U]=O)];return b.i=L,b.j=U,N})(s)}function w(M,E){return E.i=M.i,E.j=M.j,E.S=M.S.slice(),E}function v(M,E){var P=[],b=typeof M,_;if(E&&b=="object")for(_ in M)try{P.push(v(M[_],E-1))}catch{}return P.length?P:b=="string"?M:M+"\0"}function x(M,E){for(var P=M+"",b,_=0;_<P.length;)E[f&_]=f&(b^=E[f&_]*19)+P.charCodeAt(_++);return R(E)}function k(){try{var M;return h&&(M=h.randomBytes)?M=M(s):(M=new Uint8Array(s),(e.crypto||e.msCrypto).getRandomValues(M)),R(M)}catch{var E=e.navigator,P=E&&E.plugins;return[+new Date,e,P,e.screen,R(n)]}}function R(M){return String.fromCharCode.apply(0,M)}if(x(r.random(),n),t.exports){t.exports=d;try{h=sd}catch{}}else r["seed"+l]=d})(typeof self<"u"?self:xt,[],Math)})(qo);var id=qo.exports,ad=Gh,od=Qh,ld=Yh,ud=Zh,cd=ed,fd=td,Tt=id;Tt.alea=ad;Tt.xor128=od;Tt.xorwow=ld;Tt.xorshift7=ud;Tt.xor4096=cd;Tt.tychei=fd;var hd=Tt;const dd=eo(hd);function pd(t){let e,n,r,s,i,o,l,a,u,c,f,h,d,p,w,v,x,k,R,M,E,P,b,_,m,C,S,O,N,L,U;function X(j){t[10](j)}let D={};return t[0]!==void 0&&(D.fileName=t[0]),n=new Hs({props:D}),t[9](n),we.push(()=>Be(n,"fileName",X)),C=new As({props:{fileName:`${t[6]}-split1.jsonl`,data:t[4]}}),O=new As({props:{fileName:`${t[6]}-split2.jsonl`,data:t[5]}}),{c(){e=A("main"),$e(n.$$.fragment),s=B(),i=A("section"),o=A("div"),o.textContent="Parameters",l=B(),a=A("div"),u=A("label"),u.textContent="Seed",c=A("input"),f=B(),h=A("div"),d=A("label"),d.textContent="Number of samples",p=A("input"),w=B(),v=A("section"),x=A("div"),x.textContent="Split",k=B(),R=A("button"),M=fe("Run"),P=B(),b=A("section"),_=A("div"),_.textContent="Results",m=B(),$e(C.$$.fragment),S=B(),$e(O.$$.fragment),y(o,"class","section-title svelte-1pkcvx7"),y(u,"for","seed"),y(u,"class","svelte-1pkcvx7"),y(c,"type","text"),y(c,"id","seed"),y(c,"class","svelte-1pkcvx7"),y(a,"class","input"),y(d,"for","k"),y(d,"class","svelte-1pkcvx7"),y(p,"type","number"),y(p,"id","k"),y(p,"class","svelte-1pkcvx7"),he(p,"invalid",t[7]),y(h,"class","input"),y(i,"class","svelte-1pkcvx7"),y(x,"class","section-title svelte-1pkcvx7"),y(R,"class","button svelte-1pkcvx7"),R.disabled=E=t[0]===""||t[7],y(v,"class","svelte-1pkcvx7"),y(_,"class","section-title svelte-1pkcvx7"),y(b,"class","svelte-1pkcvx7")},m(j,$){oe(j,e,$),Pe(n,e,null),g(e,s),g(e,i),g(i,o),g(i,l),g(i,a),g(a,u),g(a,c),se(c,t[3]),g(i,f),g(i,h),g(h,d),g(h,p),se(p,t[1]),g(e,w),g(e,v),g(v,x),g(v,k),g(v,R),g(R,M),g(e,P),g(e,b),g(b,_),g(b,m),Pe(C,b,null),g(b,S),Pe(O,b,null),N=!0,L||(U=[le(c,"input",t[11]),le(p,"input",t[12]),le(R,"click",t[13])],L=!0)},p(j,[$]){const W={};!r&&$&1&&(r=!0,W.fileName=j[0],qe(()=>r=!1)),n.$set(W),$&8&&c.value!==j[3]&&se(c,j[3]),$&2&&be(p.value)!==j[1]&&se(p,j[1]),(!N||$&128)&&he(p,"invalid",j[7]),(!N||$&129&&E!==(E=j[0]===""||j[7]))&&(R.disabled=E);const J={};$&64&&(J.fileName=`${j[6]}-split1.jsonl`),$&16&&(J.data=j[4]),C.$set(J);const F={};$&64&&(F.fileName=`${j[6]}-split2.jsonl`),$&32&&(F.data=j[5]),O.$set(F)},i(j){N||(Re(n.$$.fragment,j),Re(C.$$.fragment,j),Re(O.$$.fragment,j),N=!0)},o(j){Ne(n.$$.fragment,j),Ne(C.$$.fragment,j),Ne(O.$$.fragment,j),N=!1},d(j){j&&ae(e),t[9](null),Ie(n),Ie(C),Ie(O),L=!1,Ue(U)}}}function md(t,e,n){let r,s;const i=(x,k,R="")=>{k>x&&(k=x);let M=dd(R),E=new Set(Array.from({length:x},(b,_)=>_)),P=new Set;for(let b=0;b<k;b++){let _=Math.floor(M()*E.size),m=Array.from(E)[_];E.delete(m),P.add(m)}return[Array.from(P).sort(),Array.from(E).sort()]};let o,l="",a="",u=0,c=[],f=[];function h(x){we[x?"unshift":"push"](()=>{o=x,n(2,o)})}function d(x){l=x,n(0,l)}function p(){a=this.value,n(3,a)}function w(){u=be(this.value),n(1,u)}const v=()=>{let[x,k]=i(o.data.length,u,a);n(4,c=x.map(R=>o.data[R])),n(5,f=k.map(R=>o.data[R]))};return t.$$.update=()=>{t.$$.dirty&2&&n(7,r=!Number.isInteger(u)||u<0),t.$$.dirty&1&&n(6,s=l.split(".")[0])},[l,u,o,a,c,f,s,r,i,h,d,p,w,v]}class _d extends ut{constructor(e){super(),lt(this,e,md,pd,et,{})}}function ya(t,e,n){const r=t.slice();return r[7]=e[n],r[9]=n,r}function va(t){let e,n=t[7].name+"",r,s,i,o,l,a;function u(){return t[4](t[9])}return{c(){e=A("button"),r=fe(n),s=A("br"),i=A("span"),i.textContent=`${t[7].phon}`,y(i,"class","phonetics svelte-1kr8nc0"),y(e,"class",o="tab "+(t[0]==t[9]?"selected":"")+" svelte-1kr8nc0")},m(c,f){oe(c,e,f),g(e,r),g(e,s),g(e,i),l||(a=le(e,"click",u),l=!0)},p(c,f){t=c,f&1&&o!==(o="tab "+(t[0]==t[9]?"selected":"")+" svelte-1kr8nc0")&&y(e,"class",o)},d(c){c&&ae(e),l=!1,a()}}}function ba(t){let e,n,r;return{c(){e=A("button"),e.textContent="d.sknnect",je(e,"flex","0.25"),je(e,"font-size","16px"),je(e,"white-space","nowrap"),y(e,"class","tab svelte-1kr8nc0")},m(s,i){oe(s,e,i),n||(r=le(e,"click",t[6]),n=!0)},p:ye,d(s){s&&ae(e),n=!1,r()}}}function gd(t){let e,n,r,s,i,o,l,a,u,c,f=bt(t[3]),h=[];for(let v=0;v<f.length;v+=1)h[v]=va(ya(t,f,v));let d=t[1]&&ba(t);var p=t[3][t[0]].component;function w(v,x){return{}}return p&&(l=_i(p,w())),{c(){e=A("header");for(let v=0;v<h.length;v+=1)h[v].c();n=B(),r=A("button"),r.textContent="klear cche",s=B(),d&&d.c(),i=B(),o=A("main"),l&&$e(l.$$.fragment),je(r,"flex","0.2"),je(r,"font-size","16px"),y(r,"class","tab svelte-1kr8nc0"),y(e,"class","tabs svelte-1kr8nc0")},m(v,x){oe(v,e,x);for(let k=0;k<h.length;k+=1)h[k]&&h[k].m(e,null);g(e,n),g(e,r),g(e,s),d&&d.m(e,null),oe(v,i,x),oe(v,o,x),l&&Pe(l,o,null),a=!0,u||(c=le(r,"click",t[5]),u=!0)},p(v,[x]){if(x&13){f=bt(v[3]);let k;for(k=0;k<f.length;k+=1){const R=ya(v,f,k);h[k]?h[k].p(R,x):(h[k]=va(R),h[k].c(),h[k].m(e,n))}for(;k<h.length;k+=1)h[k].d(1);h.length=f.length}if(v[1]?d?d.p(v,x):(d=ba(v),d.c(),d.m(e,null)):d&&(d.d(1),d=null),x&1&&p!==(p=v[3][v[0]].component)){if(l){Zo();const k=l;Ne(k.$$.fragment,1,0,()=>{Ie(k,1)}),el()}p?(l=_i(p,w()),$e(l.$$.fragment),Re(l.$$.fragment,1),Pe(l,o,null)):l=null}},i(v){a||(l&&Re(l.$$.fragment,v),a=!0)},o(v){l&&Ne(l.$$.fragment,v),a=!1},d(v){v&&(ae(e),ae(i),ae(o)),Pn(h,v),d&&d.d(),l&&Ie(l),u=!1,c()}}}function wd(t,e,n){let r;Xo(t,Mt,c=>n(1,r=c));let s=0;function i(c){n(0,s=c)}return[s,r,i,[{name:"evl",phon:"/vl/",component:Dh},{name:"ptim",phon:"/ptm/",component:Kh},{name:"splt",phon:"/splt/",component:_d}],c=>i(c),async()=>{const c=r;localStorage.clear(),localStorage.setItem("apiKey",c)},()=>{Uo(Mt,r="",r)}]}class yd extends ut{constructor(e){super(),lt(this,e,wd,gd,et,{})}}new yd({target:document.getElementById("app")});
