var Bl=Object.defineProperty;var Wl=(t,e,n)=>e in t?Bl(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Vr=(t,e,n)=>Wl(t,typeof e!="symbol"?e+"":e,n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function ye(){}function Aa(t){return t()}function pi(){return Object.create(null)}function De(t){t.forEach(Aa)}function ka(t){return typeof t=="function"}function et(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function Ul(t){return Object.keys(t).length===0}function Sa(t,...e){if(t==null){for(const r of e)r(void 0);return ye}const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function mi(t){let e;return Sa(t,n=>e=n)(),e}function Xl(t,e,n){t.$$.on_destroy.push(Sa(e,n))}function Hl(t,e,n){return t.set(n),e}function g(t,e){t.appendChild(e)}function X(t,e,n){t.insertBefore(e,n||null)}function W(t){t.parentNode&&t.parentNode.removeChild(t)}function In(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function S(t){return document.createElement(t)}function ie(t){return document.createTextNode(t)}function $(){return ie(" ")}function zl(){return ie("")}function se(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function y(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function ke(t){return t===""?null:+t}function Vl(t){return Array.from(t.childNodes)}function Se(t,e){e=""+e,t.data!==e&&(t.data=e)}function re(t,e){t.value=e??""}function ze(t,e,n,r){n==null?t.style.removeProperty(e):t.style.setProperty(e,n,"")}function Ht(t,e,n){for(let r=0;r<t.options.length;r+=1){const s=t.options[r];if(s.__value===e){s.selected=!0;return}}(!n||e!==void 0)&&(t.selectedIndex=-1)}function ns(t){const e=t.querySelector(":checked");return e&&e.__value}function _e(t,e,n){t.classList.toggle(e,!!n)}function _i(t,e){return new t(e)}let xn;function yn(t){xn=t}function Jl(){if(!xn)throw new Error("Function called outside component initialization");return xn}function Kl(t){Jl().$$.on_mount.push(t)}const Bt=[],we=[];let Vt=[];const rs=[],Gl=Promise.resolve();let ss=!1;function Yl(){ss||(ss=!0,Gl.then(Ze))}function Zt(t){Vt.push(t)}function qe(t){rs.push(t)}const Jr=new Set;let Dt=0;function Ze(){if(Dt!==0)return;const t=xn;do{try{for(;Dt<Bt.length;){const e=Bt[Dt];Dt++,yn(e),Ql(e.$$)}}catch(e){throw Bt.length=0,Dt=0,e}for(yn(null),Bt.length=0,Dt=0;we.length;)we.pop()();for(let e=0;e<Vt.length;e+=1){const n=Vt[e];Jr.has(n)||(Jr.add(n),n())}Vt.length=0}while(Bt.length);for(;rs.length;)rs.pop()();ss=!1,Jr.clear(),yn(t)}function Ql(t){if(t.fragment!==null){t.update(),De(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Zt)}}function Zl(t){const e=[],n=[];Vt.forEach(r=>t.indexOf(r)===-1?e.push(r):n.push(r)),n.forEach(r=>r()),Vt=e}const Wn=new Set;let It;function eo(){It={r:0,c:[],p:It}}function to(){It.r||De(It.c),It=It.p}function Te(t,e){t&&t.i&&(Wn.delete(t),t.i(e))}function Be(t,e,n,r){if(t&&t.o){if(Wn.has(t))return;Wn.add(t),It.c.push(()=>{Wn.delete(t),r&&(n&&t.d(1),r())}),t.o(e)}else r&&r()}function At(t){return(t==null?void 0:t.length)!==void 0?t:Array.from(t)}function je(t,e,n){const r=t.$$.props[e];r!==void 0&&(t.$$.bound[r]=n,n(t.$$.ctx[r]))}function We(t){t&&t.c()}function $e(t,e,n){const{fragment:r,after_update:s}=t.$$;r&&r.m(e,n),Zt(()=>{const i=t.$$.on_mount.map(Aa).filter(ka);t.$$.on_destroy?t.$$.on_destroy.push(...i):De(i),t.$$.on_mount=[]}),s.forEach(Zt)}function Le(t,e){const n=t.$$;n.fragment!==null&&(Zl(n.after_update),De(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function no(t,e){t.$$.dirty[0]===-1&&(Bt.push(t),Yl(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function lt(t,e,n,r,s,i,l=null,o=[-1]){const a=xn;yn(t);const u=t.$$={fragment:null,ctx:[],props:i,update:ye,not_equal:s,bound:pi(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(a?a.$$.context:[])),callbacks:pi(),dirty:o,skip_bound:!1,root:e.target||a.$$.root};l&&l(u.root);let f=!1;if(u.ctx=n?n(t,e.props||{},(c,h,...d)=>{const p=d.length?d[0]:h;return u.ctx&&s(u.ctx[c],u.ctx[c]=p)&&(!u.skip_bound&&u.bound[c]&&u.bound[c](p),f&&no(t,c)),h}):[],u.update(),f=!0,De(u.before_update),u.fragment=r?r(u.ctx):!1,e.target){if(e.hydrate){const c=Vl(e.target);u.fragment&&u.fragment.l(c),c.forEach(W)}else u.fragment&&u.fragment.c();e.intro&&Te(t.$$.fragment),$e(t,e.target,e.anchor),Ze()}yn(a)}class ot{constructor(){Vr(this,"$$");Vr(this,"$$set")}$destroy(){Le(this,1),this.$destroy=ye}$on(e,n){if(!ka(n))return ye;const r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(n),()=>{const s=r.indexOf(n);s!==-1&&r.splice(s,1)}}$set(e){this.$$set&&!Ul(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const ro="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(ro);function so(t,e){let n;for(const r of t)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);return n}function io(t,e){let n;for(const r of t)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);return n}var ao={value:()=>{}};function Ea(){for(var t=0,e=arguments.length,n={},r;t<e;++t){if(!(r=arguments[t]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new Un(n)}function Un(t){this._=t}function lo(t,e){return t.trim().split(/^|\s+/).map(function(n){var r="",s=n.indexOf(".");if(s>=0&&(r=n.slice(s+1),n=n.slice(0,s)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}Un.prototype=Ea.prototype={constructor:Un,on:function(t,e){var n=this._,r=lo(t+"",n),s,i=-1,l=r.length;if(arguments.length<2){for(;++i<l;)if((s=(t=r[i]).type)&&(s=oo(n[s],t.name)))return s;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++i<l;)if(s=(t=r[i]).type)n[s]=gi(n[s],t.name,e);else if(e==null)for(s in n)n[s]=gi(n[s],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Un(t)},call:function(t,e){if((s=arguments.length-2)>0)for(var n=new Array(s),r=0,s,i;r<s;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(i=this._[t],r=0,s=i.length;r<s;++r)i[r].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],s=0,i=r.length;s<i;++s)r[s].value.apply(e,n)}};function oo(t,e){for(var n=0,r=t.length,s;n<r;++n)if((s=t[n]).name===e)return s.value}function gi(t,e,n){for(var r=0,s=t.length;r<s;++r)if(t[r].name===e){t[r]=ao,t=t.slice(0,r).concat(t.slice(r+1));break}return n!=null&&t.push({name:e,value:n}),t}var is="http://www.w3.org/1999/xhtml";const wi={svg:"http://www.w3.org/2000/svg",xhtml:is,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function jr(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),wi.hasOwnProperty(e)?{space:wi[e],local:t}:t}function uo(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===is&&e.documentElement.namespaceURI===is?e.createElement(t):e.createElementNS(n,t)}}function co(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Ra(t){var e=jr(t);return(e.local?co:uo)(e)}function fo(){}function Ds(t){return t==null?fo:function(){return this.querySelector(t)}}function ho(t){typeof t!="function"&&(t=Ds(t));for(var e=this._groups,n=e.length,r=new Array(n),s=0;s<n;++s)for(var i=e[s],l=i.length,o=r[s]=new Array(l),a,u,f=0;f<l;++f)(a=i[f])&&(u=t.call(a,a.__data__,f,i))&&("__data__"in a&&(u.__data__=a.__data__),o[f]=u);return new Fe(r,this._parents)}function Pa(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function po(){return[]}function Ia(t){return t==null?po:function(){return this.querySelectorAll(t)}}function mo(t){return function(){return Pa(t.apply(this,arguments))}}function _o(t){typeof t=="function"?t=mo(t):t=Ia(t);for(var e=this._groups,n=e.length,r=[],s=[],i=0;i<n;++i)for(var l=e[i],o=l.length,a,u=0;u<o;++u)(a=l[u])&&(r.push(t.call(a,a.__data__,u,l)),s.push(a));return new Fe(r,s)}function Ma(t){return function(){return this.matches(t)}}function Oa(t){return function(e){return e.matches(t)}}var go=Array.prototype.find;function wo(t){return function(){return go.call(this.children,t)}}function yo(){return this.firstElementChild}function vo(t){return this.select(t==null?yo:wo(typeof t=="function"?t:Oa(t)))}var bo=Array.prototype.filter;function xo(){return Array.from(this.children)}function Co(t){return function(){return bo.call(this.children,t)}}function Ao(t){return this.selectAll(t==null?xo:Co(typeof t=="function"?t:Oa(t)))}function ko(t){typeof t!="function"&&(t=Ma(t));for(var e=this._groups,n=e.length,r=new Array(n),s=0;s<n;++s)for(var i=e[s],l=i.length,o=r[s]=[],a,u=0;u<l;++u)(a=i[u])&&t.call(a,a.__data__,u,i)&&o.push(a);return new Fe(r,this._parents)}function Na(t){return new Array(t.length)}function So(){return new Fe(this._enter||this._groups.map(Na),this._parents)}function ir(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}ir.prototype={constructor:ir,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function Eo(t){return function(){return t}}function Ro(t,e,n,r,s,i){for(var l=0,o,a=e.length,u=i.length;l<u;++l)(o=e[l])?(o.__data__=i[l],r[l]=o):n[l]=new ir(t,i[l]);for(;l<a;++l)(o=e[l])&&(s[l]=o)}function Po(t,e,n,r,s,i,l){var o,a,u=new Map,f=e.length,c=i.length,h=new Array(f),d;for(o=0;o<f;++o)(a=e[o])&&(h[o]=d=l.call(a,a.__data__,o,e)+"",u.has(d)?s[o]=a:u.set(d,a));for(o=0;o<c;++o)d=l.call(t,i[o],o,i)+"",(a=u.get(d))?(r[o]=a,a.__data__=i[o],u.delete(d)):n[o]=new ir(t,i[o]);for(o=0;o<f;++o)(a=e[o])&&u.get(h[o])===a&&(s[o]=a)}function Io(t){return t.__data__}function Mo(t,e){if(!arguments.length)return Array.from(this,Io);var n=e?Po:Ro,r=this._parents,s=this._groups;typeof t!="function"&&(t=Eo(t));for(var i=s.length,l=new Array(i),o=new Array(i),a=new Array(i),u=0;u<i;++u){var f=r[u],c=s[u],h=c.length,d=Oo(t.call(f,f&&f.__data__,u,r)),p=d.length,w=o[u]=new Array(p),v=l[u]=new Array(p),b=a[u]=new Array(h);n(f,c,w,v,b,d,e);for(var x=0,A=0,P,R;x<p;++x)if(P=w[x]){for(x>=A&&(A=x+1);!(R=v[A])&&++A<p;);P._next=R||null}}return l=new Fe(l,r),l._enter=o,l._exit=a,l}function Oo(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function No(){return new Fe(this._exit||this._groups.map(Na),this._parents)}function To(t,e,n){var r=this.enter(),s=this,i=this.exit();return typeof t=="function"?(r=t(r),r&&(r=r.selection())):r=r.append(t+""),e!=null&&(s=e(s),s&&(s=s.selection())),n==null?i.remove():n(i),r&&s?r.merge(s).order():s}function $o(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,s=n.length,i=r.length,l=Math.min(s,i),o=new Array(s),a=0;a<l;++a)for(var u=n[a],f=r[a],c=u.length,h=o[a]=new Array(c),d,p=0;p<c;++p)(d=u[p]||f[p])&&(h[p]=d);for(;a<s;++a)o[a]=n[a];return new Fe(o,this._parents)}function Lo(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r=t[e],s=r.length-1,i=r[s],l;--s>=0;)(l=r[s])&&(i&&l.compareDocumentPosition(i)^4&&i.parentNode.insertBefore(l,i),i=l);return this}function Fo(t){t||(t=Do);function e(c,h){return c&&h?t(c.__data__,h.__data__):!c-!h}for(var n=this._groups,r=n.length,s=new Array(r),i=0;i<r;++i){for(var l=n[i],o=l.length,a=s[i]=new Array(o),u,f=0;f<o;++f)(u=l[f])&&(a[f]=u);a.sort(e)}return new Fe(s,this._parents).order()}function Do(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function qo(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function jo(){return Array.from(this)}function Bo(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],s=0,i=r.length;s<i;++s){var l=r[s];if(l)return l}return null}function Wo(){let t=0;for(const e of this)++t;return t}function Uo(){return!this.node()}function Xo(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var s=e[n],i=0,l=s.length,o;i<l;++i)(o=s[i])&&t.call(o,o.__data__,i,s);return this}function Ho(t){return function(){this.removeAttribute(t)}}function zo(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Vo(t,e){return function(){this.setAttribute(t,e)}}function Jo(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function Ko(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function Go(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function Yo(t,e){var n=jr(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((e==null?n.local?zo:Ho:typeof e=="function"?n.local?Go:Ko:n.local?Jo:Vo)(n,e))}function Ta(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Qo(t){return function(){this.style.removeProperty(t)}}function Zo(t,e,n){return function(){this.style.setProperty(t,e,n)}}function eu(t,e,n){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function tu(t,e,n){return arguments.length>1?this.each((e==null?Qo:typeof e=="function"?eu:Zo)(t,e,n??"")):en(this.node(),t)}function en(t,e){return t.style.getPropertyValue(e)||Ta(t).getComputedStyle(t,null).getPropertyValue(e)}function nu(t){return function(){delete this[t]}}function ru(t,e){return function(){this[t]=e}}function su(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function iu(t,e){return arguments.length>1?this.each((e==null?nu:typeof e=="function"?su:ru)(t,e)):this.node()[t]}function $a(t){return t.trim().split(/^|\s+/)}function qs(t){return t.classList||new La(t)}function La(t){this._node=t,this._names=$a(t.getAttribute("class")||"")}La.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function Fa(t,e){for(var n=qs(t),r=-1,s=e.length;++r<s;)n.add(e[r])}function Da(t,e){for(var n=qs(t),r=-1,s=e.length;++r<s;)n.remove(e[r])}function au(t){return function(){Fa(this,t)}}function lu(t){return function(){Da(this,t)}}function ou(t,e){return function(){(e.apply(this,arguments)?Fa:Da)(this,t)}}function uu(t,e){var n=$a(t+"");if(arguments.length<2){for(var r=qs(this.node()),s=-1,i=n.length;++s<i;)if(!r.contains(n[s]))return!1;return!0}return this.each((typeof e=="function"?ou:e?au:lu)(n,e))}function cu(){this.textContent=""}function fu(t){return function(){this.textContent=t}}function hu(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function du(t){return arguments.length?this.each(t==null?cu:(typeof t=="function"?hu:fu)(t)):this.node().textContent}function pu(){this.innerHTML=""}function mu(t){return function(){this.innerHTML=t}}function _u(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function gu(t){return arguments.length?this.each(t==null?pu:(typeof t=="function"?_u:mu)(t)):this.node().innerHTML}function wu(){this.nextSibling&&this.parentNode.appendChild(this)}function yu(){return this.each(wu)}function vu(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function bu(){return this.each(vu)}function xu(t){var e=typeof t=="function"?t:Ra(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function Cu(){return null}function Au(t,e){var n=typeof t=="function"?t:Ra(t),r=e==null?Cu:typeof e=="function"?e:Ds(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function ku(){var t=this.parentNode;t&&t.removeChild(this)}function Su(){return this.each(ku)}function Eu(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Ru(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Pu(t){return this.select(t?Ru:Eu)}function Iu(t){return arguments.length?this.property("__data__",t):this.node().__data__}function Mu(t){return function(e){t.call(this,e,this.__data__)}}function Ou(t){return t.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");return r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),{type:e,name:n}})}function Nu(t){return function(){var e=this.__on;if(e){for(var n=0,r=-1,s=e.length,i;n<s;++n)i=e[n],(!t.type||i.type===t.type)&&i.name===t.name?this.removeEventListener(i.type,i.listener,i.options):e[++r]=i;++r?e.length=r:delete this.__on}}}function Tu(t,e,n){return function(){var r=this.__on,s,i=Mu(e);if(r){for(var l=0,o=r.length;l<o;++l)if((s=r[l]).type===t.type&&s.name===t.name){this.removeEventListener(s.type,s.listener,s.options),this.addEventListener(s.type,s.listener=i,s.options=n),s.value=e;return}}this.addEventListener(t.type,i,n),s={type:t.type,name:t.name,value:e,listener:i,options:n},r?r.push(s):this.__on=[s]}}function $u(t,e,n){var r=Ou(t+""),s,i=r.length,l;if(arguments.length<2){var o=this.node().__on;if(o){for(var a=0,u=o.length,f;a<u;++a)for(s=0,f=o[a];s<i;++s)if((l=r[s]).type===f.type&&l.name===f.name)return f.value}return}for(o=e?Tu:Nu,s=0;s<i;++s)this.each(o(r[s],e,n));return this}function qa(t,e,n){var r=Ta(t),s=r.CustomEvent;typeof s=="function"?s=new s(e,n):(s=r.document.createEvent("Event"),n?(s.initEvent(e,n.bubbles,n.cancelable),s.detail=n.detail):s.initEvent(e,!1,!1)),t.dispatchEvent(s)}function Lu(t,e){return function(){return qa(this,t,e)}}function Fu(t,e){return function(){return qa(this,t,e.apply(this,arguments))}}function Du(t,e){return this.each((typeof e=="function"?Fu:Lu)(t,e))}function*qu(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],s=0,i=r.length,l;s<i;++s)(l=r[s])&&(yield l)}var js=[null];function Fe(t,e){this._groups=t,this._parents=e}function Mn(){return new Fe([[document.documentElement]],js)}function ju(){return this}Fe.prototype=Mn.prototype={constructor:Fe,select:ho,selectAll:_o,selectChild:vo,selectChildren:Ao,filter:ko,data:Mo,enter:So,exit:No,join:To,merge:$o,selection:ju,order:Lo,sort:Fo,call:qo,nodes:jo,node:Bo,size:Wo,empty:Uo,each:Xo,attr:Yo,style:tu,property:iu,classed:uu,text:du,html:gu,raise:yu,lower:bu,append:xu,insert:Au,remove:Su,clone:Pu,datum:Iu,on:$u,dispatch:Du,[Symbol.iterator]:qu};function nn(t){return typeof t=="string"?new Fe([[document.querySelector(t)]],[document.documentElement]):new Fe([[t]],js)}function Bu(t){return typeof t=="string"?new Fe([document.querySelectorAll(t)],[document.documentElement]):new Fe([Pa(t)],js)}function Bs(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function ja(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function On(){}var Cn=.7,ar=1/Cn,Jt="\\s*([+-]?\\d+)\\s*",An="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",mt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Wu=/^#([0-9a-f]{3,8})$/,Uu=new RegExp(`^rgb\\(${Jt},${Jt},${Jt}\\)$`),Xu=new RegExp(`^rgb\\(${mt},${mt},${mt}\\)$`),Hu=new RegExp(`^rgba\\(${Jt},${Jt},${Jt},${An}\\)$`),zu=new RegExp(`^rgba\\(${mt},${mt},${mt},${An}\\)$`),Vu=new RegExp(`^hsl\\(${An},${mt},${mt}\\)$`),Ju=new RegExp(`^hsla\\(${An},${mt},${mt},${An}\\)$`),yi={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Bs(On,kn,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:vi,formatHex:vi,formatHex8:Ku,formatHsl:Gu,formatRgb:bi,toString:bi});function vi(){return this.rgb().formatHex()}function Ku(){return this.rgb().formatHex8()}function Gu(){return Ba(this).formatHsl()}function bi(){return this.rgb().formatRgb()}function kn(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Wu.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?xi(e):n===3?new Ue(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?Tn(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?Tn(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=Uu.exec(t))?new Ue(e[1],e[2],e[3],1):(e=Xu.exec(t))?new Ue(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=Hu.exec(t))?Tn(e[1],e[2],e[3],e[4]):(e=zu.exec(t))?Tn(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=Vu.exec(t))?ki(e[1],e[2]/100,e[3]/100,1):(e=Ju.exec(t))?ki(e[1],e[2]/100,e[3]/100,e[4]):yi.hasOwnProperty(t)?xi(yi[t]):t==="transparent"?new Ue(NaN,NaN,NaN,0):null}function xi(t){return new Ue(t>>16&255,t>>8&255,t&255,1)}function Tn(t,e,n,r){return r<=0&&(t=e=n=NaN),new Ue(t,e,n,r)}function Yu(t){return t instanceof On||(t=kn(t)),t?(t=t.rgb(),new Ue(t.r,t.g,t.b,t.opacity)):new Ue}function as(t,e,n,r){return arguments.length===1?Yu(t):new Ue(t,e,n,r??1)}function Ue(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}Bs(Ue,as,ja(On,{brighter(t){return t=t==null?ar:Math.pow(ar,t),new Ue(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?Cn:Math.pow(Cn,t),new Ue(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Ue(Tt(this.r),Tt(this.g),Tt(this.b),lr(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Ci,formatHex:Ci,formatHex8:Qu,formatRgb:Ai,toString:Ai}));function Ci(){return`#${Mt(this.r)}${Mt(this.g)}${Mt(this.b)}`}function Qu(){return`#${Mt(this.r)}${Mt(this.g)}${Mt(this.b)}${Mt((isNaN(this.opacity)?1:this.opacity)*255)}`}function Ai(){const t=lr(this.opacity);return`${t===1?"rgb(":"rgba("}${Tt(this.r)}, ${Tt(this.g)}, ${Tt(this.b)}${t===1?")":`, ${t})`}`}function lr(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Tt(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Mt(t){return t=Tt(t),(t<16?"0":"")+t.toString(16)}function ki(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new it(t,e,n,r)}function Ba(t){if(t instanceof it)return new it(t.h,t.s,t.l,t.opacity);if(t instanceof On||(t=kn(t)),!t)return new it;if(t instanceof it)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,s=Math.min(e,n,r),i=Math.max(e,n,r),l=NaN,o=i-s,a=(i+s)/2;return o?(e===i?l=(n-r)/o+(n<r)*6:n===i?l=(r-e)/o+2:l=(e-n)/o+4,o/=a<.5?i+s:2-i-s,l*=60):o=a>0&&a<1?0:l,new it(l,o,a,t.opacity)}function Zu(t,e,n,r){return arguments.length===1?Ba(t):new it(t,e,n,r??1)}function it(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}Bs(it,Zu,ja(On,{brighter(t){return t=t==null?ar:Math.pow(ar,t),new it(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?Cn:Math.pow(Cn,t),new it(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,s=2*n-r;return new Ue(Kr(t>=240?t-240:t+120,s,r),Kr(t,s,r),Kr(t<120?t+240:t-120,s,r),this.opacity)},clamp(){return new it(Si(this.h),$n(this.s),$n(this.l),lr(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=lr(this.opacity);return`${t===1?"hsl(":"hsla("}${Si(this.h)}, ${$n(this.s)*100}%, ${$n(this.l)*100}%${t===1?")":`, ${t})`}`}}));function Si(t){return t=(t||0)%360,t<0?t+360:t}function $n(t){return Math.max(0,Math.min(1,t||0))}function Kr(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const Wa=t=>()=>t;function ec(t,e){return function(n){return t+n*e}}function tc(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function nc(t){return(t=+t)==1?Ua:function(e,n){return n-e?tc(e,n,t):Wa(isNaN(e)?n:e)}}function Ua(t,e){var n=e-t;return n?ec(t,n):Wa(isNaN(t)?e:t)}const Ei=function t(e){var n=nc(e);function r(s,i){var l=n((s=as(s)).r,(i=as(i)).r),o=n(s.g,i.g),a=n(s.b,i.b),u=Ua(s.opacity,i.opacity);return function(f){return s.r=l(f),s.g=o(f),s.b=a(f),s.opacity=u(f),s+""}}return r.gamma=t,r}(1);function Ct(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}var ls=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Gr=new RegExp(ls.source,"g");function rc(t){return function(){return t}}function sc(t){return function(e){return t(e)+""}}function ic(t,e){var n=ls.lastIndex=Gr.lastIndex=0,r,s,i,l=-1,o=[],a=[];for(t=t+"",e=e+"";(r=ls.exec(t))&&(s=Gr.exec(e));)(i=s.index)>n&&(i=e.slice(n,i),o[l]?o[l]+=i:o[++l]=i),(r=r[0])===(s=s[0])?o[l]?o[l]+=s:o[++l]=s:(o[++l]=null,a.push({i:l,x:Ct(r,s)})),n=Gr.lastIndex;return n<e.length&&(i=e.slice(n),o[l]?o[l]+=i:o[++l]=i),o.length<2?a[0]?sc(a[0].x):rc(e):(e=a.length,function(u){for(var f=0,c;f<e;++f)o[(c=a[f]).i]=c.x(u);return o.join("")})}var Ri=180/Math.PI,os={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Xa(t,e,n,r,s,i){var l,o,a;return(l=Math.sqrt(t*t+e*e))&&(t/=l,e/=l),(a=t*n+e*r)&&(n-=t*a,r-=e*a),(o=Math.sqrt(n*n+r*r))&&(n/=o,r/=o,a/=o),t*r<e*n&&(t=-t,e=-e,a=-a,l=-l),{translateX:s,translateY:i,rotate:Math.atan2(e,t)*Ri,skewX:Math.atan(a)*Ri,scaleX:l,scaleY:o}}var Ln;function ac(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?os:Xa(e.a,e.b,e.c,e.d,e.e,e.f)}function lc(t){return t==null||(Ln||(Ln=document.createElementNS("http://www.w3.org/2000/svg","g")),Ln.setAttribute("transform",t),!(t=Ln.transform.baseVal.consolidate()))?os:(t=t.matrix,Xa(t.a,t.b,t.c,t.d,t.e,t.f))}function Ha(t,e,n,r){function s(u){return u.length?u.pop()+" ":""}function i(u,f,c,h,d,p){if(u!==c||f!==h){var w=d.push("translate(",null,e,null,n);p.push({i:w-4,x:Ct(u,c)},{i:w-2,x:Ct(f,h)})}else(c||h)&&d.push("translate("+c+e+h+n)}function l(u,f,c,h){u!==f?(u-f>180?f+=360:f-u>180&&(u+=360),h.push({i:c.push(s(c)+"rotate(",null,r)-2,x:Ct(u,f)})):f&&c.push(s(c)+"rotate("+f+r)}function o(u,f,c,h){u!==f?h.push({i:c.push(s(c)+"skewX(",null,r)-2,x:Ct(u,f)}):f&&c.push(s(c)+"skewX("+f+r)}function a(u,f,c,h,d,p){if(u!==c||f!==h){var w=d.push(s(d)+"scale(",null,",",null,")");p.push({i:w-4,x:Ct(u,c)},{i:w-2,x:Ct(f,h)})}else(c!==1||h!==1)&&d.push(s(d)+"scale("+c+","+h+")")}return function(u,f){var c=[],h=[];return u=t(u),f=t(f),i(u.translateX,u.translateY,f.translateX,f.translateY,c,h),l(u.rotate,f.rotate,c,h),o(u.skewX,f.skewX,c,h),a(u.scaleX,u.scaleY,f.scaleX,f.scaleY,c,h),u=f=null,function(d){for(var p=-1,w=h.length,v;++p<w;)c[(v=h[p]).i]=v.x(d);return c.join("")}}}var oc=Ha(ac,"px, ","px)","deg)"),uc=Ha(lc,", ",")",")"),tn=0,sn=0,rn=0,za=1e3,or,an,ur=0,$t=0,Br=0,Sn=typeof performance=="object"&&performance.now?performance:Date,Va=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Ws(){return $t||(Va(cc),$t=Sn.now()+Br)}function cc(){$t=0}function cr(){this._call=this._time=this._next=null}cr.prototype=Ja.prototype={constructor:cr,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?Ws():+n)+(e==null?0:+e),!this._next&&an!==this&&(an?an._next=this:or=this,an=this),this._call=t,this._time=n,us()},stop:function(){this._call&&(this._call=null,this._time=1/0,us())}};function Ja(t,e,n){var r=new cr;return r.restart(t,e,n),r}function fc(){Ws(),++tn;for(var t=or,e;t;)(e=$t-t._time)>=0&&t._call.call(void 0,e),t=t._next;--tn}function Pi(){$t=(ur=Sn.now())+Br,tn=sn=0;try{fc()}finally{tn=0,dc(),$t=0}}function hc(){var t=Sn.now(),e=t-ur;e>za&&(Br-=e,ur=t)}function dc(){for(var t,e=or,n,r=1/0;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:or=n);an=t,us(r)}function us(t){if(!tn){sn&&(sn=clearTimeout(sn));var e=t-$t;e>24?(t<1/0&&(sn=setTimeout(Pi,t-Sn.now()-Br)),rn&&(rn=clearInterval(rn))):(rn||(ur=Sn.now(),rn=setInterval(hc,za)),tn=1,Va(Pi))}}function Ii(t,e,n){var r=new cr;return e=e==null?0:+e,r.restart(s=>{r.stop(),t(s+e)},e,n),r}var pc=Ea("start","end","cancel","interrupt"),mc=[],Ka=0,Mi=1,cs=2,Xn=3,Oi=4,fs=5,Hn=6;function Wr(t,e,n,r,s,i){var l=t.__transition;if(!l)t.__transition={};else if(n in l)return;_c(t,n,{name:e,index:r,group:s,on:pc,tween:mc,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:Ka})}function Us(t,e){var n=ut(t,e);if(n.state>Ka)throw new Error("too late; already scheduled");return n}function _t(t,e){var n=ut(t,e);if(n.state>Xn)throw new Error("too late; already running");return n}function ut(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function _c(t,e,n){var r=t.__transition,s;r[e]=n,n.timer=Ja(i,0,n.time);function i(u){n.state=Mi,n.timer.restart(l,n.delay,n.time),n.delay<=u&&l(u-n.delay)}function l(u){var f,c,h,d;if(n.state!==Mi)return a();for(f in r)if(d=r[f],d.name===n.name){if(d.state===Xn)return Ii(l);d.state===Oi?(d.state=Hn,d.timer.stop(),d.on.call("interrupt",t,t.__data__,d.index,d.group),delete r[f]):+f<e&&(d.state=Hn,d.timer.stop(),d.on.call("cancel",t,t.__data__,d.index,d.group),delete r[f])}if(Ii(function(){n.state===Xn&&(n.state=Oi,n.timer.restart(o,n.delay,n.time),o(u))}),n.state=cs,n.on.call("start",t,t.__data__,n.index,n.group),n.state===cs){for(n.state=Xn,s=new Array(h=n.tween.length),f=0,c=-1;f<h;++f)(d=n.tween[f].value.call(t,t.__data__,n.index,n.group))&&(s[++c]=d);s.length=c+1}}function o(u){for(var f=u<n.duration?n.ease.call(null,u/n.duration):(n.timer.restart(a),n.state=fs,1),c=-1,h=s.length;++c<h;)s[c].call(t,f);n.state===fs&&(n.on.call("end",t,t.__data__,n.index,n.group),a())}function a(){n.state=Hn,n.timer.stop(),delete r[e];for(var u in r)return;delete t.__transition}}function gc(t,e){var n=t.__transition,r,s,i=!0,l;if(n){e=e==null?null:e+"";for(l in n){if((r=n[l]).name!==e){i=!1;continue}s=r.state>cs&&r.state<fs,r.state=Hn,r.timer.stop(),r.on.call(s?"interrupt":"cancel",t,t.__data__,r.index,r.group),delete n[l]}i&&delete t.__transition}}function wc(t){return this.each(function(){gc(this,t)})}function yc(t,e){var n,r;return function(){var s=_t(this,t),i=s.tween;if(i!==n){r=n=i;for(var l=0,o=r.length;l<o;++l)if(r[l].name===e){r=r.slice(),r.splice(l,1);break}}s.tween=r}}function vc(t,e,n){var r,s;if(typeof n!="function")throw new Error;return function(){var i=_t(this,t),l=i.tween;if(l!==r){s=(r=l).slice();for(var o={name:e,value:n},a=0,u=s.length;a<u;++a)if(s[a].name===e){s[a]=o;break}a===u&&s.push(o)}i.tween=s}}function bc(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r=ut(this.node(),n).tween,s=0,i=r.length,l;s<i;++s)if((l=r[s]).name===t)return l.value;return null}return this.each((e==null?yc:vc)(n,t,e))}function Xs(t,e,n){var r=t._id;return t.each(function(){var s=_t(this,r);(s.value||(s.value={}))[e]=n.apply(this,arguments)}),function(s){return ut(s,r).value[e]}}function Ga(t,e){var n;return(typeof e=="number"?Ct:e instanceof kn?Ei:(n=kn(e))?(e=n,Ei):ic)(t,e)}function xc(t){return function(){this.removeAttribute(t)}}function Cc(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Ac(t,e,n){var r,s=n+"",i;return function(){var l=this.getAttribute(t);return l===s?null:l===r?i:i=e(r=l,n)}}function kc(t,e,n){var r,s=n+"",i;return function(){var l=this.getAttributeNS(t.space,t.local);return l===s?null:l===r?i:i=e(r=l,n)}}function Sc(t,e,n){var r,s,i;return function(){var l,o=n(this),a;return o==null?void this.removeAttribute(t):(l=this.getAttribute(t),a=o+"",l===a?null:l===r&&a===s?i:(s=a,i=e(r=l,o)))}}function Ec(t,e,n){var r,s,i;return function(){var l,o=n(this),a;return o==null?void this.removeAttributeNS(t.space,t.local):(l=this.getAttributeNS(t.space,t.local),a=o+"",l===a?null:l===r&&a===s?i:(s=a,i=e(r=l,o)))}}function Rc(t,e){var n=jr(t),r=n==="transform"?uc:Ga;return this.attrTween(t,typeof e=="function"?(n.local?Ec:Sc)(n,r,Xs(this,"attr."+t,e)):e==null?(n.local?Cc:xc)(n):(n.local?kc:Ac)(n,r,e))}function Pc(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function Ic(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function Mc(t,e){var n,r;function s(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&Ic(t,i)),n}return s._value=e,s}function Oc(t,e){var n,r;function s(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&Pc(t,i)),n}return s._value=e,s}function Nc(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var r=jr(t);return this.tween(n,(r.local?Mc:Oc)(r,e))}function Tc(t,e){return function(){Us(this,t).delay=+e.apply(this,arguments)}}function $c(t,e){return e=+e,function(){Us(this,t).delay=e}}function Lc(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?Tc:$c)(e,t)):ut(this.node(),e).delay}function Fc(t,e){return function(){_t(this,t).duration=+e.apply(this,arguments)}}function Dc(t,e){return e=+e,function(){_t(this,t).duration=e}}function qc(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?Fc:Dc)(e,t)):ut(this.node(),e).duration}function jc(t,e){if(typeof e!="function")throw new Error;return function(){_t(this,t).ease=e}}function Bc(t){var e=this._id;return arguments.length?this.each(jc(e,t)):ut(this.node(),e).ease}function Wc(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;_t(this,t).ease=n}}function Uc(t){if(typeof t!="function")throw new Error;return this.each(Wc(this._id,t))}function Xc(t){typeof t!="function"&&(t=Ma(t));for(var e=this._groups,n=e.length,r=new Array(n),s=0;s<n;++s)for(var i=e[s],l=i.length,o=r[s]=[],a,u=0;u<l;++u)(a=i[u])&&t.call(a,a.__data__,u,i)&&o.push(a);return new bt(r,this._parents,this._name,this._id)}function Hc(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,s=n.length,i=Math.min(r,s),l=new Array(r),o=0;o<i;++o)for(var a=e[o],u=n[o],f=a.length,c=l[o]=new Array(f),h,d=0;d<f;++d)(h=a[d]||u[d])&&(c[d]=h);for(;o<r;++o)l[o]=e[o];return new bt(l,this._parents,this._name,this._id)}function zc(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function Vc(t,e,n){var r,s,i=zc(e)?Us:_t;return function(){var l=i(this,t),o=l.on;o!==r&&(s=(r=o).copy()).on(e,n),l.on=s}}function Jc(t,e){var n=this._id;return arguments.length<2?ut(this.node(),n).on.on(t):this.each(Vc(n,t,e))}function Kc(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function Gc(){return this.on("end.remove",Kc(this._id))}function Yc(t){var e=this._name,n=this._id;typeof t!="function"&&(t=Ds(t));for(var r=this._groups,s=r.length,i=new Array(s),l=0;l<s;++l)for(var o=r[l],a=o.length,u=i[l]=new Array(a),f,c,h=0;h<a;++h)(f=o[h])&&(c=t.call(f,f.__data__,h,o))&&("__data__"in f&&(c.__data__=f.__data__),u[h]=c,Wr(u[h],e,n,h,u,ut(f,n)));return new bt(i,this._parents,e,n)}function Qc(t){var e=this._name,n=this._id;typeof t!="function"&&(t=Ia(t));for(var r=this._groups,s=r.length,i=[],l=[],o=0;o<s;++o)for(var a=r[o],u=a.length,f,c=0;c<u;++c)if(f=a[c]){for(var h=t.call(f,f.__data__,c,a),d,p=ut(f,n),w=0,v=h.length;w<v;++w)(d=h[w])&&Wr(d,e,n,w,h,p);i.push(h),l.push(f)}return new bt(i,l,e,n)}var Zc=Mn.prototype.constructor;function ef(){return new Zc(this._groups,this._parents)}function tf(t,e){var n,r,s;return function(){var i=en(this,t),l=(this.style.removeProperty(t),en(this,t));return i===l?null:i===n&&l===r?s:s=e(n=i,r=l)}}function Ya(t){return function(){this.style.removeProperty(t)}}function nf(t,e,n){var r,s=n+"",i;return function(){var l=en(this,t);return l===s?null:l===r?i:i=e(r=l,n)}}function rf(t,e,n){var r,s,i;return function(){var l=en(this,t),o=n(this),a=o+"";return o==null&&(a=o=(this.style.removeProperty(t),en(this,t))),l===a?null:l===r&&a===s?i:(s=a,i=e(r=l,o))}}function sf(t,e){var n,r,s,i="style."+e,l="end."+i,o;return function(){var a=_t(this,t),u=a.on,f=a.value[i]==null?o||(o=Ya(e)):void 0;(u!==n||s!==f)&&(r=(n=u).copy()).on(l,s=f),a.on=r}}function af(t,e,n){var r=(t+="")=="transform"?oc:Ga;return e==null?this.styleTween(t,tf(t,r)).on("end.style."+t,Ya(t)):typeof e=="function"?this.styleTween(t,rf(t,r,Xs(this,"style."+t,e))).each(sf(this._id,t)):this.styleTween(t,nf(t,r,e),n).on("end.style."+t,null)}function lf(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function of(t,e,n){var r,s;function i(){var l=e.apply(this,arguments);return l!==s&&(r=(s=l)&&lf(t,l,n)),r}return i._value=e,i}function uf(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;return this.tween(r,of(t,e,n??""))}function cf(t){return function(){this.textContent=t}}function ff(t){return function(){var e=t(this);this.textContent=e??""}}function hf(t){return this.tween("text",typeof t=="function"?ff(Xs(this,"text",t)):cf(t==null?"":t+""))}function df(t){return function(e){this.textContent=t.call(this,e)}}function pf(t){var e,n;function r(){var s=t.apply(this,arguments);return s!==n&&(e=(n=s)&&df(s)),e}return r._value=t,r}function mf(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,pf(t))}function _f(){for(var t=this._name,e=this._id,n=Qa(),r=this._groups,s=r.length,i=0;i<s;++i)for(var l=r[i],o=l.length,a,u=0;u<o;++u)if(a=l[u]){var f=ut(a,e);Wr(a,t,n,u,l,{time:f.time+f.delay+f.duration,delay:0,duration:f.duration,ease:f.ease})}return new bt(r,this._parents,t,n)}function gf(){var t,e,n=this,r=n._id,s=n.size();return new Promise(function(i,l){var o={value:l},a={value:function(){--s===0&&i()}};n.each(function(){var u=_t(this,r),f=u.on;f!==t&&(e=(t=f).copy(),e._.cancel.push(o),e._.interrupt.push(o),e._.end.push(a)),u.on=e}),s===0&&i()})}var wf=0;function bt(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function Qa(){return++wf}var wt=Mn.prototype;bt.prototype={constructor:bt,select:Yc,selectAll:Qc,selectChild:wt.selectChild,selectChildren:wt.selectChildren,filter:Xc,merge:Hc,selection:ef,transition:_f,call:wt.call,nodes:wt.nodes,node:wt.node,size:wt.size,empty:wt.empty,each:wt.each,on:Jc,attr:Rc,attrTween:Nc,style:af,styleTween:uf,text:hf,textTween:mf,remove:Gc,tween:bc,delay:Lc,duration:qc,ease:Bc,easeVarying:Uc,end:gf,[Symbol.iterator]:wt[Symbol.iterator]};function yf(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var vf={time:null,delay:0,duration:250,ease:yf};function bf(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function xf(t){var e,n;t instanceof bt?(e=t._id,t=t._name):(e=Qa(),(n=vf).time=Ws(),t=t==null?null:t+"");for(var r=this._groups,s=r.length,i=0;i<s;++i)for(var l=r[i],o=l.length,a,u=0;u<o;++u)(a=l[u])&&Wr(a,t,e,u,l,n||bf(a,e));return new bt(r,this._parents,t,e)}Mn.prototype.interrupt=wc;Mn.prototype.transition=xf;const hs=Math.PI,ds=2*hs,Rt=1e-6,Cf=ds-Rt;function Za(t){this._+=t[0];for(let e=1,n=t.length;e<n;++e)this._+=arguments[e]+t[e]}function Af(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return Za;const n=10**e;return function(r){this._+=r[0];for(let s=1,i=r.length;s<i;++s)this._+=Math.round(arguments[s]*n)/n+r[s]}}class kf{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?Za:Af(e)}moveTo(e,n){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,n){this._append`L${this._x1=+e},${this._y1=+n}`}quadraticCurveTo(e,n,r,s){this._append`Q${+e},${+n},${this._x1=+r},${this._y1=+s}`}bezierCurveTo(e,n,r,s,i,l){this._append`C${+e},${+n},${+r},${+s},${this._x1=+i},${this._y1=+l}`}arcTo(e,n,r,s,i){if(e=+e,n=+n,r=+r,s=+s,i=+i,i<0)throw new Error(`negative radius: ${i}`);let l=this._x1,o=this._y1,a=r-e,u=s-n,f=l-e,c=o-n,h=f*f+c*c;if(this._x1===null)this._append`M${this._x1=e},${this._y1=n}`;else if(h>Rt)if(!(Math.abs(c*a-u*f)>Rt)||!i)this._append`L${this._x1=e},${this._y1=n}`;else{let d=r-l,p=s-o,w=a*a+u*u,v=d*d+p*p,b=Math.sqrt(w),x=Math.sqrt(h),A=i*Math.tan((hs-Math.acos((w+h-v)/(2*b*x)))/2),P=A/x,R=A/b;Math.abs(P-1)>Rt&&this._append`L${e+P*f},${n+P*c}`,this._append`A${i},${i},0,0,${+(c*d>f*p)},${this._x1=e+R*a},${this._y1=n+R*u}`}}arc(e,n,r,s,i,l){if(e=+e,n=+n,r=+r,l=!!l,r<0)throw new Error(`negative radius: ${r}`);let o=r*Math.cos(s),a=r*Math.sin(s),u=e+o,f=n+a,c=1^l,h=l?s-i:i-s;this._x1===null?this._append`M${u},${f}`:(Math.abs(this._x1-u)>Rt||Math.abs(this._y1-f)>Rt)&&this._append`L${u},${f}`,r&&(h<0&&(h=h%ds+ds),h>Cf?this._append`A${r},${r},0,1,${c},${e-o},${n-a}A${r},${r},0,1,${c},${this._x1=u},${this._y1=f}`:h>Rt&&this._append`A${r},${r},0,${+(h>=hs)},${c},${this._x1=e+r*Math.cos(i)},${this._y1=n+r*Math.sin(i)}`)}rect(e,n,r,s){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}h${r=+r}v${+s}h${-r}Z`}toString(){return this._}}function qt(t){return function(){return t}}function Sf(t){let e=3;return t.digits=function(n){if(!arguments.length)return e;if(n==null)e=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);e=r}return t},()=>new kf(e)}function Ef(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function el(t){this._context=t}el.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function Rf(t){return new el(t)}function Pf(t){return t[0]}function If(t){return t[1]}function Mf(t,e){var n=qt(!0),r=null,s=Rf,i=null,l=Sf(o);t=typeof t=="function"?t:t===void 0?Pf:qt(t),e=typeof e=="function"?e:e===void 0?If:qt(e);function o(a){var u,f=(a=Ef(a)).length,c,h=!1,d;for(r==null&&(i=s(d=l())),u=0;u<=f;++u)!(u<f&&n(c=a[u],u,a))===h&&((h=!h)?i.lineStart():i.lineEnd()),h&&i.point(+t(c,u,a),+e(c,u,a));if(d)return i=null,d+""||null}return o.x=function(a){return arguments.length?(t=typeof a=="function"?a:qt(+a),o):t},o.y=function(a){return arguments.length?(e=typeof a=="function"?a:qt(+a),o):e},o.defined=function(a){return arguments.length?(n=typeof a=="function"?a:qt(!!a),o):n},o.curve=function(a){return arguments.length?(s=a,r!=null&&(i=s(r)),o):s},o.context=function(a){return arguments.length?(a==null?r=i=null:i=s(r=a),o):r},o}function Ni(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function tl(t){this._context=t}tl.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Ni(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Ni(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function Of(t){return new tl(t)}function ln(t,e,n){this.k=t,this.x=e,this.y=n}ln.prototype={constructor:ln,scale:function(t){return t===1?this:new ln(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new ln(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};ln.prototype;function Nf(t){let e;return{c(){e=S("main"),e.innerHTML=`<section class="svelte-1oma2gs"><b>Welcome to Prompt Ultra!</b> <p>This browser-based app allows you to automatically label textual datasets
      using Large Language Models (LLMs) with your ChatGPT <a href="https://help.openai.com/en/articles/7039783-how-can-i-access-the-chatgpt-api">API key</a>.</p> <p>Here are the different features of Prompt Ultra:</p> <ul><li><b>EVÅL</b>: You can upload an unlabelled dataset and label it by
        providing custom instructions to an LLM. You can also upload an already
        labelled dataset to evaluate the accuracy of the labels generated by
        your instructions.</li> <li><b>ØPTIM</b>: Start by uploading an already labelled dataset and
        providing a set of initial instructions. The app uses a genetic
        algorithm to create and test successive generations of new instructions.
        It selects the instructions that produce the most accurate labels. At
        the end of the optimization process, the app outputs the best
        instructions discovered.</li> <li><b>SPLËT</b>: This convenience feature allows you to randomly divide a
        dataset into two separate datasets.</li> <li><b>KLEAR CÄCHE</b>: API calls are stored by default so that results are
        not lost upon closing the tab. This button clears the cache.</li> <li><b>D.SKÖNNECT</b>: Your OpenAI API key is stored by the browser. You can
        delete it from the browser&#39;s memory using this button (only appears once
        you have entered a valid key).</li></ul></section>`},m(n,r){X(n,e,r)},p:ye,i:ye,o:ye,d(n){n&&W(e)}}}class Tf extends ot{constructor(e){super(),lt(this,e,null,Nf,et,{})}}var kt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function nl(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function $f(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var s=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,s.get?s:{enumerable:!0,get:function(){return t[r]}})}),n}var rl={exports:{}};/* @license
Papa Parse
v5.4.1
https://github.com/mholt/PapaParse
License: MIT
*/(function(t,e){(function(n,r){t.exports=r()})(kt,function n(){var r=typeof self<"u"?self:typeof window<"u"?window:r!==void 0?r:{},s=!r.document&&!!r.postMessage,i=r.IS_PAPA_WORKER||!1,l={},o=0,a={parse:function(_,m){var C=(m=m||{}).dynamicTyping||!1;if(k(C)&&(m.dynamicTypingFunction=C,C={}),m.dynamicTyping=C,m.transform=!!k(m.transform)&&m.transform,m.worker&&a.WORKERS_SUPPORTED){var M=function(){if(!a.WORKERS_SUPPORTED)return!1;var O=(G=r.URL||r.webkitURL||null,D=n.toString(),a.BLOB_URL||(a.BLOB_URL=G.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",D,")();"],{type:"text/javascript"})))),q=new r.Worker(O),G,D;return q.onmessage=x,q.id=o++,l[q.id]=q}();return M.userStep=m.step,M.userChunk=m.chunk,M.userComplete=m.complete,M.userError=m.error,m.step=k(m.step),m.chunk=k(m.chunk),m.complete=k(m.complete),m.error=k(m.error),delete m.worker,void M.postMessage({input:_,config:m,workerId:M.id})}var E=null;return a.NODE_STREAM_INPUT,typeof _=="string"?(_=function(O){return O.charCodeAt(0)===65279?O.slice(1):O}(_),E=m.download?new c(m):new d(m)):_.readable===!0&&k(_.read)&&k(_.on)?E=new p(m):(r.File&&_ instanceof File||_ instanceof Object)&&(E=new h(m)),E.stream(_)},unparse:function(_,m){var C=!1,M=!0,E=",",O=`\r
`,q='"',G=q+q,D=!1,T=null,Y=!1;(function(){if(typeof m=="object"){if(typeof m.delimiter!="string"||a.BAD_DELIMITERS.filter(function(L){return m.delimiter.indexOf(L)!==-1}).length||(E=m.delimiter),(typeof m.quotes=="boolean"||typeof m.quotes=="function"||Array.isArray(m.quotes))&&(C=m.quotes),typeof m.skipEmptyLines!="boolean"&&typeof m.skipEmptyLines!="string"||(D=m.skipEmptyLines),typeof m.newline=="string"&&(O=m.newline),typeof m.quoteChar=="string"&&(q=m.quoteChar),typeof m.header=="boolean"&&(M=m.header),Array.isArray(m.columns)){if(m.columns.length===0)throw new Error("Option columns is empty");T=m.columns}m.escapeChar!==void 0&&(G=m.escapeChar+q),(typeof m.escapeFormulae=="boolean"||m.escapeFormulae instanceof RegExp)&&(Y=m.escapeFormulae instanceof RegExp?m.escapeFormulae:/^[=+\-@\t\r].*$/)}})();var B=new RegExp(v(q),"g");if(typeof _=="string"&&(_=JSON.parse(_)),Array.isArray(_)){if(!_.length||Array.isArray(_[0]))return H(null,_,D);if(typeof _[0]=="object")return H(T||Object.keys(_[0]),_,D)}else if(typeof _=="object")return typeof _.data=="string"&&(_.data=JSON.parse(_.data)),Array.isArray(_.data)&&(_.fields||(_.fields=_.meta&&_.meta.fields||T),_.fields||(_.fields=Array.isArray(_.data[0])?_.fields:typeof _.data[0]=="object"?Object.keys(_.data[0]):[]),Array.isArray(_.data[0])||typeof _.data[0]=="object"||(_.data=[_.data])),H(_.fields||[],_.data||[],D);throw new Error("Unable to serialize unrecognized input");function H(L,Z,ne){var te="";typeof L=="string"&&(L=JSON.parse(L)),typeof Z=="string"&&(Z=JSON.parse(Z));var ee=Array.isArray(L)&&0<L.length,z=!Array.isArray(Z[0]);if(ee&&M){for(var F=0;F<L.length;F++)0<F&&(te+=E),te+=K(L[F],F);0<Z.length&&(te+=O)}for(var N=0;N<Z.length;N++){var J=ee?L.length:Z[N].length,fe=!1,pe=ee?Object.keys(Z[N]).length===0:Z[N].length===0;if(ne&&!ee&&(fe=ne==="greedy"?Z[N].join("").trim()==="":Z[N].length===1&&Z[N][0].length===0),ne==="greedy"&&ee){for(var ae=[],ue=0;ue<J;ue++){var Q=z?L[ue]:ue;ae.push(Z[N][Q])}fe=ae.join("").trim()===""}if(!fe){for(var j=0;j<J;j++){0<j&&!pe&&(te+=E);var me=ee&&z?L[j]:j;te+=K(Z[N][me],j)}N<Z.length-1&&(!ne||0<J&&!pe)&&(te+=O)}}return te}function K(L,Z){if(L==null)return"";if(L.constructor===Date)return JSON.stringify(L).slice(1,25);var ne=!1;Y&&typeof L=="string"&&Y.test(L)&&(L="'"+L,ne=!0);var te=L.toString().replace(B,G);return(ne=ne||C===!0||typeof C=="function"&&C(L,Z)||Array.isArray(C)&&C[Z]||function(ee,z){for(var F=0;F<z.length;F++)if(-1<ee.indexOf(z[F]))return!0;return!1}(te,a.BAD_DELIMITERS)||-1<te.indexOf(E)||te.charAt(0)===" "||te.charAt(te.length-1)===" ")?q+te+q:te}}};if(a.RECORD_SEP="",a.UNIT_SEP="",a.BYTE_ORDER_MARK="\uFEFF",a.BAD_DELIMITERS=["\r",`
`,'"',a.BYTE_ORDER_MARK],a.WORKERS_SUPPORTED=!s&&!!r.Worker,a.NODE_STREAM_INPUT=1,a.LocalChunkSize=10485760,a.RemoteChunkSize=5242880,a.DefaultDelimiter=",",a.Parser=b,a.ParserHandle=w,a.NetworkStreamer=c,a.FileStreamer=h,a.StringStreamer=d,a.ReadableStreamStreamer=p,r.jQuery){var u=r.jQuery;u.fn.parse=function(_){var m=_.config||{},C=[];return this.each(function(O){if(!(u(this).prop("tagName").toUpperCase()==="INPUT"&&u(this).attr("type").toLowerCase()==="file"&&r.FileReader)||!this.files||this.files.length===0)return!0;for(var q=0;q<this.files.length;q++)C.push({file:this.files[q],inputElem:this,instanceConfig:u.extend({},m)})}),M(),this;function M(){if(C.length!==0){var O,q,G,D,T=C[0];if(k(_.before)){var Y=_.before(T.file,T.inputElem);if(typeof Y=="object"){if(Y.action==="abort")return O="AbortError",q=T.file,G=T.inputElem,D=Y.reason,void(k(_.error)&&_.error({name:O},q,G,D));if(Y.action==="skip")return void E();typeof Y.config=="object"&&(T.instanceConfig=u.extend(T.instanceConfig,Y.config))}else if(Y==="skip")return void E()}var B=T.instanceConfig.complete;T.instanceConfig.complete=function(H){k(B)&&B(H,T.file,T.inputElem),E()},a.parse(T.file,T.instanceConfig)}else k(_.complete)&&_.complete()}function E(){C.splice(0,1),M()}}}function f(_){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(m){var C=R(m);C.chunkSize=parseInt(C.chunkSize),m.step||m.chunk||(C.chunkSize=null),this._handle=new w(C),(this._handle.streamer=this)._config=C}).call(this,_),this.parseChunk=function(m,C){if(this.isFirstChunk&&k(this._config.beforeFirstChunk)){var M=this._config.beforeFirstChunk(m);M!==void 0&&(m=M)}this.isFirstChunk=!1,this._halted=!1;var E=this._partialLine+m;this._partialLine="";var O=this._handle.parse(E,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var q=O.meta.cursor;this._finished||(this._partialLine=E.substring(q-this._baseIndex),this._baseIndex=q),O&&O.data&&(this._rowCount+=O.data.length);var G=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(i)r.postMessage({results:O,workerId:a.WORKER_ID,finished:G});else if(k(this._config.chunk)&&!C){if(this._config.chunk(O,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);O=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(O.data),this._completeResults.errors=this._completeResults.errors.concat(O.errors),this._completeResults.meta=O.meta),this._completed||!G||!k(this._config.complete)||O&&O.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),G||O&&O.meta.paused||this._nextChunk(),O}this._halted=!0},this._sendError=function(m){k(this._config.error)?this._config.error(m):i&&this._config.error&&r.postMessage({workerId:a.WORKER_ID,error:m,finished:!1})}}function c(_){var m;(_=_||{}).chunkSize||(_.chunkSize=a.RemoteChunkSize),f.call(this,_),this._nextChunk=s?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(C){this._input=C,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(m=new XMLHttpRequest,this._config.withCredentials&&(m.withCredentials=this._config.withCredentials),s||(m.onload=I(this._chunkLoaded,this),m.onerror=I(this._chunkError,this)),m.open(this._config.downloadRequestBody?"POST":"GET",this._input,!s),this._config.downloadRequestHeaders){var C=this._config.downloadRequestHeaders;for(var M in C)m.setRequestHeader(M,C[M])}if(this._config.chunkSize){var E=this._start+this._config.chunkSize-1;m.setRequestHeader("Range","bytes="+this._start+"-"+E)}try{m.send(this._config.downloadRequestBody)}catch(O){this._chunkError(O.message)}s&&m.status===0&&this._chunkError()}},this._chunkLoaded=function(){m.readyState===4&&(m.status<200||400<=m.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:m.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(C){var M=C.getResponseHeader("Content-Range");return M===null?-1:parseInt(M.substring(M.lastIndexOf("/")+1))}(m),this.parseChunk(m.responseText)))},this._chunkError=function(C){var M=m.statusText||C;this._sendError(new Error(M))}}function h(_){var m,C;(_=_||{}).chunkSize||(_.chunkSize=a.LocalChunkSize),f.call(this,_);var M=typeof FileReader<"u";this.stream=function(E){this._input=E,C=E.slice||E.webkitSlice||E.mozSlice,M?((m=new FileReader).onload=I(this._chunkLoaded,this),m.onerror=I(this._chunkError,this)):m=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var E=this._input;if(this._config.chunkSize){var O=Math.min(this._start+this._config.chunkSize,this._input.size);E=C.call(E,this._start,O)}var q=m.readAsText(E,this._config.encoding);M||this._chunkLoaded({target:{result:q}})},this._chunkLoaded=function(E){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(E.target.result)},this._chunkError=function(){this._sendError(m.error)}}function d(_){var m;f.call(this,_=_||{}),this.stream=function(C){return m=C,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var C,M=this._config.chunkSize;return M?(C=m.substring(0,M),m=m.substring(M)):(C=m,m=""),this._finished=!m,this.parseChunk(C)}}}function p(_){f.call(this,_=_||{});var m=[],C=!0,M=!1;this.pause=function(){f.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){f.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(E){this._input=E,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){M&&m.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),m.length?this.parseChunk(m.shift()):C=!0},this._streamData=I(function(E){try{m.push(typeof E=="string"?E:E.toString(this._config.encoding)),C&&(C=!1,this._checkIsFinished(),this.parseChunk(m.shift()))}catch(O){this._streamError(O)}},this),this._streamError=I(function(E){this._streamCleanUp(),this._sendError(E)},this),this._streamEnd=I(function(){this._streamCleanUp(),M=!0,this._streamData("")},this),this._streamCleanUp=I(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function w(_){var m,C,M,E=Math.pow(2,53),O=-E,q=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,G=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,D=this,T=0,Y=0,B=!1,H=!1,K=[],L={data:[],errors:[],meta:{}};if(k(_.step)){var Z=_.step;_.step=function(N){if(L=N,ee())te();else{if(te(),L.data.length===0)return;T+=N.data.length,_.preview&&T>_.preview?C.abort():(L.data=L.data[0],Z(L,D))}}}function ne(N){return _.skipEmptyLines==="greedy"?N.join("").trim()==="":N.length===1&&N[0].length===0}function te(){return L&&M&&(F("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+a.DefaultDelimiter+"'"),M=!1),_.skipEmptyLines&&(L.data=L.data.filter(function(N){return!ne(N)})),ee()&&function(){if(!L)return;function N(fe,pe){k(_.transformHeader)&&(fe=_.transformHeader(fe,pe)),K.push(fe)}if(Array.isArray(L.data[0])){for(var J=0;ee()&&J<L.data.length;J++)L.data[J].forEach(N);L.data.splice(0,1)}else L.data.forEach(N)}(),function(){if(!L||!_.header&&!_.dynamicTyping&&!_.transform)return L;function N(fe,pe){var ae,ue=_.header?{}:[];for(ae=0;ae<fe.length;ae++){var Q=ae,j=fe[ae];_.header&&(Q=ae>=K.length?"__parsed_extra":K[ae]),_.transform&&(j=_.transform(j,Q)),j=z(Q,j),Q==="__parsed_extra"?(ue[Q]=ue[Q]||[],ue[Q].push(j)):ue[Q]=j}return _.header&&(ae>K.length?F("FieldMismatch","TooManyFields","Too many fields: expected "+K.length+" fields but parsed "+ae,Y+pe):ae<K.length&&F("FieldMismatch","TooFewFields","Too few fields: expected "+K.length+" fields but parsed "+ae,Y+pe)),ue}var J=1;return!L.data.length||Array.isArray(L.data[0])?(L.data=L.data.map(N),J=L.data.length):L.data=N(L.data,0),_.header&&L.meta&&(L.meta.fields=K),Y+=J,L}()}function ee(){return _.header&&K.length===0}function z(N,J){return fe=N,_.dynamicTypingFunction&&_.dynamicTyping[fe]===void 0&&(_.dynamicTyping[fe]=_.dynamicTypingFunction(fe)),(_.dynamicTyping[fe]||_.dynamicTyping)===!0?J==="true"||J==="TRUE"||J!=="false"&&J!=="FALSE"&&(function(pe){if(q.test(pe)){var ae=parseFloat(pe);if(O<ae&&ae<E)return!0}return!1}(J)?parseFloat(J):G.test(J)?new Date(J):J===""?null:J):J;var fe}function F(N,J,fe,pe){var ae={type:N,code:J,message:fe};pe!==void 0&&(ae.row=pe),L.errors.push(ae)}this.parse=function(N,J,fe){var pe=_.quoteChar||'"';if(_.newline||(_.newline=function(Q,j){Q=Q.substring(0,1048576);var me=new RegExp(v(j)+"([^]*?)"+v(j),"gm"),Ae=(Q=Q.replace(me,"")).split("\r"),Ie=Q.split(`
`),Oe=1<Ie.length&&Ie[0].length<Ae[0].length;if(Ae.length===1||Oe)return`
`;for(var xe=0,le=0;le<Ae.length;le++)Ae[le][0]===`
`&&xe++;return xe>=Ae.length/2?`\r
`:"\r"}(N,pe)),M=!1,_.delimiter)k(_.delimiter)&&(_.delimiter=_.delimiter(N),L.meta.delimiter=_.delimiter);else{var ae=function(Q,j,me,Ae,Ie){var Oe,xe,le,ce;Ie=Ie||[",","	","|",";",a.RECORD_SEP,a.UNIT_SEP];for(var gt=0;gt<Ie.length;gt++){var de=Ie[gt],Ce=0,U=0,be=0;le=void 0;for(var Ke=new b({comments:Ae,delimiter:de,newline:j,preview:10}).parse(Q),Ge=0;Ge<Ke.data.length;Ge++)if(me&&ne(Ke.data[Ge]))be++;else{var Ye=Ke.data[Ge].length;U+=Ye,le!==void 0?0<Ye&&(Ce+=Math.abs(Ye-le),le=Ye):le=Ye}0<Ke.data.length&&(U/=Ke.data.length-be),(xe===void 0||Ce<=xe)&&(ce===void 0||ce<U)&&1.99<U&&(xe=Ce,Oe=de,ce=U)}return{successful:!!(_.delimiter=Oe),bestDelimiter:Oe}}(N,_.newline,_.skipEmptyLines,_.comments,_.delimitersToGuess);ae.successful?_.delimiter=ae.bestDelimiter:(M=!0,_.delimiter=a.DefaultDelimiter),L.meta.delimiter=_.delimiter}var ue=R(_);return _.preview&&_.header&&ue.preview++,m=N,C=new b(ue),L=C.parse(m,J,fe),te(),B?{meta:{paused:!0}}:L||{meta:{paused:!1}}},this.paused=function(){return B},this.pause=function(){B=!0,C.abort(),m=k(_.chunk)?"":m.substring(C.getCharIndex())},this.resume=function(){D.streamer._halted?(B=!1,D.streamer.parseChunk(m,!0)):setTimeout(D.resume,3)},this.aborted=function(){return H},this.abort=function(){H=!0,C.abort(),L.meta.aborted=!0,k(_.complete)&&_.complete(L),m=""}}function v(_){return _.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function b(_){var m,C=(_=_||{}).delimiter,M=_.newline,E=_.comments,O=_.step,q=_.preview,G=_.fastMode,D=m=_.quoteChar===void 0||_.quoteChar===null?'"':_.quoteChar;if(_.escapeChar!==void 0&&(D=_.escapeChar),(typeof C!="string"||-1<a.BAD_DELIMITERS.indexOf(C))&&(C=","),E===C)throw new Error("Comment character same as delimiter");E===!0?E="#":(typeof E!="string"||-1<a.BAD_DELIMITERS.indexOf(E))&&(E=!1),M!==`
`&&M!=="\r"&&M!==`\r
`&&(M=`
`);var T=0,Y=!1;this.parse=function(B,H,K){if(typeof B!="string")throw new Error("Input must be a string");var L=B.length,Z=C.length,ne=M.length,te=E.length,ee=k(O),z=[],F=[],N=[],J=T=0;if(!B)return Ne();if(_.header&&!H){var fe=B.split(M)[0].split(C),pe=[],ae={},ue=!1;for(var Q in fe){var j=fe[Q];k(_.transformHeader)&&(j=_.transformHeader(j,Q));var me=j,Ae=ae[j]||0;for(0<Ae&&(ue=!0,me=j+"_"+Ae),ae[j]=Ae+1;pe.includes(me);)me=me+"_"+Ae;pe.push(me)}if(ue){var Ie=B.split(M);Ie[0]=pe.join(C),B=Ie.join(M)}}if(G||G!==!1&&B.indexOf(m)===-1){for(var Oe=B.split(M),xe=0;xe<Oe.length;xe++){if(N=Oe[xe],T+=N.length,xe!==Oe.length-1)T+=M.length;else if(K)return Ne();if(!E||N.substring(0,te)!==E){if(ee){if(z=[],be(N.split(C)),Et(),Y)return Ne()}else be(N.split(C));if(q&&q<=xe)return z=z.slice(0,q),Ne(!0)}}return Ne()}for(var le=B.indexOf(C,T),ce=B.indexOf(M,T),gt=new RegExp(v(D)+v(m),"g"),de=B.indexOf(m,T);;)if(B[T]!==m)if(E&&N.length===0&&B.substring(T,T+te)===E){if(ce===-1)return Ne();T=ce+ne,ce=B.indexOf(M,T),le=B.indexOf(C,T)}else if(le!==-1&&(le<ce||ce===-1))N.push(B.substring(T,le)),T=le+Z,le=B.indexOf(C,T);else{if(ce===-1)break;if(N.push(B.substring(T,ce)),Ye(ce+ne),ee&&(Et(),Y))return Ne();if(q&&z.length>=q)return Ne(!0)}else for(de=T,T++;;){if((de=B.indexOf(m,de+1))===-1)return K||F.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:z.length,index:T}),Ge();if(de===L-1)return Ge(B.substring(T,de).replace(gt,m));if(m!==D||B[de+1]!==D){if(m===D||de===0||B[de-1]!==D){le!==-1&&le<de+1&&(le=B.indexOf(C,de+1)),ce!==-1&&ce<de+1&&(ce=B.indexOf(M,de+1));var Ce=Ke(ce===-1?le:Math.min(le,ce));if(B.substr(de+1+Ce,Z)===C){N.push(B.substring(T,de).replace(gt,m)),B[T=de+1+Ce+Z]!==m&&(de=B.indexOf(m,T)),le=B.indexOf(C,T),ce=B.indexOf(M,T);break}var U=Ke(ce);if(B.substring(de+1+U,de+1+U+ne)===M){if(N.push(B.substring(T,de).replace(gt,m)),Ye(de+1+U+ne),le=B.indexOf(C,T),de=B.indexOf(m,T),ee&&(Et(),Y))return Ne();if(q&&z.length>=q)return Ne(!0);break}F.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:z.length,index:T}),de++}}else de++}return Ge();function be(Qe){z.push(Qe),J=T}function Ke(Qe){var di=0;if(Qe!==-1){var zr=B.substring(de+1,Qe);zr&&zr.trim()===""&&(di=zr.length)}return di}function Ge(Qe){return K||(Qe===void 0&&(Qe=B.substring(T)),N.push(Qe),T=L,be(N),ee&&Et()),Ne()}function Ye(Qe){T=Qe,be(N),N=[],ce=B.indexOf(M,T)}function Ne(Qe){return{data:z,errors:F,meta:{delimiter:C,linebreak:M,aborted:Y,truncated:!!Qe,cursor:J+(H||0)}}}function Et(){O(Ne()),z=[],F=[]}},this.abort=function(){Y=!0},this.getCharIndex=function(){return T}}function x(_){var m=_.data,C=l[m.workerId],M=!1;if(m.error)C.userError(m.error,m.file);else if(m.results&&m.results.data){var E={abort:function(){M=!0,A(m.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:P,resume:P};if(k(C.userStep)){for(var O=0;O<m.results.data.length&&(C.userStep({data:m.results.data[O],errors:m.results.errors,meta:m.results.meta},E),!M);O++);delete m.results}else k(C.userChunk)&&(C.userChunk(m.results,E,m.file),delete m.results)}m.finished&&!M&&A(m.workerId,m.results)}function A(_,m){var C=l[_];k(C.userComplete)&&C.userComplete(m),C.terminate(),delete l[_]}function P(){throw new Error("Not implemented.")}function R(_){if(typeof _!="object"||_===null)return _;var m=Array.isArray(_)?[]:{};for(var C in _)m[C]=R(_[C]);return m}function I(_,m){return function(){_.apply(m,arguments)}}function k(_){return typeof _=="function"}return i&&(r.onmessage=function(_){var m=_.data;if(a.WORKER_ID===void 0&&m&&(a.WORKER_ID=m.workerId),typeof m.input=="string")r.postMessage({workerId:a.WORKER_ID,results:a.parse(m.input,m.config),finished:!0});else if(r.File&&m.input instanceof File||m.input instanceof Object){var C=a.parse(m.input,m.config);C&&r.postMessage({workerId:a.WORKER_ID,results:C,finished:!0})}}),(c.prototype=Object.create(f.prototype)).constructor=c,(h.prototype=Object.create(f.prototype)).constructor=h,(d.prototype=Object.create(d.prototype)).constructor=d,(p.prototype=Object.create(f.prototype)).constructor=p,a})})(rl);var Lf=rl.exports;function Ti(t,e,n){const r=t.slice();return r[14]=e[n],r}function $i(t){let e,n,r,s,i,l,o,a,u=t[1]&&Li(),f=At(t[0]),c=[];for(let h=0;h<f.length;h+=1)c[h]=Di(Ti(t,f,h));return{c(){e=S("div"),n=S("table"),r=S("thead"),s=S("tr"),i=S("th"),i.textContent="Text",l=$(),u&&u.c(),o=$(),a=S("tbody");for(let h=0;h<c.length;h+=1)c[h].c();y(i,"class","svelte-1y74j1x"),y(r,"class","svelte-1y74j1x"),y(n,"class","svelte-1y74j1x"),y(e,"class","table svelte-1y74j1x")},m(h,d){X(h,e,d),g(e,n),g(n,r),g(r,s),g(s,i),g(s,l),u&&u.m(s,null),g(n,o),g(n,a);for(let p=0;p<c.length;p+=1)c[p]&&c[p].m(a,null)},p(h,d){if(h[1]?u||(u=Li(),u.c(),u.m(s,null)):u&&(u.d(1),u=null),d&3){f=At(h[0]);let p;for(p=0;p<f.length;p+=1){const w=Ti(h,f,p);c[p]?c[p].p(w,d):(c[p]=Di(w),c[p].c(),c[p].m(a,null))}for(;p<c.length;p+=1)c[p].d(1);c.length=f.length}},d(h){h&&W(e),u&&u.d(),In(c,h)}}}function Li(t){let e;return{c(){e=S("th"),e.textContent="Label",y(e,"class","svelte-1y74j1x")},m(n,r){X(n,e,r)},d(n){n&&W(e)}}}function Fi(t){let e,n=t[14].label+"",r;return{c(){e=S("td"),r=ie(n),y(e,"class","svelte-1y74j1x")},m(s,i){X(s,e,i),g(e,r)},p(s,i){i&1&&n!==(n=s[14].label+"")&&Se(r,n)},d(s){s&&W(e)}}}function Di(t){let e,n,r=t[14].text+"",s,i,l,o=t[1]&&Fi(t);return{c(){e=S("tr"),n=S("td"),s=ie(r),i=$(),o&&o.c(),l=$(),y(n,"class","svelte-1y74j1x"),y(e,"class","svelte-1y74j1x")},m(a,u){X(a,e,u),g(e,n),g(n,s),g(e,i),o&&o.m(e,null),g(e,l)},p(a,u){u&1&&r!==(r=a[14].text+"")&&Se(s,r),a[1]?o?o.p(a,u):(o=Fi(a),o.c(),o.m(e,l)):o&&(o.d(1),o=null)},d(a){a&&W(e),o&&o.d()}}}function Ff(t){let e,n,r,s,i,l,o,a,u=t[3]?"Hide":"Show",f,c,h,d,p,w,v,b,x=t[3]&&$i(t);return{c(){e=S("section"),n=S("div"),n.textContent="Dataset",r=$(),s=S("input"),i=$(),l=S("button"),l.textContent="Upload",o=$(),a=S("button"),f=ie(u),h=$(),d=S("div"),p=ie(t[4]),w=$(),x&&x.c(),y(n,"class","section-title svelte-1y74j1x"),y(s,"type","file"),y(s,"id","fileInput"),ze(s,"display","none"),y(s,"accept",".csv, .tsv, .json, .jsonl"),y(s,"class","svelte-1y74j1x"),y(l,"class","button svelte-1y74j1x"),y(l,"id","data-upload"),y(a,"class","button svelte-1y74j1x"),y(a,"id","data-show"),a.disabled=c=!(t[3]||t[0].length),y(d,"class","message svelte-1y74j1x"),y(e,"class","svelte-1y74j1x")},m(A,P){X(A,e,P),g(e,n),g(e,r),g(e,s),t[10](s),g(e,i),g(e,l),g(e,o),g(e,a),g(a,f),g(e,h),g(e,d),g(d,p),g(e,w),x&&x.m(e,null),v||(b=[se(s,"change",t[5]),se(l,"click",t[11]),se(a,"click",t[12])],v=!0)},p(A,[P]){P&8&&u!==(u=A[3]?"Hide":"Show")&&Se(f,u),P&9&&c!==(c=!(A[3]||A[0].length))&&(a.disabled=c),P&16&&Se(p,A[4]),A[3]?x?x.p(A,P):(x=$i(A),x.c(),x.m(e,null)):x&&(x.d(1),x=null)},i:ye,o:ye,d(A){A&&W(e),t[10](null),x&&x.d(),v=!1,De(b)}}}function Df(t,e,n){let r,{fileName:s=""}=e,{hasLabel:i=!1}=e,{data:l=[]}=e,{requireLabel:o=!1}=e,{isFake:a=!1}=e;const u=async()=>{let b=await fetch("./cache.json"),x=JSON.parse(await b.text());Object.keys(x).forEach(function(I){localStorage.setItem(I,x[I])}),b=await fetch("./tweet_eval_emotion_test.jsonl");let A=await b.text(),P=new File([A],"tweet_eval_emotion_test.jsonl",{type:"text/plain"}),R=new DataTransfer;R.items.add(P),n(2,f.files=R.files,f),f.dispatchEvent(new Event("change")),n(7,a=!0)};let f,c=!1,h;const d=b=>{n(7,a=!1);const x=b.target;if(x.files&&x.files[0]){const A=x.files[0],P=new FileReader;P.onload=R=>{if(!R.target||(h=R.target.result,!h))return;let I;try{A.name.endsWith(".csv")||A.name.endsWith(".tsv")?I=Lf.parse(h,{delimiter:A.name.endsWith(".csv")?",":"	",header:!0}).data:(A.name.endsWith(".json")||A.name.endsWith(".jsonl"))&&(A.name.endsWith(".json")?I=JSON.parse(h):I=h.split(`
`).filter(_=>_.trim()).map(_=>JSON.parse(_)))}catch(k){n(4,r=`Error: ${k}`);return}if(!I){n(4,r="Error: empty file");return}if(!I[0].text){n(4,r='Error: CSV file must have a "text" column');return}if(n(1,i=I[0].label!==void 0),i)n(0,l=I.map(k=>({text:k.text,label:k.label})));else{if(o){n(4,r='Error: CSV file must have a "label" column');return}n(0,l=I.map(k=>({text:k.text})))}n(6,s=A.name)},P.readAsText(A)}};function p(b){we[b?"unshift":"push"](()=>{f=b,n(2,f)})}const w=()=>{f.click()},v=()=>{(c||l.length)&&n(3,c=!c)};return t.$$set=b=>{"fileName"in b&&n(6,s=b.fileName),"hasLabel"in b&&n(1,i=b.hasLabel),"data"in b&&n(0,l=b.data),"requireLabel"in b&&n(8,o=b.requireLabel),"isFake"in b&&n(7,a=b.isFake)},t.$$.update=()=>{t.$$.dirty&321&&n(4,r=s?`${l.length} records read from ${s}`:`No file uploaded, please upload a CSV, TSV, JSON, or JSONL file with a "text" and ${o?"a":"an optional"} "label" column.`)},[l,i,f,c,r,d,s,a,o,u,p,w,v]}class Hs extends ot{constructor(e){super(),lt(this,e,Df,Ff,et,{fileName:6,hasLabel:1,data:0,requireLabel:8,isFake:7,loadExample:9})}get fileName(){return this.$$.ctx[6]}set fileName(e){this.$$set({fileName:e}),Ze()}get hasLabel(){return this.$$.ctx[1]}set hasLabel(e){this.$$set({hasLabel:e}),Ze()}get data(){return this.$$.ctx[0]}set data(e){this.$$set({data:e}),Ze()}get requireLabel(){return this.$$.ctx[8]}set requireLabel(e){this.$$set({requireLabel:e}),Ze()}get isFake(){return this.$$.ctx[7]}set isFake(e){this.$$set({isFake:e}),Ze()}get loadExample(){return this.$$.ctx[9]}}const Wt="4.51.0";let qi=!1,vn,sl,il,ps,al,ll,ol,ul,cl;function qf(t,e={auto:!1}){if(qi)throw new Error(`you must \`import 'openai/shims/${t.kind}'\` before importing anything else from openai`);if(vn)throw new Error(`can't \`import 'openai/shims/${t.kind}'\` after \`import 'openai/shims/${vn}'\``);qi=e.auto,vn=t.kind,sl=t.fetch,il=t.FormData,ps=t.File,al=t.ReadableStream,ll=t.getMultipartRequestOptions,ol=t.getDefaultAgent,ul=t.fileFromPath,cl=t.isFsReadStream}class jf{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}}function Bf({manuallyImported:t}={}){const e=t?"You may need to use polyfills":"Add one of these imports before your first `import … from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let n,r,s,i;try{n=fetch,r=Request,s=Response,i=Headers}catch(l){throw new Error(`this environment is missing the following Web Fetch API type: ${l.message}. ${e}`)}return{kind:"web",fetch:n,Request:r,Response:s,Headers:i,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${e}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${e}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${e}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${e}`)}},getMultipartRequestOptions:async(l,o)=>({...o,body:new jf(l)}),getDefaultAgent:l=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:l=>!1}}vn||qf(Bf(),{auto:!0});class he extends Error{}class Pe extends he{constructor(e,n,r,s){super(`${Pe.makeMessage(e,n,r)}`),this.status=e,this.headers=s,this.request_id=s==null?void 0:s["x-request-id"];const i=n;this.error=i,this.code=i==null?void 0:i.code,this.param=i==null?void 0:i.param,this.type=i==null?void 0:i.type}static makeMessage(e,n,r){const s=n!=null&&n.message?typeof n.message=="string"?n.message:JSON.stringify(n.message):n?JSON.stringify(n):r;return e&&s?`${e} ${s}`:e?`${e} status code (no body)`:s||"(no status code or body)"}static generate(e,n,r,s){if(!e)return new Ur({cause:_s(n)});const i=n==null?void 0:n.error;return e===400?new fl(e,i,r,s):e===401?new hl(e,i,r,s):e===403?new dl(e,i,r,s):e===404?new pl(e,i,r,s):e===409?new ml(e,i,r,s):e===422?new _l(e,i,r,s):e===429?new gl(e,i,r,s):e>=500?new wl(e,i,r,s):new Pe(e,i,r,s)}}class Ve extends Pe{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0),this.status=void 0}}class Ur extends Pe{constructor({message:e,cause:n}){super(void 0,void 0,e||"Connection error.",void 0),this.status=void 0,n&&(this.cause=n)}}class zs extends Ur{constructor({message:e}={}){super({message:e??"Request timed out."})}}class fl extends Pe{constructor(){super(...arguments),this.status=400}}class hl extends Pe{constructor(){super(...arguments),this.status=401}}class dl extends Pe{constructor(){super(...arguments),this.status=403}}class pl extends Pe{constructor(){super(...arguments),this.status=404}}class ml extends Pe{constructor(){super(...arguments),this.status=409}}class _l extends Pe{constructor(){super(...arguments),this.status=422}}class gl extends Pe{constructor(){super(...arguments),this.status=429}}class wl extends Pe{}class pt{constructor(e,n){this.iterator=e,this.controller=n}static fromSSEResponse(e,n){let r=!1;async function*s(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let i=!1;try{for await(const l of Wf(e,n))if(!i){if(l.data.startsWith("[DONE]")){i=!0;continue}if(l.event===null){let o;try{o=JSON.parse(l.data)}catch(a){throw console.error("Could not parse message into JSON:",l.data),console.error("From chunk:",l.raw),a}if(o&&o.error)throw new Pe(void 0,o.error,void 0,void 0);yield o}else{let o;try{o=JSON.parse(l.data)}catch(a){throw console.error("Could not parse message into JSON:",l.data),console.error("From chunk:",l.raw),a}if(l.event=="error")throw new Pe(void 0,o.error,o.message,void 0);yield{event:l.event,data:o}}}i=!0}catch(l){if(l instanceof Error&&l.name==="AbortError")return;throw l}finally{i||n.abort()}}return new pt(s,n)}static fromReadableStream(e,n){let r=!1;async function*s(){const l=new Lt,o=yl(e);for await(const a of o)for(const u of l.decode(a))yield u;for(const a of l.flush())yield a}async function*i(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let l=!1;try{for await(const o of s())l||o&&(yield JSON.parse(o));l=!0}catch(o){if(o instanceof Error&&o.name==="AbortError")return;throw o}finally{l||n.abort()}}return new pt(i,n)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],n=[],r=this.iterator(),s=i=>({next:()=>{if(i.length===0){const l=r.next();e.push(l),n.push(l)}return i.shift()}});return[new pt(()=>s(e),this.controller),new pt(()=>s(n),this.controller)]}toReadableStream(){const e=this;let n;const r=new TextEncoder;return new al({async start(){n=e[Symbol.asyncIterator]()},async pull(s){try{const{value:i,done:l}=await n.next();if(l)return s.close();const o=r.encode(JSON.stringify(i)+`
`);s.enqueue(o)}catch(i){s.error(i)}},async cancel(){var s;await((s=n.return)==null?void 0:s.call(n))}})}}async function*Wf(t,e){if(!t.body)throw e.abort(),new he("Attempted to iterate over a response with no body");const n=new Hf,r=new Lt,s=yl(t.body);for await(const i of Uf(s))for(const l of r.decode(i)){const o=n.decode(l);o&&(yield o)}for(const i of r.flush()){const l=n.decode(i);l&&(yield l)}}async function*Uf(t){let e=new Uint8Array;for await(const n of t){if(n==null)continue;const r=n instanceof ArrayBuffer?new Uint8Array(n):typeof n=="string"?new TextEncoder().encode(n):n;let s=new Uint8Array(e.length+r.length);s.set(e),s.set(r,e.length),e=s;let i;for(;(i=Xf(e))!==-1;)yield e.slice(0,i),e=e.slice(i)}e.length>0&&(yield e)}function Xf(t){for(let r=0;r<t.length-2;r++){if(t[r]===10&&t[r+1]===10||t[r]===13&&t[r+1]===13)return r+2;if(t[r]===13&&t[r+1]===10&&r+3<t.length&&t[r+2]===13&&t[r+3]===10)return r+4}return-1}class Hf{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const i={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],i}if(this.chunks.push(e),e.startsWith(":"))return null;let[n,r,s]=zf(e,":");return s.startsWith(" ")&&(s=s.substring(1)),n==="event"?this.event=s:n==="data"&&this.data.push(s),null}}class Lt{constructor(){this.buffer=[],this.trailingCR=!1}decode(e){let n=this.decodeText(e);if(this.trailingCR&&(n="\r"+n,this.trailingCR=!1),n.endsWith("\r")&&(this.trailingCR=!0,n=n.slice(0,-1)),!n)return[];const r=Lt.NEWLINE_CHARS.has(n[n.length-1]||"");let s=n.split(Lt.NEWLINE_REGEXP);return r&&s.pop(),s.length===1&&!r?(this.buffer.push(s[0]),[]):(this.buffer.length>0&&(s=[this.buffer.join("")+s[0],...s.slice(1)],this.buffer=[]),r||(this.buffer=[s.pop()||""]),s)}decodeText(e){if(e==null)return"";if(typeof e=="string")return e;if(typeof Buffer<"u"){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new he(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new he(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new he("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){if(!this.buffer.length&&!this.trailingCR)return[];const e=[this.buffer.join("")];return this.buffer=[],this.trailingCR=!1,e}}Lt.NEWLINE_CHARS=new Set([`
`,"\r"]);Lt.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function zf(t,e){const n=t.indexOf(e);return n!==-1?[t.substring(0,n),e,t.substring(n+e.length)]:[t,"",""]}function yl(t){if(t[Symbol.asyncIterator])return t;const e=t.getReader();return{async next(){try{const n=await e.read();return n!=null&&n.done&&e.releaseLock(),n}catch(n){throw e.releaseLock(),n}},async return(){const n=e.cancel();return e.releaseLock(),await n,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}const vl=t=>t!=null&&typeof t=="object"&&typeof t.url=="string"&&typeof t.blob=="function",bl=t=>t!=null&&typeof t=="object"&&typeof t.name=="string"&&typeof t.lastModified=="number"&&Vs(t),Vs=t=>t!=null&&typeof t=="object"&&typeof t.size=="number"&&typeof t.type=="string"&&typeof t.text=="function"&&typeof t.slice=="function"&&typeof t.arrayBuffer=="function",Vf=t=>bl(t)||vl(t)||cl(t);async function xl(t,e,n){var s;if(t=await t,n??(n=bl(t)?{lastModified:t.lastModified,type:t.type}:{}),vl(t)){const i=await t.blob();return e||(e=new URL(t.url).pathname.split(/[\\/]/).pop()??"unknown_file"),new ps([i],e,n)}const r=await Jf(t);if(e||(e=Gf(t)??"unknown_file"),!n.type){const i=(s=r[0])==null?void 0:s.type;typeof i=="string"&&(n={...n,type:i})}return new ps(r,e,n)}async function Jf(t){var n;let e=[];if(typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer)e.push(t);else if(Vs(t))e.push(await t.arrayBuffer());else if(Yf(t))for await(const r of t)e.push(r);else throw new Error(`Unexpected data type: ${typeof t}; constructor: ${(n=t==null?void 0:t.constructor)==null?void 0:n.name}; props: ${Kf(t)}`);return e}function Kf(t){return`[${Object.getOwnPropertyNames(t).map(n=>`"${n}"`).join(", ")}]`}function Gf(t){var e;return Yr(t.name)||Yr(t.filename)||((e=Yr(t.path))==null?void 0:e.split(/[\\/]/).pop())}const Yr=t=>{if(typeof t=="string")return t;if(typeof Buffer<"u"&&t instanceof Buffer)return String(t)},Yf=t=>t!=null&&typeof t=="object"&&typeof t[Symbol.asyncIterator]=="function",ji=t=>t&&typeof t=="object"&&t.body&&t[Symbol.toStringTag]==="MultipartBody",En=async t=>{const e=await Qf(t.body);return ll(e,t)},Qf=async t=>{const e=new il;return await Promise.all(Object.entries(t||{}).map(([n,r])=>ms(e,n,r))),e},ms=async(t,e,n)=>{if(n!==void 0){if(n==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")t.append(e,String(n));else if(Vf(n)){const r=await xl(n);t.append(e,r)}else if(Array.isArray(n))await Promise.all(n.map(r=>ms(t,e+"[]",r)));else if(typeof n=="object")await Promise.all(Object.entries(n).map(([r,s])=>ms(t,`${e}[${r}]`,s)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${n} instead`)}};var Kt={},Zf=function(t,e,n,r,s){if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(t,n),n},eh=function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},Fn;async function Cl(t){const{response:e}=t;if(t.options.stream)return Gt("response",e.status,e.url,e.headers,e.body),t.options.__streamClass?t.options.__streamClass.fromSSEResponse(e,t.controller):pt.fromSSEResponse(e,t.controller);if(e.status===204)return null;if(t.options.__binaryResponse)return e;const n=e.headers.get("content-type");if((n==null?void 0:n.includes("application/json"))||(n==null?void 0:n.includes("application/vnd.api+json"))){const i=await e.json();return Gt("response",e.status,e.url,e.headers,i),i}const s=await e.text();return Gt("response",e.status,e.url,e.headers,s),s}class Xr extends Promise{constructor(e,n=Cl){super(r=>{r(null)}),this.responsePromise=e,this.parseResponse=n}_thenUnwrap(e){return new Xr(this.responsePromise,async n=>e(await this.parseResponse(n)))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,n]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:n}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,n){return this.parse().then(e,n)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}class th{constructor({baseURL:e,maxRetries:n=2,timeout:r=6e5,httpAgent:s,fetch:i}){this.baseURL=e,this.maxRetries=Qr("maxRetries",n),this.timeout=Qr("timeout",r),this.httpAgent=s,this.fetch=i??sl}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...lh(),...this.authHeaders(e)}}validateHeaders(e,n){}defaultIdempotencyKey(){return`stainless-node-retry-${fh()}`}get(e,n){return this.methodRequest("get",e,n)}post(e,n){return this.methodRequest("post",e,n)}patch(e,n){return this.methodRequest("patch",e,n)}put(e,n){return this.methodRequest("put",e,n)}delete(e,n){return this.methodRequest("delete",e,n)}methodRequest(e,n,r){return this.request(Promise.resolve(r).then(async s=>{const i=s&&Vs(s==null?void 0:s.body)?new DataView(await s.body.arrayBuffer()):(s==null?void 0:s.body)instanceof DataView?s.body:(s==null?void 0:s.body)instanceof ArrayBuffer?new DataView(s.body):s&&ArrayBuffer.isView(s==null?void 0:s.body)?new DataView(s.body.buffer):s==null?void 0:s.body;return{method:e,path:n,...s,body:i}}))}getAPIList(e,n,r){return this.requestAPIList(n,{method:"get",path:e,...r})}calculateContentLength(e){if(typeof e=="string"){if(typeof Buffer<"u")return Buffer.byteLength(e,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(e).length.toString()}else if(ArrayBuffer.isView(e))return e.byteLength.toString();return null}buildRequest(e){var p;const{method:n,path:r,query:s,headers:i={}}=e,l=ArrayBuffer.isView(e.body)||e.__binaryRequest&&typeof e.body=="string"?e.body:ji(e.body)?e.body.body:e.body?JSON.stringify(e.body,null,2):null,o=this.calculateContentLength(l),a=this.buildURL(r,s);"timeout"in e&&Qr("timeout",e.timeout);const u=e.timeout??this.timeout,f=e.httpAgent??this.httpAgent??ol(a),c=u+1e3;typeof((p=f==null?void 0:f.options)==null?void 0:p.timeout)=="number"&&c>(f.options.timeout??0)&&(f.options.timeout=c),this.idempotencyHeader&&n!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),i[this.idempotencyHeader]=e.idempotencyKey);const h=this.buildHeaders({options:e,headers:i,contentLength:o});return{req:{method:n,...l&&{body:l},headers:h,...f&&{agent:f},signal:e.signal??null},url:a,timeout:u}}buildHeaders({options:e,headers:n,contentLength:r}){const s={};r&&(s["content-length"]=r);const i=this.defaultHeaders(e);return Xi(s,i),Xi(s,n),ji(e.body)&&vn!=="node"&&delete s["content-type"],this.validateHeaders(s,n),s}async prepareOptions(e){}async prepareRequest(e,{url:n,options:r}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map(n=>[...n])):{...e}:{}}makeStatusError(e,n,r,s){return Pe.generate(e,n,r,s)}request(e,n=null){return new Xr(this.makeRequest(e,n))}async makeRequest(e,n){var f,c;const r=await e;n==null&&(n=r.maxRetries??this.maxRetries),await this.prepareOptions(r);const{req:s,url:i,timeout:l}=this.buildRequest(r);if(await this.prepareRequest(s,{url:i,options:r}),Gt("request",i,r,s.headers),(f=r.signal)!=null&&f.aborted)throw new Ve;const o=new AbortController,a=await this.fetchWithTimeout(i,s,l,o).catch(_s);if(a instanceof Error){if((c=r.signal)!=null&&c.aborted)throw new Ve;if(n)return this.retryRequest(r,n);throw a.name==="AbortError"?new zs:new Ur({cause:a})}const u=rh(a.headers);if(!a.ok){if(n&&this.shouldRetry(a)){const b=`retrying, ${n} attempts remaining`;return Gt(`response (error; ${b})`,a.status,i,u),this.retryRequest(r,n,u)}const h=await a.text().catch(b=>_s(b).message),d=oh(h),p=d?void 0:h;throw Gt(`response (error; ${n?"(error; no more retries left)":"(error; not retryable)"})`,a.status,i,u,p),this.makeStatusError(a.status,d,p,u)}return{response:a,options:r,controller:o}}requestAPIList(e,n){const r=this.makeRequest(n,null);return new nh(this,r,e)}buildURL(e,n){const r=ch(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),s=this.defaultQuery();return kl(s)||(n={...s,...n}),typeof n=="object"&&n&&!Array.isArray(n)&&(r.search=this.stringifyQuery(n)),r.toString()}stringifyQuery(e){return Object.entries(e).filter(([n,r])=>typeof r<"u").map(([n,r])=>{if(typeof r=="string"||typeof r=="number"||typeof r=="boolean")return`${encodeURIComponent(n)}=${encodeURIComponent(r)}`;if(r===null)return`${encodeURIComponent(n)}=`;throw new he(`Cannot stringify type ${typeof r}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(e,n,r,s){const{signal:i,...l}=n||{};i&&i.addEventListener("abort",()=>s.abort());const o=setTimeout(()=>s.abort(),r);return this.getRequestClient().fetch.call(void 0,e,{signal:s.signal,...l}).finally(()=>{clearTimeout(o)})}getRequestClient(){return{fetch:this.fetch}}shouldRetry(e){const n=e.headers.get("x-should-retry");return n==="true"?!0:n==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,n,r){let s;const i=r==null?void 0:r["retry-after-ms"];if(i){const o=parseFloat(i);Number.isNaN(o)||(s=o)}const l=r==null?void 0:r["retry-after"];if(l&&!s){const o=parseFloat(l);Number.isNaN(o)?s=Date.parse(l)-Date.now():s=o*1e3}if(!(s&&0<=s&&s<60*1e3)){const o=e.maxRetries??this.maxRetries;s=this.calculateDefaultRetryTimeoutMillis(n,o)}return await Nn(s),this.makeRequest(e,n-1)}calculateDefaultRetryTimeoutMillis(e,n){const i=n-e,l=Math.min(.5*Math.pow(2,i),8),o=1-Math.random()*.25;return l*o*1e3}getUserAgent(){return`${this.constructor.name}/JS ${Wt}`}}class Al{constructor(e,n,r,s){Fn.set(this,void 0),Zf(this,Fn,e),this.options=s,this.response=n,this.body=r}hasNextPage(){return this.getPaginatedItems().length?this.nextPageInfo()!=null:!1}async getNextPage(){const e=this.nextPageInfo();if(!e)throw new he("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const n={...this.options};if("params"in e&&typeof n.query=="object")n.query={...n.query,...e.params};else if("url"in e){const r=[...Object.entries(n.query||{}),...e.url.searchParams.entries()];for(const[s,i]of r)e.url.searchParams.set(s,i);n.query=void 0,n.path=e.url.toString()}return await eh(this,Fn,"f").requestAPIList(this.constructor,n)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(Fn=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const n of e.getPaginatedItems())yield n}}class nh extends Xr{constructor(e,n,r){super(n,async s=>new r(e,s.response,await Cl(s),s.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const n of e)yield n}}const rh=t=>new Proxy(Object.fromEntries(t.entries()),{get(e,n){const r=n.toString();return e[r.toLowerCase()]||e[r]}}),sh={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},Je=t=>typeof t=="object"&&t!==null&&!kl(t)&&Object.keys(t).every(e=>Sl(sh,e)),ih=()=>{var e;if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Wt,"X-Stainless-OS":Wi(Deno.build.os),"X-Stainless-Arch":Bi(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((e=Deno.version)==null?void 0:e.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Wt,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if(Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Wt,"X-Stainless-OS":Wi(process.platform),"X-Stainless-Arch":Bi(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const t=ah();return t?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Wt,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${t.browser}`,"X-Stainless-Runtime-Version":t.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Wt,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function ah(){if(typeof navigator>"u"||!navigator)return null;const t=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:n}of t){const r=n.exec(navigator.userAgent);if(r){const s=r[1]||0,i=r[2]||0,l=r[3]||0;return{browser:e,version:`${s}.${i}.${l}`}}}return null}const Bi=t=>t==="x32"?"x32":t==="x86_64"||t==="x64"?"x64":t==="arm"?"arm":t==="aarch64"||t==="arm64"?"arm64":t?`other:${t}`:"unknown",Wi=t=>(t=t.toLowerCase(),t.includes("ios")?"iOS":t==="android"?"Android":t==="darwin"?"MacOS":t==="win32"?"Windows":t==="freebsd"?"FreeBSD":t==="openbsd"?"OpenBSD":t==="linux"?"Linux":t?`Other:${t}`:"Unknown");let Ui;const lh=()=>Ui??(Ui=ih()),oh=t=>{try{return JSON.parse(t)}catch{return}},uh=new RegExp("^(?:[a-z]+:)?//","i"),ch=t=>uh.test(t),Nn=t=>new Promise(e=>setTimeout(e,t)),Qr=(t,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new he(`${t} must be an integer`);if(e<0)throw new he(`${t} must be a positive integer`);return e},_s=t=>t instanceof Error?t:new Error(t),Dn=t=>{var e,n,r,s;if(typeof process<"u")return((e=Kt==null?void 0:Kt[t])==null?void 0:e.trim())??void 0;if(typeof Deno<"u")return(s=(r=(n=Deno.env)==null?void 0:n.get)==null?void 0:r.call(n,t))==null?void 0:s.trim()};function kl(t){if(!t)return!0;for(const e in t)return!1;return!0}function Sl(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Xi(t,e){for(const n in e){if(!Sl(e,n))continue;const r=n.toLowerCase();if(!r)continue;const s=e[n];s===null?delete t[r]:s!==void 0&&(t[r]=s)}}function Gt(t,...e){typeof process<"u"&&(Kt==null?void 0:Kt.DEBUG)==="true"&&console.log(`OpenAI:DEBUG:${t}`,...e)}const fh=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)}),hh=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u";function Hi(t){return t!=null&&typeof t=="object"&&!Array.isArray(t)}class Js extends Al{constructor(e,n,r,s){super(e,n,r,s),this.data=r.data||[],this.object=r.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}}class ct extends Al{constructor(e,n,r,s){super(e,n,r,s),this.data=r.data||[]}getPaginatedItems(){return this.data??[]}nextPageParams(){const e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;const n=Object.fromEntries(e.url.searchParams);return Object.keys(n).length?n:null}nextPageInfo(){var r;const e=this.getPaginatedItems();if(!e.length)return null;const n=(r=e[e.length-1])==null?void 0:r.id;return n?{params:{after:n}}:null}}class ge{constructor(e){this._client=e}}let fr=class extends ge{create(e,n){return this._client.post("/chat/completions",{body:e,...n,stream:e.stream??!1})}};fr||(fr={});let hr=class extends ge{constructor(){super(...arguments),this.completions=new fr(this._client)}};(function(t){t.Completions=fr})(hr||(hr={}));class dr extends ge{create(e,n){return this._client.post("/audio/speech",{body:e,...n,__binaryResponse:!0})}}dr||(dr={});class pr extends ge{create(e,n){return this._client.post("/audio/transcriptions",En({body:e,...n}))}}pr||(pr={});class mr extends ge{create(e,n){return this._client.post("/audio/translations",En({body:e,...n}))}}mr||(mr={});class _r extends ge{constructor(){super(...arguments),this.transcriptions=new pr(this._client),this.translations=new mr(this._client),this.speech=new dr(this._client)}}(function(t){t.Transcriptions=pr,t.Translations=mr,t.Speech=dr})(_r||(_r={}));class gr extends ge{create(e,n){return this._client.post("/batches",{body:e,...n})}retrieve(e,n){return this._client.get(`/batches/${e}`,n)}list(e={},n){return Je(e)?this.list({},e):this._client.getAPIList("/batches",Ks,{query:e,...n})}cancel(e,n){return this._client.post(`/batches/${e}/cancel`,n)}}class Ks extends ct{}(function(t){t.BatchesPage=Ks})(gr||(gr={}));class wr extends ge{create(e,n){return this._client.post("/assistants",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,n){return this._client.get(`/assistants/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(e,n,r){return this._client.post(`/assistants/${e}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(e={},n){return Je(e)?this.list({},e):this._client.getAPIList("/assistants",Gs,{query:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,n){return this._client.delete(`/assistants/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class Gs extends ct{}(function(t){t.AssistantsPage=Gs})(wr||(wr={}));function zi(t){return typeof t.parse=="function"}const Yt=t=>(t==null?void 0:t.role)==="assistant",El=t=>(t==null?void 0:t.role)==="function",Rl=t=>(t==null?void 0:t.role)==="tool";var tt=function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},oe=function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},Me,zn,Vn,on,un,Jn,cn,yt,fn,Kn,Gn,Ut,gs,yr,ws,ys,vs,bs,Pl,xs;const Vi=10;class Il{constructor(){Me.add(this),this.controller=new AbortController,zn.set(this,void 0),Vn.set(this,()=>{}),on.set(this,()=>{}),un.set(this,void 0),Jn.set(this,()=>{}),cn.set(this,()=>{}),yt.set(this,{}),this._chatCompletions=[],this.messages=[],fn.set(this,!1),Kn.set(this,!1),Gn.set(this,!1),Ut.set(this,!1),bs.set(this,e=>{if(tt(this,Kn,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new Ve),e instanceof Ve)return tt(this,Gn,!0,"f"),this._emit("abort",e);if(e instanceof he)return this._emit("error",e);if(e instanceof Error){const n=new he(e.message);return n.cause=e,this._emit("error",n)}return this._emit("error",new he(String(e)))}),tt(this,zn,new Promise((e,n)=>{tt(this,Vn,e,"f"),tt(this,on,n,"f")}),"f"),tt(this,un,new Promise((e,n)=>{tt(this,Jn,e,"f"),tt(this,cn,n,"f")}),"f"),oe(this,zn,"f").catch(()=>{}),oe(this,un,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},oe(this,bs,"f"))},0)}_addChatCompletion(e){var r;this._chatCompletions.push(e),this._emit("chatCompletion",e);const n=(r=e.choices[0])==null?void 0:r.message;return n&&this._addMessage(n),e}_addMessage(e,n=!0){if("content"in e||(e.content=null),this.messages.push(e),n){if(this._emit("message",e),(El(e)||Rl(e))&&e.content)this._emit("functionCallResult",e.content);else if(Yt(e)&&e.function_call)this._emit("functionCall",e.function_call);else if(Yt(e)&&e.tool_calls)for(const r of e.tool_calls)r.type==="function"&&this._emit("functionCall",r.function)}}_connected(){this.ended||(oe(this,Vn,"f").call(this),this._emit("connect"))}get ended(){return oe(this,fn,"f")}get errored(){return oe(this,Kn,"f")}get aborted(){return oe(this,Gn,"f")}abort(){this.controller.abort()}on(e,n){return(oe(this,yt,"f")[e]||(oe(this,yt,"f")[e]=[])).push({listener:n}),this}off(e,n){const r=oe(this,yt,"f")[e];if(!r)return this;const s=r.findIndex(i=>i.listener===n);return s>=0&&r.splice(s,1),this}once(e,n){return(oe(this,yt,"f")[e]||(oe(this,yt,"f")[e]=[])).push({listener:n,once:!0}),this}emitted(e){return new Promise((n,r)=>{tt(this,Ut,!0,"f"),e!=="error"&&this.once("error",r),this.once(e,n)})}async done(){tt(this,Ut,!0,"f"),await oe(this,un,"f")}async finalChatCompletion(){await this.done();const e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new he("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),oe(this,Me,"m",gs).call(this)}async finalMessage(){return await this.done(),oe(this,Me,"m",yr).call(this)}async finalFunctionCall(){return await this.done(),oe(this,Me,"m",ws).call(this)}async finalFunctionCallResult(){return await this.done(),oe(this,Me,"m",ys).call(this)}async totalUsage(){return await this.done(),oe(this,Me,"m",vs).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emit(e,...n){if(oe(this,fn,"f"))return;e==="end"&&(tt(this,fn,!0,"f"),oe(this,Jn,"f").call(this));const r=oe(this,yt,"f")[e];if(r&&(oe(this,yt,"f")[e]=r.filter(s=>!s.once),r.forEach(({listener:s})=>s(...n))),e==="abort"){const s=n[0];!oe(this,Ut,"f")&&!(r!=null&&r.length)&&Promise.reject(s),oe(this,on,"f").call(this,s),oe(this,cn,"f").call(this,s),this._emit("end");return}if(e==="error"){const s=n[0];!oe(this,Ut,"f")&&!(r!=null&&r.length)&&Promise.reject(s),oe(this,on,"f").call(this,s),oe(this,cn,"f").call(this,s),this._emit("end")}}_emitFinal(){const e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);const n=oe(this,Me,"m",yr).call(this);n&&this._emit("finalMessage",n);const r=oe(this,Me,"m",gs).call(this);r&&this._emit("finalContent",r);const s=oe(this,Me,"m",ws).call(this);s&&this._emit("finalFunctionCall",s);const i=oe(this,Me,"m",ys).call(this);i!=null&&this._emit("finalFunctionCallResult",i),this._chatCompletions.some(l=>l.usage)&&this._emit("totalUsage",oe(this,Me,"m",vs).call(this))}async _createChatCompletion(e,n,r){const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),oe(this,Me,"m",Pl).call(this,n);const i=await e.create({...n,stream:!1},{...r,signal:this.controller.signal});return this._connected(),this._addChatCompletion(i)}async _runChatCompletion(e,n,r){for(const s of n.messages)this._addMessage(s,!1);return await this._createChatCompletion(e,n,r)}async _runFunctions(e,n,r){var h;const s="function",{function_call:i="auto",stream:l,...o}=n,a=typeof i!="string"&&(i==null?void 0:i.name),{maxChatCompletions:u=Vi}=r||{},f={};for(const d of n.functions)f[d.name||d.function.name]=d;const c=n.functions.map(d=>({name:d.name||d.function.name,parameters:d.parameters,description:d.description}));for(const d of n.messages)this._addMessage(d,!1);for(let d=0;d<u;++d){const w=(h=(await this._createChatCompletion(e,{...o,function_call:i,functions:c,messages:[...this.messages]},r)).choices[0])==null?void 0:h.message;if(!w)throw new he("missing message in ChatCompletion response");if(!w.function_call)return;const{name:v,arguments:b}=w.function_call,x=f[v];if(x){if(a&&a!==v){const I=`Invalid function_call: ${JSON.stringify(v)}. ${JSON.stringify(a)} requested. Please try again`;this._addMessage({role:s,name:v,content:I});continue}}else{const I=`Invalid function_call: ${JSON.stringify(v)}. Available options are: ${c.map(k=>JSON.stringify(k.name)).join(", ")}. Please try again`;this._addMessage({role:s,name:v,content:I});continue}let A;try{A=zi(x)?await x.parse(b):b}catch(I){this._addMessage({role:s,name:v,content:I instanceof Error?I.message:String(I)});continue}const P=await x.function(A,this),R=oe(this,Me,"m",xs).call(this,P);if(this._addMessage({role:s,name:v,content:R}),a)return}}async _runTools(e,n,r){var h,d;const s="tool",{tool_choice:i="auto",stream:l,...o}=n,a=typeof i!="string"&&((h=i==null?void 0:i.function)==null?void 0:h.name),{maxChatCompletions:u=Vi}=r||{},f={};for(const p of n.tools)p.type==="function"&&(f[p.function.name||p.function.function.name]=p.function);const c="tools"in n?n.tools.map(p=>p.type==="function"?{type:"function",function:{name:p.function.name||p.function.function.name,parameters:p.function.parameters,description:p.function.description}}:p):void 0;for(const p of n.messages)this._addMessage(p,!1);for(let p=0;p<u;++p){const v=(d=(await this._createChatCompletion(e,{...o,tool_choice:i,tools:c,messages:[...this.messages]},r)).choices[0])==null?void 0:d.message;if(!v)throw new he("missing message in ChatCompletion response");if(!v.tool_calls)return;for(const b of v.tool_calls){if(b.type!=="function")continue;const x=b.id,{name:A,arguments:P}=b.function,R=f[A];if(R){if(a&&a!==A){const m=`Invalid tool_call: ${JSON.stringify(A)}. ${JSON.stringify(a)} requested. Please try again`;this._addMessage({role:s,tool_call_id:x,content:m});continue}}else{const m=`Invalid tool_call: ${JSON.stringify(A)}. Available options are: ${c.map(C=>JSON.stringify(C.function.name)).join(", ")}. Please try again`;this._addMessage({role:s,tool_call_id:x,content:m});continue}let I;try{I=zi(R)?await R.parse(P):P}catch(m){const C=m instanceof Error?m.message:String(m);this._addMessage({role:s,tool_call_id:x,content:C});continue}const k=await R.function(I,this),_=oe(this,Me,"m",xs).call(this,k);if(this._addMessage({role:s,tool_call_id:x,content:_}),a)return}}}}zn=new WeakMap,Vn=new WeakMap,on=new WeakMap,un=new WeakMap,Jn=new WeakMap,cn=new WeakMap,yt=new WeakMap,fn=new WeakMap,Kn=new WeakMap,Gn=new WeakMap,Ut=new WeakMap,bs=new WeakMap,Me=new WeakSet,gs=function(){return oe(this,Me,"m",yr).call(this).content??null},yr=function(){let e=this.messages.length;for(;e-- >0;){const n=this.messages[e];if(Yt(n)){const{function_call:r,...s}=n,i={...s,content:n.content??null};return r&&(i.function_call=r),i}}throw new he("stream ended without producing a ChatCompletionMessage with role=assistant")},ws=function(){var e,n;for(let r=this.messages.length-1;r>=0;r--){const s=this.messages[r];if(Yt(s)&&(s!=null&&s.function_call))return s.function_call;if(Yt(s)&&((e=s==null?void 0:s.tool_calls)!=null&&e.length))return(n=s.tool_calls.at(-1))==null?void 0:n.function}},ys=function(){for(let e=this.messages.length-1;e>=0;e--){const n=this.messages[e];if(El(n)&&n.content!=null||Rl(n)&&n.content!=null&&this.messages.some(r=>{var s;return r.role==="assistant"&&((s=r.tool_calls)==null?void 0:s.some(i=>i.type==="function"&&i.id===n.tool_call_id))}))return n.content}},vs=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:n}of this._chatCompletions)n&&(e.completion_tokens+=n.completion_tokens,e.prompt_tokens+=n.prompt_tokens,e.total_tokens+=n.total_tokens);return e},Pl=function(e){if(e.n!=null&&e.n>1)throw new he("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},xs=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};class Rn extends Il{static runFunctions(e,n,r){const s=new Rn,i={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runFunctions"}};return s._run(()=>s._runFunctions(e,n,i)),s}static runTools(e,n,r){const s=new Rn,i={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runTools"}};return s._run(()=>s._runTools(e,n,i)),s}_addMessage(e){super._addMessage(e),Yt(e)&&e.content&&this._emit("content",e.content)}}var nt=function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},Zr=function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},ft,xt,es,ts,qn,Ji;class Pn extends Il{constructor(){super(...arguments),ft.add(this),xt.set(this,void 0)}get currentChatCompletionSnapshot(){return nt(this,xt,"f")}static fromReadableStream(e){const n=new Pn;return n._run(()=>n._fromReadableStream(e)),n}static createChatCompletion(e,n,r){const s=new Pn;return s._run(()=>s._runChatCompletion(e,{...n,stream:!0},{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),s}async _createChatCompletion(e,n,r){var l;const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),nt(this,ft,"m",es).call(this);const i=await e.create({...n,stream:!0},{...r,signal:this.controller.signal});this._connected();for await(const o of i)nt(this,ft,"m",ts).call(this,o);if((l=i.controller.signal)!=null&&l.aborted)throw new Ve;return this._addChatCompletion(nt(this,ft,"m",qn).call(this))}async _fromReadableStream(e,n){var l;const r=n==null?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),nt(this,ft,"m",es).call(this),this._connected();const s=pt.fromReadableStream(e,this.controller);let i;for await(const o of s)i&&i!==o.id&&this._addChatCompletion(nt(this,ft,"m",qn).call(this)),nt(this,ft,"m",ts).call(this,o),i=o.id;if((l=s.controller.signal)!=null&&l.aborted)throw new Ve;return this._addChatCompletion(nt(this,ft,"m",qn).call(this))}[(xt=new WeakMap,ft=new WeakSet,es=function(){this.ended||Zr(this,xt,void 0,"f")},ts=function(n){var l,o,a;if(this.ended)return;const r=nt(this,ft,"m",Ji).call(this,n);this._emit("chunk",n,r);const s=(o=(l=n.choices[0])==null?void 0:l.delta)==null?void 0:o.content,i=(a=r.choices[0])==null?void 0:a.message;s!=null&&(i==null?void 0:i.role)==="assistant"&&(i!=null&&i.content)&&this._emit("content",s,i.content)},qn=function(){if(this.ended)throw new he("stream has ended, this shouldn't happen");const n=nt(this,xt,"f");if(!n)throw new he("request ended without sending any chunks");return Zr(this,xt,void 0,"f"),dh(n)},Ji=function(n){var r,s,i;let l=nt(this,xt,"f");const{choices:o,...a}=n;l?Object.assign(l,a):l=Zr(this,xt,{...a,choices:[]},"f");for(const{delta:u,finish_reason:f,index:c,logprobs:h=null,...d}of n.choices){let p=l.choices[c];if(p||(p=l.choices[c]={finish_reason:f,index:c,message:{},logprobs:h,...d}),h)if(!p.logprobs)p.logprobs=Object.assign({},h);else{const{content:P,...R}=h;Object.assign(p.logprobs,R),P&&((r=p.logprobs).content??(r.content=[]),p.logprobs.content.push(...P))}if(f&&(p.finish_reason=f),Object.assign(p,d),!u)continue;const{content:w,function_call:v,role:b,tool_calls:x,...A}=u;if(Object.assign(p.message,A),w&&(p.message.content=(p.message.content||"")+w),b&&(p.message.role=b),v&&(p.message.function_call?(v.name&&(p.message.function_call.name=v.name),v.arguments&&((s=p.message.function_call).arguments??(s.arguments=""),p.message.function_call.arguments+=v.arguments)):p.message.function_call=v),x){p.message.tool_calls||(p.message.tool_calls=[]);for(const{index:P,id:R,type:I,function:k,..._}of x){const m=(i=p.message.tool_calls)[P]??(i[P]={});Object.assign(m,_),R&&(m.id=R),I&&(m.type=I),k&&(m.function??(m.function={arguments:""})),k!=null&&k.name&&(m.function.name=k.name),k!=null&&k.arguments&&(m.function.arguments+=k.arguments)}}}return l},Symbol.asyncIterator)](){const e=[],n=[];let r=!1;return this.on("chunk",s=>{const i=n.shift();i?i.resolve(s):e.push(s)}),this.on("end",()=>{r=!0;for(const s of n)s.resolve(void 0);n.length=0}),this.on("abort",s=>{r=!0;for(const i of n)i.reject(s);n.length=0}),this.on("error",s=>{r=!0;for(const i of n)i.reject(s);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((i,l)=>n.push({resolve:i,reject:l})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new pt(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function dh(t){const{id:e,choices:n,created:r,model:s,system_fingerprint:i,...l}=t;return{...l,id:e,choices:n.map(({message:o,finish_reason:a,index:u,logprobs:f,...c})=>{if(!a)throw new he(`missing finish_reason for choice ${u}`);const{content:h=null,function_call:d,tool_calls:p,...w}=o,v=o.role;if(!v)throw new he(`missing role for choice ${u}`);if(d){const{arguments:b,name:x}=d;if(b==null)throw new he(`missing function_call.arguments for choice ${u}`);if(!x)throw new he(`missing function_call.name for choice ${u}`);return{...c,message:{content:h,function_call:{arguments:b,name:x},role:v},finish_reason:a,index:u,logprobs:f}}return p?{...c,index:u,finish_reason:a,logprobs:f,message:{...w,role:v,content:h,tool_calls:p.map((b,x)=>{const{function:A,type:P,id:R,...I}=b,{arguments:k,name:_,...m}=A||{};if(R==null)throw new he(`missing choices[${u}].tool_calls[${x}].id
${jn(t)}`);if(P==null)throw new he(`missing choices[${u}].tool_calls[${x}].type
${jn(t)}`);if(_==null)throw new he(`missing choices[${u}].tool_calls[${x}].function.name
${jn(t)}`);if(k==null)throw new he(`missing choices[${u}].tool_calls[${x}].function.arguments
${jn(t)}`);return{...I,id:R,type:P,function:{...m,name:_,arguments:k}}})}}:{...c,message:{...w,content:h,role:v},finish_reason:a,index:u,logprobs:f}}),created:r,model:s,object:"chat.completion",...i?{system_fingerprint:i}:{}}}function jn(t){return JSON.stringify(t)}class Qt extends Pn{static fromReadableStream(e){const n=new Qt;return n._run(()=>n._fromReadableStream(e)),n}static runFunctions(e,n,r){const s=new Qt,i={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runFunctions"}};return s._run(()=>s._runFunctions(e,n,i)),s}static runTools(e,n,r){const s=new Qt,i={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runTools"}};return s._run(()=>s._runTools(e,n,i)),s}}let Ml=class extends ge{runFunctions(e,n){return e.stream?Qt.runFunctions(this._client.chat.completions,e,n):Rn.runFunctions(this._client.chat.completions,e,n)}runTools(e,n){return e.stream?Qt.runTools(this._client.chat.completions,e,n):Rn.runTools(this._client.chat.completions,e,n)}stream(e,n){return Pn.createChatCompletion(this._client.chat.completions,e,n)}};class vr extends ge{constructor(){super(...arguments),this.completions=new Ml(this._client)}}(function(t){t.Completions=Ml})(vr||(vr={}));var rt=function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},ve=function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},Yn,Qn,hn,dn,Zn,pn,vt,mn,er,tr,Xt,Cs;class ph{constructor(){this.controller=new AbortController,Yn.set(this,void 0),Qn.set(this,()=>{}),hn.set(this,()=>{}),dn.set(this,void 0),Zn.set(this,()=>{}),pn.set(this,()=>{}),vt.set(this,{}),mn.set(this,!1),er.set(this,!1),tr.set(this,!1),Xt.set(this,!1),Cs.set(this,e=>{if(rt(this,er,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new Ve),e instanceof Ve)return rt(this,tr,!0,"f"),this._emit("abort",e);if(e instanceof he)return this._emit("error",e);if(e instanceof Error){const n=new he(e.message);return n.cause=e,this._emit("error",n)}return this._emit("error",new he(String(e)))}),rt(this,Yn,new Promise((e,n)=>{rt(this,Qn,e,"f"),rt(this,hn,n,"f")}),"f"),rt(this,dn,new Promise((e,n)=>{rt(this,Zn,e,"f"),rt(this,pn,n,"f")}),"f"),ve(this,Yn,"f").catch(()=>{}),ve(this,dn,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emit("end")},ve(this,Cs,"f"))},0)}_addRun(e){return e}_connected(){this.ended||(ve(this,Qn,"f").call(this),this._emit("connect"))}get ended(){return ve(this,mn,"f")}get errored(){return ve(this,er,"f")}get aborted(){return ve(this,tr,"f")}abort(){this.controller.abort()}on(e,n){return(ve(this,vt,"f")[e]||(ve(this,vt,"f")[e]=[])).push({listener:n}),this}off(e,n){const r=ve(this,vt,"f")[e];if(!r)return this;const s=r.findIndex(i=>i.listener===n);return s>=0&&r.splice(s,1),this}once(e,n){return(ve(this,vt,"f")[e]||(ve(this,vt,"f")[e]=[])).push({listener:n,once:!0}),this}emitted(e){return new Promise((n,r)=>{rt(this,Xt,!0,"f"),e!=="error"&&this.once("error",r),this.once(e,n)})}async done(){rt(this,Xt,!0,"f"),await ve(this,dn,"f")}_emit(e,...n){if(ve(this,mn,"f"))return;e==="end"&&(rt(this,mn,!0,"f"),ve(this,Zn,"f").call(this));const r=ve(this,vt,"f")[e];if(r&&(ve(this,vt,"f")[e]=r.filter(s=>!s.once),r.forEach(({listener:s})=>s(...n))),e==="abort"){const s=n[0];!ve(this,Xt,"f")&&!(r!=null&&r.length)&&Promise.reject(s),ve(this,hn,"f").call(this,s),ve(this,pn,"f").call(this,s),this._emit("end");return}if(e==="error"){const s=n[0];!ve(this,Xt,"f")&&!(r!=null&&r.length)&&Promise.reject(s),ve(this,hn,"f").call(this,s),ve(this,pn,"f").call(this,s),this._emit("end")}}async _threadAssistantStream(e,n,r){return await this._createThreadAssistantStream(n,e,r)}async _runAssistantStream(e,n,r,s){return await this._createAssistantStream(n,e,r,s)}async _runToolAssistantStream(e,n,r,s,i){return await this._createToolAssistantStream(r,e,n,s,i)}async _createThreadAssistantStream(e,n,r){const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort()));const i=await e.createAndRun({...n,stream:!1},{...r,signal:this.controller.signal});return this._connected(),this._addRun(i)}async _createToolAssistantStream(e,n,r,s,i){const l=i==null?void 0:i.signal;l&&(l.aborted&&this.controller.abort(),l.addEventListener("abort",()=>this.controller.abort()));const o=await e.submitToolOutputs(n,r,{...s,stream:!1},{...i,signal:this.controller.signal});return this._connected(),this._addRun(o)}async _createAssistantStream(e,n,r,s){const i=s==null?void 0:s.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));const l=await e.create(n,{...r,stream:!1},{...s,signal:this.controller.signal});return this._connected(),this._addRun(l)}}Yn=new WeakMap,Qn=new WeakMap,hn=new WeakMap,dn=new WeakMap,Zn=new WeakMap,pn=new WeakMap,vt=new WeakMap,mn=new WeakMap,er=new WeakMap,tr=new WeakMap,Xt=new WeakMap,Cs=new WeakMap;var V=function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},Xe=function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},Re,As,dt,nr,st,Ot,zt,Pt,br,He,rr,sr,bn,_n,gn,Ki,Gi,Yi,Qi,Zi,ea,ta;class at extends ph{constructor(){super(...arguments),Re.add(this),As.set(this,[]),dt.set(this,{}),nr.set(this,{}),st.set(this,void 0),Ot.set(this,void 0),zt.set(this,void 0),Pt.set(this,void 0),br.set(this,void 0),He.set(this,void 0),rr.set(this,void 0),sr.set(this,void 0),bn.set(this,void 0)}[(As=new WeakMap,dt=new WeakMap,nr=new WeakMap,st=new WeakMap,Ot=new WeakMap,zt=new WeakMap,Pt=new WeakMap,br=new WeakMap,He=new WeakMap,rr=new WeakMap,sr=new WeakMap,bn=new WeakMap,Re=new WeakSet,Symbol.asyncIterator)](){const e=[],n=[];let r=!1;return this.on("event",s=>{const i=n.shift();i?i.resolve(s):e.push(s)}),this.on("end",()=>{r=!0;for(const s of n)s.resolve(void 0);n.length=0}),this.on("abort",s=>{r=!0;for(const i of n)i.reject(s);n.length=0}),this.on("error",s=>{r=!0;for(const i of n)i.reject(s);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((i,l)=>n.push({resolve:i,reject:l})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){const n=new at;return n._run(()=>n._fromReadableStream(e)),n}async _fromReadableStream(e,n){var i;const r=n==null?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),this._connected();const s=pt.fromReadableStream(e,this.controller);for await(const l of s)V(this,Re,"m",_n).call(this,l);if((i=s.controller.signal)!=null&&i.aborted)throw new Ve;return this._addRun(V(this,Re,"m",gn).call(this))}toReadableStream(){return new pt(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,n,r,s,i){const l=new at;return l._run(()=>l._runToolAssistantStream(e,n,r,s,{...i,headers:{...i==null?void 0:i.headers,"X-Stainless-Helper-Method":"stream"}})),l}async _createToolAssistantStream(e,n,r,s,i){var u;const l=i==null?void 0:i.signal;l&&(l.aborted&&this.controller.abort(),l.addEventListener("abort",()=>this.controller.abort()));const o={...s,stream:!0},a=await e.submitToolOutputs(n,r,o,{...i,signal:this.controller.signal});this._connected();for await(const f of a)V(this,Re,"m",_n).call(this,f);if((u=a.controller.signal)!=null&&u.aborted)throw new Ve;return this._addRun(V(this,Re,"m",gn).call(this))}static createThreadAssistantStream(e,n,r){const s=new at;return s._run(()=>s._threadAssistantStream(e,n,{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),s}static createAssistantStream(e,n,r,s){const i=new at;return i._run(()=>i._runAssistantStream(e,n,r,{...s,headers:{...s==null?void 0:s.headers,"X-Stainless-Helper-Method":"stream"}})),i}currentEvent(){return V(this,rr,"f")}currentRun(){return V(this,sr,"f")}currentMessageSnapshot(){return V(this,st,"f")}currentRunStepSnapshot(){return V(this,bn,"f")}async finalRunSteps(){return await this.done(),Object.values(V(this,dt,"f"))}async finalMessages(){return await this.done(),Object.values(V(this,nr,"f"))}async finalRun(){if(await this.done(),!V(this,Ot,"f"))throw Error("Final run was not received.");return V(this,Ot,"f")}async _createThreadAssistantStream(e,n,r){var o;const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort()));const i={...n,stream:!0},l=await e.createAndRun(i,{...r,signal:this.controller.signal});this._connected();for await(const a of l)V(this,Re,"m",_n).call(this,a);if((o=l.controller.signal)!=null&&o.aborted)throw new Ve;return this._addRun(V(this,Re,"m",gn).call(this))}async _createAssistantStream(e,n,r,s){var a;const i=s==null?void 0:s.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));const l={...r,stream:!0},o=await e.create(n,l,{...s,signal:this.controller.signal});this._connected();for await(const u of o)V(this,Re,"m",_n).call(this,u);if((a=o.controller.signal)!=null&&a.aborted)throw new Ve;return this._addRun(V(this,Re,"m",gn).call(this))}static accumulateDelta(e,n){for(const[r,s]of Object.entries(n)){if(!e.hasOwnProperty(r)){e[r]=s;continue}let i=e[r];if(i==null){e[r]=s;continue}if(r==="index"||r==="type"){e[r]=s;continue}if(typeof i=="string"&&typeof s=="string")i+=s;else if(typeof i=="number"&&typeof s=="number")i+=s;else if(Hi(i)&&Hi(s))i=this.accumulateDelta(i,s);else if(Array.isArray(i)&&Array.isArray(s)){if(i.every(l=>typeof l=="string"||typeof l=="number")){i.push(...s);continue}}else throw Error(`Unhandled record type: ${r}, deltaValue: ${s}, accValue: ${i}`);e[r]=i}return e}}_n=function(e){if(!this.ended)switch(Xe(this,rr,e,"f"),V(this,Re,"m",Yi).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":V(this,Re,"m",ta).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":V(this,Re,"m",Gi).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":V(this,Re,"m",Ki).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},gn=function(){if(this.ended)throw new he("stream has ended, this shouldn't happen");if(!V(this,Ot,"f"))throw Error("Final run has not been received");return V(this,Ot,"f")},Ki=function(e){const[n,r]=V(this,Re,"m",Zi).call(this,e,V(this,st,"f"));Xe(this,st,n,"f"),V(this,nr,"f")[n.id]=n;for(const s of r){const i=n.content[s.index];(i==null?void 0:i.type)=="text"&&this._emit("textCreated",i.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,n),e.data.delta.content)for(const s of e.data.delta.content){if(s.type=="text"&&s.text){let i=s.text,l=n.content[s.index];if(l&&l.type=="text")this._emit("textDelta",i,l.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(s.index!=V(this,zt,"f")){if(V(this,Pt,"f"))switch(V(this,Pt,"f").type){case"text":this._emit("textDone",V(this,Pt,"f").text,V(this,st,"f"));break;case"image_file":this._emit("imageFileDone",V(this,Pt,"f").image_file,V(this,st,"f"));break}Xe(this,zt,s.index,"f")}Xe(this,Pt,n.content[s.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(V(this,zt,"f")!==void 0){const s=e.data.content[V(this,zt,"f")];if(s)switch(s.type){case"image_file":this._emit("imageFileDone",s.image_file,V(this,st,"f"));break;case"text":this._emit("textDone",s.text,V(this,st,"f"));break}}V(this,st,"f")&&this._emit("messageDone",e.data),Xe(this,st,void 0,"f")}},Gi=function(e){const n=V(this,Re,"m",Qi).call(this,e);switch(Xe(this,bn,n,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const r=e.data.delta;if(r.step_details&&r.step_details.type=="tool_calls"&&r.step_details.tool_calls&&n.step_details.type=="tool_calls")for(const i of r.step_details.tool_calls)i.index==V(this,br,"f")?this._emit("toolCallDelta",i,n.step_details.tool_calls[i.index]):(V(this,He,"f")&&this._emit("toolCallDone",V(this,He,"f")),Xe(this,br,i.index,"f"),Xe(this,He,n.step_details.tool_calls[i.index],"f"),V(this,He,"f")&&this._emit("toolCallCreated",V(this,He,"f")));this._emit("runStepDelta",e.data.delta,n);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":Xe(this,bn,void 0,"f"),e.data.step_details.type=="tool_calls"&&V(this,He,"f")&&(this._emit("toolCallDone",V(this,He,"f")),Xe(this,He,void 0,"f")),this._emit("runStepDone",e.data,n);break}},Yi=function(e){V(this,As,"f").push(e),this._emit("event",e)},Qi=function(e){switch(e.event){case"thread.run.step.created":return V(this,dt,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let n=V(this,dt,"f")[e.data.id];if(!n)throw Error("Received a RunStepDelta before creation of a snapshot");let r=e.data;if(r.delta){const s=at.accumulateDelta(n,r.delta);V(this,dt,"f")[e.data.id]=s}return V(this,dt,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":V(this,dt,"f")[e.data.id]=e.data;break}if(V(this,dt,"f")[e.data.id])return V(this,dt,"f")[e.data.id];throw new Error("No snapshot available")},Zi=function(e,n){let r=[];switch(e.event){case"thread.message.created":return[e.data,r];case"thread.message.delta":if(!n)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let s=e.data;if(s.delta.content)for(const i of s.delta.content)if(i.index in n.content){let l=n.content[i.index];n.content[i.index]=V(this,Re,"m",ea).call(this,i,l)}else n.content[i.index]=i,r.push(i);return[n,r];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(n)return[n,r];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},ea=function(e,n){return at.accumulateDelta(n,e)},ta=function(e){switch(Xe(this,sr,e.data,"f"),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":Xe(this,Ot,e.data,"f"),V(this,He,"f")&&(this._emit("toolCallDone",V(this,He,"f")),Xe(this,He,void 0,"f"));break}};class xr extends ge{create(e,n,r){return this._client.post(`/threads/${e}/messages`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,n,r){return this._client.get(`/threads/${e}/messages/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(e,n,r,s){return this._client.post(`/threads/${e}/messages/${n}`,{body:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}list(e,n={},r){return Je(n)?this.list(e,{},n):this._client.getAPIList(`/threads/${e}/messages`,Ys,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(e,n,r){return this._client.delete(`/threads/${e}/messages/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}}class Ys extends ct{}(function(t){t.MessagesPage=Ys})(xr||(xr={}));class Cr extends ge{retrieve(e,n,r,s){return this._client.get(`/threads/${e}/runs/${n}/steps/${r}`,{...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}list(e,n,r={},s){return Je(r)?this.list(e,n,{},r):this._client.getAPIList(`/threads/${e}/runs/${n}/steps`,Qs,{query:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}}class Qs extends ct{}(function(t){t.RunStepsPage=Qs})(Cr||(Cr={}));class Ar extends ge{constructor(){super(...arguments),this.steps=new Cr(this._client)}create(e,n,r){return this._client.post(`/threads/${e}/runs`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers},stream:n.stream??!1})}retrieve(e,n,r){return this._client.get(`/threads/${e}/runs/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(e,n,r,s){return this._client.post(`/threads/${e}/runs/${n}`,{body:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}list(e,n={},r){return Je(n)?this.list(e,{},n):this._client.getAPIList(`/threads/${e}/runs`,Zs,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}cancel(e,n,r){return this._client.post(`/threads/${e}/runs/${n}/cancel`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(e,n,r){const s=await this.create(e,n,r);return await this.poll(e,s.id,r)}createAndStream(e,n,r){return at.createAssistantStream(e,this._client.beta.threads.runs,n,r)}async poll(e,n,r){const s={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for(r!=null&&r.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const{data:i,response:l}=await this.retrieve(e,n,{...r,headers:{...r==null?void 0:r.headers,...s}}).withResponse();switch(i.status){case"queued":case"in_progress":case"cancelling":let o=5e3;if(r!=null&&r.pollIntervalMs)o=r.pollIntervalMs;else{const a=l.headers.get("openai-poll-after-ms");if(a){const u=parseInt(a);isNaN(u)||(o=u)}}await Nn(o);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return i}}}stream(e,n,r){return at.createAssistantStream(e,this._client.beta.threads.runs,n,r)}submitToolOutputs(e,n,r,s){return this._client.post(`/threads/${e}/runs/${n}/submit_tool_outputs`,{body:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers},stream:r.stream??!1})}async submitToolOutputsAndPoll(e,n,r,s){const i=await this.submitToolOutputs(e,n,r,s);return await this.poll(e,i.id,s)}submitToolOutputsStream(e,n,r,s){return at.createToolAssistantStream(e,n,this._client.beta.threads.runs,r,s)}}class Zs extends ct{}(function(t){t.RunsPage=Zs,t.Steps=Cr,t.RunStepsPage=Qs})(Ar||(Ar={}));class kr extends ge{constructor(){super(...arguments),this.runs=new Ar(this._client),this.messages=new xr(this._client)}create(e={},n){return Je(e)?this.create({},e):this._client.post("/threads",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,n){return this._client.get(`/threads/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(e,n,r){return this._client.post(`/threads/${e}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(e,n){return this._client.delete(`/threads/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}createAndRun(e,n){return this._client.post("/threads/runs",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers},stream:e.stream??!1})}async createAndRunPoll(e,n){const r=await this.createAndRun(e,n);return await this.runs.poll(r.thread_id,r.id,n)}createAndRunStream(e,n){return at.createThreadAssistantStream(e,this._client.beta.threads,n)}}(function(t){t.Runs=Ar,t.RunsPage=Zs,t.Messages=xr,t.MessagesPage=Ys})(kr||(kr={}));const mh=async t=>{const e=await Promise.allSettled(t),n=e.filter(s=>s.status==="rejected");if(n.length){for(const s of n)console.error(s.reason);throw new Error(`${n.length} promise(s) failed - see the above errors`)}const r=[];for(const s of e)s.status==="fulfilled"&&r.push(s.value);return r};let Sr=class extends ge{create(e,n,r){return this._client.post(`/vector_stores/${e}/files`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,n,r){return this._client.get(`/vector_stores/${e}/files/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(e,n={},r){return Je(n)?this.list(e,{},n):this._client.getAPIList(`/vector_stores/${e}/files`,Hr,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(e,n,r){return this._client.delete(`/vector_stores/${e}/files/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(e,n,r){const s=await this.create(e,n,r);return await this.poll(e,s.id,r)}async poll(e,n,r){const s={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for(r!=null&&r.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const i=await this.retrieve(e,n,{...r,headers:s}).withResponse(),l=i.data;switch(l.status){case"in_progress":let o=5e3;if(r!=null&&r.pollIntervalMs)o=r.pollIntervalMs;else{const a=i.response.headers.get("openai-poll-after-ms");if(a){const u=parseInt(a);isNaN(u)||(o=u)}}await Nn(o);break;case"failed":case"completed":return l}}}async upload(e,n,r){const s=await this._client.files.create({file:n,purpose:"assistants"},r);return this.create(e,{file_id:s.id},r)}async uploadAndPoll(e,n,r){const s=await this.upload(e,n,r);return await this.poll(e,s.id,r)}};class Hr extends ct{}(function(t){t.VectorStoreFilesPage=Hr})(Sr||(Sr={}));class Er extends ge{create(e,n,r){return this._client.post(`/vector_stores/${e}/file_batches`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,n,r){return this._client.get(`/vector_stores/${e}/file_batches/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}cancel(e,n,r){return this._client.post(`/vector_stores/${e}/file_batches/${n}/cancel`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(e,n,r){const s=await this.create(e,n);return await this.poll(e,s.id,r)}listFiles(e,n,r={},s){return Je(r)?this.listFiles(e,n,{},r):this._client.getAPIList(`/vector_stores/${e}/file_batches/${n}/files`,Hr,{query:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}async poll(e,n,r){const s={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for(r!=null&&r.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const{data:i,response:l}=await this.retrieve(e,n,{...r,headers:s}).withResponse();switch(i.status){case"in_progress":let o=5e3;if(r!=null&&r.pollIntervalMs)o=r.pollIntervalMs;else{const a=l.headers.get("openai-poll-after-ms");if(a){const u=parseInt(a);isNaN(u)||(o=u)}}await Nn(o);break;case"failed":case"cancelled":case"completed":return i}}}async uploadAndPoll(e,{files:n,fileIds:r=[]},s){if(n===null||n.length==0)throw new Error("No files provided to process.");const i=(s==null?void 0:s.maxConcurrency)??5,l=Math.min(i,n.length),o=this._client,a=n.values(),u=[...r];async function f(h){for(let d of h){const p=await o.files.create({file:d,purpose:"assistants"},s);u.push(p.id)}}const c=Array(l).fill(a).map(f);return await mh(c),await this.createAndPoll(e,{file_ids:u})}}Er||(Er={});class Rr extends ge{constructor(){super(...arguments),this.files=new Sr(this._client),this.fileBatches=new Er(this._client)}create(e,n){return this._client.post("/vector_stores",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,n){return this._client.get(`/vector_stores/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(e,n,r){return this._client.post(`/vector_stores/${e}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(e={},n){return Je(e)?this.list({},e):this._client.getAPIList("/vector_stores",ei,{query:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,n){return this._client.delete(`/vector_stores/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class ei extends ct{}(function(t){t.VectorStoresPage=ei,t.Files=Sr,t.VectorStoreFilesPage=Hr,t.FileBatches=Er})(Rr||(Rr={}));class Pr extends ge{constructor(){super(...arguments),this.vectorStores=new Rr(this._client),this.chat=new vr(this._client),this.assistants=new wr(this._client),this.threads=new kr(this._client)}}(function(t){t.VectorStores=Rr,t.VectorStoresPage=ei,t.Chat=vr,t.Assistants=wr,t.AssistantsPage=Gs,t.Threads=kr})(Pr||(Pr={}));class Ir extends ge{create(e,n){return this._client.post("/completions",{body:e,...n,stream:e.stream??!1})}}Ir||(Ir={});class Mr extends ge{create(e,n){return this._client.post("/embeddings",{body:e,...n})}}Mr||(Mr={});class Or extends ge{create(e,n){return this._client.post("/files",En({body:e,...n}))}retrieve(e,n){return this._client.get(`/files/${e}`,n)}list(e={},n){return Je(e)?this.list({},e):this._client.getAPIList("/files",ti,{query:e,...n})}del(e,n){return this._client.delete(`/files/${e}`,n)}content(e,n){return this._client.get(`/files/${e}/content`,{...n,__binaryResponse:!0})}retrieveContent(e,n){return this._client.get(`/files/${e}/content`,{...n,headers:{Accept:"application/json",...n==null?void 0:n.headers}})}async waitForProcessing(e,{pollInterval:n=5e3,maxWait:r=30*60*1e3}={}){const s=new Set(["processed","error","deleted"]),i=Date.now();let l=await this.retrieve(e);for(;!l.status||!s.has(l.status);)if(await Nn(n),l=await this.retrieve(e),Date.now()-i>r)throw new zs({message:`Giving up on waiting for file ${e} to finish processing after ${r} milliseconds.`});return l}}class ti extends Js{}(function(t){t.FileObjectsPage=ti})(Or||(Or={}));class Nr extends ge{list(e,n={},r){return Je(n)?this.list(e,{},n):this._client.getAPIList(`/fine_tuning/jobs/${e}/checkpoints`,ni,{query:n,...r})}}class ni extends ct{}(function(t){t.FineTuningJobCheckpointsPage=ni})(Nr||(Nr={}));class Tr extends ge{constructor(){super(...arguments),this.checkpoints=new Nr(this._client)}create(e,n){return this._client.post("/fine_tuning/jobs",{body:e,...n})}retrieve(e,n){return this._client.get(`/fine_tuning/jobs/${e}`,n)}list(e={},n){return Je(e)?this.list({},e):this._client.getAPIList("/fine_tuning/jobs",ri,{query:e,...n})}cancel(e,n){return this._client.post(`/fine_tuning/jobs/${e}/cancel`,n)}listEvents(e,n={},r){return Je(n)?this.listEvents(e,{},n):this._client.getAPIList(`/fine_tuning/jobs/${e}/events`,si,{query:n,...r})}}class ri extends ct{}class si extends ct{}(function(t){t.FineTuningJobsPage=ri,t.FineTuningJobEventsPage=si,t.Checkpoints=Nr,t.FineTuningJobCheckpointsPage=ni})(Tr||(Tr={}));class $r extends ge{constructor(){super(...arguments),this.jobs=new Tr(this._client)}}(function(t){t.Jobs=Tr,t.FineTuningJobsPage=ri,t.FineTuningJobEventsPage=si})($r||($r={}));class Lr extends ge{createVariation(e,n){return this._client.post("/images/variations",En({body:e,...n}))}edit(e,n){return this._client.post("/images/edits",En({body:e,...n}))}generate(e,n){return this._client.post("/images/generations",{body:e,...n})}}Lr||(Lr={});class Fr extends ge{retrieve(e,n){return this._client.get(`/models/${e}`,n)}list(e){return this._client.getAPIList("/models",ii,e)}del(e,n){return this._client.delete(`/models/${e}`,n)}}class ii extends Js{}(function(t){t.ModelsPage=ii})(Fr||(Fr={}));class Dr extends ge{create(e,n){return this._client.post("/moderations",{body:e,...n})}}Dr||(Dr={});var Ol;class Ee extends th{constructor({baseURL:e=Dn("OPENAI_BASE_URL"),apiKey:n=Dn("OPENAI_API_KEY"),organization:r=Dn("OPENAI_ORG_ID")??null,project:s=Dn("OPENAI_PROJECT_ID")??null,...i}={}){if(n===void 0)throw new he("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const l={apiKey:n,organization:r,project:s,...i,baseURL:e||"https://api.openai.com/v1"};if(!l.dangerouslyAllowBrowser&&hh())throw new he(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);super({baseURL:l.baseURL,timeout:l.timeout??6e5,httpAgent:l.httpAgent,maxRetries:l.maxRetries,fetch:l.fetch}),this.completions=new Ir(this),this.chat=new hr(this),this.embeddings=new Mr(this),this.files=new Or(this),this.images=new Lr(this),this.audio=new _r(this),this.moderations=new Dr(this),this.models=new Fr(this),this.fineTuning=new $r(this),this.beta=new Pr(this),this.batches=new gr(this),this._options=l,this.apiKey=n,this.organization=r,this.project=s}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project,...this._options.defaultHeaders}}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}}Ol=Ee;Ee.OpenAI=Ol;Ee.OpenAIError=he;Ee.APIError=Pe;Ee.APIConnectionError=Ur;Ee.APIConnectionTimeoutError=zs;Ee.APIUserAbortError=Ve;Ee.NotFoundError=pl;Ee.ConflictError=ml;Ee.RateLimitError=gl;Ee.BadRequestError=fl;Ee.AuthenticationError=hl;Ee.InternalServerError=wl;Ee.PermissionDeniedError=dl;Ee.UnprocessableEntityError=_l;Ee.toFile=xl;Ee.fileFromPath=ul;(function(t){t.Page=Js,t.CursorPage=ct,t.Completions=Ir,t.Chat=hr,t.Embeddings=Mr,t.Files=Or,t.FileObjectsPage=ti,t.Images=Lr,t.Audio=_r,t.Moderations=Dr,t.Models=Fr,t.ModelsPage=ii,t.FineTuning=$r,t.Beta=Pr,t.Batches=gr,t.BatchesPage=Ks})(Ee||(Ee={}));const jt=[];function _h(t,e=ye){let n;const r=new Set;function s(o){if(et(t,o)&&(t=o,n)){const a=!jt.length;for(const u of r)u[1](),jt.push(u,t);if(a){for(let u=0;u<jt.length;u+=2)jt[u][0](jt[u+1]);jt.length=0}}}function i(o){s(o(t))}function l(o,a=ye){const u=[o,a];return r.add(u),r.size===1&&(n=e(s,i)||ye),o(t),()=>{r.delete(u),r.size===0&&n&&(n(),n=null)}}return{set:s,update:i,subscribe:l}}let Nt=_h(localStorage.getItem("apiKey")||"");Nt.subscribe(t=>localStorage.setItem("apiKey",t));let qr;const Nl=async()=>{if(mi(Nt)===""){let t=window.prompt("Please enter your OpenAI API key");if(t===null)return!1;Nt.set(t)}return qr=new Ee({apiKey:mi(Nt),dangerouslyAllowBrowser:!0}),await qr.models.list().then(t=>!0).catch(t=>t.status===401?(Nt.set(""),alert("Invalid API key"),!1):(alert("Error: "+t.response.data.error.message),!1))};let Tl=["gpt-4-turbo-2024-04-09","gpt-4-turbo","gpt-3.5-turbo-1106","gpt-4-0613","gpt-4o-2024-05-13","gpt-4-0125-preview","gpt-4o","gpt-4-turbo-preview","gpt-4","gpt-3.5-turbo-16k","gpt-4-1106-preview","gpt-3.5-turbo-0125","gpt-3.5-turbo","gpt-3.5-turbo-instruct","gpt-3.5-turbo-instruct-0914"];function gh(t,e,n){const r=t.slice();return r[40]=e[n],r}function na(t){let e,n,r,s,i,l,o,a,u,f,c,h,d,p,w,v,b,x,A,P,R,I,k,_,m,C,M,E,O,q,G,D,T,Y,B,H,K,L,Z,ne=At(Tl),te=[];for(let F=0;F<ne.length;F+=1)te[F]=wh(gh(t,ne,F));let ee=t[5]!=="none"&&ra(t),z=t[9]&&sa(t);return{c(){e=S("div"),n=S("label"),n.textContent="Model name",r=S("select");for(let F=0;F<te.length;F+=1)te[F].c();s=$(),i=S("div"),l=S("label"),l.textContent="Max tokens",o=S("input"),a=$(),u=S("div"),f=S("label"),f.textContent="Temperature",c=S("input"),h=$(),d=S("div"),p=S("label"),p.textContent="Post processing function",w=S("select"),v=S("option"),v.textContent="None",b=S("option"),b.textContent="Trim",x=S("option"),x.textContent="Last word",A=S("option"),A.textContent="Custom",P=$(),ee&&ee.c(),R=$(),I=S("div"),k=S("label"),k.textContent="Default class",_=S("input"),m=$(),C=S("div"),M=S("label"),M.textContent="Label whitelist ",E=S("input"),O=$(),z&&z.c(),q=$(),G=S("div"),D=S("label"),D.textContent="Retries",T=S("input"),Y=$(),B=S("div"),H=S("label"),H.textContent="Threads",K=S("input"),y(n,"for","model"),ze(n,"display","inline-block"),y(n,"class","svelte-453y32"),y(r,"id","model"),y(r,"class","svelte-453y32"),t[3]===void 0&&Zt(()=>t[26].call(r)),y(l,"for","max-tokens"),y(l,"class","svelte-453y32"),y(o,"type","number"),y(o,"id","max-tokens"),y(o,"class","svelte-453y32"),_e(o,"invalid",!Number.isInteger(t[2])||t[2]<1),y(f,"for","temperature"),y(f,"class","svelte-453y32"),y(c,"type","number"),y(c,"id","temperature"),y(c,"class","svelte-453y32"),_e(c,"invalid",t[17]),y(p,"for","post-processing"),ze(p,"display","inline-block"),y(p,"class","svelte-453y32"),v.__value="none",re(v,v.__value),y(v,"class","svelte-453y32"),b.__value="trim",re(b,b.__value),y(b,"class","svelte-453y32"),x.__value="last",re(x,x.__value),y(x,"class","svelte-453y32"),A.__value="custom",re(A,A.__value),y(A,"class","svelte-453y32"),y(w,"id","postprocessing"),y(w,"class","svelte-453y32"),t[5]===void 0&&Zt(()=>t[29].call(w)),y(k,"for","default-class"),y(k,"class","svelte-453y32"),y(_,"type","text"),y(_,"id","default-class"),ze(_,"width","6em"),y(_,"class","svelte-453y32"),y(I,"class","default-class"),y(M,"for","enable-wl"),y(M,"class","svelte-453y32"),y(E,"type","checkbox"),y(E,"id","enable-wl"),y(E,"class","svelte-453y32"),y(C,"class","whitelist svelte-453y32"),ze(C,"user-select","none"),y(D,"for","retries"),y(D,"class","svelte-453y32"),y(T,"type","number"),y(T,"id","retries"),y(T,"class","svelte-453y32"),_e(T,"invalid",t[14]),y(H,"for","threads"),y(H,"class","svelte-453y32"),y(K,"type","number"),y(K,"id","threads"),y(K,"class","svelte-453y32"),_e(K,"invalid",t[13])},m(F,N){X(F,e,N),g(e,n),g(e,r);for(let J=0;J<te.length;J+=1)te[J]&&te[J].m(r,null);Ht(r,t[3],!0),X(F,s,N),X(F,i,N),g(i,l),g(i,o),re(o,t[2]),X(F,a,N),X(F,u,N),g(u,f),g(u,c),re(c,t[4]),X(F,h,N),X(F,d,N),g(d,p),g(d,w),g(w,v),g(w,b),g(w,x),g(w,A),Ht(w,t[5],!0),g(d,P),ee&&ee.m(d,null),X(F,R,N),X(F,I,N),g(I,k),g(I,_),re(_,t[8]),X(F,m,N),X(F,C,N),g(C,M),g(C,E),E.checked=t[9],g(C,O),z&&z.m(C,null),X(F,q,N),X(F,G,N),g(G,D),g(G,T),re(T,t[11]),X(F,Y,N),X(F,B,N),g(B,H),g(B,K),re(K,t[12]),L||(Z=[se(r,"change",t[26]),se(o,"input",t[27]),se(c,"input",t[28]),se(w,"change",t[29]),se(w,"input",t[30]),se(_,"input",t[33]),se(E,"change",t[34]),se(T,"input",t[36]),se(K,"input",t[37])],L=!0)},p(F,N){N[0]&8&&Ht(r,F[3]),N[0]&4&&ke(o.value)!==F[2]&&re(o,F[2]),N[0]&4&&_e(o,"invalid",!Number.isInteger(F[2])||F[2]<1),N[0]&16&&ke(c.value)!==F[4]&&re(c,F[4]),N[0]&131072&&_e(c,"invalid",F[17]),N[0]&32&&Ht(w,F[5]),F[5]!=="none"?ee?ee.p(F,N):(ee=ra(F),ee.c(),ee.m(d,null)):ee&&(ee.d(1),ee=null),N[0]&256&&_.value!==F[8]&&re(_,F[8]),N[0]&512&&(E.checked=F[9]),F[9]?z?z.p(F,N):(z=sa(F),z.c(),z.m(C,null)):z&&(z.d(1),z=null),N[0]&2048&&ke(T.value)!==F[11]&&re(T,F[11]),N[0]&16384&&_e(T,"invalid",F[14]),N[0]&4096&&ke(K.value)!==F[12]&&re(K,F[12]),N[0]&8192&&_e(K,"invalid",F[13])},d(F){F&&(W(e),W(s),W(i),W(a),W(u),W(h),W(d),W(R),W(I),W(m),W(C),W(q),W(G),W(Y),W(B)),In(te,F),ee&&ee.d(),z&&z.d(),L=!1,De(Z)}}}function wh(t){let e;return{c(){e=S("option"),e.textContent=`${t[40]}`,e.__value=t[40],re(e,e.__value),y(e,"class","svelte-453y32")},m(n,r){X(n,e,r)},p:ye,d(n){n&&W(e)}}}function ra(t){let e,n,r;return{c(){e=S("textarea"),y(e,"id","post-processing"),y(e,"class","svelte-453y32"),_e(e,"invalid",t[16]===null)},m(s,i){X(s,e,i),re(e,t[6]),n||(r=[se(e,"input",t[31]),se(e,"input",t[32])],n=!0)},p(s,i){i[0]&64&&re(e,s[6]),i[0]&65536&&_e(e,"invalid",s[16]===null)},d(s){s&&W(e),n=!1,De(r)}}}function sa(t){let e,n,r,s;return{c(){e=ie(`(one label per line)
        `),n=S("textarea"),y(n,"id","whitelist"),y(n,"class","svelte-453y32"),_e(n,"invalid",t[15])},m(i,l){X(i,e,l),X(i,n,l),re(n,t[10]),r||(s=se(n,"input",t[35]),r=!0)},p(i,l){l[0]&1024&&re(n,i[10]),l[0]&32768&&_e(n,"invalid",i[15])},d(i){i&&(W(e),W(n)),r=!1,s()}}}function yh(t){let e,n,r,s,i=t[18]?"Hide":"Show",l,o,a,u,f,c,h,d,p,w,v,b,x,A=t[18]&&na(t);return{c(){e=S("section"),n=S("div"),n.textContent="Instructions",r=$(),s=S("button"),l=ie(i),o=ie(" advanced options"),a=$(),u=S("div"),f=ie(t[0]),c=$(),h=S("div"),d=S("label"),d.textContent="Instructions",p=$(),w=S("textarea"),v=$(),A&&A.c(),y(n,"class","section-title svelte-453y32"),y(s,"class","svelte-453y32"),y(u,"class","message svelte-453y32"),y(d,"for","prompt"),y(d,"class","svelte-453y32"),y(w,"id","prompt"),y(w,"placeholder","Classify this text as ..."),y(w,"class","svelte-453y32"),_e(w,"invalid",!t[1]),y(h,"class","prompt svelte-453y32"),y(e,"class","svelte-453y32")},m(P,R){X(P,e,R),g(e,n),g(e,r),g(e,s),g(s,l),g(s,o),g(e,a),g(e,u),g(u,f),g(e,c),g(e,h),g(h,d),g(h,p),g(h,w),re(w,t[1]),g(e,v),A&&A.m(e,null),b||(x=[se(s,"click",t[24]),se(w,"input",t[25])],b=!0)},p(P,R){R[0]&262144&&i!==(i=P[18]?"Hide":"Show")&&Se(l,i),R[0]&1&&Se(f,P[0]),R[0]&2&&re(w,P[1]),R[0]&2&&_e(w,"invalid",!P[1]),P[18]?A?A.p(P,R):(A=na(P),A.c(),A.m(e,null)):A&&(A.d(1),A=null)},i:ye,o:ye,d(P){P&&W(e),A&&A.d(),b=!1,De(x)}}}function vh(t,e,n){let r,s,i,l,o,a,u,f="";const c=()=>{n(1,f="Describe the emotion expressed in the following message as joy, anger, sadness or optimism. Output only “joy”, “anger”, “sadness” or “optimism” without quotes.")};let{message:h="Enter instructions asking the LLM to label the dataset."}=e,d=!1,p=20,w="gpt-3.5-turbo",v=.1,b="none",x={none:"return s;",trim:"return s.trim();",last:`// get last word
s = s.split(/\\s+/).slice(-1)[0];
// convert to lowercase
s = s.toLowerCase();
// remove punctuation at the end
s = s.replace(/[.,;]+$/g, "");
return s;`,custom:`// your code here
// return null to note an invalid input
return s;`},A=x[b],P=!1;const R=z=>{let F;try{F=new Function("s",z)}catch{return null}return F};let I="",k=!1,_="",m=1,C=4,{params:M}=e,{valid:E}=e;const O=()=>{n(18,d=!d)};function q(){f=this.value,n(1,f)}function G(){w=ns(this),n(3,w)}function D(){p=ke(this.value),n(2,p)}function T(){v=ke(this.value),n(4,v)}function Y(){b=ns(this),n(5,b)}const B=()=>{n(7,P=!0)};function H(){A=this.value,n(6,A),n(7,P),n(38,x),n(5,b)}const K=()=>{let z=A;n(5,b="custom"),n(6,A=z)};function L(){I=this.value,n(8,I)}function Z(){k=this.checked,n(9,k)}function ne(){_=this.value,n(10,_)}function te(){m=ke(this.value),n(11,m)}function ee(){C=ke(this.value),n(12,C)}return t.$$set=z=>{"message"in z&&n(0,h=z.message),"params"in z&&n(19,M=z.params),"valid"in z&&n(20,E=z.valid)},t.$$.update=()=>{t.$$.dirty[0]&4&&n(22,r=!Number.isInteger(p)||p<1),t.$$.dirty[0]&16&&n(17,s=v<0||v>1),t.$$.dirty[0]&160&&(P&&n(6,A=x[b]),n(7,P=!1)),t.$$.dirty[0]&64&&n(16,i=R(A)),t.$$.dirty[0]&1024&&n(23,l=_?_.split(`
`).map(z=>z.trim()):null),t.$$.dirty[0]&8389120&&n(15,o=k&&l===null),t.$$.dirty[0]&2048&&n(14,a=!Number.isInteger(m)||m<1),t.$$.dirty[0]&4096&&n(13,u=!Number.isInteger(C)||C<1),t.$$.dirty[0]&8460574&&n(19,M={prompt:f,model:w,maxTokens:p,temperature:v,postprocess_fun:i,default_class:I,whitelist:l,retries:m,threads:C}),t.$$.dirty[0]&4448258&&n(20,E=f!==""&&!r&&!s&&i!==null&&!o&&!a&&!u)},[h,f,p,w,v,b,A,P,I,k,_,m,C,u,a,o,i,s,d,M,E,c,r,l,O,q,G,D,T,Y,B,H,K,L,Z,ne,te,ee]}class $l extends ot{constructor(e){super(),lt(this,e,vh,yh,et,{loadExample:21,message:0,params:19,valid:20},null,[-1,-1])}get loadExample(){return this.$$.ctx[21]}get message(){return this.$$.ctx[0]}set message(e){this.$$set({message:e}),Ze()}get params(){return this.$$.ctx[19]}set params(e){this.$$set({params:e}),Ze()}get valid(){return this.$$.ctx[20]}set valid(e){this.$$set({valid:e}),Ze()}}function ia(t,e,n){const r=t.slice();return r[8]=e[n],r}function aa(t){let e,n,r,s,i,l,o=t[3]?"Hide":"Show",a,u,f,c,h,d,p=t[1].length+"",w,v,b,x,A,P,R=t[3]&&la(t);return{c(){e=S("section"),n=S("button"),r=ie("Download"),i=$(),l=S("button"),a=ie(o),f=$(),c=S("span"),h=ie(t[0]),d=ie(": "),w=ie(p),v=ie(" records"),b=$(),R&&R.c(),x=zl(),n.disabled=s=!t[2],y(n,"class","svelte-17s6c9l"),y(l,"class","button svelte-17s6c9l"),y(l,"id","data-show"),l.disabled=u=!(t[3]||t[1].length),y(c,"class","svelte-17s6c9l"),y(e,"class","download svelte-17s6c9l")},m(I,k){X(I,e,k),g(e,n),g(n,r),g(e,i),g(e,l),g(l,a),g(e,f),g(e,c),g(c,h),g(c,d),g(c,w),g(c,v),X(I,b,k),R&&R.m(I,k),X(I,x,k),A||(P=[se(n,"click",t[6]),se(l,"click",t[7])],A=!0)},p(I,k){k&4&&s!==(s=!I[2])&&(n.disabled=s),k&8&&o!==(o=I[3]?"Hide":"Show")&&Se(a,o),k&10&&u!==(u=!(I[3]||I[1].length))&&(l.disabled=u),k&1&&Se(h,I[0]),k&2&&p!==(p=I[1].length+"")&&Se(w,p),I[3]?R?R.p(I,k):(R=la(I),R.c(),R.m(x.parentNode,x)):R&&(R.d(1),R=null)},d(I){I&&(W(e),W(b),W(x)),R&&R.d(I),A=!1,De(P)}}}function la(t){let e,n,r,s,i,l,o,a,u,f=t[5]&&oa(),c=t[4]&&ua(),h=At(t[1]),d=[];for(let p=0;p<h.length;p+=1)d[p]=ha(ia(t,h,p));return{c(){e=S("div"),n=S("table"),r=S("thead"),s=S("tr"),i=S("th"),i.textContent="Text",l=$(),f&&f.c(),o=$(),c&&c.c(),a=$(),u=S("tbody");for(let p=0;p<d.length;p+=1)d[p].c();y(i,"class","svelte-17s6c9l"),y(r,"class","svelte-17s6c9l"),y(n,"class","svelte-17s6c9l"),y(e,"class","table svelte-17s6c9l")},m(p,w){X(p,e,w),g(e,n),g(n,r),g(r,s),g(s,i),g(s,l),f&&f.m(s,null),g(s,o),c&&c.m(s,null),g(n,a),g(n,u);for(let v=0;v<d.length;v+=1)d[v]&&d[v].m(u,null)},p(p,w){if(p[5]?f||(f=oa(),f.c(),f.m(s,o)):f&&(f.d(1),f=null),p[4]?c||(c=ua(),c.c(),c.m(s,null)):c&&(c.d(1),c=null),w&50){h=At(p[1]);let v;for(v=0;v<h.length;v+=1){const b=ia(p,h,v);d[v]?d[v].p(b,w):(d[v]=ha(b),d[v].c(),d[v].m(u,null))}for(;v<d.length;v+=1)d[v].d(1);d.length=h.length}},d(p){p&&W(e),f&&f.d(),c&&c.d(),In(d,p)}}}function oa(t){let e;return{c(){e=S("th"),e.textContent="Label",y(e,"class","svelte-17s6c9l")},m(n,r){X(n,e,r)},d(n){n&&W(e)}}}function ua(t){let e;return{c(){e=S("th"),e.textContent="Prediction",y(e,"class","svelte-17s6c9l")},m(n,r){X(n,e,r)},d(n){n&&W(e)}}}function ca(t){let e,n=t[8].label+"",r;return{c(){e=S("td"),r=ie(n),y(e,"class","svelte-17s6c9l")},m(s,i){X(s,e,i),g(e,r)},p(s,i){i&2&&n!==(n=s[8].label+"")&&Se(r,n)},d(s){s&&W(e)}}}function fa(t){let e,n=t[8].prediction+"",r;return{c(){e=S("td"),r=ie(n),y(e,"class","svelte-17s6c9l")},m(s,i){X(s,e,i),g(e,r)},p(s,i){i&2&&n!==(n=s[8].prediction+"")&&Se(r,n)},d(s){s&&W(e)}}}function ha(t){let e,n,r=t[8].text+"",s,i,l,o,a=t[5]&&ca(t),u=t[4]&&fa(t);return{c(){e=S("tr"),n=S("td"),s=ie(r),i=$(),a&&a.c(),l=$(),u&&u.c(),o=$(),y(n,"class","svelte-17s6c9l"),y(e,"class","svelte-17s6c9l")},m(f,c){X(f,e,c),g(e,n),g(n,s),g(e,i),a&&a.m(e,null),g(e,l),u&&u.m(e,null),g(e,o)},p(f,c){c&2&&r!==(r=f[8].text+"")&&Se(s,r),f[5]?a?a.p(f,c):(a=ca(f),a.c(),a.m(e,l)):a&&(a.d(1),a=null),f[4]?u?u.p(f,c):(u=fa(f),u.c(),u.m(e,o)):u&&(u.d(1),u=null)},d(f){f&&W(e),a&&a.d(),u&&u.d()}}}function bh(t){let e,n=t[1].length&&aa(t);return{c(){e=S("main"),n&&n.c()},m(r,s){X(r,e,s),n&&n.m(e,null)},p(r,[s]){r[1].length?n?n.p(r,s):(n=aa(r),n.c(),n.m(e,null)):n&&(n.d(1),n=null)},i:ye,o:ye,d(r){r&&W(e),n&&n.d()}}}function xh(t,e,n){let r,s,{fileName:i=""}=e,{data:l=[]}=e,{canDownload:o=!0}=e,a=!1;const u=()=>{const c=new Blob([l.map(p=>JSON.stringify(p)).join(`
`)],{type:"text/plain"}),h=URL.createObjectURL(c),d=document.createElement("a");d.href=h,d.download=i,d.click(),URL.revokeObjectURL(h)},f=()=>{(a||l.length)&&n(3,a=!a)};return t.$$set=c=>{"fileName"in c&&n(0,i=c.fileName),"data"in c&&n(1,l=c.data),"canDownload"in c&&n(2,o=c.canDownload)},t.$$.update=()=>{t.$$.dirty&2&&n(5,r=l.length>0&&"label"in l[0]),t.$$.dirty&2&&n(4,s=l.length>0&&"prediction"in l[0])},[i,l,o,a,s,r,u,f]}class ks extends ot{constructor(e){super(),lt(this,e,xh,bh,et,{fileName:0,data:1,canDownload:2})}}var Ss={exports:{}},Es={exports:{}},ht={},Bn={exports:{}},Rs={exports:{}};(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(n){return function(...r){var s=r.pop();return n.call(this,r,s)}},t.exports=e.default})(Rs,Rs.exports);var Ch=Rs.exports,St={};Object.defineProperty(St,"__esModule",{value:!0});St.fallback=Ll;St.wrap=Fl;var Ah=St.hasQueueMicrotask=typeof queueMicrotask=="function"&&queueMicrotask,kh=St.hasSetImmediate=typeof setImmediate=="function"&&setImmediate,Sh=St.hasNextTick=typeof process=="object"&&typeof process.nextTick=="function";function Ll(t){setTimeout(t,0)}function Fl(t){return(e,...n)=>t(()=>e(...n))}var wn;Ah?wn=queueMicrotask:kh?wn=setImmediate:Sh?wn=process.nextTick:wn=Ll;St.default=Fl(wn);var da;function Eh(){return da||(da=1,function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=a;var n=Ch,r=o(n),s=St,i=o(s),l=ai();function o(c){return c&&c.__esModule?c:{default:c}}function a(c){return(0,l.isAsync)(c)?function(...h){const d=h.pop(),p=c.apply(this,h);return u(p,d)}:(0,r.default)(function(h,d){var p;try{p=c.apply(this,h)}catch(w){return d(w)}if(p&&typeof p.then=="function")return u(p,d);d(null,p)})}function u(c,h){return c.then(d=>{f(h,null,d)},d=>{f(h,d&&(d instanceof Error||d.message)?d:new Error(d))})}function f(c,h,d){try{c(h,d)}catch(p){(0,i.default)(w=>{throw w},p)}}t.exports=e.default}(Bn,Bn.exports)),Bn.exports}var pa;function ai(){if(pa)return ht;pa=1,Object.defineProperty(ht,"__esModule",{value:!0}),ht.isAsyncIterable=ht.isAsyncGenerator=ht.isAsync=void 0;var t=Eh(),e=n(t);function n(o){return o&&o.__esModule?o:{default:o}}function r(o){return o[Symbol.toStringTag]==="AsyncFunction"}function s(o){return o[Symbol.toStringTag]==="AsyncGenerator"}function i(o){return typeof o[Symbol.asyncIterator]=="function"}function l(o){if(typeof o!="function")throw new Error("expected a function");return r(o)?(0,e.default)(o):o}return ht.default=l,ht.isAsync=r,ht.isAsyncGenerator=s,ht.isAsyncIterable=i,ht}(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=i;var n=ai(),r=s(n);function s(l){return l&&l.__esModule?l:{default:l}}function i(l,o,a,u){o=o||[];var f=[],c=0,h=(0,r.default)(a);return l(o,(d,p,w)=>{var v=c++;h(d,(b,x)=>{f[v]=x,w(b)})},d=>{u(d,f)})}t.exports=e.default})(Es,Es.exports);var Rh=Es.exports,Ps={exports:{}},Is={exports:{}};(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=n;function n(r){function s(...i){if(r!==null){var l=r;r=null,l.apply(this,i)}}return Object.assign(s,r),s}t.exports=e.default})(Is,Is.exports);var Ph=Is.exports,Ms={exports:{}},Os={exports:{}};(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=n;function n(r){return r&&typeof r.length=="number"&&r.length>=0&&r.length%1===0}t.exports=e.default})(Os,Os.exports);var Ih=Os.exports,Ns={exports:{}};(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(n){return n[Symbol.iterator]&&n[Symbol.iterator]()},t.exports=e.default})(Ns,Ns.exports);var Mh=Ns.exports;(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=f;var n=Ih,r=l(n),s=Mh,i=l(s);function l(c){return c&&c.__esModule?c:{default:c}}function o(c){var h=-1,d=c.length;return function(){return++h<d?{value:c[h],key:h}:null}}function a(c){var h=-1;return function(){var p=c.next();return p.done?null:(h++,{value:p.value,key:h})}}function u(c){var h=c?Object.keys(c):[],d=-1,p=h.length;return function w(){var v=h[++d];return v==="__proto__"?w():d<p?{value:c[v],key:v}:null}}function f(c){if((0,r.default)(c))return o(c);var h=(0,i.default)(c);return h?a(h):u(c)}t.exports=e.default})(Ms,Ms.exports);var Oh=Ms.exports,Ts={exports:{}};(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=n;function n(r){return function(...s){if(r===null)throw new Error("Callback was already called.");var i=r;r=null,i.apply(this,s)}}t.exports=e.default})(Ts,Ts.exports);var Nh=Ts.exports,$s={exports:{}},Ls={exports:{}};(function(t,e){Object.defineProperty(e,"__esModule",{value:!0});const n={};e.default=n,t.exports=e.default})(Ls,Ls.exports);var Dl=Ls.exports;(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=i;var n=Dl,r=s(n);function s(l){return l&&l.__esModule?l:{default:l}}function i(l,o,a,u){let f=!1,c=!1,h=!1,d=0,p=0;function w(){d>=o||h||f||(h=!0,l.next().then(({value:x,done:A})=>{if(!(c||f)){if(h=!1,A){f=!0,d<=0&&u(null);return}d++,a(x,p,v),p++,w()}}).catch(b))}function v(x,A){if(d-=1,!c){if(x)return b(x);if(x===!1){f=!0,c=!0;return}if(A===r.default||f&&d<=0)return f=!0,u(null);w()}}function b(x){c||(h=!1,f=!0,u(x))}w()}t.exports=e.default})($s,$s.exports);var Th=$s.exports;(function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=Ph,r=d(n),s=Oh,i=d(s),l=Nh,o=d(l),a=ai(),u=Th,f=d(u),c=Dl,h=d(c);function d(p){return p&&p.__esModule?p:{default:p}}e.default=p=>(w,v,b)=>{if(b=(0,r.default)(b),p<=0)throw new RangeError("concurrency limit cannot be less than 1");if(!w)return b(null);if((0,a.isAsyncGenerator)(w))return(0,f.default)(w,p,v,b);if((0,a.isAsyncIterable)(w))return(0,f.default)(w[Symbol.asyncIterator](),p,v,b);var x=(0,i.default)(w),A=!1,P=!1,R=0,I=!1;function k(m,C){if(!P)if(R-=1,m)A=!0,b(m);else if(m===!1)A=!0,P=!0;else{if(C===h.default||A&&R<=0)return A=!0,b(null);I||_()}}function _(){for(I=!0;R<p&&!A;){var m=x();if(m===null){A=!0,R<=0&&b(null);return}R+=1,v(m.value,m.key,(0,o.default)(k))}I=!1}_()},t.exports=e.default})(Ps,Ps.exports);var $h=Ps.exports,Fs={exports:{}};(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=n;function n(r,s){if(s||(s=r.length),!s)throw new Error("arity is undefined");function i(...l){return typeof l[s-1]=="function"?r.apply(this,l):new Promise((o,a)=>{l[s-1]=(u,...f)=>{if(u)return a(u);o(f.length>1?f:f[0])},r.apply(this,l)})}return i}t.exports=e.default})(Fs,Fs.exports);var Lh=Fs.exports;(function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=Rh,r=a(n),s=$h,i=a(s),l=Lh,o=a(l);function a(f){return f&&f.__esModule?f:{default:f}}function u(f,c,h,d){return(0,r.default)((0,i.default)(c),f,h,d)}e.default=(0,o.default)(u,4),t.exports=e.default})(Ss,Ss.exports);var Fh=Ss.exports;const Dh=nl(Fh);function qh(t,e,n){let{results:r=[]}=e,{running:s=!1}=e;const i=async(a,{prompt:u,model:f="gpt-3.5-turbo",max_tokens:c=20,temperature:h=.1,postprocess_fun:d=x=>x,default_class:p="",whitelist:w=null,retries:v=1},b=!1)=>{const x=JSON.stringify({text:a,prompt:u,model:f,max_tokens:c,temperature:h,postprocess_fun:d.toString(),default_class:p,whitelist:w,retries:v}),A=localStorage.getItem(x);if(A!==null)return b&&await new Promise(k=>setTimeout(k,10)),JSON.parse(A);if(b)throw new Error("Not in cache");let P=0,R=null;for(let k=0;k<v;k++){P+=1,R=(await qr.chat.completions.create({messages:[{role:"system",content:u},{role:"user",content:a}],model:f,max_tokens:c,temperature:h})).choices[0].message.content||"";const m=d(R);if(m===null||w!==null&&!w.includes(m))continue;const C={raw_prediction:R,prediction:m,requests:P};return localStorage.setItem(x,JSON.stringify(C)),C}const I={raw_prediction:R,prediction:p.length>0?p:null,requests:P};return localStorage.setItem(x,JSON.stringify(I)),I},l=a=>{let u=0,f=0;for(let c of a)c.prediction===c.label&&(u+=1),f+=1;return u/f},o=async(a,{prompt:u,model:f,max_tokens:c=20,temperature:h=.1,postprocess_fun:d=A=>A,default_class:p="",whitelist:w=null,retries:v=1,threads:b=4},x=!1)=>{if(!x&&!await Nl())return;n(1,s=!0);const A=a.map((R,I)=>({row:R,index:I})),P=new Map;return n(0,r=[]),new Promise((R,I)=>{Dh(A,b,async({row:k,index:_})=>{try{let m=await i(k.text,{prompt:u,model:f,max_tokens:c,temperature:h,postprocess_fun:d,default_class:p,whitelist:w,retries:v},x);for(P.set(_,{...k,...m});P.has(r.length);){const C=r.length,M=P.get(C);n(0,r=[...r,M]),P.delete(C)}}catch(m){if(m.message=="Not in cache")throw m;n(1,s=!1),I(m)}},k=>{n(1,s=!1),k?k.message=="Not in cache"?o(a,{prompt:u,model:f,max_tokens:c,temperature:h,postprocess_fun:d,default_class:p,whitelist:w,retries:v,threads:b},!1).then(R):(alert(k),I(k)):R()})})};return t.$$set=a=>{"results"in a&&n(0,r=a.results),"running"in a&&n(1,s=a.running)},[r,s,l,o]}class ql extends ot{constructor(e){super(),lt(this,e,qh,null,et,{results:0,running:1,accuracy:2,process:3})}get results(){return this.$$.ctx[0]}set results(e){this.$$set({results:e}),Ze()}get running(){return this.$$.ctx[1]}set running(e){this.$$set({running:e}),Ze()}get accuracy(){return this.$$.ctx[2]}get process(){return this.$$.ctx[3]}}function ma(t){let e,n,r,s,i,l,o=t[2].length+"",a,u,f=t[1].length+"",c;return{c(){e=S("div"),n=S("progress"),i=$(),l=S("div"),a=ie(o),u=ie("/"),c=ie(f),y(n,"id","progress-bar"),n.value=r=t[2].length,y(n,"max",s=t[1].length),y(n,"class","svelte-nqwsfv"),y(l,"class","progress-message svelte-nqwsfv"),y(e,"class","progress svelte-nqwsfv")},m(h,d){X(h,e,d),g(e,n),g(e,i),g(e,l),g(l,a),g(l,u),g(l,c)},p(h,d){d&4&&r!==(r=h[2].length)&&(n.value=r),d&2&&s!==(s=h[1].length)&&y(n,"max",s),d&4&&o!==(o=h[2].length+"")&&Se(a,o),d&2&&f!==(f=h[1].length+"")&&Se(c,f)},d(h){h&&W(e)}}}function _a(t){let e,n,r=t[9].accuracy(t[2])+"",s;return{c(){e=S("div"),n=ie("Accuracy: "),s=ie(r),y(e,"class","results svelte-nqwsfv")},m(i,l){X(i,e,l),g(e,n),g(e,s)},p(i,l){l&516&&r!==(r=i[9].accuracy(i[2])+"")&&Se(s,r)},d(i){i&&W(e)}}}function jh(t){let e,n,r,s,i,l,o,a,u,f,c,h,d,p,w,v,b,x,A,P,R,I,k,_,m,C,M,E,O,q,G,D,T,Y,B,H,K,L,Z,ne;function te(j){t[13](j)}function ee(j){t[14](j)}let z={};t[0]!==void 0&&(z.fileName=t[0]),t[1]!==void 0&&(z.data=t[1]),c=new Hs({props:z}),we.push(()=>je(c,"fileName",te)),we.push(()=>je(c,"data",ee)),t[15](c);function F(j){t[16](j)}function N(j){t[17](j)}let J={};t[7]!==void 0&&(J.params=t[7]),t[8]!==void 0&&(J.valid=t[8]),w=new $l({props:J}),we.push(()=>je(w,"params",F)),we.push(()=>je(w,"valid",N)),t[18](w);function fe(j){t[21](j)}function pe(j){t[22](j)}let ae={};t[2]!==void 0&&(ae.results=t[2]),t[3]!==void 0&&(ae.running=t[3]),E=new ql({props:ae}),t[20](E),we.push(()=>je(E,"results",fe)),we.push(()=>je(E,"running",pe));let ue=t[10]&&ma(t);H=new ks({props:{fileName:`${t[11]}-results.jsonl`,data:t[2],canDownload:t[4]}});let Q=t[4]&&_a(t);return{c(){e=S("main"),n=S("section"),n.innerHTML=`<p class="svelte-nqwsfv">Upload a dataset in the Dataset section, enter labelling instructions in
      the Instructions section and make the LLM apply those instructions in the
      Process section.</p>`,r=$(),s=S("section"),i=S("b"),i.textContent="New here?",l=$(),o=S("button"),o.textContent="Load Example",a=$(),u=S("div"),u.textContent=`Load an already labeled example dataset and instructions for this dataset
      (no need for an OpenAI API key to process this example).`,f=$(),We(c.$$.fragment),p=$(),We(w.$$.fragment),x=$(),A=S("section"),P=S("div"),P.textContent="Process",R=$(),I=S("button"),k=ie("Run"),m=$(),C=S("div"),C.innerHTML=`<p class="svelte-nqwsfv">Press Run to make the LLM execute your instructions and label the
        dataset (requires an OpenAI API key).
        <br/> This outputs a new dataset comprising the entries of the initial
        dataset and the labels produced by the LLM.
        <br/> If the initial dataset was already labelled, the two sets of labels
        are compared and the accuracy of the new labels is computed.</p>`,M=$(),We(E.$$.fragment),G=$(),ue&&ue.c(),D=$(),T=S("section"),Y=S("div"),Y.textContent="Results",B=$(),We(H.$$.fragment),K=$(),Q&&Q.c(),y(n,"id","help"),y(n,"class","svelte-nqwsfv"),y(o,"class","smallbutton svelte-nqwsfv"),y(u,"class","message svelte-nqwsfv"),y(s,"id","new"),y(s,"class","svelte-nqwsfv"),y(P,"class","section-title svelte-nqwsfv"),y(I,"class","button svelte-nqwsfv"),y(I,"id","process-run"),I.disabled=_=t[0]===""||!t[8]||t[9].running,y(A,"class","svelte-nqwsfv"),y(Y,"class","section-title svelte-nqwsfv"),y(T,"class","svelte-nqwsfv")},m(j,me){X(j,e,me),g(e,n),g(e,r),g(e,s),g(s,i),g(s,l),g(s,o),g(s,a),g(s,u),g(e,f),$e(c,e,null),g(e,p),$e(w,e,null),g(e,x),g(e,A),g(A,P),g(A,R),g(A,I),g(I,k),g(A,m),g(A,C),g(A,M),$e(E,A,null),g(A,G),ue&&ue.m(A,null),g(e,D),g(e,T),g(T,Y),g(T,B),$e(H,T,null),g(T,K),Q&&Q.m(T,null),L=!0,Z||(ne=[se(o,"click",t[12]),se(I,"click",t[19])],Z=!0)},p(j,[me]){const Ae={};!h&&me&1&&(h=!0,Ae.fileName=j[0],qe(()=>h=!1)),!d&&me&2&&(d=!0,Ae.data=j[1],qe(()=>d=!1)),c.$set(Ae);const Ie={};!v&&me&128&&(v=!0,Ie.params=j[7],qe(()=>v=!1)),!b&&me&256&&(b=!0,Ie.valid=j[8],qe(()=>b=!1)),w.$set(Ie),(!L||me&769&&_!==(_=j[0]===""||!j[8]||j[9].running))&&(I.disabled=_);const Oe={};!O&&me&4&&(O=!0,Oe.results=j[2],qe(()=>O=!1)),!q&&me&8&&(q=!0,Oe.running=j[3],qe(()=>q=!1)),E.$set(Oe),j[10]?ue?ue.p(j,me):(ue=ma(j),ue.c(),ue.m(A,null)):ue&&(ue.d(1),ue=null);const xe={};me&2048&&(xe.fileName=`${j[11]}-results.jsonl`),me&4&&(xe.data=j[2]),me&16&&(xe.canDownload=j[4]),H.$set(xe),j[4]?Q?Q.p(j,me):(Q=_a(j),Q.c(),Q.m(T,null)):Q&&(Q.d(1),Q=null)},i(j){L||(Te(c.$$.fragment,j),Te(w.$$.fragment,j),Te(E.$$.fragment,j),Te(H.$$.fragment,j),L=!0)},o(j){Be(c.$$.fragment,j),Be(w.$$.fragment,j),Be(E.$$.fragment,j),Be(H.$$.fragment,j),L=!1},d(j){j&&W(e),t[15](null),Le(c),t[18](null),Le(w),t[20](null),Le(E),ue&&ue.d(),Le(H),Q&&Q.d(),Z=!1,De(ne)}}}function Bh(t,e,n){let r,s,i,l,o,a="",u,f,c,h,d,p;const w=()=>{l.loadExample(),o.loadExample()};function v(C){a=C,n(0,a)}function b(C){u=C,n(1,u)}function x(C){we[C?"unshift":"push"](()=>{l=C,n(5,l)})}function A(C){f=C,n(7,f)}function P(C){c=C,n(8,c)}function R(C){we[C?"unshift":"push"](()=>{o=C,n(6,o)})}const I=()=>d.process(u,f,l.isFake);function k(C){we[C?"unshift":"push"](()=>{d=C,n(9,d)})}function _(C){h=C,n(2,h)}function m(C){p=C,n(3,p)}return t.$$.update=()=>{t.$$.dirty&1&&n(11,r=a.split(".")[0]),t.$$.dirty&6&&n(4,s=u&&u.length>0&&h.length==u.length),t.$$.dirty&24&&n(10,i=p||s)},[a,u,h,p,s,l,o,f,c,d,i,r,w,v,b,x,A,P,R,I,k,_,m]}class Wh extends ot{constructor(e){super(),lt(this,e,Bh,jh,et,{})}}function Uh(t){let e;return{c(){e=S("main"),e.innerHTML='<svg width="100%" height="400px"></svg> <div class="popup svelte-4flyhw"></div>'},m(n,r){X(n,e,r)},p:ye,i:ye,o:ye,d(n){n&&W(e)}}}function Xh(t,e,n){let{population:r}=e,s,i=2;const l=a=>{let u=a.map((p,w)=>w).sort((p,w)=>a[p].score-a[w].score);a.forEach((p,w)=>a[u[w]].scoreIndex=w);let f=so(a.map(p=>p.level))-io(a.map(p=>p.level)),c=Math.max(5,f)/1e3,h=Math.max(2,a.length-1)/300;a.forEach(p=>(p.x=p.level/c+100,p.y=p.scoreIndex/h+50)),s=a.filter(p=>p.parent!==null).map(p=>({source:p.parent,target:p.id}));let d=Math.min(...a.map(p=>Math.min(...a.map(w=>Math.abs(p.score-w.score)+(Math.abs(p.score-w.score)<1e-9?1:0)))));i=Math.max(2,Math.ceil(Math.log10(1/d)))},o=a=>{const u=nn(".popup"),f=nn("svg");Bu("svg > *").remove(),u.style("display","none");const c=Mf().x(w=>w.x).y(w=>w.y).curve(Of);f.selectAll("path").data(s).enter().append("path").attr("d",w=>{const v=a.find(x=>x.id===w.source),b=a.find(x=>x.id===w.target);if(!(!v||!b))return c([{x:v.x,y:v.y},{x:(v.x+b.x)/2,y:(v.y+b.y)/2},{x:b.x,y:b.y}])}).attr("fill","none").attr("stroke","#ccc").attr("stroke-width",2),f.selectAll("circle").data(a).enter().append("circle").attr("cx",w=>w.x).attr("cy",w=>w.y).attr("r",10).attr("class","node"),f.selectAll("text").data(a).enter().append("text").attr("x",w=>w.x+15).attr("y",w=>w.y+5).attr("class","label").text(w=>w.score.toFixed(i));let h=!1,d=null;function p(w,v){const b=f.node().getBoundingClientRect(),x=window.scrollX+b.left+v.x+15,A=window.scrollY+b.top+v.y;u.style("left",x+"px").style("top",A+"px")}f.selectAll("circle").on("mouseover",function(w,v){if(!h){p(w,v),u.style("display","block");const b=v.text.replace(/</g,"&lt;").replace(/>/g,"&gt;");u.html(`Generation: ${v.level} <br>Score: ${v.score.toFixed(i)} <br>Prompt: <br>${b}`)}}).on("mouseout",function(w,v){h||u.style("display","none")}).on("mousedown",function(w,v){w.stopPropagation();const b=x=>x._groups[0][0].__data__.id;if(d){if(d.classed("selected",!1),h=!1,u.style("display","none"),b(nn(this))==b(d)){d=null;return}d=null}h=!0,d=nn(this),d.classed("selected",!0),p(w,v),u.style("display","block")}),nn("body").on("mousedown",function(){d&&(d.classed("selected",!1),d=null),h&&(h=!1,u.style("display","none"))}),u.on("mousedown",function(w){w.stopPropagation()})};return Kl(()=>{n(0,r)}),t.$$set=a=>{"population"in a&&n(0,r=a.population)},t.$$.update=()=>{t.$$.dirty&1&&l(r),t.$$.dirty&1&&o(r)},[r]}class Hh extends ot{constructor(e){super(),lt(this,e,Xh,Uh,et,{population:0})}}function zh(t,e,n){const r=t.slice();return r[24]=e[n],r}function ga(t){let e,n,r,s,i,l,o,a,u,f,c,h,d,p,w,v,b,x,A,P,R,I,k,_,m,C=At(Tl),M=[];for(let E=0;E<C.length;E+=1)M[E]=Vh(zh(t,C,E));return{c(){e=S("div"),n=S("label"),n.textContent="Model name",r=S("select");for(let E=0;E<M.length;E+=1)M[E].c();s=$(),i=S("div"),l=S("label"),l.textContent="Max prompt tokens",o=S("input"),a=$(),u=S("div"),f=S("label"),f.textContent="Population size",c=S("input"),h=$(),d=S("div"),p=S("label"),p.textContent="Generation multiplier",w=S("input"),v=$(),b=S("div"),x=S("label"),x.textContent="Generations",A=S("input"),P=$(),R=S("div"),I=S("label"),I.textContent="Temperature",k=S("input"),y(n,"for","model"),ze(n,"display","inline-block"),y(n,"class","svelte-rqjf61"),y(r,"id","model"),y(r,"class","svelte-rqjf61"),t[1]===void 0&&Zt(()=>t[18].call(r)),y(l,"for","max-prompt-tokens"),y(l,"class","svelte-rqjf61"),y(o,"type","number"),y(o,"id","max-prompt-tokens"),y(o,"class","svelte-rqjf61"),_e(o,"invalid",t[11]),y(i,"class","input"),y(f,"for","popsize"),y(f,"class","svelte-rqjf61"),y(c,"type","number"),y(c,"id","popsize"),y(c,"class","svelte-rqjf61"),_e(c,"invalid",t[10]),y(u,"class","input"),y(p,"for","genmultiplier"),y(p,"class","svelte-rqjf61"),y(w,"type","number"),y(w,"id","genmultiplier"),y(w,"class","svelte-rqjf61"),_e(w,"invalid",t[9]),y(d,"class","input"),y(x,"for","generations"),y(x,"class","svelte-rqjf61"),y(A,"type","number"),y(A,"id","generations"),y(A,"class","svelte-rqjf61"),_e(A,"invalid",t[8]),y(b,"class","input"),y(I,"for","temperature"),y(I,"class","svelte-rqjf61"),y(k,"type","number"),y(k,"id","temperature"),y(k,"class","svelte-rqjf61"),_e(k,"invalid",t[7]),y(R,"class","input")},m(E,O){X(E,e,O),g(e,n),g(e,r);for(let q=0;q<M.length;q+=1)M[q]&&M[q].m(r,null);Ht(r,t[1],!0),X(E,s,O),X(E,i,O),g(i,l),g(i,o),re(o,t[2]),X(E,a,O),X(E,u,O),g(u,f),g(u,c),re(c,t[3]),X(E,h,O),X(E,d,O),g(d,p),g(d,w),re(w,t[4]),X(E,v,O),X(E,b,O),g(b,x),g(b,A),re(A,t[5]),X(E,P,O),X(E,R,O),g(R,I),g(R,k),re(k,t[6]),_||(m=[se(r,"change",t[18]),se(o,"input",t[19]),se(c,"input",t[20]),se(w,"input",t[21]),se(A,"input",t[22]),se(k,"input",t[23])],_=!0)},p(E,O){O&2&&Ht(r,E[1]),O&4&&ke(o.value)!==E[2]&&re(o,E[2]),O&2048&&_e(o,"invalid",E[11]),O&8&&ke(c.value)!==E[3]&&re(c,E[3]),O&1024&&_e(c,"invalid",E[10]),O&16&&ke(w.value)!==E[4]&&re(w,E[4]),O&512&&_e(w,"invalid",E[9]),O&32&&ke(A.value)!==E[5]&&re(A,E[5]),O&256&&_e(A,"invalid",E[8]),O&64&&ke(k.value)!==E[6]&&re(k,E[6]),O&128&&_e(k,"invalid",E[7])},d(E){E&&(W(e),W(s),W(i),W(a),W(u),W(h),W(d),W(v),W(b),W(P),W(R)),In(M,E),_=!1,De(m)}}}function Vh(t){let e;return{c(){e=S("option"),e.textContent=`${t[24]}`,e.__value=t[24],re(e,e.__value),y(e,"class","svelte-rqjf61")},m(n,r){X(n,e,r)},p:ye,d(n){n&&W(e)}}}function Jh(t){let e,n,r,s,i=t[13]?"Hide":"Show",l,o,a,u,f,c,h,d,p,w,v,b=t[13]&&ga(t);return{c(){e=S("section"),n=S("div"),n.textContent="Meta-Instructions",r=$(),s=S("button"),l=ie(i),o=ie(" advanced options"),a=$(),u=S("div"),u.innerHTML=`Write a set of meta-instructions asking the LLM to rephrase a given set of
    instructions. These meta-instructions will be repeatedly applied to generate
    new labelling instructions.<br/>A suitable example is already provided
    below.`,f=$(),c=S("label"),c.textContent="Meta-instructions",h=$(),d=S("textarea"),p=$(),b&&b.c(),y(n,"class","section-title svelte-rqjf61"),y(s,"class","svelte-rqjf61"),y(u,"class","message svelte-rqjf61"),y(c,"for","metaprompt"),y(c,"class","svelte-rqjf61"),y(d,"id","metaprompt"),y(d,"class","svelte-rqjf61"),_e(d,"invalid",!t[12]),y(e,"id","parameters"),y(e,"class","svelte-rqjf61")},m(x,A){X(x,e,A),g(e,n),g(e,r),g(e,s),g(s,l),g(s,o),g(e,a),g(e,u),g(e,f),g(e,c),g(e,h),g(e,d),re(d,t[0]),g(e,p),b&&b.m(e,null),w||(v=[se(s,"click",t[16]),se(d,"input",t[17])],w=!0)},p(x,[A]){A&8192&&i!==(i=x[13]?"Hide":"Show")&&Se(l,i),A&1&&re(d,x[0]),A&4096&&_e(d,"invalid",!x[12]),x[13]?b?b.p(x,A):(b=ga(x),b.c(),b.m(e,null)):b&&(b.d(1),b=null)},i:ye,o:ye,d(x){x&&W(e),b&&b.d(),w=!1,De(v)}}}function Kh(t,e,n){let r,s,i,l,o,a,u=`Generate a variation of the following instruction while keeping the semantic meaning and the output format:

{prompt}

Output only the new instruction.`,f=!1,c="gpt-3.5-turbo",h=100,d=2,p=3,w=8,v=1,{params:b}=e,{valid:x}=e;const A=()=>{n(13,f=!f)};function P(){u=this.value,n(0,u)}function R(){c=ns(this),n(1,c)}function I(){h=ke(this.value),n(2,h)}function k(){d=ke(this.value),n(3,d)}function _(){p=ke(this.value),n(4,p)}function m(){w=ke(this.value),n(5,w)}function C(){v=ke(this.value),n(6,v)}return t.$$set=M=>{"params"in M&&n(14,b=M.params),"valid"in M&&n(15,x=M.valid)},t.$$.update=()=>{t.$$.dirty&1&&n(12,r=u.includes("{prompt}")),t.$$.dirty&4&&n(11,s=!Number.isInteger(h)||h<0),t.$$.dirty&8&&n(10,i=!Number.isInteger(d)||d<0),t.$$.dirty&16&&n(9,l=!Number.isInteger(p)||p<0),t.$$.dirty&32&&n(8,o=!Number.isInteger(w)||w<0),t.$$.dirty&64&&n(7,a=v<0||v>1),t.$$.dirty&127&&n(14,b={metaprompt:u,model:c,max_prompt_tokens:h,pop_size:d,gen_multiplier:p,generations:w,temperature:v}),t.$$.dirty&8064&&n(15,x=r&&!s&&!i&&!l&&!o&&!a)},[u,c,h,d,p,w,v,a,o,l,i,s,r,f,b,x,A,P,R,I,k,_,m,C]}class Gh extends ot{constructor(e){super(),lt(this,e,Kh,Jh,et,{params:14,valid:15})}}function wa(t){let e;return{c(){e=S("div"),e.textContent="The process will be stopped after the current evaluation.",y(e,"class","message svelte-eywvte")},m(n,r){X(n,e,r)},d(n){n&&W(e)}}}function ya(t){let e,n,r,s,i,l,o=t[10].length+"",a,u,f=t[4].length+"",c;return{c(){e=S("div"),n=S("progress"),i=$(),l=S("div"),a=ie(o),u=ie("/"),c=ie(f),y(n,"id","progress-bar"),n.value=r=t[10].length,y(n,"max",s=t[4].length),y(n,"class","svelte-eywvte"),y(l,"class","progress-message svelte-eywvte"),y(e,"class","progress svelte-eywvte")},m(h,d){X(h,e,d),g(e,n),g(e,i),g(e,l),g(l,a),g(l,u),g(l,c)},p(h,d){d&1024&&r!==(r=h[10].length)&&(n.value=r),d&16&&s!==(s=h[4].length)&&y(n,"max",s),d&1024&&o!==(o=h[10].length+"")&&Se(a,o),d&16&&f!==(f=h[4].length+"")&&Se(c,f)},d(h){h&&W(e)}}}function va(t){let e,n,r,s,i,l=t[13].text+"",o,a,u,f,c=t[13].score+"",h;return{c(){e=S("div"),n=ie(`Best instructions:
        `),r=S("br"),s=$(),i=S("span"),o=ie(l),a=$(),u=S("br"),f=ie(`
        Score: `),h=ie(c),ze(i,"font-family","Courier New, Courier, monospace"),ze(i,"font-weight","normal"),y(e,"class","results svelte-eywvte")},m(d,p){X(d,e,p),g(e,n),g(e,r),g(e,s),g(e,i),g(i,o),g(e,a),g(e,u),g(e,f),g(e,h)},p(d,p){p&8192&&l!==(l=d[13].text+"")&&Se(o,l),p&8192&&c!==(c=d[13].score+"")&&Se(h,c)},d(d){d&&W(e)}}}function Yh(t){let e,n,r,s,i,l,o,a,u,f,c,h,d,p,w,v,b,x,A,P,R,I,k,_,m,C,M,E,O,q,G,D,T,Y,B,H,K,L,Z,ne,te,ee,z,F,N,J,fe,pe;function ae(U){t[16](U)}function ue(U){t[17](U)}let Q={requireLabel:!0};t[3]!==void 0&&(Q.fileName=t[3]),t[4]!==void 0&&(Q.data=t[4]),c=new Hs({props:Q}),we.push(()=>je(c,"fileName",ae)),we.push(()=>je(c,"data",ue)),t[18](c);function j(U){t[19](U)}function me(U){t[20](U)}let Ae={message:"Write initial instructions asking the LLM to label the dataset. They will serve as the starting point of the optimization process."};t[5]!==void 0&&(Ae.params=t[5]),t[6]!==void 0&&(Ae.valid=t[6]),w=new $l({props:Ae}),we.push(()=>je(w,"params",j)),we.push(()=>je(w,"valid",me)),t[21](w);function Ie(U){t[22](U)}function Oe(U){t[23](U)}let xe={};t[7]!==void 0&&(xe.params=t[7]),t[8]!==void 0&&(xe.valid=t[8]),A=new Gh({props:xe}),we.push(()=>je(A,"params",Ie)),we.push(()=>je(A,"valid",Oe));let le=t[12]&&t[11]&&wa(),ce=t[11]&&t[10]&&ya(t);L=new Hh({props:{population:t[0]}});function gt(U){t[27](U)}let de={};t[10]!==void 0&&(de.results=t[10]),ne=new ql({props:de}),t[26](ne),we.push(()=>je(ne,"results",gt));let Ce=t[0].length>0&&va(t);return{c(){e=S("main"),n=S("section"),n.innerHTML=`<p class="svelte-eywvte">In this tab, you can perform automatic prompt optimization to optimize the
      accuracy of the labelling instructions taken as input by the LLM to label
      your dataset.</p> <p class="svelte-eywvte">Upload a labelled dataset in the Dataset section, input starting
      instructions in the Instructions section, input meta-instructions in the
      Meta-instructions section, and start the optimization process in the
      Process section.</p>`,r=$(),s=S("section"),i=S("b"),i.textContent="New here?",l=$(),o=S("button"),o.textContent="Load Example",a=$(),u=S("div"),u.textContent=`Load an already labeled example dataset and instructions for this dataset
      (you need an OpenAI API key to process this example).`,f=$(),We(c.$$.fragment),p=$(),We(w.$$.fragment),x=$(),We(A.$$.fragment),I=$(),k=S("section"),_=S("div"),_.textContent="Optimize",m=$(),C=S("button"),M=ie("Run"),O=$(),q=S("button"),G=ie("Stop"),T=$(),Y=S("div"),Y.textContent=`Press Run to start the optimization process. Successive generations of
      instructions will be generated by repeatedly applying the “mutating”
      meta-instructions. The best sets of instructions of each generation
      survive to the next generation. The graph illustrates which set of
      instructions is a mutation of which. At the end of the process, the best
      set of instructions and its accuracy are output.`,B=$(),le&&le.c(),H=$(),ce&&ce.c(),K=$(),We(L.$$.fragment),Z=$(),We(ne.$$.fragment),ee=$(),z=S("section"),F=S("div"),F.textContent="Results",N=$(),Ce&&Ce.c(),y(n,"id","help"),y(n,"class","svelte-eywvte"),y(o,"class","smallbutton svelte-eywvte"),y(u,"class","message svelte-eywvte"),y(s,"id","new"),y(s,"class","svelte-eywvte"),y(_,"class","section-title svelte-eywvte"),y(C,"class","button svelte-eywvte"),y(C,"id","process-run"),C.disabled=E=t[3]===""||!t[6]||!t[8]||t[11],y(q,"class","button svelte-eywvte"),y(q,"id","process-stop"),q.disabled=D=!t[11]||t[12],y(Y,"class","message svelte-eywvte"),y(k,"class","svelte-eywvte"),y(F,"class","section-title svelte-eywvte"),y(z,"class","svelte-eywvte")},m(U,be){X(U,e,be),g(e,n),g(e,r),g(e,s),g(s,i),g(s,l),g(s,o),g(s,a),g(s,u),g(e,f),$e(c,e,null),g(e,p),$e(w,e,null),g(e,x),$e(A,e,null),g(e,I),g(e,k),g(k,_),g(k,m),g(k,C),g(C,M),g(k,O),g(k,q),g(q,G),g(k,T),g(k,Y),g(k,B),le&&le.m(k,null),g(k,H),ce&&ce.m(k,null),g(k,K),$e(L,k,null),g(e,Z),$e(ne,e,null),g(e,ee),g(e,z),g(z,F),g(z,N),Ce&&Ce.m(z,null),J=!0,fe||(pe=[se(o,"click",t[15]),se(C,"click",t[24]),se(q,"click",t[25])],fe=!0)},p(U,[be]){const Ke={};!h&&be&8&&(h=!0,Ke.fileName=U[3],qe(()=>h=!1)),!d&&be&16&&(d=!0,Ke.data=U[4],qe(()=>d=!1)),c.$set(Ke);const Ge={};!v&&be&32&&(v=!0,Ge.params=U[5],qe(()=>v=!1)),!b&&be&64&&(b=!0,Ge.valid=U[6],qe(()=>b=!1)),w.$set(Ge);const Ye={};!P&&be&128&&(P=!0,Ye.params=U[7],qe(()=>P=!1)),!R&&be&256&&(R=!0,Ye.valid=U[8],qe(()=>R=!1)),A.$set(Ye),(!J||be&2376&&E!==(E=U[3]===""||!U[6]||!U[8]||U[11]))&&(C.disabled=E),(!J||be&6144&&D!==(D=!U[11]||U[12]))&&(q.disabled=D),U[12]&&U[11]?le||(le=wa(),le.c(),le.m(k,H)):le&&(le.d(1),le=null),U[11]&&U[10]?ce?ce.p(U,be):(ce=ya(U),ce.c(),ce.m(k,K)):ce&&(ce.d(1),ce=null);const Ne={};be&1&&(Ne.population=U[0]),L.$set(Ne);const Et={};!te&&be&1024&&(te=!0,Et.results=U[10],qe(()=>te=!1)),ne.$set(Et),U[0].length>0?Ce?Ce.p(U,be):(Ce=va(U),Ce.c(),Ce.m(z,null)):Ce&&(Ce.d(1),Ce=null)},i(U){J||(Te(c.$$.fragment,U),Te(w.$$.fragment,U),Te(A.$$.fragment,U),Te(L.$$.fragment,U),Te(ne.$$.fragment,U),J=!0)},o(U){Be(c.$$.fragment,U),Be(w.$$.fragment,U),Be(A.$$.fragment,U),Be(L.$$.fragment,U),Be(ne.$$.fragment,U),J=!1},d(U){U&&W(e),t[18](null),Le(c),t[21](null),Le(w),Le(A),le&&le.d(),ce&&ce.d(),Le(L),t[26](null),Le(ne),Ce&&Ce.d(),fe=!1,De(pe)}}}function Qh(t,e,n){let r,s,i,l="",o,a=[],u,f,c,h,d,p;const w=async({metaprompt:D,model:T,max_prompt_tokens:Y,temperature:B},H)=>(await qr.chat.completions.create({messages:[{role:"user",content:D.replace("{prompt}",H)}],model:T,max_tokens:Y,temperature:B})).choices[0].message.content||"";let v=!1,b=!1;const x=async(D,{metaprompt:T,model:Y,max_prompt_tokens:B,pop_size:H,gen_multiplier:K,generations:L,temperature:Z},ne)=>{if(v||!await Nl())return;n(11,v=!0),n(0,a=[]);const te=D.prompt;let ee={...D};delete ee.prompt;const z=new Map,F=async J=>{if(z.has(J))return z.get(J);let fe={...ee,prompt:J};return await d.process(ne,fe),d.accuracy(p)};n(0,a=[{id:0,text:te,score:await F(te),parent:null,generation:0,level:0}]);let N=[a[0]];for(let J=1;J<=L;J++){let fe=N.slice();for(let pe of N)for(let ae=0;ae<K;ae++){let ue=await w({metaprompt:T,model:Y,max_prompt_tokens:B,temperature:Z},pe.text),Q={id:a.length+1,text:ue,score:await F(ue),parent:pe.id,generation:J,level:J};if(fe.push(Q),n(0,a=[...a,Q]),b){n(12,b=!1),n(11,v=!1);return}}N=fe,N.sort((pe,ae)=>pe.score-ae.score),N=N.slice(-H)}},A=()=>{s.loadExample(),i.loadExample()};function P(D){l=D,n(3,l)}function R(D){o=D,n(4,o)}function I(D){we[D?"unshift":"push"](()=>{s=D,n(1,s)})}function k(D){u=D,n(5,u)}function _(D){f=D,n(6,f)}function m(D){we[D?"unshift":"push"](()=>{i=D,n(2,i)})}function C(D){c=D,n(7,c)}function M(D){h=D,n(8,h)}const E=()=>x(u,c,o),O=()=>{n(12,b=!0)};function q(D){we[D?"unshift":"push"](()=>{d=D,n(9,d)})}function G(D){p=D,n(10,p)}return t.$$.update=()=>{t.$$.dirty&1&&n(13,r=a.reduce((D,T)=>D.score>T.score?D:T,{score:-1/0}))},[a,s,i,l,o,u,f,c,h,d,p,v,b,r,x,A,P,R,I,k,_,m,C,M,E,O,q,G]}class Zh extends ot{constructor(e){super(),lt(this,e,Qh,Yh,et,{})}}var li={exports:{}};li.exports;(function(t){(function(e,n,r){function s(a){var u=this,f=o();u.next=function(){var c=2091639*u.s0+u.c*23283064365386963e-26;return u.s0=u.s1,u.s1=u.s2,u.s2=c-(u.c=c|0)},u.c=1,u.s0=f(" "),u.s1=f(" "),u.s2=f(" "),u.s0-=f(a),u.s0<0&&(u.s0+=1),u.s1-=f(a),u.s1<0&&(u.s1+=1),u.s2-=f(a),u.s2<0&&(u.s2+=1),f=null}function i(a,u){return u.c=a.c,u.s0=a.s0,u.s1=a.s1,u.s2=a.s2,u}function l(a,u){var f=new s(a),c=u&&u.state,h=f.next;return h.int32=function(){return f.next()*4294967296|0},h.double=function(){return h()+(h()*2097152|0)*11102230246251565e-32},h.quick=h,c&&(typeof c=="object"&&i(c,f),h.state=function(){return i(f,{})}),h}function o(){var a=4022871197,u=function(f){f=String(f);for(var c=0;c<f.length;c++){a+=f.charCodeAt(c);var h=.02519603282416938*a;a=h>>>0,h-=a,h*=a,a=h>>>0,h-=a,a+=h*4294967296}return(a>>>0)*23283064365386963e-26};return u}n&&n.exports?n.exports=l:this.alea=l})(kt,t)})(li);var ed=li.exports,oi={exports:{}};oi.exports;(function(t){(function(e,n,r){function s(o){var a=this,u="";a.x=0,a.y=0,a.z=0,a.w=0,a.next=function(){var c=a.x^a.x<<11;return a.x=a.y,a.y=a.z,a.z=a.w,a.w^=a.w>>>19^c^c>>>8},o===(o|0)?a.x=o:u+=o;for(var f=0;f<u.length+64;f++)a.x^=u.charCodeAt(f)|0,a.next()}function i(o,a){return a.x=o.x,a.y=o.y,a.z=o.z,a.w=o.w,a}function l(o,a){var u=new s(o),f=a&&a.state,c=function(){return(u.next()>>>0)/4294967296};return c.double=function(){do var h=u.next()>>>11,d=(u.next()>>>0)/4294967296,p=(h+d)/(1<<21);while(p===0);return p},c.int32=u.next,c.quick=c,f&&(typeof f=="object"&&i(f,u),c.state=function(){return i(u,{})}),c}n&&n.exports?n.exports=l:this.xor128=l})(kt,t)})(oi);var td=oi.exports,ui={exports:{}};ui.exports;(function(t){(function(e,n,r){function s(o){var a=this,u="";a.next=function(){var c=a.x^a.x>>>2;return a.x=a.y,a.y=a.z,a.z=a.w,a.w=a.v,(a.d=a.d+362437|0)+(a.v=a.v^a.v<<4^(c^c<<1))|0},a.x=0,a.y=0,a.z=0,a.w=0,a.v=0,o===(o|0)?a.x=o:u+=o;for(var f=0;f<u.length+64;f++)a.x^=u.charCodeAt(f)|0,f==u.length&&(a.d=a.x<<10^a.x>>>4),a.next()}function i(o,a){return a.x=o.x,a.y=o.y,a.z=o.z,a.w=o.w,a.v=o.v,a.d=o.d,a}function l(o,a){var u=new s(o),f=a&&a.state,c=function(){return(u.next()>>>0)/4294967296};return c.double=function(){do var h=u.next()>>>11,d=(u.next()>>>0)/4294967296,p=(h+d)/(1<<21);while(p===0);return p},c.int32=u.next,c.quick=c,f&&(typeof f=="object"&&i(f,u),c.state=function(){return i(u,{})}),c}n&&n.exports?n.exports=l:this.xorwow=l})(kt,t)})(ui);var nd=ui.exports,ci={exports:{}};ci.exports;(function(t){(function(e,n,r){function s(o){var a=this;a.next=function(){var f=a.x,c=a.i,h,d;return h=f[c],h^=h>>>7,d=h^h<<24,h=f[c+1&7],d^=h^h>>>10,h=f[c+3&7],d^=h^h>>>3,h=f[c+4&7],d^=h^h<<7,h=f[c+7&7],h=h^h<<13,d^=h^h<<9,f[c]=d,a.i=c+1&7,d};function u(f,c){var h,d=[];if(c===(c|0))d[0]=c;else for(c=""+c,h=0;h<c.length;++h)d[h&7]=d[h&7]<<15^c.charCodeAt(h)+d[h+1&7]<<13;for(;d.length<8;)d.push(0);for(h=0;h<8&&d[h]===0;++h);for(h==8?d[7]=-1:d[h],f.x=d,f.i=0,h=256;h>0;--h)f.next()}u(a,o)}function i(o,a){return a.x=o.x.slice(),a.i=o.i,a}function l(o,a){o==null&&(o=+new Date);var u=new s(o),f=a&&a.state,c=function(){return(u.next()>>>0)/4294967296};return c.double=function(){do var h=u.next()>>>11,d=(u.next()>>>0)/4294967296,p=(h+d)/(1<<21);while(p===0);return p},c.int32=u.next,c.quick=c,f&&(f.x&&i(f,u),c.state=function(){return i(u,{})}),c}n&&n.exports?n.exports=l:this.xorshift7=l})(kt,t)})(ci);var rd=ci.exports,fi={exports:{}};fi.exports;(function(t){(function(e,n,r){function s(o){var a=this;a.next=function(){var f=a.w,c=a.X,h=a.i,d,p;return a.w=f=f+1640531527|0,p=c[h+34&127],d=c[h=h+1&127],p^=p<<13,d^=d<<17,p^=p>>>15,d^=d>>>12,p=c[h]=p^d,a.i=h,p+(f^f>>>16)|0};function u(f,c){var h,d,p,w,v,b=[],x=128;for(c===(c|0)?(d=c,c=null):(c=c+"\0",d=0,x=Math.max(x,c.length)),p=0,w=-32;w<x;++w)c&&(d^=c.charCodeAt((w+32)%c.length)),w===0&&(v=d),d^=d<<10,d^=d>>>15,d^=d<<4,d^=d>>>13,w>=0&&(v=v+1640531527|0,h=b[w&127]^=d+v,p=h==0?p+1:0);for(p>=128&&(b[(c&&c.length||0)&127]=-1),p=127,w=4*128;w>0;--w)d=b[p+34&127],h=b[p=p+1&127],d^=d<<13,h^=h<<17,d^=d>>>15,h^=h>>>12,b[p]=d^h;f.w=v,f.X=b,f.i=p}u(a,o)}function i(o,a){return a.i=o.i,a.w=o.w,a.X=o.X.slice(),a}function l(o,a){o==null&&(o=+new Date);var u=new s(o),f=a&&a.state,c=function(){return(u.next()>>>0)/4294967296};return c.double=function(){do var h=u.next()>>>11,d=(u.next()>>>0)/4294967296,p=(h+d)/(1<<21);while(p===0);return p},c.int32=u.next,c.quick=c,f&&(f.X&&i(f,u),c.state=function(){return i(u,{})}),c}n&&n.exports?n.exports=l:this.xor4096=l})(kt,t)})(fi);var sd=fi.exports,hi={exports:{}};hi.exports;(function(t){(function(e,n,r){function s(o){var a=this,u="";a.next=function(){var c=a.b,h=a.c,d=a.d,p=a.a;return c=c<<25^c>>>7^h,h=h-d|0,d=d<<24^d>>>8^p,p=p-c|0,a.b=c=c<<20^c>>>12^h,a.c=h=h-d|0,a.d=d<<16^h>>>16^p,a.a=p-c|0},a.a=0,a.b=0,a.c=-1640531527,a.d=1367130551,o===Math.floor(o)?(a.a=o/4294967296|0,a.b=o|0):u+=o;for(var f=0;f<u.length+20;f++)a.b^=u.charCodeAt(f)|0,a.next()}function i(o,a){return a.a=o.a,a.b=o.b,a.c=o.c,a.d=o.d,a}function l(o,a){var u=new s(o),f=a&&a.state,c=function(){return(u.next()>>>0)/4294967296};return c.double=function(){do var h=u.next()>>>11,d=(u.next()>>>0)/4294967296,p=(h+d)/(1<<21);while(p===0);return p},c.int32=u.next,c.quick=c,f&&(typeof f=="object"&&i(f,u),c.state=function(){return i(u,{})}),c}n&&n.exports?n.exports=l:this.tychei=l})(kt,t)})(hi);var id=hi.exports,jl={exports:{}};const ad={},ld=Object.freeze(Object.defineProperty({__proto__:null,default:ad},Symbol.toStringTag,{value:"Module"})),od=$f(ld);(function(t){(function(e,n,r){var s=256,i=6,l=52,o="random",a=r.pow(s,i),u=r.pow(2,l),f=u*2,c=s-1,h;function d(P,R,I){var k=[];R=R==!0?{entropy:!0}:R||{};var _=b(v(R.entropy?[P,A(n)]:P??x(),3),k),m=new p(k),C=function(){for(var M=m.g(i),E=a,O=0;M<u;)M=(M+O)*s,E*=s,O=m.g(1);for(;M>=f;)M/=2,E/=2,O>>>=1;return(M+O)/E};return C.int32=function(){return m.g(4)|0},C.quick=function(){return m.g(4)/4294967296},C.double=C,b(A(m.S),n),(R.pass||I||function(M,E,O,q){return q&&(q.S&&w(q,m),M.state=function(){return w(m,{})}),O?(r[o]=M,E):M})(C,_,"global"in R?R.global:this==r,R.state)}function p(P){var R,I=P.length,k=this,_=0,m=k.i=k.j=0,C=k.S=[];for(I||(P=[I++]);_<s;)C[_]=_++;for(_=0;_<s;_++)C[_]=C[m=c&m+P[_%I]+(R=C[_])],C[m]=R;(k.g=function(M){for(var E,O=0,q=k.i,G=k.j,D=k.S;M--;)E=D[q=c&q+1],O=O*s+D[c&(D[q]=D[G=c&G+E])+(D[G]=E)];return k.i=q,k.j=G,O})(s)}function w(P,R){return R.i=P.i,R.j=P.j,R.S=P.S.slice(),R}function v(P,R){var I=[],k=typeof P,_;if(R&&k=="object")for(_ in P)try{I.push(v(P[_],R-1))}catch{}return I.length?I:k=="string"?P:P+"\0"}function b(P,R){for(var I=P+"",k,_=0;_<I.length;)R[c&_]=c&(k^=R[c&_]*19)+I.charCodeAt(_++);return A(R)}function x(){try{var P;return h&&(P=h.randomBytes)?P=P(s):(P=new Uint8Array(s),(e.crypto||e.msCrypto).getRandomValues(P)),A(P)}catch{var R=e.navigator,I=R&&R.plugins;return[+new Date,e,I,e.screen,A(n)]}}function A(P){return String.fromCharCode.apply(0,P)}if(b(r.random(),n),t.exports){t.exports=d;try{h=od}catch{}}else r["seed"+o]=d})(typeof self<"u"?self:kt,[],Math)})(jl);var ud=jl.exports,cd=ed,fd=td,hd=nd,dd=rd,pd=sd,md=id,Ft=ud;Ft.alea=cd;Ft.xor128=fd;Ft.xorwow=hd;Ft.xorshift7=dd;Ft.xor4096=pd;Ft.tychei=md;var _d=Ft;const gd=nl(_d);function wd(t){let e,n,r,s,i,l,o,a,u,f,c,h,d,p,w,v,b,x,A,P,R,I,k,_,m,C,M,E,O,q,G,D,T;function Y(H){t[10](H)}let B={};return t[0]!==void 0&&(B.fileName=t[0]),s=new Hs({props:B}),t[9](s),we.push(()=>je(s,"fileName",Y)),E=new ks({props:{fileName:`${t[6]}-split1.jsonl`,data:t[4]}}),q=new ks({props:{fileName:`${t[6]}-split2.jsonl`,data:t[5]}}),{c(){e=S("main"),n=S("section"),n.textContent=`This tab provides a convenient way to randomly split a dataset in two.
    Upload a (labelled or unlabelled) dataset and input the number of samples
    that should belong to the first of the two resulting datasets.`,r=$(),We(s.$$.fragment),l=$(),o=S("section"),a=S("div"),a.textContent="Parameters",u=$(),f=S("div"),c=S("label"),c.textContent="Number of samples",h=S("input"),d=$(),p=S("div"),w=S("label"),w.textContent="Random seed",v=S("input"),b=$(),x=S("section"),A=S("div"),A.textContent="Split",P=$(),R=S("button"),I=ie("Run"),_=$(),m=S("section"),C=S("div"),C.textContent="Results",M=$(),We(E.$$.fragment),O=$(),We(q.$$.fragment),y(n,"id","help"),y(n,"class","svelte-k9lpbi"),y(a,"class","section-title svelte-k9lpbi"),y(c,"for","k"),y(c,"class","svelte-k9lpbi"),y(h,"type","number"),y(h,"id","k"),y(h,"class","svelte-k9lpbi"),_e(h,"invalid",t[7]),y(f,"class","input"),y(w,"for","seed"),y(w,"class","svelte-k9lpbi"),y(v,"type","text"),y(v,"id","seed"),y(v,"class","svelte-k9lpbi"),y(p,"class","input"),y(o,"id","parameters"),y(o,"class","svelte-k9lpbi"),y(A,"class","section-title svelte-k9lpbi"),y(R,"class","button svelte-k9lpbi"),R.disabled=k=t[0]===""||t[7],y(x,"class","svelte-k9lpbi"),y(C,"class","section-title svelte-k9lpbi"),y(m,"class","svelte-k9lpbi")},m(H,K){X(H,e,K),g(e,n),g(e,r),$e(s,e,null),g(e,l),g(e,o),g(o,a),g(o,u),g(o,f),g(f,c),g(f,h),re(h,t[1]),g(o,d),g(o,p),g(p,w),g(p,v),re(v,t[3]),g(e,b),g(e,x),g(x,A),g(x,P),g(x,R),g(R,I),g(e,_),g(e,m),g(m,C),g(m,M),$e(E,m,null),g(m,O),$e(q,m,null),G=!0,D||(T=[se(h,"input",t[11]),se(v,"input",t[12]),se(R,"click",t[13])],D=!0)},p(H,[K]){const L={};!i&&K&1&&(i=!0,L.fileName=H[0],qe(()=>i=!1)),s.$set(L),K&2&&ke(h.value)!==H[1]&&re(h,H[1]),(!G||K&128)&&_e(h,"invalid",H[7]),K&8&&v.value!==H[3]&&re(v,H[3]),(!G||K&129&&k!==(k=H[0]===""||H[7]))&&(R.disabled=k);const Z={};K&64&&(Z.fileName=`${H[6]}-split1.jsonl`),K&16&&(Z.data=H[4]),E.$set(Z);const ne={};K&64&&(ne.fileName=`${H[6]}-split2.jsonl`),K&32&&(ne.data=H[5]),q.$set(ne)},i(H){G||(Te(s.$$.fragment,H),Te(E.$$.fragment,H),Te(q.$$.fragment,H),G=!0)},o(H){Be(s.$$.fragment,H),Be(E.$$.fragment,H),Be(q.$$.fragment,H),G=!1},d(H){H&&W(e),t[9](null),Le(s),Le(E),Le(q),D=!1,De(T)}}}function yd(t,e,n){let r,s;const i=(b,x,A="")=>{x>b&&(x=b);let P=gd(A),R=new Set(Array.from({length:b},(k,_)=>_)),I=new Set;for(let k=0;k<x;k++){let _=Math.floor(P()*R.size),m=Array.from(R)[_];R.delete(m),I.add(m)}return[Array.from(I).sort(),Array.from(R).sort()]};let l,o="",a="",u=0,f=[],c=[];function h(b){we[b?"unshift":"push"](()=>{l=b,n(2,l)})}function d(b){o=b,n(0,o)}function p(){u=ke(this.value),n(1,u)}function w(){a=this.value,n(3,a)}const v=()=>{let[b,x]=i(l.data.length,u,a);n(4,f=b.map(A=>l.data[A])),n(5,c=x.map(A=>l.data[A]))};return t.$$.update=()=>{t.$$.dirty&2&&n(7,r=!Number.isInteger(u)||u<0),t.$$.dirty&1&&n(6,s=o.split(".")[0])},[o,u,l,a,f,c,s,r,i,h,d,p,w,v]}class vd extends ot{constructor(e){super(),lt(this,e,yd,wd,et,{})}}function ba(t,e,n){const r=t.slice();return r[7]=e[n],r[9]=n,r}function xa(t){let e,n=t[7].name+"",r,s,i,l,o,a;function u(){return t[4](t[9])}return{c(){e=S("button"),r=ie(n),s=S("br"),i=S("span"),i.textContent=`${t[7].phon}`,y(i,"class","phonetics svelte-ljf93f"),y(e,"class",l="tab "+(t[0]==t[9]?"selected":"")+" svelte-ljf93f")},m(f,c){X(f,e,c),g(e,r),g(e,s),g(e,i),o||(a=se(e,"click",u),o=!0)},p(f,c){t=f,c&1&&l!==(l="tab "+(t[0]==t[9]?"selected":"")+" svelte-ljf93f")&&y(e,"class",l)},d(f){f&&W(e),o=!1,a()}}}function Ca(t){let e,n,r;return{c(){e=S("button"),e.textContent="d.skönnect",ze(e,"flex","0.25"),ze(e,"font-size","16px"),ze(e,"white-space","nowrap"),y(e,"class","tab svelte-ljf93f")},m(s,i){X(s,e,i),n||(r=se(e,"click",t[6]),n=!0)},p:ye,d(s){s&&W(e),n=!1,r()}}}function bd(t){let e,n,r,s,i,l,o,a,u,f,c=At(t[3]),h=[];for(let v=0;v<c.length;v+=1)h[v]=xa(ba(t,c,v));let d=t[1]&&Ca(t);var p=t[3][t[0]].component;function w(v,b){return{}}return p&&(o=_i(p,w())),{c(){e=S("header");for(let v=0;v<h.length;v+=1)h[v].c();n=$(),r=S("button"),r.textContent="klear cäche",s=$(),d&&d.c(),i=$(),l=S("main"),o&&We(o.$$.fragment),ze(r,"flex","0.2"),ze(r,"font-size","16px"),y(r,"class","tab svelte-ljf93f"),y(e,"class","tabs svelte-ljf93f")},m(v,b){X(v,e,b);for(let x=0;x<h.length;x+=1)h[x]&&h[x].m(e,null);g(e,n),g(e,r),g(e,s),d&&d.m(e,null),X(v,i,b),X(v,l,b),o&&$e(o,l,null),a=!0,u||(f=se(r,"click",t[5]),u=!0)},p(v,[b]){if(b&13){c=At(v[3]);let x;for(x=0;x<c.length;x+=1){const A=ba(v,c,x);h[x]?h[x].p(A,b):(h[x]=xa(A),h[x].c(),h[x].m(e,n))}for(;x<h.length;x+=1)h[x].d(1);h.length=c.length}if(v[1]?d?d.p(v,b):(d=Ca(v),d.c(),d.m(e,null)):d&&(d.d(1),d=null),b&1&&p!==(p=v[3][v[0]].component)){if(o){eo();const x=o;Be(x.$$.fragment,1,0,()=>{Le(x,1)}),to()}p?(o=_i(p,w()),We(o.$$.fragment),Te(o.$$.fragment,1),$e(o,l,null)):o=null}},i(v){a||(o&&Te(o.$$.fragment,v),a=!0)},o(v){o&&Be(o.$$.fragment,v),a=!1},d(v){v&&(W(e),W(i),W(l)),In(h,v),d&&d.d(),o&&Le(o),u=!1,f()}}}function xd(t,e,n){let r;Xl(t,Nt,f=>n(1,r=f));let s=0;function i(f){n(0,s=f)}return[s,r,i,[{name:"wilköm",phon:"/ˈwɛlkəm/",component:Tf},{name:"evål",phon:"/ɪˈvæl/",component:Wh},{name:"øptim",phon:"/ˈɒptɪm/",component:Zh},{name:"splët",phon:"/splɪt/",component:vd}],f=>i(f),async()=>{const f=r;localStorage.clear(),localStorage.setItem("apiKey",f)},()=>{Hl(Nt,r="",r)}]}class Cd extends ot{constructor(e){super(),lt(this,e,xd,bd,et,{})}}new Cd({target:document.getElementById("app")});
