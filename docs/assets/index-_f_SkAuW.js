var qo=Object.defineProperty;var jo=(t,e,n)=>e in t?qo(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Vr=(t,e,n)=>jo(t,typeof e!="symbol"?e+"":e,n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();function ye(){}function xa(t){return t()}function ps(){return Object.create(null)}function Xe(t){t.forEach(xa)}function Ca(t){return typeof t=="function"}function et(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function zo(t){return Object.keys(t).length===0}function Aa(t,...e){if(t==null){for(const r of e)r(void 0);return ye}const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function ms(t){let e;return Aa(t,n=>e=n)(),e}function Wo(t,e,n){t.$$.on_destroy.push(Aa(e,n))}function Xo(t,e,n){return t.set(n),e}function g(t,e){t.appendChild(e)}function oe(t,e,n){t.insertBefore(e,n||null)}function ae(t){t.parentNode&&t.parentNode.removeChild(t)}function Pn(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function S(t){return document.createElement(t)}function fe(t){return document.createTextNode(t)}function q(){return fe(" ")}function Uo(){return fe("")}function le(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function y(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function be(t){return t===""?null:+t}function Ho(t){return Array.from(t.childNodes)}function Ae(t,e){e=""+e,t.data!==e&&(t.data=e)}function ie(t,e){t.value=e??""}function je(t,e,n,r){n==null?t.style.removeProperty(e):t.style.setProperty(e,n,"")}function Xt(t,e,n){for(let r=0;r<t.options.length;r+=1){const i=t.options[r];if(i.__value===e){i.selected=!0;return}}(!n||e!==void 0)&&(t.selectedIndex=-1)}function ni(t){const e=t.querySelector(":checked");return e&&e.__value}function he(t,e,n){t.classList.toggle(e,!!n)}function _s(t,e){return new t(e)}let bn;function wn(t){bn=t}function Vo(){if(!bn)throw new Error("Function called outside component initialization");return bn}function Jo(t){Vo().$$.on_mount.push(t)}const qt=[],we=[];let Ht=[];const ri=[],Ko=Promise.resolve();let ii=!1;function Go(){ii||(ii=!0,Ko.then(Qe))}function Yt(t){Ht.push(t)}function Be(t){ri.push(t)}const Jr=new Set;let Lt=0;function Qe(){if(Lt!==0)return;const t=bn;do{try{for(;Lt<qt.length;){const e=qt[Lt];Lt++,wn(e),Qo(e.$$)}}catch(e){throw qt.length=0,Lt=0,e}for(wn(null),qt.length=0,Lt=0;we.length;)we.pop()();for(let e=0;e<Ht.length;e+=1){const n=Ht[e];Jr.has(n)||(Jr.add(n),n())}Ht.length=0}while(qt.length);for(;ri.length;)ri.pop()();ii=!1,Jr.clear(),wn(t)}function Qo(t){if(t.fragment!==null){t.update(),Xe(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Yt)}}function Yo(t){const e=[],n=[];Ht.forEach(r=>t.indexOf(r)===-1?e.push(r):n.push(r)),n.forEach(r=>r()),Ht=e}const zn=new Set;let Rt;function Zo(){Rt={r:0,c:[],p:Rt}}function el(){Rt.r||Xe(Rt.c),Rt=Rt.p}function Re(t,e){t&&t.i&&(zn.delete(t),t.i(e))}function Ne(t,e,n,r){if(t&&t.o){if(zn.has(t))return;zn.add(t),Rt.c.push(()=>{zn.delete(t),r&&(n&&t.d(1),r())}),t.o(e)}else r&&r()}function bt(t){return(t==null?void 0:t.length)!==void 0?t:Array.from(t)}function qe(t,e,n){const r=t.$$.props[e];r!==void 0&&(t.$$.bound[r]=n,n(t.$$.ctx[r]))}function $e(t){t&&t.c()}function Pe(t,e,n){const{fragment:r,after_update:i}=t.$$;r&&r.m(e,n),Yt(()=>{const s=t.$$.on_mount.map(xa).filter(Ca);t.$$.on_destroy?t.$$.on_destroy.push(...s):Xe(s),t.$$.on_mount=[]}),i.forEach(Yt)}function Ie(t,e){const n=t.$$;n.fragment!==null&&(Yo(n.after_update),Xe(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function tl(t,e){t.$$.dirty[0]===-1&&(qt.push(t),Go(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function lt(t,e,n,r,i,s,o=null,l=[-1]){const a=bn;wn(t);const u=t.$$={fragment:null,ctx:[],props:s,update:ye,not_equal:i,bound:ps(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(a?a.$$.context:[])),callbacks:ps(),dirty:l,skip_bound:!1,root:e.target||a.$$.root};o&&o(u.root);let c=!1;if(u.ctx=n?n(t,e.props||{},(f,h,...d)=>{const p=d.length?d[0]:h;return u.ctx&&i(u.ctx[f],u.ctx[f]=p)&&(!u.skip_bound&&u.bound[f]&&u.bound[f](p),c&&tl(t,f)),h}):[],u.update(),c=!0,Xe(u.before_update),u.fragment=r?r(u.ctx):!1,e.target){if(e.hydrate){const f=Ho(e.target);u.fragment&&u.fragment.l(f),f.forEach(ae)}else u.fragment&&u.fragment.c();e.intro&&Re(t.$$.fragment),Pe(t,e.target,e.anchor),Qe()}wn(a)}class ut{constructor(){Vr(this,"$$");Vr(this,"$$set")}$destroy(){Ie(this,1),this.$destroy=ye}$on(e,n){if(!Ca(n))return ye;const r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(n),()=>{const i=r.indexOf(n);i!==-1&&r.splice(i,1)}}$set(e){this.$$set&&!zo(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const nl="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(nl);function rl(t,e){let n;for(const r of t)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);return n}function il(t,e){let n;for(const r of t)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);return n}var sl={value:()=>{}};function Sa(){for(var t=0,e=arguments.length,n={},r;t<e;++t){if(!(r=arguments[t]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new Wn(n)}function Wn(t){this._=t}function al(t,e){return t.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}Wn.prototype=Sa.prototype={constructor:Wn,on:function(t,e){var n=this._,r=al(t+"",n),i,s=-1,o=r.length;if(arguments.length<2){for(;++s<o;)if((i=(t=r[s]).type)&&(i=ol(n[i],t.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++s<o;)if(i=(t=r[s]).type)n[i]=gs(n[i],t.name,e);else if(e==null)for(i in n)n[i]=gs(n[i],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Wn(t)},call:function(t,e){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,s;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(s=this._[t],r=0,i=s.length;r<i;++r)s[r].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,s=r.length;i<s;++i)r[i].value.apply(e,n)}};function ol(t,e){for(var n=0,r=t.length,i;n<r;++n)if((i=t[n]).name===e)return i.value}function gs(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=sl,t=t.slice(0,r).concat(t.slice(r+1));break}return n!=null&&t.push({name:e,value:n}),t}var si="http://www.w3.org/1999/xhtml";const ws={svg:"http://www.w3.org/2000/svg",xhtml:si,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function qr(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),ws.hasOwnProperty(e)?{space:ws[e],local:t}:t}function ll(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===si&&e.documentElement.namespaceURI===si?e.createElement(t):e.createElementNS(n,t)}}function ul(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function ka(t){var e=qr(t);return(e.local?ul:ll)(e)}function cl(){}function Di(t){return t==null?cl:function(){return this.querySelector(t)}}function fl(t){typeof t!="function"&&(t=Di(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s=e[i],o=s.length,l=r[i]=new Array(o),a,u,c=0;c<o;++c)(a=s[c])&&(u=t.call(a,a.__data__,c,s))&&("__data__"in a&&(u.__data__=a.__data__),l[c]=u);return new Me(r,this._parents)}function Ea(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function hl(){return[]}function Ra(t){return t==null?hl:function(){return this.querySelectorAll(t)}}function dl(t){return function(){return Ea(t.apply(this,arguments))}}function pl(t){typeof t=="function"?t=dl(t):t=Ra(t);for(var e=this._groups,n=e.length,r=[],i=[],s=0;s<n;++s)for(var o=e[s],l=o.length,a,u=0;u<l;++u)(a=o[u])&&(r.push(t.call(a,a.__data__,u,o)),i.push(a));return new Me(r,i)}function Pa(t){return function(){return this.matches(t)}}function Ia(t){return function(e){return e.matches(t)}}var ml=Array.prototype.find;function _l(t){return function(){return ml.call(this.children,t)}}function gl(){return this.firstElementChild}function wl(t){return this.select(t==null?gl:_l(typeof t=="function"?t:Ia(t)))}var yl=Array.prototype.filter;function vl(){return Array.from(this.children)}function bl(t){return function(){return yl.call(this.children,t)}}function xl(t){return this.selectAll(t==null?vl:bl(typeof t=="function"?t:Ia(t)))}function Cl(t){typeof t!="function"&&(t=Pa(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s=e[i],o=s.length,l=r[i]=[],a,u=0;u<o;++u)(a=s[u])&&t.call(a,a.__data__,u,s)&&l.push(a);return new Me(r,this._parents)}function Ma(t){return new Array(t.length)}function Al(){return new Me(this._enter||this._groups.map(Ma),this._parents)}function sr(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}sr.prototype={constructor:sr,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function Sl(t){return function(){return t}}function kl(t,e,n,r,i,s){for(var o=0,l,a=e.length,u=s.length;o<u;++o)(l=e[o])?(l.__data__=s[o],r[o]=l):n[o]=new sr(t,s[o]);for(;o<a;++o)(l=e[o])&&(i[o]=l)}function El(t,e,n,r,i,s,o){var l,a,u=new Map,c=e.length,f=s.length,h=new Array(c),d;for(l=0;l<c;++l)(a=e[l])&&(h[l]=d=o.call(a,a.__data__,l,e)+"",u.has(d)?i[l]=a:u.set(d,a));for(l=0;l<f;++l)d=o.call(t,s[l],l,s)+"",(a=u.get(d))?(r[l]=a,a.__data__=s[l],u.delete(d)):n[l]=new sr(t,s[l]);for(l=0;l<c;++l)(a=e[l])&&u.get(h[l])===a&&(i[l]=a)}function Rl(t){return t.__data__}function Pl(t,e){if(!arguments.length)return Array.from(this,Rl);var n=e?El:kl,r=this._parents,i=this._groups;typeof t!="function"&&(t=Sl(t));for(var s=i.length,o=new Array(s),l=new Array(s),a=new Array(s),u=0;u<s;++u){var c=r[u],f=i[u],h=f.length,d=Il(t.call(c,c&&c.__data__,u,r)),p=d.length,w=l[u]=new Array(p),v=o[u]=new Array(p),x=a[u]=new Array(h);n(c,f,w,v,x,d,e);for(var C=0,R=0,M,E;C<p;++C)if(M=w[C]){for(C>=R&&(R=C+1);!(E=v[R])&&++R<p;);M._next=E||null}}return o=new Me(o,r),o._enter=l,o._exit=a,o}function Il(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Ml(){return new Me(this._exit||this._groups.map(Ma),this._parents)}function Ol(t,e,n){var r=this.enter(),i=this,s=this.exit();return typeof t=="function"?(r=t(r),r&&(r=r.selection())):r=r.append(t+""),e!=null&&(i=e(i),i&&(i=i.selection())),n==null?s.remove():n(s),r&&i?r.merge(i).order():i}function Nl(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,i=n.length,s=r.length,o=Math.min(i,s),l=new Array(i),a=0;a<o;++a)for(var u=n[a],c=r[a],f=u.length,h=l[a]=new Array(f),d,p=0;p<f;++p)(d=u[p]||c[p])&&(h[p]=d);for(;a<i;++a)l[a]=n[a];return new Me(l,this._parents)}function $l(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r=t[e],i=r.length-1,s=r[i],o;--i>=0;)(o=r[i])&&(s&&o.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(o,s),s=o);return this}function Tl(t){t||(t=Fl);function e(f,h){return f&&h?t(f.__data__,h.__data__):!f-!h}for(var n=this._groups,r=n.length,i=new Array(r),s=0;s<r;++s){for(var o=n[s],l=o.length,a=i[s]=new Array(l),u,c=0;c<l;++c)(u=o[c])&&(a[c]=u);a.sort(e)}return new Me(i,this._parents).order()}function Fl(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Ll(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function Dl(){return Array.from(this)}function Bl(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,s=r.length;i<s;++i){var o=r[i];if(o)return o}return null}function ql(){let t=0;for(const e of this)++t;return t}function jl(){return!this.node()}function zl(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i=e[n],s=0,o=i.length,l;s<o;++s)(l=i[s])&&t.call(l,l.__data__,s,i);return this}function Wl(t){return function(){this.removeAttribute(t)}}function Xl(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Ul(t,e){return function(){this.setAttribute(t,e)}}function Hl(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function Vl(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function Jl(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function Kl(t,e){var n=qr(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((e==null?n.local?Xl:Wl:typeof e=="function"?n.local?Jl:Vl:n.local?Hl:Ul)(n,e))}function Oa(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Gl(t){return function(){this.style.removeProperty(t)}}function Ql(t,e,n){return function(){this.style.setProperty(t,e,n)}}function Yl(t,e,n){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function Zl(t,e,n){return arguments.length>1?this.each((e==null?Gl:typeof e=="function"?Yl:Ql)(t,e,n??"")):Zt(this.node(),t)}function Zt(t,e){return t.style.getPropertyValue(e)||Oa(t).getComputedStyle(t,null).getPropertyValue(e)}function eu(t){return function(){delete this[t]}}function tu(t,e){return function(){this[t]=e}}function nu(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function ru(t,e){return arguments.length>1?this.each((e==null?eu:typeof e=="function"?nu:tu)(t,e)):this.node()[t]}function Na(t){return t.trim().split(/^|\s+/)}function Bi(t){return t.classList||new $a(t)}function $a(t){this._node=t,this._names=Na(t.getAttribute("class")||"")}$a.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function Ta(t,e){for(var n=Bi(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function Fa(t,e){for(var n=Bi(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function iu(t){return function(){Ta(this,t)}}function su(t){return function(){Fa(this,t)}}function au(t,e){return function(){(e.apply(this,arguments)?Ta:Fa)(this,t)}}function ou(t,e){var n=Na(t+"");if(arguments.length<2){for(var r=Bi(this.node()),i=-1,s=n.length;++i<s;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof e=="function"?au:e?iu:su)(n,e))}function lu(){this.textContent=""}function uu(t){return function(){this.textContent=t}}function cu(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function fu(t){return arguments.length?this.each(t==null?lu:(typeof t=="function"?cu:uu)(t)):this.node().textContent}function hu(){this.innerHTML=""}function du(t){return function(){this.innerHTML=t}}function pu(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function mu(t){return arguments.length?this.each(t==null?hu:(typeof t=="function"?pu:du)(t)):this.node().innerHTML}function _u(){this.nextSibling&&this.parentNode.appendChild(this)}function gu(){return this.each(_u)}function wu(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function yu(){return this.each(wu)}function vu(t){var e=typeof t=="function"?t:ka(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function bu(){return null}function xu(t,e){var n=typeof t=="function"?t:ka(t),r=e==null?bu:typeof e=="function"?e:Di(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function Cu(){var t=this.parentNode;t&&t.removeChild(this)}function Au(){return this.each(Cu)}function Su(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function ku(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Eu(t){return this.select(t?ku:Su)}function Ru(t){return arguments.length?this.property("__data__",t):this.node().__data__}function Pu(t){return function(e){t.call(this,e,this.__data__)}}function Iu(t){return t.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");return r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),{type:e,name:n}})}function Mu(t){return function(){var e=this.__on;if(e){for(var n=0,r=-1,i=e.length,s;n<i;++n)s=e[n],(!t.type||s.type===t.type)&&s.name===t.name?this.removeEventListener(s.type,s.listener,s.options):e[++r]=s;++r?e.length=r:delete this.__on}}}function Ou(t,e,n){return function(){var r=this.__on,i,s=Pu(e);if(r){for(var o=0,l=r.length;o<l;++o)if((i=r[o]).type===t.type&&i.name===t.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=s,i.options=n),i.value=e;return}}this.addEventListener(t.type,s,n),i={type:t.type,name:t.name,value:e,listener:s,options:n},r?r.push(i):this.__on=[i]}}function Nu(t,e,n){var r=Iu(t+""),i,s=r.length,o;if(arguments.length<2){var l=this.node().__on;if(l){for(var a=0,u=l.length,c;a<u;++a)for(i=0,c=l[a];i<s;++i)if((o=r[i]).type===c.type&&o.name===c.name)return c.value}return}for(l=e?Ou:Mu,i=0;i<s;++i)this.each(l(r[i],e,n));return this}function La(t,e,n){var r=Oa(t),i=r.CustomEvent;typeof i=="function"?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function $u(t,e){return function(){return La(this,t,e)}}function Tu(t,e){return function(){return La(this,t,e.apply(this,arguments))}}function Fu(t,e){return this.each((typeof e=="function"?Tu:$u)(t,e))}function*Lu(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,s=r.length,o;i<s;++i)(o=r[i])&&(yield o)}var qi=[null];function Me(t,e){this._groups=t,this._parents=e}function In(){return new Me([[document.documentElement]],qi)}function Du(){return this}Me.prototype=In.prototype={constructor:Me,select:fl,selectAll:pl,selectChild:wl,selectChildren:xl,filter:Cl,data:Pl,enter:Al,exit:Ml,join:Ol,merge:Nl,selection:Du,order:$l,sort:Tl,call:Ll,nodes:Dl,node:Bl,size:ql,empty:jl,each:zl,attr:Kl,style:Zl,property:ru,classed:ou,text:fu,html:mu,raise:gu,lower:yu,append:vu,insert:xu,remove:Au,clone:Eu,datum:Ru,on:Nu,dispatch:Fu,[Symbol.iterator]:Lu};function tn(t){return typeof t=="string"?new Me([[document.querySelector(t)]],[document.documentElement]):new Me([[t]],qi)}function Bu(t){return typeof t=="string"?new Me([document.querySelectorAll(t)],[document.documentElement]):new Me([Ea(t)],qi)}function ji(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Da(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Mn(){}var xn=.7,ar=1/xn,Vt="\\s*([+-]?\\d+)\\s*",Cn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ot="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",qu=/^#([0-9a-f]{3,8})$/,ju=new RegExp(`^rgb\\(${Vt},${Vt},${Vt}\\)$`),zu=new RegExp(`^rgb\\(${ot},${ot},${ot}\\)$`),Wu=new RegExp(`^rgba\\(${Vt},${Vt},${Vt},${Cn}\\)$`),Xu=new RegExp(`^rgba\\(${ot},${ot},${ot},${Cn}\\)$`),Uu=new RegExp(`^hsl\\(${Cn},${ot},${ot}\\)$`),Hu=new RegExp(`^hsla\\(${Cn},${ot},${ot},${Cn}\\)$`),ys={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};ji(Mn,An,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:vs,formatHex:vs,formatHex8:Vu,formatHsl:Ju,formatRgb:bs,toString:bs});function vs(){return this.rgb().formatHex()}function Vu(){return this.rgb().formatHex8()}function Ju(){return Ba(this).formatHsl()}function bs(){return this.rgb().formatRgb()}function An(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=qu.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?xs(e):n===3?new Te(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?$n(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?$n(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=ju.exec(t))?new Te(e[1],e[2],e[3],1):(e=zu.exec(t))?new Te(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=Wu.exec(t))?$n(e[1],e[2],e[3],e[4]):(e=Xu.exec(t))?$n(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=Uu.exec(t))?Ss(e[1],e[2]/100,e[3]/100,1):(e=Hu.exec(t))?Ss(e[1],e[2]/100,e[3]/100,e[4]):ys.hasOwnProperty(t)?xs(ys[t]):t==="transparent"?new Te(NaN,NaN,NaN,0):null}function xs(t){return new Te(t>>16&255,t>>8&255,t&255,1)}function $n(t,e,n,r){return r<=0&&(t=e=n=NaN),new Te(t,e,n,r)}function Ku(t){return t instanceof Mn||(t=An(t)),t?(t=t.rgb(),new Te(t.r,t.g,t.b,t.opacity)):new Te}function ai(t,e,n,r){return arguments.length===1?Ku(t):new Te(t,e,n,r??1)}function Te(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}ji(Te,ai,Da(Mn,{brighter(t){return t=t==null?ar:Math.pow(ar,t),new Te(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?xn:Math.pow(xn,t),new Te(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Te(Ot(this.r),Ot(this.g),Ot(this.b),or(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Cs,formatHex:Cs,formatHex8:Gu,formatRgb:As,toString:As}));function Cs(){return`#${Pt(this.r)}${Pt(this.g)}${Pt(this.b)}`}function Gu(){return`#${Pt(this.r)}${Pt(this.g)}${Pt(this.b)}${Pt((isNaN(this.opacity)?1:this.opacity)*255)}`}function As(){const t=or(this.opacity);return`${t===1?"rgb(":"rgba("}${Ot(this.r)}, ${Ot(this.g)}, ${Ot(this.b)}${t===1?")":`, ${t})`}`}function or(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Ot(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Pt(t){return t=Ot(t),(t<16?"0":"")+t.toString(16)}function Ss(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Ye(t,e,n,r)}function Ba(t){if(t instanceof Ye)return new Ye(t.h,t.s,t.l,t.opacity);if(t instanceof Mn||(t=An(t)),!t)return new Ye;if(t instanceof Ye)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),s=Math.max(e,n,r),o=NaN,l=s-i,a=(s+i)/2;return l?(e===s?o=(n-r)/l+(n<r)*6:n===s?o=(r-e)/l+2:o=(e-n)/l+4,l/=a<.5?s+i:2-s-i,o*=60):l=a>0&&a<1?0:o,new Ye(o,l,a,t.opacity)}function Qu(t,e,n,r){return arguments.length===1?Ba(t):new Ye(t,e,n,r??1)}function Ye(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}ji(Ye,Qu,Da(Mn,{brighter(t){return t=t==null?ar:Math.pow(ar,t),new Ye(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?xn:Math.pow(xn,t),new Ye(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new Te(Kr(t>=240?t-240:t+120,i,r),Kr(t,i,r),Kr(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new Ye(ks(this.h),Tn(this.s),Tn(this.l),or(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=or(this.opacity);return`${t===1?"hsl(":"hsla("}${ks(this.h)}, ${Tn(this.s)*100}%, ${Tn(this.l)*100}%${t===1?")":`, ${t})`}`}}));function ks(t){return t=(t||0)%360,t<0?t+360:t}function Tn(t){return Math.max(0,Math.min(1,t||0))}function Kr(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const qa=t=>()=>t;function Yu(t,e){return function(n){return t+n*e}}function Zu(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function ec(t){return(t=+t)==1?ja:function(e,n){return n-e?Zu(e,n,t):qa(isNaN(e)?n:e)}}function ja(t,e){var n=e-t;return n?Yu(t,n):qa(isNaN(t)?e:t)}const Es=function t(e){var n=ec(e);function r(i,s){var o=n((i=ai(i)).r,(s=ai(s)).r),l=n(i.g,s.g),a=n(i.b,s.b),u=ja(i.opacity,s.opacity);return function(c){return i.r=o(c),i.g=l(c),i.b=a(c),i.opacity=u(c),i+""}}return r.gamma=t,r}(1);function vt(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}var oi=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Gr=new RegExp(oi.source,"g");function tc(t){return function(){return t}}function nc(t){return function(e){return t(e)+""}}function rc(t,e){var n=oi.lastIndex=Gr.lastIndex=0,r,i,s,o=-1,l=[],a=[];for(t=t+"",e=e+"";(r=oi.exec(t))&&(i=Gr.exec(e));)(s=i.index)>n&&(s=e.slice(n,s),l[o]?l[o]+=s:l[++o]=s),(r=r[0])===(i=i[0])?l[o]?l[o]+=i:l[++o]=i:(l[++o]=null,a.push({i:o,x:vt(r,i)})),n=Gr.lastIndex;return n<e.length&&(s=e.slice(n),l[o]?l[o]+=s:l[++o]=s),l.length<2?a[0]?nc(a[0].x):tc(e):(e=a.length,function(u){for(var c=0,f;c<e;++c)l[(f=a[c]).i]=f.x(u);return l.join("")})}var Rs=180/Math.PI,li={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function za(t,e,n,r,i,s){var o,l,a;return(o=Math.sqrt(t*t+e*e))&&(t/=o,e/=o),(a=t*n+e*r)&&(n-=t*a,r-=e*a),(l=Math.sqrt(n*n+r*r))&&(n/=l,r/=l,a/=l),t*r<e*n&&(t=-t,e=-e,a=-a,o=-o),{translateX:i,translateY:s,rotate:Math.atan2(e,t)*Rs,skewX:Math.atan(a)*Rs,scaleX:o,scaleY:l}}var Fn;function ic(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?li:za(e.a,e.b,e.c,e.d,e.e,e.f)}function sc(t){return t==null||(Fn||(Fn=document.createElementNS("http://www.w3.org/2000/svg","g")),Fn.setAttribute("transform",t),!(t=Fn.transform.baseVal.consolidate()))?li:(t=t.matrix,za(t.a,t.b,t.c,t.d,t.e,t.f))}function Wa(t,e,n,r){function i(u){return u.length?u.pop()+" ":""}function s(u,c,f,h,d,p){if(u!==f||c!==h){var w=d.push("translate(",null,e,null,n);p.push({i:w-4,x:vt(u,f)},{i:w-2,x:vt(c,h)})}else(f||h)&&d.push("translate("+f+e+h+n)}function o(u,c,f,h){u!==c?(u-c>180?c+=360:c-u>180&&(u+=360),h.push({i:f.push(i(f)+"rotate(",null,r)-2,x:vt(u,c)})):c&&f.push(i(f)+"rotate("+c+r)}function l(u,c,f,h){u!==c?h.push({i:f.push(i(f)+"skewX(",null,r)-2,x:vt(u,c)}):c&&f.push(i(f)+"skewX("+c+r)}function a(u,c,f,h,d,p){if(u!==f||c!==h){var w=d.push(i(d)+"scale(",null,",",null,")");p.push({i:w-4,x:vt(u,f)},{i:w-2,x:vt(c,h)})}else(f!==1||h!==1)&&d.push(i(d)+"scale("+f+","+h+")")}return function(u,c){var f=[],h=[];return u=t(u),c=t(c),s(u.translateX,u.translateY,c.translateX,c.translateY,f,h),o(u.rotate,c.rotate,f,h),l(u.skewX,c.skewX,f,h),a(u.scaleX,u.scaleY,c.scaleX,c.scaleY,f,h),u=c=null,function(d){for(var p=-1,w=h.length,v;++p<w;)f[(v=h[p]).i]=v.x(d);return f.join("")}}}var ac=Wa(ic,"px, ","px)","deg)"),oc=Wa(sc,", ",")",")"),en=0,rn=0,nn=0,Xa=1e3,lr,sn,ur=0,Nt=0,jr=0,Sn=typeof performance=="object"&&performance.now?performance:Date,Ua=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function zi(){return Nt||(Ua(lc),Nt=Sn.now()+jr)}function lc(){Nt=0}function cr(){this._call=this._time=this._next=null}cr.prototype=Ha.prototype={constructor:cr,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?zi():+n)+(e==null?0:+e),!this._next&&sn!==this&&(sn?sn._next=this:lr=this,sn=this),this._call=t,this._time=n,ui()},stop:function(){this._call&&(this._call=null,this._time=1/0,ui())}};function Ha(t,e,n){var r=new cr;return r.restart(t,e,n),r}function uc(){zi(),++en;for(var t=lr,e;t;)(e=Nt-t._time)>=0&&t._call.call(void 0,e),t=t._next;--en}function Ps(){Nt=(ur=Sn.now())+jr,en=rn=0;try{uc()}finally{en=0,fc(),Nt=0}}function cc(){var t=Sn.now(),e=t-ur;e>Xa&&(jr-=e,ur=t)}function fc(){for(var t,e=lr,n,r=1/0;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:lr=n);sn=t,ui(r)}function ui(t){if(!en){rn&&(rn=clearTimeout(rn));var e=t-Nt;e>24?(t<1/0&&(rn=setTimeout(Ps,t-Sn.now()-jr)),nn&&(nn=clearInterval(nn))):(nn||(ur=Sn.now(),nn=setInterval(cc,Xa)),en=1,Ua(Ps))}}function Is(t,e,n){var r=new cr;return e=e==null?0:+e,r.restart(i=>{r.stop(),t(i+e)},e,n),r}var hc=Sa("start","end","cancel","interrupt"),dc=[],Va=0,Ms=1,ci=2,Xn=3,Os=4,fi=5,Un=6;function zr(t,e,n,r,i,s){var o=t.__transition;if(!o)t.__transition={};else if(n in o)return;pc(t,n,{name:e,index:r,group:i,on:hc,tween:dc,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:Va})}function Wi(t,e){var n=tt(t,e);if(n.state>Va)throw new Error("too late; already scheduled");return n}function ct(t,e){var n=tt(t,e);if(n.state>Xn)throw new Error("too late; already running");return n}function tt(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function pc(t,e,n){var r=t.__transition,i;r[e]=n,n.timer=Ha(s,0,n.time);function s(u){n.state=Ms,n.timer.restart(o,n.delay,n.time),n.delay<=u&&o(u-n.delay)}function o(u){var c,f,h,d;if(n.state!==Ms)return a();for(c in r)if(d=r[c],d.name===n.name){if(d.state===Xn)return Is(o);d.state===Os?(d.state=Un,d.timer.stop(),d.on.call("interrupt",t,t.__data__,d.index,d.group),delete r[c]):+c<e&&(d.state=Un,d.timer.stop(),d.on.call("cancel",t,t.__data__,d.index,d.group),delete r[c])}if(Is(function(){n.state===Xn&&(n.state=Os,n.timer.restart(l,n.delay,n.time),l(u))}),n.state=ci,n.on.call("start",t,t.__data__,n.index,n.group),n.state===ci){for(n.state=Xn,i=new Array(h=n.tween.length),c=0,f=-1;c<h;++c)(d=n.tween[c].value.call(t,t.__data__,n.index,n.group))&&(i[++f]=d);i.length=f+1}}function l(u){for(var c=u<n.duration?n.ease.call(null,u/n.duration):(n.timer.restart(a),n.state=fi,1),f=-1,h=i.length;++f<h;)i[f].call(t,c);n.state===fi&&(n.on.call("end",t,t.__data__,n.index,n.group),a())}function a(){n.state=Un,n.timer.stop(),delete r[e];for(var u in r)return;delete t.__transition}}function mc(t,e){var n=t.__transition,r,i,s=!0,o;if(n){e=e==null?null:e+"";for(o in n){if((r=n[o]).name!==e){s=!1;continue}i=r.state>ci&&r.state<fi,r.state=Un,r.timer.stop(),r.on.call(i?"interrupt":"cancel",t,t.__data__,r.index,r.group),delete n[o]}s&&delete t.__transition}}function _c(t){return this.each(function(){mc(this,t)})}function gc(t,e){var n,r;return function(){var i=ct(this,t),s=i.tween;if(s!==n){r=n=s;for(var o=0,l=r.length;o<l;++o)if(r[o].name===e){r=r.slice(),r.splice(o,1);break}}i.tween=r}}function wc(t,e,n){var r,i;if(typeof n!="function")throw new Error;return function(){var s=ct(this,t),o=s.tween;if(o!==r){i=(r=o).slice();for(var l={name:e,value:n},a=0,u=i.length;a<u;++a)if(i[a].name===e){i[a]=l;break}a===u&&i.push(l)}s.tween=i}}function yc(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r=tt(this.node(),n).tween,i=0,s=r.length,o;i<s;++i)if((o=r[i]).name===t)return o.value;return null}return this.each((e==null?gc:wc)(n,t,e))}function Xi(t,e,n){var r=t._id;return t.each(function(){var i=ct(this,r);(i.value||(i.value={}))[e]=n.apply(this,arguments)}),function(i){return tt(i,r).value[e]}}function Ja(t,e){var n;return(typeof e=="number"?vt:e instanceof An?Es:(n=An(e))?(e=n,Es):rc)(t,e)}function vc(t){return function(){this.removeAttribute(t)}}function bc(t){return function(){this.removeAttributeNS(t.space,t.local)}}function xc(t,e,n){var r,i=n+"",s;return function(){var o=this.getAttribute(t);return o===i?null:o===r?s:s=e(r=o,n)}}function Cc(t,e,n){var r,i=n+"",s;return function(){var o=this.getAttributeNS(t.space,t.local);return o===i?null:o===r?s:s=e(r=o,n)}}function Ac(t,e,n){var r,i,s;return function(){var o,l=n(this),a;return l==null?void this.removeAttribute(t):(o=this.getAttribute(t),a=l+"",o===a?null:o===r&&a===i?s:(i=a,s=e(r=o,l)))}}function Sc(t,e,n){var r,i,s;return function(){var o,l=n(this),a;return l==null?void this.removeAttributeNS(t.space,t.local):(o=this.getAttributeNS(t.space,t.local),a=l+"",o===a?null:o===r&&a===i?s:(i=a,s=e(r=o,l)))}}function kc(t,e){var n=qr(t),r=n==="transform"?oc:Ja;return this.attrTween(t,typeof e=="function"?(n.local?Sc:Ac)(n,r,Xi(this,"attr."+t,e)):e==null?(n.local?bc:vc)(n):(n.local?Cc:xc)(n,r,e))}function Ec(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function Rc(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function Pc(t,e){var n,r;function i(){var s=e.apply(this,arguments);return s!==r&&(n=(r=s)&&Rc(t,s)),n}return i._value=e,i}function Ic(t,e){var n,r;function i(){var s=e.apply(this,arguments);return s!==r&&(n=(r=s)&&Ec(t,s)),n}return i._value=e,i}function Mc(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var r=qr(t);return this.tween(n,(r.local?Pc:Ic)(r,e))}function Oc(t,e){return function(){Wi(this,t).delay=+e.apply(this,arguments)}}function Nc(t,e){return e=+e,function(){Wi(this,t).delay=e}}function $c(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?Oc:Nc)(e,t)):tt(this.node(),e).delay}function Tc(t,e){return function(){ct(this,t).duration=+e.apply(this,arguments)}}function Fc(t,e){return e=+e,function(){ct(this,t).duration=e}}function Lc(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?Tc:Fc)(e,t)):tt(this.node(),e).duration}function Dc(t,e){if(typeof e!="function")throw new Error;return function(){ct(this,t).ease=e}}function Bc(t){var e=this._id;return arguments.length?this.each(Dc(e,t)):tt(this.node(),e).ease}function qc(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;ct(this,t).ease=n}}function jc(t){if(typeof t!="function")throw new Error;return this.each(qc(this._id,t))}function zc(t){typeof t!="function"&&(t=Pa(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s=e[i],o=s.length,l=r[i]=[],a,u=0;u<o;++u)(a=s[u])&&t.call(a,a.__data__,u,s)&&l.push(a);return new mt(r,this._parents,this._name,this._id)}function Wc(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,s=Math.min(r,i),o=new Array(r),l=0;l<s;++l)for(var a=e[l],u=n[l],c=a.length,f=o[l]=new Array(c),h,d=0;d<c;++d)(h=a[d]||u[d])&&(f[d]=h);for(;l<r;++l)o[l]=e[l];return new mt(o,this._parents,this._name,this._id)}function Xc(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function Uc(t,e,n){var r,i,s=Xc(e)?Wi:ct;return function(){var o=s(this,t),l=o.on;l!==r&&(i=(r=l).copy()).on(e,n),o.on=i}}function Hc(t,e){var n=this._id;return arguments.length<2?tt(this.node(),n).on.on(t):this.each(Uc(n,t,e))}function Vc(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function Jc(){return this.on("end.remove",Vc(this._id))}function Kc(t){var e=this._name,n=this._id;typeof t!="function"&&(t=Di(t));for(var r=this._groups,i=r.length,s=new Array(i),o=0;o<i;++o)for(var l=r[o],a=l.length,u=s[o]=new Array(a),c,f,h=0;h<a;++h)(c=l[h])&&(f=t.call(c,c.__data__,h,l))&&("__data__"in c&&(f.__data__=c.__data__),u[h]=f,zr(u[h],e,n,h,u,tt(c,n)));return new mt(s,this._parents,e,n)}function Gc(t){var e=this._name,n=this._id;typeof t!="function"&&(t=Ra(t));for(var r=this._groups,i=r.length,s=[],o=[],l=0;l<i;++l)for(var a=r[l],u=a.length,c,f=0;f<u;++f)if(c=a[f]){for(var h=t.call(c,c.__data__,f,a),d,p=tt(c,n),w=0,v=h.length;w<v;++w)(d=h[w])&&zr(d,e,n,w,h,p);s.push(h),o.push(c)}return new mt(s,o,e,n)}var Qc=In.prototype.constructor;function Yc(){return new Qc(this._groups,this._parents)}function Zc(t,e){var n,r,i;return function(){var s=Zt(this,t),o=(this.style.removeProperty(t),Zt(this,t));return s===o?null:s===n&&o===r?i:i=e(n=s,r=o)}}function Ka(t){return function(){this.style.removeProperty(t)}}function ef(t,e,n){var r,i=n+"",s;return function(){var o=Zt(this,t);return o===i?null:o===r?s:s=e(r=o,n)}}function tf(t,e,n){var r,i,s;return function(){var o=Zt(this,t),l=n(this),a=l+"";return l==null&&(a=l=(this.style.removeProperty(t),Zt(this,t))),o===a?null:o===r&&a===i?s:(i=a,s=e(r=o,l))}}function nf(t,e){var n,r,i,s="style."+e,o="end."+s,l;return function(){var a=ct(this,t),u=a.on,c=a.value[s]==null?l||(l=Ka(e)):void 0;(u!==n||i!==c)&&(r=(n=u).copy()).on(o,i=c),a.on=r}}function rf(t,e,n){var r=(t+="")=="transform"?ac:Ja;return e==null?this.styleTween(t,Zc(t,r)).on("end.style."+t,Ka(t)):typeof e=="function"?this.styleTween(t,tf(t,r,Xi(this,"style."+t,e))).each(nf(this._id,t)):this.styleTween(t,ef(t,r,e),n).on("end.style."+t,null)}function sf(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function af(t,e,n){var r,i;function s(){var o=e.apply(this,arguments);return o!==i&&(r=(i=o)&&sf(t,o,n)),r}return s._value=e,s}function of(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;return this.tween(r,af(t,e,n??""))}function lf(t){return function(){this.textContent=t}}function uf(t){return function(){var e=t(this);this.textContent=e??""}}function cf(t){return this.tween("text",typeof t=="function"?uf(Xi(this,"text",t)):lf(t==null?"":t+""))}function ff(t){return function(e){this.textContent=t.call(this,e)}}function hf(t){var e,n;function r(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&ff(i)),e}return r._value=t,r}function df(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,hf(t))}function pf(){for(var t=this._name,e=this._id,n=Ga(),r=this._groups,i=r.length,s=0;s<i;++s)for(var o=r[s],l=o.length,a,u=0;u<l;++u)if(a=o[u]){var c=tt(a,e);zr(a,t,n,u,o,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new mt(r,this._parents,t,n)}function mf(){var t,e,n=this,r=n._id,i=n.size();return new Promise(function(s,o){var l={value:o},a={value:function(){--i===0&&s()}};n.each(function(){var u=ct(this,r),c=u.on;c!==t&&(e=(t=c).copy(),e._.cancel.push(l),e._.interrupt.push(l),e._.end.push(a)),u.on=e}),i===0&&s()})}var _f=0;function mt(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function Ga(){return++_f}var ht=In.prototype;mt.prototype={constructor:mt,select:Kc,selectAll:Gc,selectChild:ht.selectChild,selectChildren:ht.selectChildren,filter:zc,merge:Wc,selection:Yc,transition:pf,call:ht.call,nodes:ht.nodes,node:ht.node,size:ht.size,empty:ht.empty,each:ht.each,on:Hc,attr:kc,attrTween:Mc,style:rf,styleTween:of,text:cf,textTween:df,remove:Jc,tween:yc,delay:$c,duration:Lc,ease:Bc,easeVarying:jc,end:mf,[Symbol.iterator]:ht[Symbol.iterator]};function gf(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var wf={time:null,delay:0,duration:250,ease:gf};function yf(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function vf(t){var e,n;t instanceof mt?(e=t._id,t=t._name):(e=Ga(),(n=wf).time=zi(),t=t==null?null:t+"");for(var r=this._groups,i=r.length,s=0;s<i;++s)for(var o=r[s],l=o.length,a,u=0;u<l;++u)(a=o[u])&&zr(a,t,e,u,o,n||yf(a,e));return new mt(r,this._parents,t,e)}In.prototype.interrupt=_c;In.prototype.transition=vf;const hi=Math.PI,di=2*hi,kt=1e-6,bf=di-kt;function Qa(t){this._+=t[0];for(let e=1,n=t.length;e<n;++e)this._+=arguments[e]+t[e]}function xf(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return Qa;const n=10**e;return function(r){this._+=r[0];for(let i=1,s=r.length;i<s;++i)this._+=Math.round(arguments[i]*n)/n+r[i]}}class Cf{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?Qa:xf(e)}moveTo(e,n){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,n){this._append`L${this._x1=+e},${this._y1=+n}`}quadraticCurveTo(e,n,r,i){this._append`Q${+e},${+n},${this._x1=+r},${this._y1=+i}`}bezierCurveTo(e,n,r,i,s,o){this._append`C${+e},${+n},${+r},${+i},${this._x1=+s},${this._y1=+o}`}arcTo(e,n,r,i,s){if(e=+e,n=+n,r=+r,i=+i,s=+s,s<0)throw new Error(`negative radius: ${s}`);let o=this._x1,l=this._y1,a=r-e,u=i-n,c=o-e,f=l-n,h=c*c+f*f;if(this._x1===null)this._append`M${this._x1=e},${this._y1=n}`;else if(h>kt)if(!(Math.abs(f*a-u*c)>kt)||!s)this._append`L${this._x1=e},${this._y1=n}`;else{let d=r-o,p=i-l,w=a*a+u*u,v=d*d+p*p,x=Math.sqrt(w),C=Math.sqrt(h),R=s*Math.tan((hi-Math.acos((w+h-v)/(2*x*C)))/2),M=R/C,E=R/x;Math.abs(M-1)>kt&&this._append`L${e+M*c},${n+M*f}`,this._append`A${s},${s},0,0,${+(f*d>c*p)},${this._x1=e+E*a},${this._y1=n+E*u}`}}arc(e,n,r,i,s,o){if(e=+e,n=+n,r=+r,o=!!o,r<0)throw new Error(`negative radius: ${r}`);let l=r*Math.cos(i),a=r*Math.sin(i),u=e+l,c=n+a,f=1^o,h=o?i-s:s-i;this._x1===null?this._append`M${u},${c}`:(Math.abs(this._x1-u)>kt||Math.abs(this._y1-c)>kt)&&this._append`L${u},${c}`,r&&(h<0&&(h=h%di+di),h>bf?this._append`A${r},${r},0,1,${f},${e-l},${n-a}A${r},${r},0,1,${f},${this._x1=u},${this._y1=c}`:h>kt&&this._append`A${r},${r},0,${+(h>=hi)},${f},${this._x1=e+r*Math.cos(s)},${this._y1=n+r*Math.sin(s)}`)}rect(e,n,r,i){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}h${r=+r}v${+i}h${-r}Z`}toString(){return this._}}function Dt(t){return function(){return t}}function Af(t){let e=3;return t.digits=function(n){if(!arguments.length)return e;if(n==null)e=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);e=r}return t},()=>new Cf(e)}function Sf(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Ya(t){this._context=t}Ya.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function kf(t){return new Ya(t)}function Ef(t){return t[0]}function Rf(t){return t[1]}function Pf(t,e){var n=Dt(!0),r=null,i=kf,s=null,o=Af(l);t=typeof t=="function"?t:t===void 0?Ef:Dt(t),e=typeof e=="function"?e:e===void 0?Rf:Dt(e);function l(a){var u,c=(a=Sf(a)).length,f,h=!1,d;for(r==null&&(s=i(d=o())),u=0;u<=c;++u)!(u<c&&n(f=a[u],u,a))===h&&((h=!h)?s.lineStart():s.lineEnd()),h&&s.point(+t(f,u,a),+e(f,u,a));if(d)return s=null,d+""||null}return l.x=function(a){return arguments.length?(t=typeof a=="function"?a:Dt(+a),l):t},l.y=function(a){return arguments.length?(e=typeof a=="function"?a:Dt(+a),l):e},l.defined=function(a){return arguments.length?(n=typeof a=="function"?a:Dt(!!a),l):n},l.curve=function(a){return arguments.length?(i=a,r!=null&&(s=i(r)),l):i},l.context=function(a){return arguments.length?(a==null?r=s=null:s=i(r=a),l):r},l}function Ns(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function Za(t){this._context=t}Za.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Ns(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Ns(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function If(t){return new Za(t)}function an(t,e,n){this.k=t,this.x=e,this.y=n}an.prototype={constructor:an,scale:function(t){return t===1?this:new an(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new an(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};an.prototype;var xt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function eo(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Mf(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var i=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return t[r]}})}),n}var to={exports:{}};/* @license
Papa Parse
v5.4.1
https://github.com/mholt/PapaParse
License: MIT
*/(function(t,e){(function(n,r){t.exports=r()})(xt,function n(){var r=typeof self<"u"?self:typeof window<"u"?window:r!==void 0?r:{},i=!r.document&&!!r.postMessage,s=r.IS_PAPA_WORKER||!1,o={},l=0,a={parse:function(_,m){var A=(m=m||{}).dynamicTyping||!1;if(b(A)&&(m.dynamicTypingFunction=A,A={}),m.dynamicTyping=A,m.transform=!!b(m.transform)&&m.transform,m.worker&&a.WORKERS_SUPPORTED){var k=function(){if(!a.WORKERS_SUPPORTED)return!1;var N=(X=r.URL||r.webkitURL||null,W=n.toString(),a.BLOB_URL||(a.BLOB_URL=X.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",W,")();"],{type:"text/javascript"})))),L=new r.Worker(N),X,W;return L.onmessage=C,L.id=l++,o[L.id]=L}();return k.userStep=m.step,k.userChunk=m.chunk,k.userComplete=m.complete,k.userError=m.error,m.step=b(m.step),m.chunk=b(m.chunk),m.complete=b(m.complete),m.error=b(m.error),delete m.worker,void k.postMessage({input:_,config:m,workerId:k.id})}var O=null;return a.NODE_STREAM_INPUT,typeof _=="string"?(_=function(N){return N.charCodeAt(0)===65279?N.slice(1):N}(_),O=m.download?new f(m):new d(m)):_.readable===!0&&b(_.read)&&b(_.on)?O=new p(m):(r.File&&_ instanceof File||_ instanceof Object)&&(O=new h(m)),O.stream(_)},unparse:function(_,m){var A=!1,k=!0,O=",",N=`\r
`,L='"',X=L+L,W=!1,D=null,j=!1;(function(){if(typeof m=="object"){if(typeof m.delimiter!="string"||a.BAD_DELIMITERS.filter(function(F){return m.delimiter.indexOf(F)!==-1}).length||(O=m.delimiter),(typeof m.quotes=="boolean"||typeof m.quotes=="function"||Array.isArray(m.quotes))&&(A=m.quotes),typeof m.skipEmptyLines!="boolean"&&typeof m.skipEmptyLines!="string"||(W=m.skipEmptyLines),typeof m.newline=="string"&&(N=m.newline),typeof m.quoteChar=="string"&&(L=m.quoteChar),typeof m.header=="boolean"&&(k=m.header),Array.isArray(m.columns)){if(m.columns.length===0)throw new Error("Option columns is empty");D=m.columns}m.escapeChar!==void 0&&(X=m.escapeChar+L),(typeof m.escapeFormulae=="boolean"||m.escapeFormulae instanceof RegExp)&&(j=m.escapeFormulae instanceof RegExp?m.escapeFormulae:/^[=+\-@\t\r].*$/)}})();var $=new RegExp(v(L),"g");if(typeof _=="string"&&(_=JSON.parse(_)),Array.isArray(_)){if(!_.length||Array.isArray(_[0]))return z(null,_,W);if(typeof _[0]=="object")return z(D||Object.keys(_[0]),_,W)}else if(typeof _=="object")return typeof _.data=="string"&&(_.data=JSON.parse(_.data)),Array.isArray(_.data)&&(_.fields||(_.fields=_.meta&&_.meta.fields||D),_.fields||(_.fields=Array.isArray(_.data[0])?_.fields:typeof _.data[0]=="object"?Object.keys(_.data[0]):[]),Array.isArray(_.data[0])||typeof _.data[0]=="object"||(_.data=[_.data])),z(_.fields||[],_.data||[],W);throw new Error("Unable to serialize unrecognized input");function z(F,ne,G){var H="";typeof F=="string"&&(F=JSON.parse(F)),typeof ne=="string"&&(ne=JSON.parse(ne));var ee=Array.isArray(F)&&0<F.length,K=!Array.isArray(ne[0]);if(ee&&k){for(var B=0;B<F.length;B++)0<B&&(H+=O),H+=J(F[B],B);0<ne.length&&(H+=N)}for(var T=0;T<ne.length;T++){var Y=ee?F.length:ne[T].length,Z=!1,re=ee?Object.keys(ne[T]).length===0:ne[T].length===0;if(G&&!ee&&(Z=G==="greedy"?ne[T].join("").trim()==="":ne[T].length===1&&ne[T][0].length===0),G==="greedy"&&ee){for(var te=[],ue=0;ue<Y;ue++){var V=K?F[ue]:ue;te.push(ne[T][V])}Z=te.join("").trim()===""}if(!Z){for(var I=0;I<Y;I++){0<I&&!re&&(H+=O);var Q=ee&&K?F[I]:I;H+=J(ne[T][Q],I)}T<ne.length-1&&(!G||0<Y&&!re)&&(H+=N)}}return H}function J(F,ne){if(F==null)return"";if(F.constructor===Date)return JSON.stringify(F).slice(1,25);var G=!1;j&&typeof F=="string"&&j.test(F)&&(F="'"+F,G=!0);var H=F.toString().replace($,X);return(G=G||A===!0||typeof A=="function"&&A(F,ne)||Array.isArray(A)&&A[ne]||function(ee,K){for(var B=0;B<K.length;B++)if(-1<ee.indexOf(K[B]))return!0;return!1}(H,a.BAD_DELIMITERS)||-1<H.indexOf(O)||H.charAt(0)===" "||H.charAt(H.length-1)===" ")?L+H+L:H}}};if(a.RECORD_SEP="",a.UNIT_SEP="",a.BYTE_ORDER_MARK="\uFEFF",a.BAD_DELIMITERS=["\r",`
`,'"',a.BYTE_ORDER_MARK],a.WORKERS_SUPPORTED=!i&&!!r.Worker,a.NODE_STREAM_INPUT=1,a.LocalChunkSize=10485760,a.RemoteChunkSize=5242880,a.DefaultDelimiter=",",a.Parser=x,a.ParserHandle=w,a.NetworkStreamer=f,a.FileStreamer=h,a.StringStreamer=d,a.ReadableStreamStreamer=p,r.jQuery){var u=r.jQuery;u.fn.parse=function(_){var m=_.config||{},A=[];return this.each(function(N){if(!(u(this).prop("tagName").toUpperCase()==="INPUT"&&u(this).attr("type").toLowerCase()==="file"&&r.FileReader)||!this.files||this.files.length===0)return!0;for(var L=0;L<this.files.length;L++)A.push({file:this.files[L],inputElem:this,instanceConfig:u.extend({},m)})}),k(),this;function k(){if(A.length!==0){var N,L,X,W,D=A[0];if(b(_.before)){var j=_.before(D.file,D.inputElem);if(typeof j=="object"){if(j.action==="abort")return N="AbortError",L=D.file,X=D.inputElem,W=j.reason,void(b(_.error)&&_.error({name:N},L,X,W));if(j.action==="skip")return void O();typeof j.config=="object"&&(D.instanceConfig=u.extend(D.instanceConfig,j.config))}else if(j==="skip")return void O()}var $=D.instanceConfig.complete;D.instanceConfig.complete=function(z){b($)&&$(z,D.file,D.inputElem),O()},a.parse(D.file,D.instanceConfig)}else b(_.complete)&&_.complete()}function O(){A.splice(0,1),k()}}}function c(_){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(m){var A=E(m);A.chunkSize=parseInt(A.chunkSize),m.step||m.chunk||(A.chunkSize=null),this._handle=new w(A),(this._handle.streamer=this)._config=A}).call(this,_),this.parseChunk=function(m,A){if(this.isFirstChunk&&b(this._config.beforeFirstChunk)){var k=this._config.beforeFirstChunk(m);k!==void 0&&(m=k)}this.isFirstChunk=!1,this._halted=!1;var O=this._partialLine+m;this._partialLine="";var N=this._handle.parse(O,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var L=N.meta.cursor;this._finished||(this._partialLine=O.substring(L-this._baseIndex),this._baseIndex=L),N&&N.data&&(this._rowCount+=N.data.length);var X=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(s)r.postMessage({results:N,workerId:a.WORKER_ID,finished:X});else if(b(this._config.chunk)&&!A){if(this._config.chunk(N,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);N=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(N.data),this._completeResults.errors=this._completeResults.errors.concat(N.errors),this._completeResults.meta=N.meta),this._completed||!X||!b(this._config.complete)||N&&N.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),X||N&&N.meta.paused||this._nextChunk(),N}this._halted=!0},this._sendError=function(m){b(this._config.error)?this._config.error(m):s&&this._config.error&&r.postMessage({workerId:a.WORKER_ID,error:m,finished:!1})}}function f(_){var m;(_=_||{}).chunkSize||(_.chunkSize=a.RemoteChunkSize),c.call(this,_),this._nextChunk=i?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(A){this._input=A,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(m=new XMLHttpRequest,this._config.withCredentials&&(m.withCredentials=this._config.withCredentials),i||(m.onload=P(this._chunkLoaded,this),m.onerror=P(this._chunkError,this)),m.open(this._config.downloadRequestBody?"POST":"GET",this._input,!i),this._config.downloadRequestHeaders){var A=this._config.downloadRequestHeaders;for(var k in A)m.setRequestHeader(k,A[k])}if(this._config.chunkSize){var O=this._start+this._config.chunkSize-1;m.setRequestHeader("Range","bytes="+this._start+"-"+O)}try{m.send(this._config.downloadRequestBody)}catch(N){this._chunkError(N.message)}i&&m.status===0&&this._chunkError()}},this._chunkLoaded=function(){m.readyState===4&&(m.status<200||400<=m.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:m.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(A){var k=A.getResponseHeader("Content-Range");return k===null?-1:parseInt(k.substring(k.lastIndexOf("/")+1))}(m),this.parseChunk(m.responseText)))},this._chunkError=function(A){var k=m.statusText||A;this._sendError(new Error(k))}}function h(_){var m,A;(_=_||{}).chunkSize||(_.chunkSize=a.LocalChunkSize),c.call(this,_);var k=typeof FileReader<"u";this.stream=function(O){this._input=O,A=O.slice||O.webkitSlice||O.mozSlice,k?((m=new FileReader).onload=P(this._chunkLoaded,this),m.onerror=P(this._chunkError,this)):m=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var O=this._input;if(this._config.chunkSize){var N=Math.min(this._start+this._config.chunkSize,this._input.size);O=A.call(O,this._start,N)}var L=m.readAsText(O,this._config.encoding);k||this._chunkLoaded({target:{result:L}})},this._chunkLoaded=function(O){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(O.target.result)},this._chunkError=function(){this._sendError(m.error)}}function d(_){var m;c.call(this,_=_||{}),this.stream=function(A){return m=A,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var A,k=this._config.chunkSize;return k?(A=m.substring(0,k),m=m.substring(k)):(A=m,m=""),this._finished=!m,this.parseChunk(A)}}}function p(_){c.call(this,_=_||{});var m=[],A=!0,k=!1;this.pause=function(){c.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){c.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(O){this._input=O,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){k&&m.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),m.length?this.parseChunk(m.shift()):A=!0},this._streamData=P(function(O){try{m.push(typeof O=="string"?O:O.toString(this._config.encoding)),A&&(A=!1,this._checkIsFinished(),this.parseChunk(m.shift()))}catch(N){this._streamError(N)}},this),this._streamError=P(function(O){this._streamCleanUp(),this._sendError(O)},this),this._streamEnd=P(function(){this._streamCleanUp(),k=!0,this._streamData("")},this),this._streamCleanUp=P(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function w(_){var m,A,k,O=Math.pow(2,53),N=-O,L=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,X=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,W=this,D=0,j=0,$=!1,z=!1,J=[],F={data:[],errors:[],meta:{}};if(b(_.step)){var ne=_.step;_.step=function(T){if(F=T,ee())H();else{if(H(),F.data.length===0)return;D+=T.data.length,_.preview&&D>_.preview?A.abort():(F.data=F.data[0],ne(F,W))}}}function G(T){return _.skipEmptyLines==="greedy"?T.join("").trim()==="":T.length===1&&T[0].length===0}function H(){return F&&k&&(B("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+a.DefaultDelimiter+"'"),k=!1),_.skipEmptyLines&&(F.data=F.data.filter(function(T){return!G(T)})),ee()&&function(){if(!F)return;function T(Z,re){b(_.transformHeader)&&(Z=_.transformHeader(Z,re)),J.push(Z)}if(Array.isArray(F.data[0])){for(var Y=0;ee()&&Y<F.data.length;Y++)F.data[Y].forEach(T);F.data.splice(0,1)}else F.data.forEach(T)}(),function(){if(!F||!_.header&&!_.dynamicTyping&&!_.transform)return F;function T(Z,re){var te,ue=_.header?{}:[];for(te=0;te<Z.length;te++){var V=te,I=Z[te];_.header&&(V=te>=J.length?"__parsed_extra":J[te]),_.transform&&(I=_.transform(I,V)),I=K(V,I),V==="__parsed_extra"?(ue[V]=ue[V]||[],ue[V].push(I)):ue[V]=I}return _.header&&(te>J.length?B("FieldMismatch","TooManyFields","Too many fields: expected "+J.length+" fields but parsed "+te,j+re):te<J.length&&B("FieldMismatch","TooFewFields","Too few fields: expected "+J.length+" fields but parsed "+te,j+re)),ue}var Y=1;return!F.data.length||Array.isArray(F.data[0])?(F.data=F.data.map(T),Y=F.data.length):F.data=T(F.data,0),_.header&&F.meta&&(F.meta.fields=J),j+=Y,F}()}function ee(){return _.header&&J.length===0}function K(T,Y){return Z=T,_.dynamicTypingFunction&&_.dynamicTyping[Z]===void 0&&(_.dynamicTyping[Z]=_.dynamicTypingFunction(Z)),(_.dynamicTyping[Z]||_.dynamicTyping)===!0?Y==="true"||Y==="TRUE"||Y!=="false"&&Y!=="FALSE"&&(function(re){if(L.test(re)){var te=parseFloat(re);if(N<te&&te<O)return!0}return!1}(Y)?parseFloat(Y):X.test(Y)?new Date(Y):Y===""?null:Y):Y;var Z}function B(T,Y,Z,re){var te={type:T,code:Y,message:Z};re!==void 0&&(te.row=re),F.errors.push(te)}this.parse=function(T,Y,Z){var re=_.quoteChar||'"';if(_.newline||(_.newline=function(V,I){V=V.substring(0,1048576);var Q=new RegExp(v(I)+"([^]*?)"+v(I),"gm"),ge=(V=V.replace(Q,"")).split("\r"),Oe=V.split(`
`),Fe=1<Oe.length&&Oe[0].length<ge[0].length;if(ge.length===1||Fe)return`
`;for(var Ee=0,me=0;me<ge.length;me++)ge[me][0]===`
`&&Ee++;return Ee>=ge.length/2?`\r
`:"\r"}(T,re)),k=!1,_.delimiter)b(_.delimiter)&&(_.delimiter=_.delimiter(T),F.meta.delimiter=_.delimiter);else{var te=function(V,I,Q,ge,Oe){var Fe,Ee,me,ve;Oe=Oe||[",","	","|",";",a.RECORD_SEP,a.UNIT_SEP];for(var At=0;At<Oe.length;At++){var de=Oe[At],Ft=0,ft=0,St=0;me=void 0;for(var _t=new x({comments:ge,delimiter:de,newline:I,preview:10}).parse(V),gt=0;gt<_t.data.length;gt++)if(Q&&G(_t.data[gt]))St++;else{var wt=_t.data[gt].length;ft+=wt,me!==void 0?0<wt&&(Ft+=Math.abs(wt-me),me=wt):me=wt}0<_t.data.length&&(ft/=_t.data.length-St),(Ee===void 0||Ft<=Ee)&&(ve===void 0||ve<ft)&&1.99<ft&&(Ee=Ft,Fe=de,ve=ft)}return{successful:!!(_.delimiter=Fe),bestDelimiter:Fe}}(T,_.newline,_.skipEmptyLines,_.comments,_.delimitersToGuess);te.successful?_.delimiter=te.bestDelimiter:(k=!0,_.delimiter=a.DefaultDelimiter),F.meta.delimiter=_.delimiter}var ue=E(_);return _.preview&&_.header&&ue.preview++,m=T,A=new x(ue),F=A.parse(m,Y,Z),H(),$?{meta:{paused:!0}}:F||{meta:{paused:!1}}},this.paused=function(){return $},this.pause=function(){$=!0,A.abort(),m=b(_.chunk)?"":m.substring(A.getCharIndex())},this.resume=function(){W.streamer._halted?($=!1,W.streamer.parseChunk(m,!0)):setTimeout(W.resume,3)},this.aborted=function(){return z},this.abort=function(){z=!0,A.abort(),F.meta.aborted=!0,b(_.complete)&&_.complete(F),m=""}}function v(_){return _.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function x(_){var m,A=(_=_||{}).delimiter,k=_.newline,O=_.comments,N=_.step,L=_.preview,X=_.fastMode,W=m=_.quoteChar===void 0||_.quoteChar===null?'"':_.quoteChar;if(_.escapeChar!==void 0&&(W=_.escapeChar),(typeof A!="string"||-1<a.BAD_DELIMITERS.indexOf(A))&&(A=","),O===A)throw new Error("Comment character same as delimiter");O===!0?O="#":(typeof O!="string"||-1<a.BAD_DELIMITERS.indexOf(O))&&(O=!1),k!==`
`&&k!=="\r"&&k!==`\r
`&&(k=`
`);var D=0,j=!1;this.parse=function($,z,J){if(typeof $!="string")throw new Error("Input must be a string");var F=$.length,ne=A.length,G=k.length,H=O.length,ee=b(N),K=[],B=[],T=[],Y=D=0;if(!$)return Ue();if(_.header&&!z){var Z=$.split(k)[0].split(A),re=[],te={},ue=!1;for(var V in Z){var I=Z[V];b(_.transformHeader)&&(I=_.transformHeader(I,V));var Q=I,ge=te[I]||0;for(0<ge&&(ue=!0,Q=I+"_"+ge),te[I]=ge+1;re.includes(Q);)Q=Q+"_"+ge;re.push(Q)}if(ue){var Oe=$.split(k);Oe[0]=re.join(A),$=Oe.join(k)}}if(X||X!==!1&&$.indexOf(m)===-1){for(var Fe=$.split(k),Ee=0;Ee<Fe.length;Ee++){if(T=Fe[Ee],D+=T.length,Ee!==Fe.length-1)D+=k.length;else if(J)return Ue();if(!O||T.substring(0,H)!==O){if(ee){if(K=[],St(T.split(A)),Nn(),j)return Ue()}else St(T.split(A));if(L&&L<=Ee)return K=K.slice(0,L),Ue(!0)}}return Ue()}for(var me=$.indexOf(A,D),ve=$.indexOf(k,D),At=new RegExp(v(W)+v(m),"g"),de=$.indexOf(m,D);;)if($[D]!==m)if(O&&T.length===0&&$.substring(D,D+H)===O){if(ve===-1)return Ue();D=ve+G,ve=$.indexOf(k,D),me=$.indexOf(A,D)}else if(me!==-1&&(me<ve||ve===-1))T.push($.substring(D,me)),D=me+ne,me=$.indexOf(A,D);else{if(ve===-1)break;if(T.push($.substring(D,ve)),wt(ve+G),ee&&(Nn(),j))return Ue();if(L&&K.length>=L)return Ue(!0)}else for(de=D,D++;;){if((de=$.indexOf(m,de+1))===-1)return J||B.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:K.length,index:D}),gt();if(de===F-1)return gt($.substring(D,de).replace(At,m));if(m!==W||$[de+1]!==W){if(m===W||de===0||$[de-1]!==W){me!==-1&&me<de+1&&(me=$.indexOf(A,de+1)),ve!==-1&&ve<de+1&&(ve=$.indexOf(k,de+1));var Ft=_t(ve===-1?me:Math.min(me,ve));if($.substr(de+1+Ft,ne)===A){T.push($.substring(D,de).replace(At,m)),$[D=de+1+Ft+ne]!==m&&(de=$.indexOf(m,D)),me=$.indexOf(A,D),ve=$.indexOf(k,D);break}var ft=_t(ve);if($.substring(de+1+ft,de+1+ft+G)===k){if(T.push($.substring(D,de).replace(At,m)),wt(de+1+ft+G),me=$.indexOf(A,D),de=$.indexOf(m,D),ee&&(Nn(),j))return Ue();if(L&&K.length>=L)return Ue(!0);break}B.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:K.length,index:D}),de++}}else de++}return gt();function St(He){K.push(He),Y=D}function _t(He){var ds=0;if(He!==-1){var Hr=$.substring(de+1,He);Hr&&Hr.trim()===""&&(ds=Hr.length)}return ds}function gt(He){return J||(He===void 0&&(He=$.substring(D)),T.push(He),D=F,St(T),ee&&Nn()),Ue()}function wt(He){D=He,St(T),T=[],ve=$.indexOf(k,D)}function Ue(He){return{data:K,errors:B,meta:{delimiter:A,linebreak:k,aborted:j,truncated:!!He,cursor:Y+(z||0)}}}function Nn(){N(Ue()),K=[],B=[]}},this.abort=function(){j=!0},this.getCharIndex=function(){return D}}function C(_){var m=_.data,A=o[m.workerId],k=!1;if(m.error)A.userError(m.error,m.file);else if(m.results&&m.results.data){var O={abort:function(){k=!0,R(m.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:M,resume:M};if(b(A.userStep)){for(var N=0;N<m.results.data.length&&(A.userStep({data:m.results.data[N],errors:m.results.errors,meta:m.results.meta},O),!k);N++);delete m.results}else b(A.userChunk)&&(A.userChunk(m.results,O,m.file),delete m.results)}m.finished&&!k&&R(m.workerId,m.results)}function R(_,m){var A=o[_];b(A.userComplete)&&A.userComplete(m),A.terminate(),delete o[_]}function M(){throw new Error("Not implemented.")}function E(_){if(typeof _!="object"||_===null)return _;var m=Array.isArray(_)?[]:{};for(var A in _)m[A]=E(_[A]);return m}function P(_,m){return function(){_.apply(m,arguments)}}function b(_){return typeof _=="function"}return s&&(r.onmessage=function(_){var m=_.data;if(a.WORKER_ID===void 0&&m&&(a.WORKER_ID=m.workerId),typeof m.input=="string")r.postMessage({workerId:a.WORKER_ID,results:a.parse(m.input,m.config),finished:!0});else if(r.File&&m.input instanceof File||m.input instanceof Object){var A=a.parse(m.input,m.config);A&&r.postMessage({workerId:a.WORKER_ID,results:A,finished:!0})}}),(f.prototype=Object.create(c.prototype)).constructor=f,(h.prototype=Object.create(c.prototype)).constructor=h,(d.prototype=Object.create(d.prototype)).constructor=d,(p.prototype=Object.create(c.prototype)).constructor=p,a})})(to);var Of=to.exports;function $s(t,e,n){const r=t.slice();return r[14]=e[n],r}function Ts(t){let e,n,r,i,s,o,l,a,u=t[1]&&Fs(),c=bt(t[0]),f=[];for(let h=0;h<c.length;h+=1)f[h]=Ds($s(t,c,h));return{c(){e=S("div"),n=S("table"),r=S("thead"),i=S("tr"),s=S("th"),s.textContent="Text",o=q(),u&&u.c(),l=q(),a=S("tbody");for(let h=0;h<f.length;h+=1)f[h].c();y(s,"class","svelte-1l5rgzb"),y(r,"class","svelte-1l5rgzb"),y(n,"class","svelte-1l5rgzb"),y(e,"class","table svelte-1l5rgzb")},m(h,d){oe(h,e,d),g(e,n),g(n,r),g(r,i),g(i,s),g(i,o),u&&u.m(i,null),g(n,l),g(n,a);for(let p=0;p<f.length;p+=1)f[p]&&f[p].m(a,null)},p(h,d){if(h[1]?u||(u=Fs(),u.c(),u.m(i,null)):u&&(u.d(1),u=null),d&3){c=bt(h[0]);let p;for(p=0;p<c.length;p+=1){const w=$s(h,c,p);f[p]?f[p].p(w,d):(f[p]=Ds(w),f[p].c(),f[p].m(a,null))}for(;p<f.length;p+=1)f[p].d(1);f.length=c.length}},d(h){h&&ae(e),u&&u.d(),Pn(f,h)}}}function Fs(t){let e;return{c(){e=S("th"),e.textContent="Label",y(e,"class","svelte-1l5rgzb")},m(n,r){oe(n,e,r)},d(n){n&&ae(e)}}}function Ls(t){let e,n=t[14].label+"",r;return{c(){e=S("td"),r=fe(n),y(e,"class","svelte-1l5rgzb")},m(i,s){oe(i,e,s),g(e,r)},p(i,s){s&1&&n!==(n=i[14].label+"")&&Ae(r,n)},d(i){i&&ae(e)}}}function Ds(t){let e,n,r=t[14].text+"",i,s,o,l=t[1]&&Ls(t);return{c(){e=S("tr"),n=S("td"),i=fe(r),s=q(),l&&l.c(),o=q(),y(n,"class","svelte-1l5rgzb"),y(e,"class","svelte-1l5rgzb")},m(a,u){oe(a,e,u),g(e,n),g(n,i),g(e,s),l&&l.m(e,null),g(e,o)},p(a,u){u&1&&r!==(r=a[14].text+"")&&Ae(i,r),a[1]?l?l.p(a,u):(l=Ls(a),l.c(),l.m(e,o)):l&&(l.d(1),l=null)},d(a){a&&ae(e),l&&l.d()}}}function Nf(t){let e,n,r,i,s,o,l,a,u=t[3]?"Hide":"Show",c,f,h,d,p,w,v,x,C=t[3]&&Ts(t);return{c(){e=S("section"),n=S("div"),n.textContent="Data",r=q(),i=S("input"),s=q(),o=S("button"),o.textContent="Upload",l=q(),a=S("button"),c=fe(u),h=q(),d=S("div"),p=fe(t[4]),w=q(),C&&C.c(),y(n,"class","section-title svelte-1l5rgzb"),y(i,"type","file"),y(i,"id","fileInput"),je(i,"display","none"),y(i,"accept",".csv, .tsv, .json, .jsonl"),y(i,"class","svelte-1l5rgzb"),y(o,"class","button svelte-1l5rgzb"),y(o,"id","data-upload"),y(a,"class","button svelte-1l5rgzb"),y(a,"id","data-show"),a.disabled=f=!(t[3]||t[0].length),y(d,"class","message svelte-1l5rgzb"),y(e,"class","svelte-1l5rgzb")},m(R,M){oe(R,e,M),g(e,n),g(e,r),g(e,i),t[10](i),g(e,s),g(e,o),g(e,l),g(e,a),g(a,c),g(e,h),g(e,d),g(d,p),g(e,w),C&&C.m(e,null),v||(x=[le(i,"change",t[5]),le(o,"click",t[11]),le(a,"click",t[12])],v=!0)},p(R,[M]){M&8&&u!==(u=R[3]?"Hide":"Show")&&Ae(c,u),M&9&&f!==(f=!(R[3]||R[0].length))&&(a.disabled=f),M&16&&Ae(p,R[4]),R[3]?C?C.p(R,M):(C=Ts(R),C.c(),C.m(e,null)):C&&(C.d(1),C=null)},i:ye,o:ye,d(R){R&&ae(e),t[10](null),C&&C.d(),v=!1,Xe(x)}}}function $f(t,e,n){let r,{fileName:i=""}=e,{hasLabel:s=!1}=e,{data:o=[]}=e,{requireLabel:l=!1}=e,{isFake:a=!1}=e;const u=async()=>{let x=await fetch("./cache.json"),C=JSON.parse(await x.text());Object.keys(C).forEach(function(P){localStorage.setItem(P,C[P])}),x=await fetch("./tweet_eval_emotion_test.jsonl");let R=await x.text(),M=new File([R],"tweet_eval_emotion_test.jsonl",{type:"text/plain"}),E=new DataTransfer;E.items.add(M),n(2,c.files=E.files,c),c.dispatchEvent(new Event("change")),n(7,a=!0)};let c,f=!1,h;const d=x=>{n(7,a=!1);const C=x.target;if(C.files&&C.files[0]){const R=C.files[0],M=new FileReader;M.onload=E=>{if(!E.target||(h=E.target.result,!h))return;let P;try{R.name.endsWith(".csv")||R.name.endsWith(".tsv")?P=Of.parse(h,{delimiter:R.name.endsWith(".csv")?",":"	",header:!0}).data:(R.name.endsWith(".json")||R.name.endsWith(".jsonl"))&&(R.name.endsWith(".json")?P=JSON.parse(h):P=h.split(`
`).filter(_=>_.trim()).map(_=>JSON.parse(_)))}catch(b){n(4,r=`Error: ${b}`);return}if(!P){n(4,r="Error: empty file");return}if(!P[0].text){n(4,r='Error: CSV file must have a "text" column');return}if(n(1,s=P[0].label!==void 0),s)n(0,o=P.map(b=>({text:b.text,label:b.label})));else{if(l){n(4,r='Error: CSV file must have a "label" column');return}n(0,o=P.map(b=>({text:b.text})))}n(6,i=R.name)},M.readAsText(R)}};function p(x){we[x?"unshift":"push"](()=>{c=x,n(2,c)})}const w=()=>{c.click()},v=()=>{(f||o.length)&&n(3,f=!f)};return t.$$set=x=>{"fileName"in x&&n(6,i=x.fileName),"hasLabel"in x&&n(1,s=x.hasLabel),"data"in x&&n(0,o=x.data),"requireLabel"in x&&n(8,l=x.requireLabel),"isFake"in x&&n(7,a=x.isFake)},t.$$.update=()=>{t.$$.dirty&321&&n(4,r=i?`${o.length} records read from ${i}`:`No file uploaded, please upload a CSV, TSV, JSON, or JSONL file with a "text" and ${l?"a":"an optional"} "label" column.`)},[o,s,c,f,r,d,i,a,l,u,p,w,v]}class Ui extends ut{constructor(e){super(),lt(this,e,$f,Nf,et,{fileName:6,hasLabel:1,data:0,requireLabel:8,isFake:7,loadExample:9})}get fileName(){return this.$$.ctx[6]}set fileName(e){this.$$set({fileName:e}),Qe()}get hasLabel(){return this.$$.ctx[1]}set hasLabel(e){this.$$set({hasLabel:e}),Qe()}get data(){return this.$$.ctx[0]}set data(e){this.$$set({data:e}),Qe()}get requireLabel(){return this.$$.ctx[8]}set requireLabel(e){this.$$set({requireLabel:e}),Qe()}get isFake(){return this.$$.ctx[7]}set isFake(e){this.$$set({isFake:e}),Qe()}get loadExample(){return this.$$.ctx[9]}}const jt="4.51.0";let Bs=!1,yn,no,ro,pi,io,so,ao,oo,lo;function Tf(t,e={auto:!1}){if(Bs)throw new Error(`you must \`import 'openai/shims/${t.kind}'\` before importing anything else from openai`);if(yn)throw new Error(`can't \`import 'openai/shims/${t.kind}'\` after \`import 'openai/shims/${yn}'\``);Bs=e.auto,yn=t.kind,no=t.fetch,ro=t.FormData,pi=t.File,io=t.ReadableStream,so=t.getMultipartRequestOptions,ao=t.getDefaultAgent,oo=t.fileFromPath,lo=t.isFsReadStream}class Ff{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}}function Lf({manuallyImported:t}={}){const e=t?"You may need to use polyfills":"Add one of these imports before your first `import … from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let n,r,i,s;try{n=fetch,r=Request,i=Response,s=Headers}catch(o){throw new Error(`this environment is missing the following Web Fetch API type: ${o.message}. ${e}`)}return{kind:"web",fetch:n,Request:r,Response:i,Headers:s,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${e}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${e}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${e}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${e}`)}},getMultipartRequestOptions:async(o,l)=>({...l,body:new Ff(o)}),getDefaultAgent:o=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:o=>!1}}yn||Tf(Lf(),{auto:!0});class ce extends Error{}class Se extends ce{constructor(e,n,r,i){super(`${Se.makeMessage(e,n,r)}`),this.status=e,this.headers=i,this.request_id=i==null?void 0:i["x-request-id"];const s=n;this.error=s,this.code=s==null?void 0:s.code,this.param=s==null?void 0:s.param,this.type=s==null?void 0:s.type}static makeMessage(e,n,r){const i=n!=null&&n.message?typeof n.message=="string"?n.message:JSON.stringify(n.message):n?JSON.stringify(n):r;return e&&i?`${e} ${i}`:e?`${e} status code (no body)`:i||"(no status code or body)"}static generate(e,n,r,i){if(!e)return new Wr({cause:_i(n)});const s=n==null?void 0:n.error;return e===400?new uo(e,s,r,i):e===401?new co(e,s,r,i):e===403?new fo(e,s,r,i):e===404?new ho(e,s,r,i):e===409?new po(e,s,r,i):e===422?new mo(e,s,r,i):e===429?new _o(e,s,r,i):e>=500?new go(e,s,r,i):new Se(e,s,r,i)}}class ze extends Se{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0),this.status=void 0}}class Wr extends Se{constructor({message:e,cause:n}){super(void 0,void 0,e||"Connection error.",void 0),this.status=void 0,n&&(this.cause=n)}}class Hi extends Wr{constructor({message:e}={}){super({message:e??"Request timed out."})}}class uo extends Se{constructor(){super(...arguments),this.status=400}}class co extends Se{constructor(){super(...arguments),this.status=401}}class fo extends Se{constructor(){super(...arguments),this.status=403}}class ho extends Se{constructor(){super(...arguments),this.status=404}}class po extends Se{constructor(){super(...arguments),this.status=409}}class mo extends Se{constructor(){super(...arguments),this.status=422}}class _o extends Se{constructor(){super(...arguments),this.status=429}}class go extends Se{}class at{constructor(e,n){this.iterator=e,this.controller=n}static fromSSEResponse(e,n){let r=!1;async function*i(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let s=!1;try{for await(const o of Df(e,n))if(!s){if(o.data.startsWith("[DONE]")){s=!0;continue}if(o.event===null){let l;try{l=JSON.parse(o.data)}catch(a){throw console.error("Could not parse message into JSON:",o.data),console.error("From chunk:",o.raw),a}if(l&&l.error)throw new Se(void 0,l.error,void 0,void 0);yield l}else{let l;try{l=JSON.parse(o.data)}catch(a){throw console.error("Could not parse message into JSON:",o.data),console.error("From chunk:",o.raw),a}if(o.event=="error")throw new Se(void 0,l.error,l.message,void 0);yield{event:o.event,data:l}}}s=!0}catch(o){if(o instanceof Error&&o.name==="AbortError")return;throw o}finally{s||n.abort()}}return new at(i,n)}static fromReadableStream(e,n){let r=!1;async function*i(){const o=new $t,l=wo(e);for await(const a of l)for(const u of o.decode(a))yield u;for(const a of o.flush())yield a}async function*s(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let o=!1;try{for await(const l of i())o||l&&(yield JSON.parse(l));o=!0}catch(l){if(l instanceof Error&&l.name==="AbortError")return;throw l}finally{o||n.abort()}}return new at(s,n)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],n=[],r=this.iterator(),i=s=>({next:()=>{if(s.length===0){const o=r.next();e.push(o),n.push(o)}return s.shift()}});return[new at(()=>i(e),this.controller),new at(()=>i(n),this.controller)]}toReadableStream(){const e=this;let n;const r=new TextEncoder;return new io({async start(){n=e[Symbol.asyncIterator]()},async pull(i){try{const{value:s,done:o}=await n.next();if(o)return i.close();const l=r.encode(JSON.stringify(s)+`
`);i.enqueue(l)}catch(s){i.error(s)}},async cancel(){var i;await((i=n.return)==null?void 0:i.call(n))}})}}async function*Df(t,e){if(!t.body)throw e.abort(),new ce("Attempted to iterate over a response with no body");const n=new jf,r=new $t,i=wo(t.body);for await(const s of Bf(i))for(const o of r.decode(s)){const l=n.decode(o);l&&(yield l)}for(const s of r.flush()){const o=n.decode(s);o&&(yield o)}}async function*Bf(t){let e=new Uint8Array;for await(const n of t){if(n==null)continue;const r=n instanceof ArrayBuffer?new Uint8Array(n):typeof n=="string"?new TextEncoder().encode(n):n;let i=new Uint8Array(e.length+r.length);i.set(e),i.set(r,e.length),e=i;let s;for(;(s=qf(e))!==-1;)yield e.slice(0,s),e=e.slice(s)}e.length>0&&(yield e)}function qf(t){for(let r=0;r<t.length-2;r++){if(t[r]===10&&t[r+1]===10||t[r]===13&&t[r+1]===13)return r+2;if(t[r]===13&&t[r+1]===10&&r+3<t.length&&t[r+2]===13&&t[r+3]===10)return r+4}return-1}class jf{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const s={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],s}if(this.chunks.push(e),e.startsWith(":"))return null;let[n,r,i]=zf(e,":");return i.startsWith(" ")&&(i=i.substring(1)),n==="event"?this.event=i:n==="data"&&this.data.push(i),null}}class $t{constructor(){this.buffer=[],this.trailingCR=!1}decode(e){let n=this.decodeText(e);if(this.trailingCR&&(n="\r"+n,this.trailingCR=!1),n.endsWith("\r")&&(this.trailingCR=!0,n=n.slice(0,-1)),!n)return[];const r=$t.NEWLINE_CHARS.has(n[n.length-1]||"");let i=n.split($t.NEWLINE_REGEXP);return r&&i.pop(),i.length===1&&!r?(this.buffer.push(i[0]),[]):(this.buffer.length>0&&(i=[this.buffer.join("")+i[0],...i.slice(1)],this.buffer=[]),r||(this.buffer=[i.pop()||""]),i)}decodeText(e){if(e==null)return"";if(typeof e=="string")return e;if(typeof Buffer<"u"){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new ce(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new ce(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new ce("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){if(!this.buffer.length&&!this.trailingCR)return[];const e=[this.buffer.join("")];return this.buffer=[],this.trailingCR=!1,e}}$t.NEWLINE_CHARS=new Set([`
`,"\r"]);$t.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function zf(t,e){const n=t.indexOf(e);return n!==-1?[t.substring(0,n),e,t.substring(n+e.length)]:[t,"",""]}function wo(t){if(t[Symbol.asyncIterator])return t;const e=t.getReader();return{async next(){try{const n=await e.read();return n!=null&&n.done&&e.releaseLock(),n}catch(n){throw e.releaseLock(),n}},async return(){const n=e.cancel();return e.releaseLock(),await n,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}const yo=t=>t!=null&&typeof t=="object"&&typeof t.url=="string"&&typeof t.blob=="function",vo=t=>t!=null&&typeof t=="object"&&typeof t.name=="string"&&typeof t.lastModified=="number"&&Vi(t),Vi=t=>t!=null&&typeof t=="object"&&typeof t.size=="number"&&typeof t.type=="string"&&typeof t.text=="function"&&typeof t.slice=="function"&&typeof t.arrayBuffer=="function",Wf=t=>vo(t)||yo(t)||lo(t);async function bo(t,e,n){var i;if(t=await t,n??(n=vo(t)?{lastModified:t.lastModified,type:t.type}:{}),yo(t)){const s=await t.blob();return e||(e=new URL(t.url).pathname.split(/[\\/]/).pop()??"unknown_file"),new pi([s],e,n)}const r=await Xf(t);if(e||(e=Hf(t)??"unknown_file"),!n.type){const s=(i=r[0])==null?void 0:i.type;typeof s=="string"&&(n={...n,type:s})}return new pi(r,e,n)}async function Xf(t){var n;let e=[];if(typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer)e.push(t);else if(Vi(t))e.push(await t.arrayBuffer());else if(Vf(t))for await(const r of t)e.push(r);else throw new Error(`Unexpected data type: ${typeof t}; constructor: ${(n=t==null?void 0:t.constructor)==null?void 0:n.name}; props: ${Uf(t)}`);return e}function Uf(t){return`[${Object.getOwnPropertyNames(t).map(n=>`"${n}"`).join(", ")}]`}function Hf(t){var e;return Qr(t.name)||Qr(t.filename)||((e=Qr(t.path))==null?void 0:e.split(/[\\/]/).pop())}const Qr=t=>{if(typeof t=="string")return t;if(typeof Buffer<"u"&&t instanceof Buffer)return String(t)},Vf=t=>t!=null&&typeof t=="object"&&typeof t[Symbol.asyncIterator]=="function",qs=t=>t&&typeof t=="object"&&t.body&&t[Symbol.toStringTag]==="MultipartBody",kn=async t=>{const e=await Jf(t.body);return so(e,t)},Jf=async t=>{const e=new ro;return await Promise.all(Object.entries(t||{}).map(([n,r])=>mi(e,n,r))),e},mi=async(t,e,n)=>{if(n!==void 0){if(n==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")t.append(e,String(n));else if(Wf(n)){const r=await bo(n);t.append(e,r)}else if(Array.isArray(n))await Promise.all(n.map(r=>mi(t,e+"[]",r)));else if(typeof n=="object")await Promise.all(Object.entries(n).map(([r,i])=>mi(t,`${e}[${r}]`,i)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${n} instead`)}};var Jt={},Kf=function(t,e,n,r,i){if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(t,n),n},Gf=function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},Ln;async function xo(t){const{response:e}=t;if(t.options.stream)return Kt("response",e.status,e.url,e.headers,e.body),t.options.__streamClass?t.options.__streamClass.fromSSEResponse(e,t.controller):at.fromSSEResponse(e,t.controller);if(e.status===204)return null;if(t.options.__binaryResponse)return e;const n=e.headers.get("content-type");if((n==null?void 0:n.includes("application/json"))||(n==null?void 0:n.includes("application/vnd.api+json"))){const s=await e.json();return Kt("response",e.status,e.url,e.headers,s),s}const i=await e.text();return Kt("response",e.status,e.url,e.headers,i),i}class Xr extends Promise{constructor(e,n=xo){super(r=>{r(null)}),this.responsePromise=e,this.parseResponse=n}_thenUnwrap(e){return new Xr(this.responsePromise,async n=>e(await this.parseResponse(n)))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,n]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:n}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,n){return this.parse().then(e,n)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}class Qf{constructor({baseURL:e,maxRetries:n=2,timeout:r=6e5,httpAgent:i,fetch:s}){this.baseURL=e,this.maxRetries=Yr("maxRetries",n),this.timeout=Yr("timeout",r),this.httpAgent=i,this.fetch=s??no}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...rh(),...this.authHeaders(e)}}validateHeaders(e,n){}defaultIdempotencyKey(){return`stainless-node-retry-${oh()}`}get(e,n){return this.methodRequest("get",e,n)}post(e,n){return this.methodRequest("post",e,n)}patch(e,n){return this.methodRequest("patch",e,n)}put(e,n){return this.methodRequest("put",e,n)}delete(e,n){return this.methodRequest("delete",e,n)}methodRequest(e,n,r){return this.request(Promise.resolve(r).then(async i=>{const s=i&&Vi(i==null?void 0:i.body)?new DataView(await i.body.arrayBuffer()):(i==null?void 0:i.body)instanceof DataView?i.body:(i==null?void 0:i.body)instanceof ArrayBuffer?new DataView(i.body):i&&ArrayBuffer.isView(i==null?void 0:i.body)?new DataView(i.body.buffer):i==null?void 0:i.body;return{method:e,path:n,...i,body:s}}))}getAPIList(e,n,r){return this.requestAPIList(n,{method:"get",path:e,...r})}calculateContentLength(e){if(typeof e=="string"){if(typeof Buffer<"u")return Buffer.byteLength(e,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(e).length.toString()}else if(ArrayBuffer.isView(e))return e.byteLength.toString();return null}buildRequest(e){var p;const{method:n,path:r,query:i,headers:s={}}=e,o=ArrayBuffer.isView(e.body)||e.__binaryRequest&&typeof e.body=="string"?e.body:qs(e.body)?e.body.body:e.body?JSON.stringify(e.body,null,2):null,l=this.calculateContentLength(o),a=this.buildURL(r,i);"timeout"in e&&Yr("timeout",e.timeout);const u=e.timeout??this.timeout,c=e.httpAgent??this.httpAgent??ao(a),f=u+1e3;typeof((p=c==null?void 0:c.options)==null?void 0:p.timeout)=="number"&&f>(c.options.timeout??0)&&(c.options.timeout=f),this.idempotencyHeader&&n!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),s[this.idempotencyHeader]=e.idempotencyKey);const h=this.buildHeaders({options:e,headers:s,contentLength:l});return{req:{method:n,...o&&{body:o},headers:h,...c&&{agent:c},signal:e.signal??null},url:a,timeout:u}}buildHeaders({options:e,headers:n,contentLength:r}){const i={};r&&(i["content-length"]=r);const s=this.defaultHeaders(e);return Xs(i,s),Xs(i,n),qs(e.body)&&yn!=="node"&&delete i["content-type"],this.validateHeaders(i,n),i}async prepareOptions(e){}async prepareRequest(e,{url:n,options:r}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map(n=>[...n])):{...e}:{}}makeStatusError(e,n,r,i){return Se.generate(e,n,r,i)}request(e,n=null){return new Xr(this.makeRequest(e,n))}async makeRequest(e,n){var c,f;const r=await e;n==null&&(n=r.maxRetries??this.maxRetries),await this.prepareOptions(r);const{req:i,url:s,timeout:o}=this.buildRequest(r);if(await this.prepareRequest(i,{url:s,options:r}),Kt("request",s,r,i.headers),(c=r.signal)!=null&&c.aborted)throw new ze;const l=new AbortController,a=await this.fetchWithTimeout(s,i,o,l).catch(_i);if(a instanceof Error){if((f=r.signal)!=null&&f.aborted)throw new ze;if(n)return this.retryRequest(r,n);throw a.name==="AbortError"?new Hi:new Wr({cause:a})}const u=Zf(a.headers);if(!a.ok){if(n&&this.shouldRetry(a)){const x=`retrying, ${n} attempts remaining`;return Kt(`response (error; ${x})`,a.status,s,u),this.retryRequest(r,n,u)}const h=await a.text().catch(x=>_i(x).message),d=ih(h),p=d?void 0:h;throw Kt(`response (error; ${n?"(error; no more retries left)":"(error; not retryable)"})`,a.status,s,u,p),this.makeStatusError(a.status,d,p,u)}return{response:a,options:r,controller:l}}requestAPIList(e,n){const r=this.makeRequest(n,null);return new Yf(this,r,e)}buildURL(e,n){const r=ah(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),i=this.defaultQuery();return Ao(i)||(n={...i,...n}),typeof n=="object"&&n&&!Array.isArray(n)&&(r.search=this.stringifyQuery(n)),r.toString()}stringifyQuery(e){return Object.entries(e).filter(([n,r])=>typeof r<"u").map(([n,r])=>{if(typeof r=="string"||typeof r=="number"||typeof r=="boolean")return`${encodeURIComponent(n)}=${encodeURIComponent(r)}`;if(r===null)return`${encodeURIComponent(n)}=`;throw new ce(`Cannot stringify type ${typeof r}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(e,n,r,i){const{signal:s,...o}=n||{};s&&s.addEventListener("abort",()=>i.abort());const l=setTimeout(()=>i.abort(),r);return this.getRequestClient().fetch.call(void 0,e,{signal:i.signal,...o}).finally(()=>{clearTimeout(l)})}getRequestClient(){return{fetch:this.fetch}}shouldRetry(e){const n=e.headers.get("x-should-retry");return n==="true"?!0:n==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,n,r){let i;const s=r==null?void 0:r["retry-after-ms"];if(s){const l=parseFloat(s);Number.isNaN(l)||(i=l)}const o=r==null?void 0:r["retry-after"];if(o&&!i){const l=parseFloat(o);Number.isNaN(l)?i=Date.parse(o)-Date.now():i=l*1e3}if(!(i&&0<=i&&i<60*1e3)){const l=e.maxRetries??this.maxRetries;i=this.calculateDefaultRetryTimeoutMillis(n,l)}return await On(i),this.makeRequest(e,n-1)}calculateDefaultRetryTimeoutMillis(e,n){const s=n-e,o=Math.min(.5*Math.pow(2,s),8),l=1-Math.random()*.25;return o*l*1e3}getUserAgent(){return`${this.constructor.name}/JS ${jt}`}}class Co{constructor(e,n,r,i){Ln.set(this,void 0),Kf(this,Ln,e),this.options=i,this.response=n,this.body=r}hasNextPage(){return this.getPaginatedItems().length?this.nextPageInfo()!=null:!1}async getNextPage(){const e=this.nextPageInfo();if(!e)throw new ce("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const n={...this.options};if("params"in e&&typeof n.query=="object")n.query={...n.query,...e.params};else if("url"in e){const r=[...Object.entries(n.query||{}),...e.url.searchParams.entries()];for(const[i,s]of r)e.url.searchParams.set(i,s);n.query=void 0,n.path=e.url.toString()}return await Gf(this,Ln,"f").requestAPIList(this.constructor,n)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(Ln=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const n of e.getPaginatedItems())yield n}}class Yf extends Xr{constructor(e,n,r){super(n,async i=>new r(e,i.response,await xo(i),i.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const n of e)yield n}}const Zf=t=>new Proxy(Object.fromEntries(t.entries()),{get(e,n){const r=n.toString();return e[r.toLowerCase()]||e[r]}}),eh={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},We=t=>typeof t=="object"&&t!==null&&!Ao(t)&&Object.keys(t).every(e=>So(eh,e)),th=()=>{var e;if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":jt,"X-Stainless-OS":zs(Deno.build.os),"X-Stainless-Arch":js(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((e=Deno.version)==null?void 0:e.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":jt,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if(Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":jt,"X-Stainless-OS":zs(process.platform),"X-Stainless-Arch":js(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const t=nh();return t?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":jt,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${t.browser}`,"X-Stainless-Runtime-Version":t.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":jt,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function nh(){if(typeof navigator>"u"||!navigator)return null;const t=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:n}of t){const r=n.exec(navigator.userAgent);if(r){const i=r[1]||0,s=r[2]||0,o=r[3]||0;return{browser:e,version:`${i}.${s}.${o}`}}}return null}const js=t=>t==="x32"?"x32":t==="x86_64"||t==="x64"?"x64":t==="arm"?"arm":t==="aarch64"||t==="arm64"?"arm64":t?`other:${t}`:"unknown",zs=t=>(t=t.toLowerCase(),t.includes("ios")?"iOS":t==="android"?"Android":t==="darwin"?"MacOS":t==="win32"?"Windows":t==="freebsd"?"FreeBSD":t==="openbsd"?"OpenBSD":t==="linux"?"Linux":t?`Other:${t}`:"Unknown");let Ws;const rh=()=>Ws??(Ws=th()),ih=t=>{try{return JSON.parse(t)}catch{return}},sh=new RegExp("^(?:[a-z]+:)?//","i"),ah=t=>sh.test(t),On=t=>new Promise(e=>setTimeout(e,t)),Yr=(t,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new ce(`${t} must be an integer`);if(e<0)throw new ce(`${t} must be a positive integer`);return e},_i=t=>t instanceof Error?t:new Error(t),Dn=t=>{var e,n,r,i;if(typeof process<"u")return((e=Jt==null?void 0:Jt[t])==null?void 0:e.trim())??void 0;if(typeof Deno<"u")return(i=(r=(n=Deno.env)==null?void 0:n.get)==null?void 0:r.call(n,t))==null?void 0:i.trim()};function Ao(t){if(!t)return!0;for(const e in t)return!1;return!0}function So(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Xs(t,e){for(const n in e){if(!So(e,n))continue;const r=n.toLowerCase();if(!r)continue;const i=e[n];i===null?delete t[r]:i!==void 0&&(t[r]=i)}}function Kt(t,...e){typeof process<"u"&&(Jt==null?void 0:Jt.DEBUG)==="true"&&console.log(`OpenAI:DEBUG:${t}`,...e)}const oh=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)}),lh=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u";function Us(t){return t!=null&&typeof t=="object"&&!Array.isArray(t)}class Ji extends Co{constructor(e,n,r,i){super(e,n,r,i),this.data=r.data||[],this.object=r.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}}class nt extends Co{constructor(e,n,r,i){super(e,n,r,i),this.data=r.data||[]}getPaginatedItems(){return this.data??[]}nextPageParams(){const e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;const n=Object.fromEntries(e.url.searchParams);return Object.keys(n).length?n:null}nextPageInfo(){var r;const e=this.getPaginatedItems();if(!e.length)return null;const n=(r=e[e.length-1])==null?void 0:r.id;return n?{params:{after:n}}:null}}class pe{constructor(e){this._client=e}}let fr=class extends pe{create(e,n){return this._client.post("/chat/completions",{body:e,...n,stream:e.stream??!1})}};fr||(fr={});let hr=class extends pe{constructor(){super(...arguments),this.completions=new fr(this._client)}};(function(t){t.Completions=fr})(hr||(hr={}));class dr extends pe{create(e,n){return this._client.post("/audio/speech",{body:e,...n,__binaryResponse:!0})}}dr||(dr={});class pr extends pe{create(e,n){return this._client.post("/audio/transcriptions",kn({body:e,...n}))}}pr||(pr={});class mr extends pe{create(e,n){return this._client.post("/audio/translations",kn({body:e,...n}))}}mr||(mr={});class _r extends pe{constructor(){super(...arguments),this.transcriptions=new pr(this._client),this.translations=new mr(this._client),this.speech=new dr(this._client)}}(function(t){t.Transcriptions=pr,t.Translations=mr,t.Speech=dr})(_r||(_r={}));class gr extends pe{create(e,n){return this._client.post("/batches",{body:e,...n})}retrieve(e,n){return this._client.get(`/batches/${e}`,n)}list(e={},n){return We(e)?this.list({},e):this._client.getAPIList("/batches",Ki,{query:e,...n})}cancel(e,n){return this._client.post(`/batches/${e}/cancel`,n)}}class Ki extends nt{}(function(t){t.BatchesPage=Ki})(gr||(gr={}));class wr extends pe{create(e,n){return this._client.post("/assistants",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,n){return this._client.get(`/assistants/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(e,n,r){return this._client.post(`/assistants/${e}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(e={},n){return We(e)?this.list({},e):this._client.getAPIList("/assistants",Gi,{query:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,n){return this._client.delete(`/assistants/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class Gi extends nt{}(function(t){t.AssistantsPage=Gi})(wr||(wr={}));function Hs(t){return typeof t.parse=="function"}const Gt=t=>(t==null?void 0:t.role)==="assistant",ko=t=>(t==null?void 0:t.role)==="function",Eo=t=>(t==null?void 0:t.role)==="tool";var Ve=function(t,e,n,r,i){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?i.call(t,n):i?i.value=n:e.set(t,n),n},se=function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},ke,Hn,Vn,on,ln,Jn,un,dt,cn,Kn,Gn,zt,gi,yr,wi,yi,vi,bi,Ro,xi;const Vs=10;class Po{constructor(){ke.add(this),this.controller=new AbortController,Hn.set(this,void 0),Vn.set(this,()=>{}),on.set(this,()=>{}),ln.set(this,void 0),Jn.set(this,()=>{}),un.set(this,()=>{}),dt.set(this,{}),this._chatCompletions=[],this.messages=[],cn.set(this,!1),Kn.set(this,!1),Gn.set(this,!1),zt.set(this,!1),bi.set(this,e=>{if(Ve(this,Kn,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new ze),e instanceof ze)return Ve(this,Gn,!0,"f"),this._emit("abort",e);if(e instanceof ce)return this._emit("error",e);if(e instanceof Error){const n=new ce(e.message);return n.cause=e,this._emit("error",n)}return this._emit("error",new ce(String(e)))}),Ve(this,Hn,new Promise((e,n)=>{Ve(this,Vn,e,"f"),Ve(this,on,n,"f")}),"f"),Ve(this,ln,new Promise((e,n)=>{Ve(this,Jn,e,"f"),Ve(this,un,n,"f")}),"f"),se(this,Hn,"f").catch(()=>{}),se(this,ln,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},se(this,bi,"f"))},0)}_addChatCompletion(e){var r;this._chatCompletions.push(e),this._emit("chatCompletion",e);const n=(r=e.choices[0])==null?void 0:r.message;return n&&this._addMessage(n),e}_addMessage(e,n=!0){if("content"in e||(e.content=null),this.messages.push(e),n){if(this._emit("message",e),(ko(e)||Eo(e))&&e.content)this._emit("functionCallResult",e.content);else if(Gt(e)&&e.function_call)this._emit("functionCall",e.function_call);else if(Gt(e)&&e.tool_calls)for(const r of e.tool_calls)r.type==="function"&&this._emit("functionCall",r.function)}}_connected(){this.ended||(se(this,Vn,"f").call(this),this._emit("connect"))}get ended(){return se(this,cn,"f")}get errored(){return se(this,Kn,"f")}get aborted(){return se(this,Gn,"f")}abort(){this.controller.abort()}on(e,n){return(se(this,dt,"f")[e]||(se(this,dt,"f")[e]=[])).push({listener:n}),this}off(e,n){const r=se(this,dt,"f")[e];if(!r)return this;const i=r.findIndex(s=>s.listener===n);return i>=0&&r.splice(i,1),this}once(e,n){return(se(this,dt,"f")[e]||(se(this,dt,"f")[e]=[])).push({listener:n,once:!0}),this}emitted(e){return new Promise((n,r)=>{Ve(this,zt,!0,"f"),e!=="error"&&this.once("error",r),this.once(e,n)})}async done(){Ve(this,zt,!0,"f"),await se(this,ln,"f")}async finalChatCompletion(){await this.done();const e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new ce("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),se(this,ke,"m",gi).call(this)}async finalMessage(){return await this.done(),se(this,ke,"m",yr).call(this)}async finalFunctionCall(){return await this.done(),se(this,ke,"m",wi).call(this)}async finalFunctionCallResult(){return await this.done(),se(this,ke,"m",yi).call(this)}async totalUsage(){return await this.done(),se(this,ke,"m",vi).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emit(e,...n){if(se(this,cn,"f"))return;e==="end"&&(Ve(this,cn,!0,"f"),se(this,Jn,"f").call(this));const r=se(this,dt,"f")[e];if(r&&(se(this,dt,"f")[e]=r.filter(i=>!i.once),r.forEach(({listener:i})=>i(...n))),e==="abort"){const i=n[0];!se(this,zt,"f")&&!(r!=null&&r.length)&&Promise.reject(i),se(this,on,"f").call(this,i),se(this,un,"f").call(this,i),this._emit("end");return}if(e==="error"){const i=n[0];!se(this,zt,"f")&&!(r!=null&&r.length)&&Promise.reject(i),se(this,on,"f").call(this,i),se(this,un,"f").call(this,i),this._emit("end")}}_emitFinal(){const e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);const n=se(this,ke,"m",yr).call(this);n&&this._emit("finalMessage",n);const r=se(this,ke,"m",gi).call(this);r&&this._emit("finalContent",r);const i=se(this,ke,"m",wi).call(this);i&&this._emit("finalFunctionCall",i);const s=se(this,ke,"m",yi).call(this);s!=null&&this._emit("finalFunctionCallResult",s),this._chatCompletions.some(o=>o.usage)&&this._emit("totalUsage",se(this,ke,"m",vi).call(this))}async _createChatCompletion(e,n,r){const i=r==null?void 0:r.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort())),se(this,ke,"m",Ro).call(this,n);const s=await e.create({...n,stream:!1},{...r,signal:this.controller.signal});return this._connected(),this._addChatCompletion(s)}async _runChatCompletion(e,n,r){for(const i of n.messages)this._addMessage(i,!1);return await this._createChatCompletion(e,n,r)}async _runFunctions(e,n,r){var h;const i="function",{function_call:s="auto",stream:o,...l}=n,a=typeof s!="string"&&(s==null?void 0:s.name),{maxChatCompletions:u=Vs}=r||{},c={};for(const d of n.functions)c[d.name||d.function.name]=d;const f=n.functions.map(d=>({name:d.name||d.function.name,parameters:d.parameters,description:d.description}));for(const d of n.messages)this._addMessage(d,!1);for(let d=0;d<u;++d){const w=(h=(await this._createChatCompletion(e,{...l,function_call:s,functions:f,messages:[...this.messages]},r)).choices[0])==null?void 0:h.message;if(!w)throw new ce("missing message in ChatCompletion response");if(!w.function_call)return;const{name:v,arguments:x}=w.function_call,C=c[v];if(C){if(a&&a!==v){const P=`Invalid function_call: ${JSON.stringify(v)}. ${JSON.stringify(a)} requested. Please try again`;this._addMessage({role:i,name:v,content:P});continue}}else{const P=`Invalid function_call: ${JSON.stringify(v)}. Available options are: ${f.map(b=>JSON.stringify(b.name)).join(", ")}. Please try again`;this._addMessage({role:i,name:v,content:P});continue}let R;try{R=Hs(C)?await C.parse(x):x}catch(P){this._addMessage({role:i,name:v,content:P instanceof Error?P.message:String(P)});continue}const M=await C.function(R,this),E=se(this,ke,"m",xi).call(this,M);if(this._addMessage({role:i,name:v,content:E}),a)return}}async _runTools(e,n,r){var h,d;const i="tool",{tool_choice:s="auto",stream:o,...l}=n,a=typeof s!="string"&&((h=s==null?void 0:s.function)==null?void 0:h.name),{maxChatCompletions:u=Vs}=r||{},c={};for(const p of n.tools)p.type==="function"&&(c[p.function.name||p.function.function.name]=p.function);const f="tools"in n?n.tools.map(p=>p.type==="function"?{type:"function",function:{name:p.function.name||p.function.function.name,parameters:p.function.parameters,description:p.function.description}}:p):void 0;for(const p of n.messages)this._addMessage(p,!1);for(let p=0;p<u;++p){const v=(d=(await this._createChatCompletion(e,{...l,tool_choice:s,tools:f,messages:[...this.messages]},r)).choices[0])==null?void 0:d.message;if(!v)throw new ce("missing message in ChatCompletion response");if(!v.tool_calls)return;for(const x of v.tool_calls){if(x.type!=="function")continue;const C=x.id,{name:R,arguments:M}=x.function,E=c[R];if(E){if(a&&a!==R){const m=`Invalid tool_call: ${JSON.stringify(R)}. ${JSON.stringify(a)} requested. Please try again`;this._addMessage({role:i,tool_call_id:C,content:m});continue}}else{const m=`Invalid tool_call: ${JSON.stringify(R)}. Available options are: ${f.map(A=>JSON.stringify(A.function.name)).join(", ")}. Please try again`;this._addMessage({role:i,tool_call_id:C,content:m});continue}let P;try{P=Hs(E)?await E.parse(M):M}catch(m){const A=m instanceof Error?m.message:String(m);this._addMessage({role:i,tool_call_id:C,content:A});continue}const b=await E.function(P,this),_=se(this,ke,"m",xi).call(this,b);if(this._addMessage({role:i,tool_call_id:C,content:_}),a)return}}}}Hn=new WeakMap,Vn=new WeakMap,on=new WeakMap,ln=new WeakMap,Jn=new WeakMap,un=new WeakMap,dt=new WeakMap,cn=new WeakMap,Kn=new WeakMap,Gn=new WeakMap,zt=new WeakMap,bi=new WeakMap,ke=new WeakSet,gi=function(){return se(this,ke,"m",yr).call(this).content??null},yr=function(){let e=this.messages.length;for(;e-- >0;){const n=this.messages[e];if(Gt(n)){const{function_call:r,...i}=n,s={...i,content:n.content??null};return r&&(s.function_call=r),s}}throw new ce("stream ended without producing a ChatCompletionMessage with role=assistant")},wi=function(){var e,n;for(let r=this.messages.length-1;r>=0;r--){const i=this.messages[r];if(Gt(i)&&(i!=null&&i.function_call))return i.function_call;if(Gt(i)&&((e=i==null?void 0:i.tool_calls)!=null&&e.length))return(n=i.tool_calls.at(-1))==null?void 0:n.function}},yi=function(){for(let e=this.messages.length-1;e>=0;e--){const n=this.messages[e];if(ko(n)&&n.content!=null||Eo(n)&&n.content!=null&&this.messages.some(r=>{var i;return r.role==="assistant"&&((i=r.tool_calls)==null?void 0:i.some(s=>s.type==="function"&&s.id===n.tool_call_id))}))return n.content}},vi=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:n}of this._chatCompletions)n&&(e.completion_tokens+=n.completion_tokens,e.prompt_tokens+=n.prompt_tokens,e.total_tokens+=n.total_tokens);return e},Ro=function(e){if(e.n!=null&&e.n>1)throw new ce("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},xi=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};class En extends Po{static runFunctions(e,n,r){const i=new En,s={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runFunctions"}};return i._run(()=>i._runFunctions(e,n,s)),i}static runTools(e,n,r){const i=new En,s={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runTools"}};return i._run(()=>i._runTools(e,n,s)),i}_addMessage(e){super._addMessage(e),Gt(e)&&e.content&&this._emit("content",e.content)}}var Je=function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},Zr=function(t,e,n,r,i){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?i.call(t,n):i?i.value=n:e.set(t,n),n},rt,yt,ei,ti,Bn,Js;class Rn extends Po{constructor(){super(...arguments),rt.add(this),yt.set(this,void 0)}get currentChatCompletionSnapshot(){return Je(this,yt,"f")}static fromReadableStream(e){const n=new Rn;return n._run(()=>n._fromReadableStream(e)),n}static createChatCompletion(e,n,r){const i=new Rn;return i._run(()=>i._runChatCompletion(e,{...n,stream:!0},{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),i}async _createChatCompletion(e,n,r){var o;const i=r==null?void 0:r.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort())),Je(this,rt,"m",ei).call(this);const s=await e.create({...n,stream:!0},{...r,signal:this.controller.signal});this._connected();for await(const l of s)Je(this,rt,"m",ti).call(this,l);if((o=s.controller.signal)!=null&&o.aborted)throw new ze;return this._addChatCompletion(Je(this,rt,"m",Bn).call(this))}async _fromReadableStream(e,n){var o;const r=n==null?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),Je(this,rt,"m",ei).call(this),this._connected();const i=at.fromReadableStream(e,this.controller);let s;for await(const l of i)s&&s!==l.id&&this._addChatCompletion(Je(this,rt,"m",Bn).call(this)),Je(this,rt,"m",ti).call(this,l),s=l.id;if((o=i.controller.signal)!=null&&o.aborted)throw new ze;return this._addChatCompletion(Je(this,rt,"m",Bn).call(this))}[(yt=new WeakMap,rt=new WeakSet,ei=function(){this.ended||Zr(this,yt,void 0,"f")},ti=function(n){var o,l,a;if(this.ended)return;const r=Je(this,rt,"m",Js).call(this,n);this._emit("chunk",n,r);const i=(l=(o=n.choices[0])==null?void 0:o.delta)==null?void 0:l.content,s=(a=r.choices[0])==null?void 0:a.message;i!=null&&(s==null?void 0:s.role)==="assistant"&&(s!=null&&s.content)&&this._emit("content",i,s.content)},Bn=function(){if(this.ended)throw new ce("stream has ended, this shouldn't happen");const n=Je(this,yt,"f");if(!n)throw new ce("request ended without sending any chunks");return Zr(this,yt,void 0,"f"),uh(n)},Js=function(n){var r,i,s;let o=Je(this,yt,"f");const{choices:l,...a}=n;o?Object.assign(o,a):o=Zr(this,yt,{...a,choices:[]},"f");for(const{delta:u,finish_reason:c,index:f,logprobs:h=null,...d}of n.choices){let p=o.choices[f];if(p||(p=o.choices[f]={finish_reason:c,index:f,message:{},logprobs:h,...d}),h)if(!p.logprobs)p.logprobs=Object.assign({},h);else{const{content:M,...E}=h;Object.assign(p.logprobs,E),M&&((r=p.logprobs).content??(r.content=[]),p.logprobs.content.push(...M))}if(c&&(p.finish_reason=c),Object.assign(p,d),!u)continue;const{content:w,function_call:v,role:x,tool_calls:C,...R}=u;if(Object.assign(p.message,R),w&&(p.message.content=(p.message.content||"")+w),x&&(p.message.role=x),v&&(p.message.function_call?(v.name&&(p.message.function_call.name=v.name),v.arguments&&((i=p.message.function_call).arguments??(i.arguments=""),p.message.function_call.arguments+=v.arguments)):p.message.function_call=v),C){p.message.tool_calls||(p.message.tool_calls=[]);for(const{index:M,id:E,type:P,function:b,..._}of C){const m=(s=p.message.tool_calls)[M]??(s[M]={});Object.assign(m,_),E&&(m.id=E),P&&(m.type=P),b&&(m.function??(m.function={arguments:""})),b!=null&&b.name&&(m.function.name=b.name),b!=null&&b.arguments&&(m.function.arguments+=b.arguments)}}}return o},Symbol.asyncIterator)](){const e=[],n=[];let r=!1;return this.on("chunk",i=>{const s=n.shift();s?s.resolve(i):e.push(i)}),this.on("end",()=>{r=!0;for(const i of n)i.resolve(void 0);n.length=0}),this.on("abort",i=>{r=!0;for(const s of n)s.reject(i);n.length=0}),this.on("error",i=>{r=!0;for(const s of n)s.reject(i);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((s,o)=>n.push({resolve:s,reject:o})).then(s=>s?{value:s,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new at(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function uh(t){const{id:e,choices:n,created:r,model:i,system_fingerprint:s,...o}=t;return{...o,id:e,choices:n.map(({message:l,finish_reason:a,index:u,logprobs:c,...f})=>{if(!a)throw new ce(`missing finish_reason for choice ${u}`);const{content:h=null,function_call:d,tool_calls:p,...w}=l,v=l.role;if(!v)throw new ce(`missing role for choice ${u}`);if(d){const{arguments:x,name:C}=d;if(x==null)throw new ce(`missing function_call.arguments for choice ${u}`);if(!C)throw new ce(`missing function_call.name for choice ${u}`);return{...f,message:{content:h,function_call:{arguments:x,name:C},role:v},finish_reason:a,index:u,logprobs:c}}return p?{...f,index:u,finish_reason:a,logprobs:c,message:{...w,role:v,content:h,tool_calls:p.map((x,C)=>{const{function:R,type:M,id:E,...P}=x,{arguments:b,name:_,...m}=R||{};if(E==null)throw new ce(`missing choices[${u}].tool_calls[${C}].id
${qn(t)}`);if(M==null)throw new ce(`missing choices[${u}].tool_calls[${C}].type
${qn(t)}`);if(_==null)throw new ce(`missing choices[${u}].tool_calls[${C}].function.name
${qn(t)}`);if(b==null)throw new ce(`missing choices[${u}].tool_calls[${C}].function.arguments
${qn(t)}`);return{...P,id:E,type:M,function:{...m,name:_,arguments:b}}})}}:{...f,message:{...w,content:h,role:v},finish_reason:a,index:u,logprobs:c}}),created:r,model:i,object:"chat.completion",...s?{system_fingerprint:s}:{}}}function qn(t){return JSON.stringify(t)}class Qt extends Rn{static fromReadableStream(e){const n=new Qt;return n._run(()=>n._fromReadableStream(e)),n}static runFunctions(e,n,r){const i=new Qt,s={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runFunctions"}};return i._run(()=>i._runFunctions(e,n,s)),i}static runTools(e,n,r){const i=new Qt,s={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runTools"}};return i._run(()=>i._runTools(e,n,s)),i}}let Io=class extends pe{runFunctions(e,n){return e.stream?Qt.runFunctions(this._client.chat.completions,e,n):En.runFunctions(this._client.chat.completions,e,n)}runTools(e,n){return e.stream?Qt.runTools(this._client.chat.completions,e,n):En.runTools(this._client.chat.completions,e,n)}stream(e,n){return Rn.createChatCompletion(this._client.chat.completions,e,n)}};class vr extends pe{constructor(){super(...arguments),this.completions=new Io(this._client)}}(function(t){t.Completions=Io})(vr||(vr={}));var Ke=function(t,e,n,r,i){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?i.call(t,n):i?i.value=n:e.set(t,n),n},_e=function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},Qn,Yn,fn,hn,Zn,dn,pt,pn,er,tr,Wt,Ci;class ch{constructor(){this.controller=new AbortController,Qn.set(this,void 0),Yn.set(this,()=>{}),fn.set(this,()=>{}),hn.set(this,void 0),Zn.set(this,()=>{}),dn.set(this,()=>{}),pt.set(this,{}),pn.set(this,!1),er.set(this,!1),tr.set(this,!1),Wt.set(this,!1),Ci.set(this,e=>{if(Ke(this,er,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new ze),e instanceof ze)return Ke(this,tr,!0,"f"),this._emit("abort",e);if(e instanceof ce)return this._emit("error",e);if(e instanceof Error){const n=new ce(e.message);return n.cause=e,this._emit("error",n)}return this._emit("error",new ce(String(e)))}),Ke(this,Qn,new Promise((e,n)=>{Ke(this,Yn,e,"f"),Ke(this,fn,n,"f")}),"f"),Ke(this,hn,new Promise((e,n)=>{Ke(this,Zn,e,"f"),Ke(this,dn,n,"f")}),"f"),_e(this,Qn,"f").catch(()=>{}),_e(this,hn,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emit("end")},_e(this,Ci,"f"))},0)}_addRun(e){return e}_connected(){this.ended||(_e(this,Yn,"f").call(this),this._emit("connect"))}get ended(){return _e(this,pn,"f")}get errored(){return _e(this,er,"f")}get aborted(){return _e(this,tr,"f")}abort(){this.controller.abort()}on(e,n){return(_e(this,pt,"f")[e]||(_e(this,pt,"f")[e]=[])).push({listener:n}),this}off(e,n){const r=_e(this,pt,"f")[e];if(!r)return this;const i=r.findIndex(s=>s.listener===n);return i>=0&&r.splice(i,1),this}once(e,n){return(_e(this,pt,"f")[e]||(_e(this,pt,"f")[e]=[])).push({listener:n,once:!0}),this}emitted(e){return new Promise((n,r)=>{Ke(this,Wt,!0,"f"),e!=="error"&&this.once("error",r),this.once(e,n)})}async done(){Ke(this,Wt,!0,"f"),await _e(this,hn,"f")}_emit(e,...n){if(_e(this,pn,"f"))return;e==="end"&&(Ke(this,pn,!0,"f"),_e(this,Zn,"f").call(this));const r=_e(this,pt,"f")[e];if(r&&(_e(this,pt,"f")[e]=r.filter(i=>!i.once),r.forEach(({listener:i})=>i(...n))),e==="abort"){const i=n[0];!_e(this,Wt,"f")&&!(r!=null&&r.length)&&Promise.reject(i),_e(this,fn,"f").call(this,i),_e(this,dn,"f").call(this,i),this._emit("end");return}if(e==="error"){const i=n[0];!_e(this,Wt,"f")&&!(r!=null&&r.length)&&Promise.reject(i),_e(this,fn,"f").call(this,i),_e(this,dn,"f").call(this,i),this._emit("end")}}async _threadAssistantStream(e,n,r){return await this._createThreadAssistantStream(n,e,r)}async _runAssistantStream(e,n,r,i){return await this._createAssistantStream(n,e,r,i)}async _runToolAssistantStream(e,n,r,i,s){return await this._createToolAssistantStream(r,e,n,i,s)}async _createThreadAssistantStream(e,n,r){const i=r==null?void 0:r.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));const s=await e.createAndRun({...n,stream:!1},{...r,signal:this.controller.signal});return this._connected(),this._addRun(s)}async _createToolAssistantStream(e,n,r,i,s){const o=s==null?void 0:s.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",()=>this.controller.abort()));const l=await e.submitToolOutputs(n,r,{...i,stream:!1},{...s,signal:this.controller.signal});return this._connected(),this._addRun(l)}async _createAssistantStream(e,n,r,i){const s=i==null?void 0:i.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort()));const o=await e.create(n,{...r,stream:!1},{...i,signal:this.controller.signal});return this._connected(),this._addRun(o)}}Qn=new WeakMap,Yn=new WeakMap,fn=new WeakMap,hn=new WeakMap,Zn=new WeakMap,dn=new WeakMap,pt=new WeakMap,pn=new WeakMap,er=new WeakMap,tr=new WeakMap,Wt=new WeakMap,Ci=new WeakMap;var U=function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},Le=function(t,e,n,r,i){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?i.call(t,n):i?i.value=n:e.set(t,n),n},Ce,Ai,st,nr,Ge,It,Ut,Et,br,De,rr,ir,vn,mn,_n,Ks,Gs,Qs,Ys,Zs,ea,ta;class Ze extends ch{constructor(){super(...arguments),Ce.add(this),Ai.set(this,[]),st.set(this,{}),nr.set(this,{}),Ge.set(this,void 0),It.set(this,void 0),Ut.set(this,void 0),Et.set(this,void 0),br.set(this,void 0),De.set(this,void 0),rr.set(this,void 0),ir.set(this,void 0),vn.set(this,void 0)}[(Ai=new WeakMap,st=new WeakMap,nr=new WeakMap,Ge=new WeakMap,It=new WeakMap,Ut=new WeakMap,Et=new WeakMap,br=new WeakMap,De=new WeakMap,rr=new WeakMap,ir=new WeakMap,vn=new WeakMap,Ce=new WeakSet,Symbol.asyncIterator)](){const e=[],n=[];let r=!1;return this.on("event",i=>{const s=n.shift();s?s.resolve(i):e.push(i)}),this.on("end",()=>{r=!0;for(const i of n)i.resolve(void 0);n.length=0}),this.on("abort",i=>{r=!0;for(const s of n)s.reject(i);n.length=0}),this.on("error",i=>{r=!0;for(const s of n)s.reject(i);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((s,o)=>n.push({resolve:s,reject:o})).then(s=>s?{value:s,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){const n=new Ze;return n._run(()=>n._fromReadableStream(e)),n}async _fromReadableStream(e,n){var s;const r=n==null?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),this._connected();const i=at.fromReadableStream(e,this.controller);for await(const o of i)U(this,Ce,"m",mn).call(this,o);if((s=i.controller.signal)!=null&&s.aborted)throw new ze;return this._addRun(U(this,Ce,"m",_n).call(this))}toReadableStream(){return new at(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,n,r,i,s){const o=new Ze;return o._run(()=>o._runToolAssistantStream(e,n,r,i,{...s,headers:{...s==null?void 0:s.headers,"X-Stainless-Helper-Method":"stream"}})),o}async _createToolAssistantStream(e,n,r,i,s){var u;const o=s==null?void 0:s.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",()=>this.controller.abort()));const l={...i,stream:!0},a=await e.submitToolOutputs(n,r,l,{...s,signal:this.controller.signal});this._connected();for await(const c of a)U(this,Ce,"m",mn).call(this,c);if((u=a.controller.signal)!=null&&u.aborted)throw new ze;return this._addRun(U(this,Ce,"m",_n).call(this))}static createThreadAssistantStream(e,n,r){const i=new Ze;return i._run(()=>i._threadAssistantStream(e,n,{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),i}static createAssistantStream(e,n,r,i){const s=new Ze;return s._run(()=>s._runAssistantStream(e,n,r,{...i,headers:{...i==null?void 0:i.headers,"X-Stainless-Helper-Method":"stream"}})),s}currentEvent(){return U(this,rr,"f")}currentRun(){return U(this,ir,"f")}currentMessageSnapshot(){return U(this,Ge,"f")}currentRunStepSnapshot(){return U(this,vn,"f")}async finalRunSteps(){return await this.done(),Object.values(U(this,st,"f"))}async finalMessages(){return await this.done(),Object.values(U(this,nr,"f"))}async finalRun(){if(await this.done(),!U(this,It,"f"))throw Error("Final run was not received.");return U(this,It,"f")}async _createThreadAssistantStream(e,n,r){var l;const i=r==null?void 0:r.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));const s={...n,stream:!0},o=await e.createAndRun(s,{...r,signal:this.controller.signal});this._connected();for await(const a of o)U(this,Ce,"m",mn).call(this,a);if((l=o.controller.signal)!=null&&l.aborted)throw new ze;return this._addRun(U(this,Ce,"m",_n).call(this))}async _createAssistantStream(e,n,r,i){var a;const s=i==null?void 0:i.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort()));const o={...r,stream:!0},l=await e.create(n,o,{...i,signal:this.controller.signal});this._connected();for await(const u of l)U(this,Ce,"m",mn).call(this,u);if((a=l.controller.signal)!=null&&a.aborted)throw new ze;return this._addRun(U(this,Ce,"m",_n).call(this))}static accumulateDelta(e,n){for(const[r,i]of Object.entries(n)){if(!e.hasOwnProperty(r)){e[r]=i;continue}let s=e[r];if(s==null){e[r]=i;continue}if(r==="index"||r==="type"){e[r]=i;continue}if(typeof s=="string"&&typeof i=="string")s+=i;else if(typeof s=="number"&&typeof i=="number")s+=i;else if(Us(s)&&Us(i))s=this.accumulateDelta(s,i);else if(Array.isArray(s)&&Array.isArray(i)){if(s.every(o=>typeof o=="string"||typeof o=="number")){s.push(...i);continue}}else throw Error(`Unhandled record type: ${r}, deltaValue: ${i}, accValue: ${s}`);e[r]=s}return e}}mn=function(e){if(!this.ended)switch(Le(this,rr,e,"f"),U(this,Ce,"m",Qs).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":U(this,Ce,"m",ta).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":U(this,Ce,"m",Gs).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":U(this,Ce,"m",Ks).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},_n=function(){if(this.ended)throw new ce("stream has ended, this shouldn't happen");if(!U(this,It,"f"))throw Error("Final run has not been received");return U(this,It,"f")},Ks=function(e){const[n,r]=U(this,Ce,"m",Zs).call(this,e,U(this,Ge,"f"));Le(this,Ge,n,"f"),U(this,nr,"f")[n.id]=n;for(const i of r){const s=n.content[i.index];(s==null?void 0:s.type)=="text"&&this._emit("textCreated",s.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,n),e.data.delta.content)for(const i of e.data.delta.content){if(i.type=="text"&&i.text){let s=i.text,o=n.content[i.index];if(o&&o.type=="text")this._emit("textDelta",s,o.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(i.index!=U(this,Ut,"f")){if(U(this,Et,"f"))switch(U(this,Et,"f").type){case"text":this._emit("textDone",U(this,Et,"f").text,U(this,Ge,"f"));break;case"image_file":this._emit("imageFileDone",U(this,Et,"f").image_file,U(this,Ge,"f"));break}Le(this,Ut,i.index,"f")}Le(this,Et,n.content[i.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(U(this,Ut,"f")!==void 0){const i=e.data.content[U(this,Ut,"f")];if(i)switch(i.type){case"image_file":this._emit("imageFileDone",i.image_file,U(this,Ge,"f"));break;case"text":this._emit("textDone",i.text,U(this,Ge,"f"));break}}U(this,Ge,"f")&&this._emit("messageDone",e.data),Le(this,Ge,void 0,"f")}},Gs=function(e){const n=U(this,Ce,"m",Ys).call(this,e);switch(Le(this,vn,n,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const r=e.data.delta;if(r.step_details&&r.step_details.type=="tool_calls"&&r.step_details.tool_calls&&n.step_details.type=="tool_calls")for(const s of r.step_details.tool_calls)s.index==U(this,br,"f")?this._emit("toolCallDelta",s,n.step_details.tool_calls[s.index]):(U(this,De,"f")&&this._emit("toolCallDone",U(this,De,"f")),Le(this,br,s.index,"f"),Le(this,De,n.step_details.tool_calls[s.index],"f"),U(this,De,"f")&&this._emit("toolCallCreated",U(this,De,"f")));this._emit("runStepDelta",e.data.delta,n);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":Le(this,vn,void 0,"f"),e.data.step_details.type=="tool_calls"&&U(this,De,"f")&&(this._emit("toolCallDone",U(this,De,"f")),Le(this,De,void 0,"f")),this._emit("runStepDone",e.data,n);break}},Qs=function(e){U(this,Ai,"f").push(e),this._emit("event",e)},Ys=function(e){switch(e.event){case"thread.run.step.created":return U(this,st,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let n=U(this,st,"f")[e.data.id];if(!n)throw Error("Received a RunStepDelta before creation of a snapshot");let r=e.data;if(r.delta){const i=Ze.accumulateDelta(n,r.delta);U(this,st,"f")[e.data.id]=i}return U(this,st,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":U(this,st,"f")[e.data.id]=e.data;break}if(U(this,st,"f")[e.data.id])return U(this,st,"f")[e.data.id];throw new Error("No snapshot available")},Zs=function(e,n){let r=[];switch(e.event){case"thread.message.created":return[e.data,r];case"thread.message.delta":if(!n)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let i=e.data;if(i.delta.content)for(const s of i.delta.content)if(s.index in n.content){let o=n.content[s.index];n.content[s.index]=U(this,Ce,"m",ea).call(this,s,o)}else n.content[s.index]=s,r.push(s);return[n,r];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(n)return[n,r];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},ea=function(e,n){return Ze.accumulateDelta(n,e)},ta=function(e){switch(Le(this,ir,e.data,"f"),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":Le(this,It,e.data,"f"),U(this,De,"f")&&(this._emit("toolCallDone",U(this,De,"f")),Le(this,De,void 0,"f"));break}};class xr extends pe{create(e,n,r){return this._client.post(`/threads/${e}/messages`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,n,r){return this._client.get(`/threads/${e}/messages/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(e,n,r,i){return this._client.post(`/threads/${e}/messages/${n}`,{body:r,...i,headers:{"OpenAI-Beta":"assistants=v2",...i==null?void 0:i.headers}})}list(e,n={},r){return We(n)?this.list(e,{},n):this._client.getAPIList(`/threads/${e}/messages`,Qi,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(e,n,r){return this._client.delete(`/threads/${e}/messages/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}}class Qi extends nt{}(function(t){t.MessagesPage=Qi})(xr||(xr={}));class Cr extends pe{retrieve(e,n,r,i){return this._client.get(`/threads/${e}/runs/${n}/steps/${r}`,{...i,headers:{"OpenAI-Beta":"assistants=v2",...i==null?void 0:i.headers}})}list(e,n,r={},i){return We(r)?this.list(e,n,{},r):this._client.getAPIList(`/threads/${e}/runs/${n}/steps`,Yi,{query:r,...i,headers:{"OpenAI-Beta":"assistants=v2",...i==null?void 0:i.headers}})}}class Yi extends nt{}(function(t){t.RunStepsPage=Yi})(Cr||(Cr={}));class Ar extends pe{constructor(){super(...arguments),this.steps=new Cr(this._client)}create(e,n,r){return this._client.post(`/threads/${e}/runs`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers},stream:n.stream??!1})}retrieve(e,n,r){return this._client.get(`/threads/${e}/runs/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(e,n,r,i){return this._client.post(`/threads/${e}/runs/${n}`,{body:r,...i,headers:{"OpenAI-Beta":"assistants=v2",...i==null?void 0:i.headers}})}list(e,n={},r){return We(n)?this.list(e,{},n):this._client.getAPIList(`/threads/${e}/runs`,Zi,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}cancel(e,n,r){return this._client.post(`/threads/${e}/runs/${n}/cancel`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(e,n,r){const i=await this.create(e,n,r);return await this.poll(e,i.id,r)}createAndStream(e,n,r){return Ze.createAssistantStream(e,this._client.beta.threads.runs,n,r)}async poll(e,n,r){const i={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for(r!=null&&r.pollIntervalMs&&(i["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const{data:s,response:o}=await this.retrieve(e,n,{...r,headers:{...r==null?void 0:r.headers,...i}}).withResponse();switch(s.status){case"queued":case"in_progress":case"cancelling":let l=5e3;if(r!=null&&r.pollIntervalMs)l=r.pollIntervalMs;else{const a=o.headers.get("openai-poll-after-ms");if(a){const u=parseInt(a);isNaN(u)||(l=u)}}await On(l);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return s}}}stream(e,n,r){return Ze.createAssistantStream(e,this._client.beta.threads.runs,n,r)}submitToolOutputs(e,n,r,i){return this._client.post(`/threads/${e}/runs/${n}/submit_tool_outputs`,{body:r,...i,headers:{"OpenAI-Beta":"assistants=v2",...i==null?void 0:i.headers},stream:r.stream??!1})}async submitToolOutputsAndPoll(e,n,r,i){const s=await this.submitToolOutputs(e,n,r,i);return await this.poll(e,s.id,i)}submitToolOutputsStream(e,n,r,i){return Ze.createToolAssistantStream(e,n,this._client.beta.threads.runs,r,i)}}class Zi extends nt{}(function(t){t.RunsPage=Zi,t.Steps=Cr,t.RunStepsPage=Yi})(Ar||(Ar={}));class Sr extends pe{constructor(){super(...arguments),this.runs=new Ar(this._client),this.messages=new xr(this._client)}create(e={},n){return We(e)?this.create({},e):this._client.post("/threads",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,n){return this._client.get(`/threads/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(e,n,r){return this._client.post(`/threads/${e}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(e,n){return this._client.delete(`/threads/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}createAndRun(e,n){return this._client.post("/threads/runs",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers},stream:e.stream??!1})}async createAndRunPoll(e,n){const r=await this.createAndRun(e,n);return await this.runs.poll(r.thread_id,r.id,n)}createAndRunStream(e,n){return Ze.createThreadAssistantStream(e,this._client.beta.threads,n)}}(function(t){t.Runs=Ar,t.RunsPage=Zi,t.Messages=xr,t.MessagesPage=Qi})(Sr||(Sr={}));const fh=async t=>{const e=await Promise.allSettled(t),n=e.filter(i=>i.status==="rejected");if(n.length){for(const i of n)console.error(i.reason);throw new Error(`${n.length} promise(s) failed - see the above errors`)}const r=[];for(const i of e)i.status==="fulfilled"&&r.push(i.value);return r};let kr=class extends pe{create(e,n,r){return this._client.post(`/vector_stores/${e}/files`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,n,r){return this._client.get(`/vector_stores/${e}/files/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(e,n={},r){return We(n)?this.list(e,{},n):this._client.getAPIList(`/vector_stores/${e}/files`,Ur,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(e,n,r){return this._client.delete(`/vector_stores/${e}/files/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(e,n,r){const i=await this.create(e,n,r);return await this.poll(e,i.id,r)}async poll(e,n,r){const i={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for(r!=null&&r.pollIntervalMs&&(i["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const s=await this.retrieve(e,n,{...r,headers:i}).withResponse(),o=s.data;switch(o.status){case"in_progress":let l=5e3;if(r!=null&&r.pollIntervalMs)l=r.pollIntervalMs;else{const a=s.response.headers.get("openai-poll-after-ms");if(a){const u=parseInt(a);isNaN(u)||(l=u)}}await On(l);break;case"failed":case"completed":return o}}}async upload(e,n,r){const i=await this._client.files.create({file:n,purpose:"assistants"},r);return this.create(e,{file_id:i.id},r)}async uploadAndPoll(e,n,r){const i=await this.upload(e,n,r);return await this.poll(e,i.id,r)}};class Ur extends nt{}(function(t){t.VectorStoreFilesPage=Ur})(kr||(kr={}));class Er extends pe{create(e,n,r){return this._client.post(`/vector_stores/${e}/file_batches`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,n,r){return this._client.get(`/vector_stores/${e}/file_batches/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}cancel(e,n,r){return this._client.post(`/vector_stores/${e}/file_batches/${n}/cancel`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(e,n,r){const i=await this.create(e,n);return await this.poll(e,i.id,r)}listFiles(e,n,r={},i){return We(r)?this.listFiles(e,n,{},r):this._client.getAPIList(`/vector_stores/${e}/file_batches/${n}/files`,Ur,{query:r,...i,headers:{"OpenAI-Beta":"assistants=v2",...i==null?void 0:i.headers}})}async poll(e,n,r){const i={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for(r!=null&&r.pollIntervalMs&&(i["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const{data:s,response:o}=await this.retrieve(e,n,{...r,headers:i}).withResponse();switch(s.status){case"in_progress":let l=5e3;if(r!=null&&r.pollIntervalMs)l=r.pollIntervalMs;else{const a=o.headers.get("openai-poll-after-ms");if(a){const u=parseInt(a);isNaN(u)||(l=u)}}await On(l);break;case"failed":case"cancelled":case"completed":return s}}}async uploadAndPoll(e,{files:n,fileIds:r=[]},i){if(n===null||n.length==0)throw new Error("No files provided to process.");const s=(i==null?void 0:i.maxConcurrency)??5,o=Math.min(s,n.length),l=this._client,a=n.values(),u=[...r];async function c(h){for(let d of h){const p=await l.files.create({file:d,purpose:"assistants"},i);u.push(p.id)}}const f=Array(o).fill(a).map(c);return await fh(f),await this.createAndPoll(e,{file_ids:u})}}Er||(Er={});class Rr extends pe{constructor(){super(...arguments),this.files=new kr(this._client),this.fileBatches=new Er(this._client)}create(e,n){return this._client.post("/vector_stores",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,n){return this._client.get(`/vector_stores/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(e,n,r){return this._client.post(`/vector_stores/${e}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(e={},n){return We(e)?this.list({},e):this._client.getAPIList("/vector_stores",es,{query:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,n){return this._client.delete(`/vector_stores/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class es extends nt{}(function(t){t.VectorStoresPage=es,t.Files=kr,t.VectorStoreFilesPage=Ur,t.FileBatches=Er})(Rr||(Rr={}));class Pr extends pe{constructor(){super(...arguments),this.vectorStores=new Rr(this._client),this.chat=new vr(this._client),this.assistants=new wr(this._client),this.threads=new Sr(this._client)}}(function(t){t.VectorStores=Rr,t.VectorStoresPage=es,t.Chat=vr,t.Assistants=wr,t.AssistantsPage=Gi,t.Threads=Sr})(Pr||(Pr={}));class Ir extends pe{create(e,n){return this._client.post("/completions",{body:e,...n,stream:e.stream??!1})}}Ir||(Ir={});class Mr extends pe{create(e,n){return this._client.post("/embeddings",{body:e,...n})}}Mr||(Mr={});class Or extends pe{create(e,n){return this._client.post("/files",kn({body:e,...n}))}retrieve(e,n){return this._client.get(`/files/${e}`,n)}list(e={},n){return We(e)?this.list({},e):this._client.getAPIList("/files",ts,{query:e,...n})}del(e,n){return this._client.delete(`/files/${e}`,n)}content(e,n){return this._client.get(`/files/${e}/content`,{...n,__binaryResponse:!0})}retrieveContent(e,n){return this._client.get(`/files/${e}/content`,{...n,headers:{Accept:"application/json",...n==null?void 0:n.headers}})}async waitForProcessing(e,{pollInterval:n=5e3,maxWait:r=30*60*1e3}={}){const i=new Set(["processed","error","deleted"]),s=Date.now();let o=await this.retrieve(e);for(;!o.status||!i.has(o.status);)if(await On(n),o=await this.retrieve(e),Date.now()-s>r)throw new Hi({message:`Giving up on waiting for file ${e} to finish processing after ${r} milliseconds.`});return o}}class ts extends Ji{}(function(t){t.FileObjectsPage=ts})(Or||(Or={}));class Nr extends pe{list(e,n={},r){return We(n)?this.list(e,{},n):this._client.getAPIList(`/fine_tuning/jobs/${e}/checkpoints`,ns,{query:n,...r})}}class ns extends nt{}(function(t){t.FineTuningJobCheckpointsPage=ns})(Nr||(Nr={}));class $r extends pe{constructor(){super(...arguments),this.checkpoints=new Nr(this._client)}create(e,n){return this._client.post("/fine_tuning/jobs",{body:e,...n})}retrieve(e,n){return this._client.get(`/fine_tuning/jobs/${e}`,n)}list(e={},n){return We(e)?this.list({},e):this._client.getAPIList("/fine_tuning/jobs",rs,{query:e,...n})}cancel(e,n){return this._client.post(`/fine_tuning/jobs/${e}/cancel`,n)}listEvents(e,n={},r){return We(n)?this.listEvents(e,{},n):this._client.getAPIList(`/fine_tuning/jobs/${e}/events`,is,{query:n,...r})}}class rs extends nt{}class is extends nt{}(function(t){t.FineTuningJobsPage=rs,t.FineTuningJobEventsPage=is,t.Checkpoints=Nr,t.FineTuningJobCheckpointsPage=ns})($r||($r={}));class Tr extends pe{constructor(){super(...arguments),this.jobs=new $r(this._client)}}(function(t){t.Jobs=$r,t.FineTuningJobsPage=rs,t.FineTuningJobEventsPage=is})(Tr||(Tr={}));class Fr extends pe{createVariation(e,n){return this._client.post("/images/variations",kn({body:e,...n}))}edit(e,n){return this._client.post("/images/edits",kn({body:e,...n}))}generate(e,n){return this._client.post("/images/generations",{body:e,...n})}}Fr||(Fr={});class Lr extends pe{retrieve(e,n){return this._client.get(`/models/${e}`,n)}list(e){return this._client.getAPIList("/models",ss,e)}del(e,n){return this._client.delete(`/models/${e}`,n)}}class ss extends Ji{}(function(t){t.ModelsPage=ss})(Lr||(Lr={}));class Dr extends pe{create(e,n){return this._client.post("/moderations",{body:e,...n})}}Dr||(Dr={});var Mo;class xe extends Qf{constructor({baseURL:e=Dn("OPENAI_BASE_URL"),apiKey:n=Dn("OPENAI_API_KEY"),organization:r=Dn("OPENAI_ORG_ID")??null,project:i=Dn("OPENAI_PROJECT_ID")??null,...s}={}){if(n===void 0)throw new ce("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const o={apiKey:n,organization:r,project:i,...s,baseURL:e||"https://api.openai.com/v1"};if(!o.dangerouslyAllowBrowser&&lh())throw new ce(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);super({baseURL:o.baseURL,timeout:o.timeout??6e5,httpAgent:o.httpAgent,maxRetries:o.maxRetries,fetch:o.fetch}),this.completions=new Ir(this),this.chat=new hr(this),this.embeddings=new Mr(this),this.files=new Or(this),this.images=new Fr(this),this.audio=new _r(this),this.moderations=new Dr(this),this.models=new Lr(this),this.fineTuning=new Tr(this),this.beta=new Pr(this),this.batches=new gr(this),this._options=o,this.apiKey=n,this.organization=r,this.project=i}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project,...this._options.defaultHeaders}}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}}Mo=xe;xe.OpenAI=Mo;xe.OpenAIError=ce;xe.APIError=Se;xe.APIConnectionError=Wr;xe.APIConnectionTimeoutError=Hi;xe.APIUserAbortError=ze;xe.NotFoundError=ho;xe.ConflictError=po;xe.RateLimitError=_o;xe.BadRequestError=uo;xe.AuthenticationError=co;xe.InternalServerError=go;xe.PermissionDeniedError=fo;xe.UnprocessableEntityError=mo;xe.toFile=bo;xe.fileFromPath=oo;(function(t){t.Page=Ji,t.CursorPage=nt,t.Completions=Ir,t.Chat=hr,t.Embeddings=Mr,t.Files=Or,t.FileObjectsPage=ts,t.Images=Fr,t.Audio=_r,t.Moderations=Dr,t.Models=Lr,t.ModelsPage=ss,t.FineTuning=Tr,t.Beta=Pr,t.Batches=gr,t.BatchesPage=Ki})(xe||(xe={}));const Bt=[];function hh(t,e=ye){let n;const r=new Set;function i(l){if(et(t,l)&&(t=l,n)){const a=!Bt.length;for(const u of r)u[1](),Bt.push(u,t);if(a){for(let u=0;u<Bt.length;u+=2)Bt[u][0](Bt[u+1]);Bt.length=0}}}function s(l){i(l(t))}function o(l,a=ye){const u=[l,a];return r.add(u),r.size===1&&(n=e(i,s)||ye),l(t),()=>{r.delete(u),r.size===0&&n&&(n(),n=null)}}return{set:i,update:s,subscribe:o}}let Mt=hh(localStorage.getItem("apiKey")||"");Mt.subscribe(t=>localStorage.setItem("apiKey",t));let Br;const Oo=async()=>{if(ms(Mt)===""){let t=window.prompt("Please enter your OpenAI API key");if(t===null)return!1;Mt.set(t)}return Br=new xe({apiKey:ms(Mt),dangerouslyAllowBrowser:!0}),await Br.models.list().then(t=>!0).catch(t=>t.status===401?(Mt.set(""),alert("Invalid API key"),!1):(alert("Error: "+t.response.data.error.message),!1))};let No=["gpt-4-turbo-2024-04-09","gpt-4-turbo","gpt-3.5-turbo-1106","gpt-4-0613","gpt-4o-2024-05-13","gpt-4-0125-preview","gpt-4o","gpt-4-turbo-preview","gpt-4","gpt-3.5-turbo-16k","gpt-4-1106-preview","gpt-3.5-turbo-0125","gpt-3.5-turbo","gpt-3.5-turbo-instruct","gpt-3.5-turbo-instruct-0914"];function dh(t,e,n){const r=t.slice();return r[37]=e[n],r}function ph(t){let e;return{c(){e=S("option"),e.textContent=`${t[37]}`,e.__value=t[37],ie(e,e.__value),y(e,"class","svelte-16eyehw")},m(n,r){oe(n,e,r)},p:ye,d(n){n&&ae(e)}}}function na(t){let e,n,r;return{c(){e=S("textarea"),y(e,"id","post-processing"),y(e,"class","svelte-16eyehw"),he(e,"invalid",t[15]===null)},m(i,s){oe(i,e,s),ie(e,t[5]),n||(r=[le(e,"input",t[28]),le(e,"input",t[29])],n=!0)},p(i,s){s[0]&32&&ie(e,i[5]),s[0]&32768&&he(e,"invalid",i[15]===null)},d(i){i&&ae(e),n=!1,Xe(r)}}}function ra(t){let e,n,r,i;return{c(){e=fe(`(one label per line)
      `),n=S("textarea"),y(n,"id","whitelist"),y(n,"class","svelte-16eyehw"),he(n,"invalid",t[14])},m(s,o){oe(s,e,o),oe(s,n,o),ie(n,t[9]),r||(i=le(n,"input",t[32]),r=!0)},p(s,o){o[0]&512&&ie(n,s[9]),o[0]&16384&&he(n,"invalid",s[14])},d(s){s&&(ae(e),ae(n)),r=!1,i()}}}function mh(t){let e,n,r,i,s,o,l,a,u,c,f,h,d,p,w,v,x,C,R,M,E,P,b,_,m,A,k,O,N,L,X,W,D,j,$,z,J,F,ne,G,H,ee,K,B,T,Y,Z,re=bt(No),te=[];for(let I=0;I<re.length;I+=1)te[I]=ph(dh(t,re,I));let ue=t[4]!=="none"&&na(t),V=t[8]&&ra(t);return{c(){e=S("section"),n=S("div"),n.textContent="Prompt",r=q(),i=S("div"),s=S("label"),s.textContent="Prompt",o=q(),l=S("textarea"),a=q(),u=S("div"),c=S("label"),c.textContent="Model name",f=S("select");for(let I=0;I<te.length;I+=1)te[I].c();h=q(),d=S("div"),p=S("label"),p.textContent="Max tokens",w=S("input"),v=q(),x=S("div"),C=S("label"),C.textContent="Temperature",R=S("input"),M=q(),E=S("div"),P=S("label"),P.textContent="Post processing function",b=S("select"),_=S("option"),_.textContent="None",m=S("option"),m.textContent="Trim",A=S("option"),A.textContent="Last word",k=S("option"),k.textContent="Custom",O=q(),ue&&ue.c(),N=q(),L=S("div"),X=S("label"),X.textContent="Default class",W=S("input"),D=q(),j=S("div"),$=S("label"),$.textContent="Label whitelist ",z=S("input"),J=q(),V&&V.c(),F=q(),ne=S("div"),G=S("label"),G.textContent="Retries",H=S("input"),ee=q(),K=S("div"),B=S("label"),B.textContent="Threads",T=S("input"),y(n,"class","section-title svelte-16eyehw"),y(s,"for","prompt"),y(s,"class","svelte-16eyehw"),y(l,"id","prompt"),y(l,"placeholder","Classify this text as ..."),y(l,"class","svelte-16eyehw"),he(l,"invalid",!t[0]),y(i,"class","prompt svelte-16eyehw"),y(c,"for","model"),je(c,"display","inline-block"),y(c,"class","svelte-16eyehw"),y(f,"id","model"),y(f,"class","svelte-16eyehw"),t[2]===void 0&&Yt(()=>t[23].call(f)),y(p,"for","max-tokens"),y(p,"class","svelte-16eyehw"),y(w,"type","number"),y(w,"id","max-tokens"),y(w,"class","svelte-16eyehw"),he(w,"invalid",!Number.isInteger(t[1])||t[1]<1),y(C,"for","temperature"),y(C,"class","svelte-16eyehw"),y(R,"type","number"),y(R,"id","temperature"),y(R,"class","svelte-16eyehw"),he(R,"invalid",t[16]),y(P,"for","post-processing"),je(P,"display","inline-block"),y(P,"class","svelte-16eyehw"),_.__value="none",ie(_,_.__value),y(_,"class","svelte-16eyehw"),m.__value="trim",ie(m,m.__value),y(m,"class","svelte-16eyehw"),A.__value="last",ie(A,A.__value),y(A,"class","svelte-16eyehw"),k.__value="custom",ie(k,k.__value),y(k,"class","svelte-16eyehw"),y(b,"id","postprocessing"),y(b,"class","svelte-16eyehw"),t[4]===void 0&&Yt(()=>t[26].call(b)),y(X,"for","default-class"),y(X,"class","svelte-16eyehw"),y(W,"type","text"),y(W,"id","default-class"),je(W,"width","6em"),y(W,"class","svelte-16eyehw"),y(L,"class","default-class"),y($,"for","enable-wl"),y($,"class","svelte-16eyehw"),y(z,"type","checkbox"),y(z,"id","enable-wl"),y(z,"class","svelte-16eyehw"),y(j,"class","whitelist svelte-16eyehw"),je(j,"user-select","none"),y(G,"for","retries"),y(G,"class","svelte-16eyehw"),y(H,"type","number"),y(H,"id","retries"),y(H,"class","svelte-16eyehw"),he(H,"invalid",t[13]),y(B,"for","threads"),y(B,"class","svelte-16eyehw"),y(T,"type","number"),y(T,"id","threads"),y(T,"class","svelte-16eyehw"),he(T,"invalid",t[12]),y(e,"class","svelte-16eyehw")},m(I,Q){oe(I,e,Q),g(e,n),g(e,r),g(e,i),g(i,s),g(i,o),g(i,l),ie(l,t[0]),g(e,a),g(e,u),g(u,c),g(u,f);for(let ge=0;ge<te.length;ge+=1)te[ge]&&te[ge].m(f,null);Xt(f,t[2],!0),g(e,h),g(e,d),g(d,p),g(d,w),ie(w,t[1]),g(e,v),g(e,x),g(x,C),g(x,R),ie(R,t[3]),g(e,M),g(e,E),g(E,P),g(E,b),g(b,_),g(b,m),g(b,A),g(b,k),Xt(b,t[4],!0),g(E,O),ue&&ue.m(E,null),g(e,N),g(e,L),g(L,X),g(L,W),ie(W,t[7]),g(e,D),g(e,j),g(j,$),g(j,z),z.checked=t[8],g(j,J),V&&V.m(j,null),g(e,F),g(e,ne),g(ne,G),g(ne,H),ie(H,t[10]),g(e,ee),g(e,K),g(K,B),g(K,T),ie(T,t[11]),Y||(Z=[le(l,"input",t[22]),le(f,"change",t[23]),le(w,"input",t[24]),le(R,"input",t[25]),le(b,"change",t[26]),le(b,"input",t[27]),le(W,"input",t[30]),le(z,"change",t[31]),le(H,"input",t[33]),le(T,"input",t[34])],Y=!0)},p(I,Q){Q[0]&1&&ie(l,I[0]),Q[0]&1&&he(l,"invalid",!I[0]),Q[0]&4&&Xt(f,I[2]),Q[0]&2&&be(w.value)!==I[1]&&ie(w,I[1]),Q[0]&2&&he(w,"invalid",!Number.isInteger(I[1])||I[1]<1),Q[0]&8&&be(R.value)!==I[3]&&ie(R,I[3]),Q[0]&65536&&he(R,"invalid",I[16]),Q[0]&16&&Xt(b,I[4]),I[4]!=="none"?ue?ue.p(I,Q):(ue=na(I),ue.c(),ue.m(E,null)):ue&&(ue.d(1),ue=null),Q[0]&128&&W.value!==I[7]&&ie(W,I[7]),Q[0]&256&&(z.checked=I[8]),I[8]?V?V.p(I,Q):(V=ra(I),V.c(),V.m(j,null)):V&&(V.d(1),V=null),Q[0]&1024&&be(H.value)!==I[10]&&ie(H,I[10]),Q[0]&8192&&he(H,"invalid",I[13]),Q[0]&2048&&be(T.value)!==I[11]&&ie(T,I[11]),Q[0]&4096&&he(T,"invalid",I[12])},i:ye,o:ye,d(I){I&&ae(e),Pn(te,I),ue&&ue.d(),V&&V.d(),Y=!1,Xe(Z)}}}function _h(t,e,n){let r,i,s,o,l,a,u,c="";const f=()=>{n(0,c="Describe the emotion expressed in the following message as joy, anger, sadness or optimism. Output only “joy”, “anger”, “sadness” or “optimism” without quotes.")};let h=20,d="gpt-3.5-turbo",p=.1,w="none",v={none:"return s;",trim:"return s.trim();",last:`// get last word
s = s.split(/\\s+/).slice(-1)[0];
// convert to lowercase
s = s.toLowerCase();
// remove punctuation at the end
s = s.replace(/[.,;]+$/g, "");
return s;`,custom:`// your code here
// return null to note an invalid input
return s;`},x=v[w],C=!1;const R=G=>{let H;try{H=new Function("s",G)}catch{return null}return H};let M="",E=!1,P="",b=1,_=4,{params:m}=e,{valid:A}=e;function k(){c=this.value,n(0,c)}function O(){d=ni(this),n(2,d)}function N(){h=be(this.value),n(1,h)}function L(){p=be(this.value),n(3,p)}function X(){w=ni(this),n(4,w)}const W=()=>{n(6,C=!0)};function D(){x=this.value,n(5,x),n(6,C),n(35,v),n(4,w)}const j=()=>{let G=x;n(4,w="custom"),n(5,x=G)};function $(){M=this.value,n(7,M)}function z(){E=this.checked,n(8,E)}function J(){P=this.value,n(9,P)}function F(){b=be(this.value),n(10,b)}function ne(){_=be(this.value),n(11,_)}return t.$$set=G=>{"params"in G&&n(17,m=G.params),"valid"in G&&n(18,A=G.valid)},t.$$.update=()=>{t.$$.dirty[0]&2&&n(20,r=!Number.isInteger(h)||h<1),t.$$.dirty[0]&8&&n(16,i=p<0||p>1),t.$$.dirty[0]&80&&(C&&n(5,x=v[w]),n(6,C=!1)),t.$$.dirty[0]&32&&n(15,s=R(x)),t.$$.dirty[0]&512&&n(21,o=P?P.split(`
`).map(G=>G.trim()):null),t.$$.dirty[0]&2097408&&n(14,l=E&&o===null),t.$$.dirty[0]&1024&&n(13,a=!Number.isInteger(b)||b<1),t.$$.dirty[0]&2048&&n(12,u=!Number.isInteger(_)||_<1),t.$$.dirty[0]&2133135&&n(17,m={prompt:c,model:d,maxTokens:h,temperature:p,postprocess_fun:s,default_class:M,whitelist:o,retries:b,threads:_}),t.$$.dirty[0]&1175553&&n(18,A=c!==""&&!r&&!i&&s!==null&&!l&&!a&&!u)},[c,h,d,p,w,x,C,M,E,P,b,_,u,a,l,s,i,m,A,f,r,o,k,O,N,L,X,W,D,j,$,z,J,F,ne]}class $o extends ut{constructor(e){super(),lt(this,e,_h,mh,et,{loadExample:19,params:17,valid:18},null,[-1,-1])}get loadExample(){return this.$$.ctx[19]}get params(){return this.$$.ctx[17]}set params(e){this.$$set({params:e}),Qe()}get valid(){return this.$$.ctx[18]}set valid(e){this.$$set({valid:e}),Qe()}}function ia(t,e,n){const r=t.slice();return r[8]=e[n],r}function sa(t){let e,n,r,i,s,o,l=t[3]?"Hide":"Show",a,u,c,f,h,d,p=t[1].length+"",w,v,x,C,R,M,E=t[3]&&aa(t);return{c(){e=S("section"),n=S("button"),r=fe("Download"),s=q(),o=S("button"),a=fe(l),c=q(),f=S("span"),h=fe(t[0]),d=fe(": "),w=fe(p),v=fe(" records"),x=q(),E&&E.c(),C=Uo(),n.disabled=i=!t[2],y(n,"class","svelte-hf245m"),y(o,"class","button svelte-hf245m"),y(o,"id","data-show"),o.disabled=u=!(t[3]||t[1].length),y(f,"class","svelte-hf245m"),y(e,"class","download svelte-hf245m")},m(P,b){oe(P,e,b),g(e,n),g(n,r),g(e,s),g(e,o),g(o,a),g(e,c),g(e,f),g(f,h),g(f,d),g(f,w),g(f,v),oe(P,x,b),E&&E.m(P,b),oe(P,C,b),R||(M=[le(n,"click",t[6]),le(o,"click",t[7])],R=!0)},p(P,b){b&4&&i!==(i=!P[2])&&(n.disabled=i),b&8&&l!==(l=P[3]?"Hide":"Show")&&Ae(a,l),b&10&&u!==(u=!(P[3]||P[1].length))&&(o.disabled=u),b&1&&Ae(h,P[0]),b&2&&p!==(p=P[1].length+"")&&Ae(w,p),P[3]?E?E.p(P,b):(E=aa(P),E.c(),E.m(C.parentNode,C)):E&&(E.d(1),E=null)},d(P){P&&(ae(e),ae(x),ae(C)),E&&E.d(P),R=!1,Xe(M)}}}function aa(t){let e,n,r,i,s,o,l,a,u,c=t[5]&&oa(),f=t[4]&&la(),h=bt(t[1]),d=[];for(let p=0;p<h.length;p+=1)d[p]=fa(ia(t,h,p));return{c(){e=S("div"),n=S("table"),r=S("thead"),i=S("tr"),s=S("th"),s.textContent="Text",o=q(),c&&c.c(),l=q(),f&&f.c(),a=q(),u=S("tbody");for(let p=0;p<d.length;p+=1)d[p].c();y(s,"class","svelte-hf245m"),y(r,"class","svelte-hf245m"),y(n,"class","svelte-hf245m"),y(e,"class","table svelte-hf245m")},m(p,w){oe(p,e,w),g(e,n),g(n,r),g(r,i),g(i,s),g(i,o),c&&c.m(i,null),g(i,l),f&&f.m(i,null),g(n,a),g(n,u);for(let v=0;v<d.length;v+=1)d[v]&&d[v].m(u,null)},p(p,w){if(p[5]?c||(c=oa(),c.c(),c.m(i,l)):c&&(c.d(1),c=null),p[4]?f||(f=la(),f.c(),f.m(i,null)):f&&(f.d(1),f=null),w&50){h=bt(p[1]);let v;for(v=0;v<h.length;v+=1){const x=ia(p,h,v);d[v]?d[v].p(x,w):(d[v]=fa(x),d[v].c(),d[v].m(u,null))}for(;v<d.length;v+=1)d[v].d(1);d.length=h.length}},d(p){p&&ae(e),c&&c.d(),f&&f.d(),Pn(d,p)}}}function oa(t){let e;return{c(){e=S("th"),e.textContent="Label",y(e,"class","svelte-hf245m")},m(n,r){oe(n,e,r)},d(n){n&&ae(e)}}}function la(t){let e;return{c(){e=S("th"),e.textContent="Prediction",y(e,"class","svelte-hf245m")},m(n,r){oe(n,e,r)},d(n){n&&ae(e)}}}function ua(t){let e,n=t[8].label+"",r;return{c(){e=S("td"),r=fe(n),y(e,"class","svelte-hf245m")},m(i,s){oe(i,e,s),g(e,r)},p(i,s){s&2&&n!==(n=i[8].label+"")&&Ae(r,n)},d(i){i&&ae(e)}}}function ca(t){let e,n=t[8].prediction+"",r;return{c(){e=S("td"),r=fe(n),y(e,"class","svelte-hf245m")},m(i,s){oe(i,e,s),g(e,r)},p(i,s){s&2&&n!==(n=i[8].prediction+"")&&Ae(r,n)},d(i){i&&ae(e)}}}function fa(t){let e,n,r=t[8].text+"",i,s,o,l,a=t[5]&&ua(t),u=t[4]&&ca(t);return{c(){e=S("tr"),n=S("td"),i=fe(r),s=q(),a&&a.c(),o=q(),u&&u.c(),l=q(),y(n,"class","svelte-hf245m"),y(e,"class","svelte-hf245m")},m(c,f){oe(c,e,f),g(e,n),g(n,i),g(e,s),a&&a.m(e,null),g(e,o),u&&u.m(e,null),g(e,l)},p(c,f){f&2&&r!==(r=c[8].text+"")&&Ae(i,r),c[5]?a?a.p(c,f):(a=ua(c),a.c(),a.m(e,o)):a&&(a.d(1),a=null),c[4]?u?u.p(c,f):(u=ca(c),u.c(),u.m(e,l)):u&&(u.d(1),u=null)},d(c){c&&ae(e),a&&a.d(),u&&u.d()}}}function gh(t){let e,n=t[1].length&&sa(t);return{c(){e=S("main"),n&&n.c()},m(r,i){oe(r,e,i),n&&n.m(e,null)},p(r,[i]){r[1].length?n?n.p(r,i):(n=sa(r),n.c(),n.m(e,null)):n&&(n.d(1),n=null)},i:ye,o:ye,d(r){r&&ae(e),n&&n.d()}}}function wh(t,e,n){let r,i,{fileName:s=""}=e,{data:o=[]}=e,{canDownload:l=!0}=e,a=!1;const u=()=>{const f=new Blob([o.map(p=>JSON.stringify(p)).join(`
`)],{type:"text/plain"}),h=URL.createObjectURL(f),d=document.createElement("a");d.href=h,d.download=s,d.click(),URL.revokeObjectURL(h)},c=()=>{(a||o.length)&&n(3,a=!a)};return t.$$set=f=>{"fileName"in f&&n(0,s=f.fileName),"data"in f&&n(1,o=f.data),"canDownload"in f&&n(2,l=f.canDownload)},t.$$.update=()=>{t.$$.dirty&2&&n(5,r=o.length>0&&"label"in o[0]),t.$$.dirty&2&&n(4,i=o.length>0&&"prediction"in o[0])},[s,o,l,a,i,r,u,c]}class Si extends ut{constructor(e){super(),lt(this,e,wh,gh,et,{fileName:0,data:1,canDownload:2})}}var ki={exports:{}},Ei={exports:{}},it={},jn={exports:{}},Ri={exports:{}};(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(n){return function(...r){var i=r.pop();return n.call(this,r,i)}},t.exports=e.default})(Ri,Ri.exports);var yh=Ri.exports,Ct={};Object.defineProperty(Ct,"__esModule",{value:!0});Ct.fallback=To;Ct.wrap=Fo;var vh=Ct.hasQueueMicrotask=typeof queueMicrotask=="function"&&queueMicrotask,bh=Ct.hasSetImmediate=typeof setImmediate=="function"&&setImmediate,xh=Ct.hasNextTick=typeof process=="object"&&typeof process.nextTick=="function";function To(t){setTimeout(t,0)}function Fo(t){return(e,...n)=>t(()=>e(...n))}var gn;vh?gn=queueMicrotask:bh?gn=setImmediate:xh?gn=process.nextTick:gn=To;Ct.default=Fo(gn);var ha;function Ch(){return ha||(ha=1,function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=a;var n=yh,r=l(n),i=Ct,s=l(i),o=as();function l(f){return f&&f.__esModule?f:{default:f}}function a(f){return(0,o.isAsync)(f)?function(...h){const d=h.pop(),p=f.apply(this,h);return u(p,d)}:(0,r.default)(function(h,d){var p;try{p=f.apply(this,h)}catch(w){return d(w)}if(p&&typeof p.then=="function")return u(p,d);d(null,p)})}function u(f,h){return f.then(d=>{c(h,null,d)},d=>{c(h,d&&(d instanceof Error||d.message)?d:new Error(d))})}function c(f,h,d){try{f(h,d)}catch(p){(0,s.default)(w=>{throw w},p)}}t.exports=e.default}(jn,jn.exports)),jn.exports}var da;function as(){if(da)return it;da=1,Object.defineProperty(it,"__esModule",{value:!0}),it.isAsyncIterable=it.isAsyncGenerator=it.isAsync=void 0;var t=Ch(),e=n(t);function n(l){return l&&l.__esModule?l:{default:l}}function r(l){return l[Symbol.toStringTag]==="AsyncFunction"}function i(l){return l[Symbol.toStringTag]==="AsyncGenerator"}function s(l){return typeof l[Symbol.asyncIterator]=="function"}function o(l){if(typeof l!="function")throw new Error("expected a function");return r(l)?(0,e.default)(l):l}return it.default=o,it.isAsync=r,it.isAsyncGenerator=i,it.isAsyncIterable=s,it}(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=s;var n=as(),r=i(n);function i(o){return o&&o.__esModule?o:{default:o}}function s(o,l,a,u){l=l||[];var c=[],f=0,h=(0,r.default)(a);return o(l,(d,p,w)=>{var v=f++;h(d,(x,C)=>{c[v]=C,w(x)})},d=>{u(d,c)})}t.exports=e.default})(Ei,Ei.exports);var Ah=Ei.exports,Pi={exports:{}},Ii={exports:{}};(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=n;function n(r){function i(...s){if(r!==null){var o=r;r=null,o.apply(this,s)}}return Object.assign(i,r),i}t.exports=e.default})(Ii,Ii.exports);var Sh=Ii.exports,Mi={exports:{}},Oi={exports:{}};(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=n;function n(r){return r&&typeof r.length=="number"&&r.length>=0&&r.length%1===0}t.exports=e.default})(Oi,Oi.exports);var kh=Oi.exports,Ni={exports:{}};(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(n){return n[Symbol.iterator]&&n[Symbol.iterator]()},t.exports=e.default})(Ni,Ni.exports);var Eh=Ni.exports;(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=c;var n=kh,r=o(n),i=Eh,s=o(i);function o(f){return f&&f.__esModule?f:{default:f}}function l(f){var h=-1,d=f.length;return function(){return++h<d?{value:f[h],key:h}:null}}function a(f){var h=-1;return function(){var p=f.next();return p.done?null:(h++,{value:p.value,key:h})}}function u(f){var h=f?Object.keys(f):[],d=-1,p=h.length;return function w(){var v=h[++d];return v==="__proto__"?w():d<p?{value:f[v],key:v}:null}}function c(f){if((0,r.default)(f))return l(f);var h=(0,s.default)(f);return h?a(h):u(f)}t.exports=e.default})(Mi,Mi.exports);var Rh=Mi.exports,$i={exports:{}};(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=n;function n(r){return function(...i){if(r===null)throw new Error("Callback was already called.");var s=r;r=null,s.apply(this,i)}}t.exports=e.default})($i,$i.exports);var Ph=$i.exports,Ti={exports:{}},Fi={exports:{}};(function(t,e){Object.defineProperty(e,"__esModule",{value:!0});const n={};e.default=n,t.exports=e.default})(Fi,Fi.exports);var Lo=Fi.exports;(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=s;var n=Lo,r=i(n);function i(o){return o&&o.__esModule?o:{default:o}}function s(o,l,a,u){let c=!1,f=!1,h=!1,d=0,p=0;function w(){d>=l||h||c||(h=!0,o.next().then(({value:C,done:R})=>{if(!(f||c)){if(h=!1,R){c=!0,d<=0&&u(null);return}d++,a(C,p,v),p++,w()}}).catch(x))}function v(C,R){if(d-=1,!f){if(C)return x(C);if(C===!1){c=!0,f=!0;return}if(R===r.default||c&&d<=0)return c=!0,u(null);w()}}function x(C){f||(h=!1,c=!0,u(C))}w()}t.exports=e.default})(Ti,Ti.exports);var Ih=Ti.exports;(function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=Sh,r=d(n),i=Rh,s=d(i),o=Ph,l=d(o),a=as(),u=Ih,c=d(u),f=Lo,h=d(f);function d(p){return p&&p.__esModule?p:{default:p}}e.default=p=>(w,v,x)=>{if(x=(0,r.default)(x),p<=0)throw new RangeError("concurrency limit cannot be less than 1");if(!w)return x(null);if((0,a.isAsyncGenerator)(w))return(0,c.default)(w,p,v,x);if((0,a.isAsyncIterable)(w))return(0,c.default)(w[Symbol.asyncIterator](),p,v,x);var C=(0,s.default)(w),R=!1,M=!1,E=0,P=!1;function b(m,A){if(!M)if(E-=1,m)R=!0,x(m);else if(m===!1)R=!0,M=!0;else{if(A===h.default||R&&E<=0)return R=!0,x(null);P||_()}}function _(){for(P=!0;E<p&&!R;){var m=C();if(m===null){R=!0,E<=0&&x(null);return}E+=1,v(m.value,m.key,(0,l.default)(b))}P=!1}_()},t.exports=e.default})(Pi,Pi.exports);var Mh=Pi.exports,Li={exports:{}};(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=n;function n(r,i){if(i||(i=r.length),!i)throw new Error("arity is undefined");function s(...o){return typeof o[i-1]=="function"?r.apply(this,o):new Promise((l,a)=>{o[i-1]=(u,...c)=>{if(u)return a(u);l(c.length>1?c:c[0])},r.apply(this,o)})}return s}t.exports=e.default})(Li,Li.exports);var Oh=Li.exports;(function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=Ah,r=a(n),i=Mh,s=a(i),o=Oh,l=a(o);function a(c){return c&&c.__esModule?c:{default:c}}function u(c,f,h,d){return(0,r.default)((0,s.default)(f),c,h,d)}e.default=(0,l.default)(u,4),t.exports=e.default})(ki,ki.exports);var Nh=ki.exports;const $h=eo(Nh);function Th(t,e,n){let{results:r=[]}=e,{running:i=!1}=e;const s=async(a,{prompt:u,model:c="gpt-3.5-turbo",max_tokens:f=20,temperature:h=.1,postprocess_fun:d=C=>C,default_class:p="",whitelist:w=null,retries:v=1},x=!1)=>{const C=JSON.stringify({text:a,prompt:u,model:c,max_tokens:f,temperature:h,postprocess_fun:d.toString(),default_class:p,whitelist:w,retries:v}),R=localStorage.getItem(C);if(R!==null)return x&&await new Promise(b=>setTimeout(b,10)),JSON.parse(R);let M=0,E=null;for(let b=0;b<v;b++){M+=1,E=(await Br.chat.completions.create({messages:[{role:"system",content:u},{role:"user",content:a}],model:c,max_tokens:f,temperature:h})).choices[0].message.content||"";const m=d(E);if(m===null||w!==null&&!w.includes(m))continue;const A={raw_prediction:E,prediction:m,requests:M};return localStorage.setItem(C,JSON.stringify(A)),A}const P={raw_prediction:E,prediction:p.length>0?p:null,requests:M};return localStorage.setItem(C,JSON.stringify(P)),P},o=a=>{let u=0,c=0;for(let f of a)f.prediction===f.label&&(u+=1),c+=1;return u/c},l=async(a,{prompt:u,model:c,max_tokens:f=20,temperature:h=.1,postprocess_fun:d=R=>R,default_class:p="",whitelist:w=null,retries:v=1,threads:x=4},C=!1)=>{if(!C&&!await Oo())return;n(1,i=!0);const R=a.map((E,P)=>({row:E,index:P})),M=new Map;return n(0,r=[]),new Promise((E,P)=>{$h(R,x,async({row:b,index:_})=>{try{let m=await s(b.text,{prompt:u,model:c,max_tokens:f,temperature:h,postprocess_fun:d,default_class:p,whitelist:w,retries:v},C);for(M.set(_,{...b,...m});M.has(r.length);){const A=r.length,k=M.get(A);n(0,r=[...r,k]),M.delete(A)}}catch(m){console.error(m),P(m)}},b=>{n(1,i=!1),b?(alert(b),P(b)):E(r)})})};return t.$$set=a=>{"results"in a&&n(0,r=a.results),"running"in a&&n(1,i=a.running)},[r,i,o,l]}class Do extends ut{constructor(e){super(),lt(this,e,Th,null,et,{results:0,running:1,accuracy:2,process:3})}get results(){return this.$$.ctx[0]}set results(e){this.$$set({results:e}),Qe()}get running(){return this.$$.ctx[1]}set running(e){this.$$set({running:e}),Qe()}get accuracy(){return this.$$.ctx[2]}get process(){return this.$$.ctx[3]}}function pa(t){let e,n,r,i,s,o,l=t[2].length+"",a,u,c=t[1].length+"",f;return{c(){e=S("div"),n=S("progress"),s=q(),o=S("div"),a=fe(l),u=fe("/"),f=fe(c),y(n,"id","progress-bar"),n.value=r=t[2].length,y(n,"max",i=t[1].length),y(n,"class","svelte-10j97u8"),y(o,"class","progress-message svelte-10j97u8"),y(e,"class","progress svelte-10j97u8")},m(h,d){oe(h,e,d),g(e,n),g(e,s),g(e,o),g(o,a),g(o,u),g(o,f)},p(h,d){d&4&&r!==(r=h[2].length)&&(n.value=r),d&2&&i!==(i=h[1].length)&&y(n,"max",i),d&4&&l!==(l=h[2].length+"")&&Ae(a,l),d&2&&c!==(c=h[1].length+"")&&Ae(f,c)},d(h){h&&ae(e)}}}function ma(t){let e,n,r=t[7].accuracy(t[2])+"",i;return{c(){e=S("div"),n=fe("Accuracy: "),i=fe(r),y(e,"class","results svelte-10j97u8")},m(s,o){oe(s,e,o),g(e,n),g(e,i)},p(s,o){o&132&&r!==(r=s[7].accuracy(s[2])+"")&&Ae(i,r)},d(s){s&&ae(e)}}}function Fh(t){let e,n,r,i,s,o,l,a,u,c,f,h,d,p,w,v,x,C,R,M,E,P,b,_,m,A,k,O,N,L,X,W,D;function j(B){t[11](B)}function $(B){t[12](B)}let z={};t[0]!==void 0&&(z.fileName=t[0]),t[1]!==void 0&&(z.data=t[1]),l=new Ui({props:z}),we.push(()=>qe(l,"fileName",j)),we.push(()=>qe(l,"data",$)),t[13](l);function J(B){t[14](B)}function F(B){t[15](B)}let ne={};t[5]!==void 0&&(ne.params=t[5]),t[6]!==void 0&&(ne.valid=t[6]),f=new $o({props:ne}),we.push(()=>qe(f,"params",J)),we.push(()=>qe(f,"valid",F)),t[16](f);function G(B){t[19](B)}let H={};t[2]!==void 0&&(H.results=t[2]),P=new Do({props:H}),t[18](P),we.push(()=>qe(P,"results",G));let ee=(t[7]&&t[7].running||t[8])&&pa(t);N=new Si({props:{fileName:`${t[9]}-results.jsonl`,data:t[2],canDownload:t[8]}});let K=t[8]&&ma(t);return{c(){e=S("main"),n=S("section"),r=S("b"),r.textContent="New here?",i=q(),s=S("button"),s.textContent="Load Example",o=q(),$e(l.$$.fragment),c=q(),$e(f.$$.fragment),p=q(),w=S("section"),v=S("div"),v.textContent="Process",x=q(),C=S("button"),R=fe("Run"),E=q(),$e(P.$$.fragment),_=q(),ee&&ee.c(),m=q(),A=S("section"),k=S("div"),k.textContent="Results",O=q(),$e(N.$$.fragment),L=q(),K&&K.c(),y(s,"class","smallbutton svelte-10j97u8"),y(n,"class","svelte-10j97u8"),y(v,"class","section-title svelte-10j97u8"),y(C,"class","button svelte-10j97u8"),y(C,"id","process-run"),C.disabled=M=t[0]===""||!t[6]||t[7].running,y(w,"class","svelte-10j97u8"),y(k,"class","section-title svelte-10j97u8"),y(A,"class","svelte-10j97u8")},m(B,T){oe(B,e,T),g(e,n),g(n,r),g(n,i),g(n,s),g(e,o),Pe(l,e,null),g(e,c),Pe(f,e,null),g(e,p),g(e,w),g(w,v),g(w,x),g(w,C),g(C,R),g(w,E),Pe(P,w,null),g(w,_),ee&&ee.m(w,null),g(e,m),g(e,A),g(A,k),g(A,O),Pe(N,A,null),g(A,L),K&&K.m(A,null),X=!0,W||(D=[le(s,"click",t[10]),le(C,"click",t[17])],W=!0)},p(B,[T]){const Y={};!a&&T&1&&(a=!0,Y.fileName=B[0],Be(()=>a=!1)),!u&&T&2&&(u=!0,Y.data=B[1],Be(()=>u=!1)),l.$set(Y);const Z={};!h&&T&32&&(h=!0,Z.params=B[5],Be(()=>h=!1)),!d&&T&64&&(d=!0,Z.valid=B[6],Be(()=>d=!1)),f.$set(Z),(!X||T&193&&M!==(M=B[0]===""||!B[6]||B[7].running))&&(C.disabled=M);const re={};!b&&T&4&&(b=!0,re.results=B[2],Be(()=>b=!1)),P.$set(re),B[7]&&B[7].running||B[8]?ee?ee.p(B,T):(ee=pa(B),ee.c(),ee.m(w,null)):ee&&(ee.d(1),ee=null);const te={};T&512&&(te.fileName=`${B[9]}-results.jsonl`),T&4&&(te.data=B[2]),T&256&&(te.canDownload=B[8]),N.$set(te),B[8]?K?K.p(B,T):(K=ma(B),K.c(),K.m(A,null)):K&&(K.d(1),K=null)},i(B){X||(Re(l.$$.fragment,B),Re(f.$$.fragment,B),Re(P.$$.fragment,B),Re(N.$$.fragment,B),X=!0)},o(B){Ne(l.$$.fragment,B),Ne(f.$$.fragment,B),Ne(P.$$.fragment,B),Ne(N.$$.fragment,B),X=!1},d(B){B&&ae(e),t[13](null),Ie(l),t[16](null),Ie(f),t[18](null),Ie(P),ee&&ee.d(),Ie(N),K&&K.d(),W=!1,Xe(D)}}}function Lh(t,e,n){let r,i,s,o,l="",a,u,c,f,h;const d=()=>{s.loadExample(),o.loadExample()};function p(b){l=b,n(0,l)}function w(b){a=b,n(1,a)}function v(b){we[b?"unshift":"push"](()=>{s=b,n(3,s)})}function x(b){u=b,n(5,u)}function C(b){c=b,n(6,c)}function R(b){we[b?"unshift":"push"](()=>{o=b,n(4,o)})}const M=()=>h.process(a,u,s.isFake);function E(b){we[b?"unshift":"push"](()=>{h=b,n(7,h)})}function P(b){f=b,n(2,f)}return t.$$.update=()=>{t.$$.dirty&1&&n(9,r=l.split(".")[0]),t.$$.dirty&6&&n(8,i=a&&a.length>0&&f.length==a.length)},[l,a,f,s,o,u,c,h,i,r,d,p,w,v,x,C,R,M,E,P]}class Dh extends ut{constructor(e){super(),lt(this,e,Lh,Fh,et,{})}}function Bh(t){let e;return{c(){e=S("main"),e.innerHTML='<svg width="100%" height="400px"></svg> <div class="popup svelte-4flyhw"></div>'},m(n,r){oe(n,e,r)},p:ye,i:ye,o:ye,d(n){n&&ae(e)}}}function qh(t,e,n){let{population:r}=e,i,s=2;const o=a=>{let u=a.map((p,w)=>w).sort((p,w)=>a[p].score-a[w].score);a.forEach((p,w)=>a[u[w]].scoreIndex=w);let c=rl(a.map(p=>p.level))-il(a.map(p=>p.level)),f=Math.max(5,c)/1e3,h=Math.max(2,a.length-1)/300;a.forEach(p=>(p.x=p.level/f+100,p.y=p.scoreIndex/h+50)),i=a.filter(p=>p.parent!==null).map(p=>({source:p.parent,target:p.id}));let d=Math.min(...a.map(p=>Math.min(...a.map(w=>Math.abs(p.score-w.score)+(Math.abs(p.score-w.score)<1e-9?1:0)))));s=Math.max(2,Math.ceil(Math.log10(1/d)))},l=a=>{const u=tn(".popup"),c=tn("svg");Bu("svg > *").remove(),u.style("display","none");const f=Pf().x(w=>w.x).y(w=>w.y).curve(If);c.selectAll("path").data(i).enter().append("path").attr("d",w=>{const v=a.find(C=>C.id===w.source),x=a.find(C=>C.id===w.target);if(!(!v||!x))return f([{x:v.x,y:v.y},{x:(v.x+x.x)/2,y:(v.y+x.y)/2},{x:x.x,y:x.y}])}).attr("fill","none").attr("stroke","#ccc").attr("stroke-width",2),c.selectAll("circle").data(a).enter().append("circle").attr("cx",w=>w.x).attr("cy",w=>w.y).attr("r",10).attr("class","node"),c.selectAll("text").data(a).enter().append("text").attr("x",w=>w.x+15).attr("y",w=>w.y+5).attr("class","label").text(w=>w.score.toFixed(s));let h=!1,d=null;function p(w,v){const x=c.node().getBoundingClientRect(),C=window.scrollX+x.left+v.x+15,R=window.scrollY+x.top+v.y;u.style("left",C+"px").style("top",R+"px")}c.selectAll("circle").on("mouseover",function(w,v){if(!h){p(w,v),u.style("display","block");const x=v.text.replace(/</g,"&lt;").replace(/>/g,"&gt;");u.html(`Generation: ${v.level} <br>Score: ${v.score.toFixed(s)} <br>Prompt: <br>${x}`)}}).on("mouseout",function(w,v){h||u.style("display","none")}).on("mousedown",function(w,v){w.stopPropagation();const x=C=>C._groups[0][0].__data__.id;if(d){if(d.classed("selected",!1),h=!1,u.style("display","none"),x(tn(this))==x(d)){d=null;return}d=null}h=!0,d=tn(this),d.classed("selected",!0),p(w,v),u.style("display","block")}),tn("body").on("mousedown",function(){d&&(d.classed("selected",!1),d=null),h&&(h=!1,u.style("display","none"))}),u.on("mousedown",function(w){w.stopPropagation()})};return Jo(()=>{n(0,r)}),t.$$set=a=>{"population"in a&&n(0,r=a.population)},t.$$.update=()=>{t.$$.dirty&1&&o(r),t.$$.dirty&1&&l(r)},[r]}class jh extends ut{constructor(e){super(),lt(this,e,qh,Bh,et,{population:0})}}function zh(t,e,n){const r=t.slice();return r[22]=e[n],r}function Wh(t){let e;return{c(){e=S("option"),e.textContent=`${t[22]}`,e.__value=t[22],ie(e,e.__value),y(e,"class","svelte-1x7vt9z")},m(n,r){oe(n,e,r)},p:ye,d(n){n&&ae(e)}}}function Xh(t){let e,n,r,i,s,o,l,a,u,c,f,h,d,p,w,v,x,C,R,M,E,P,b,_,m,A,k,O,N,L,X,W,D,j=bt(No),$=[];for(let z=0;z<j.length;z+=1)$[z]=Wh(zh(t,j,z));return{c(){e=S("main"),n=S("section"),r=S("div"),r.textContent="Parameters",i=q(),s=S("label"),s.textContent="Metaprompt",o=q(),l=S("textarea"),a=q(),u=S("div"),c=S("label"),c.textContent="Model name",f=S("select");for(let z=0;z<$.length;z+=1)$[z].c();h=q(),d=S("div"),p=S("label"),p.textContent="Max prompt tokens",w=S("input"),v=q(),x=S("div"),C=S("label"),C.textContent="Population size",R=S("input"),M=q(),E=S("div"),P=S("label"),P.textContent="Generation multiplier",b=S("input"),_=q(),m=S("div"),A=S("label"),A.textContent="Generations",k=S("input"),O=q(),N=S("div"),L=S("label"),L.textContent="Temperature",X=S("input"),y(r,"class","section-title svelte-1x7vt9z"),y(s,"for","metaprompt"),y(s,"class","svelte-1x7vt9z"),y(l,"id","metaprompt"),y(l,"class","svelte-1x7vt9z"),he(l,"invalid",!t[12]),y(c,"for","model"),je(c,"display","inline-block"),y(c,"class","svelte-1x7vt9z"),y(f,"id","model"),y(f,"class","svelte-1x7vt9z"),t[1]===void 0&&Yt(()=>t[16].call(f)),y(p,"for","max-prompt-tokens"),y(p,"class","svelte-1x7vt9z"),y(w,"type","number"),y(w,"id","max-prompt-tokens"),y(w,"class","svelte-1x7vt9z"),he(w,"invalid",t[11]),y(d,"class","input"),y(C,"for","popsize"),y(C,"class","svelte-1x7vt9z"),y(R,"type","number"),y(R,"id","popsize"),y(R,"class","svelte-1x7vt9z"),he(R,"invalid",t[10]),y(x,"class","input"),y(P,"for","genmultiplier"),y(P,"class","svelte-1x7vt9z"),y(b,"type","number"),y(b,"id","genmultiplier"),y(b,"class","svelte-1x7vt9z"),he(b,"invalid",t[9]),y(E,"class","input"),y(A,"for","generations"),y(A,"class","svelte-1x7vt9z"),y(k,"type","number"),y(k,"id","generations"),y(k,"class","svelte-1x7vt9z"),he(k,"invalid",t[8]),y(m,"class","input"),y(L,"for","temperature"),y(L,"class","svelte-1x7vt9z"),y(X,"type","number"),y(X,"id","temperature"),y(X,"class","svelte-1x7vt9z"),he(X,"invalid",t[7]),y(N,"class","input"),y(n,"id","parameters"),y(n,"class","svelte-1x7vt9z")},m(z,J){oe(z,e,J),g(e,n),g(n,r),g(n,i),g(n,s),g(n,o),g(n,l),ie(l,t[0]),g(n,a),g(n,u),g(u,c),g(u,f);for(let F=0;F<$.length;F+=1)$[F]&&$[F].m(f,null);Xt(f,t[1],!0),g(n,h),g(n,d),g(d,p),g(d,w),ie(w,t[2]),g(n,v),g(n,x),g(x,C),g(x,R),ie(R,t[3]),g(n,M),g(n,E),g(E,P),g(E,b),ie(b,t[4]),g(n,_),g(n,m),g(m,A),g(m,k),ie(k,t[5]),g(n,O),g(n,N),g(N,L),g(N,X),ie(X,t[6]),W||(D=[le(l,"input",t[15]),le(f,"change",t[16]),le(w,"input",t[17]),le(R,"input",t[18]),le(b,"input",t[19]),le(k,"input",t[20]),le(X,"input",t[21])],W=!0)},p(z,[J]){J&1&&ie(l,z[0]),J&4096&&he(l,"invalid",!z[12]),J&2&&Xt(f,z[1]),J&4&&be(w.value)!==z[2]&&ie(w,z[2]),J&2048&&he(w,"invalid",z[11]),J&8&&be(R.value)!==z[3]&&ie(R,z[3]),J&1024&&he(R,"invalid",z[10]),J&16&&be(b.value)!==z[4]&&ie(b,z[4]),J&512&&he(b,"invalid",z[9]),J&32&&be(k.value)!==z[5]&&ie(k,z[5]),J&256&&he(k,"invalid",z[8]),J&64&&be(X.value)!==z[6]&&ie(X,z[6]),J&128&&he(X,"invalid",z[7])},i:ye,o:ye,d(z){z&&ae(e),Pn($,z),W=!1,Xe(D)}}}function Uh(t,e,n){let r,i,s,o,l,a,u=`Generate a variation of the following instruction while keeping the semantic meaning and the output format:

{prompt}

Output only the new instruction.`,c="gpt-3.5-turbo",f=100,h=2,d=3,p=8,w=1,{params:v}=e,{valid:x}=e;function C(){u=this.value,n(0,u)}function R(){c=ni(this),n(1,c)}function M(){f=be(this.value),n(2,f)}function E(){h=be(this.value),n(3,h)}function P(){d=be(this.value),n(4,d)}function b(){p=be(this.value),n(5,p)}function _(){w=be(this.value),n(6,w)}return t.$$set=m=>{"params"in m&&n(13,v=m.params),"valid"in m&&n(14,x=m.valid)},t.$$.update=()=>{t.$$.dirty&1&&n(12,r=u.includes("{prompt}")),t.$$.dirty&4&&n(11,i=!Number.isInteger(f)||f<0),t.$$.dirty&8&&n(10,s=!Number.isInteger(h)||h<0),t.$$.dirty&16&&n(9,o=!Number.isInteger(d)||d<0),t.$$.dirty&32&&n(8,l=!Number.isInteger(p)||p<0),t.$$.dirty&64&&n(7,a=w<0||w>1),t.$$.dirty&127&&n(13,v={metaprompt:u,model:c,max_prompt_tokens:f,pop_size:h,gen_multiplier:d,generations:p,temperature:w}),t.$$.dirty&8064&&n(14,x=r&&!i&&!s&&!o&&!l&&!a)},[u,c,f,h,d,p,w,a,l,o,s,i,r,v,x,C,R,M,E,P,b,_]}class Hh extends ut{constructor(e){super(),lt(this,e,Uh,Xh,et,{params:13,valid:14})}}function _a(t){let e;return{c(){e=S("div"),e.textContent="The process will be stopped after the current evaluation.",y(e,"class","message svelte-877se2")},m(n,r){oe(n,e,r)},d(n){n&&ae(e)}}}function ga(t){let e,n,r,i,s,o,l=t[8].length+"",a,u,c=t[2].length+"",f;return{c(){e=S("div"),n=S("progress"),s=q(),o=S("div"),a=fe(l),u=fe("/"),f=fe(c),y(n,"id","progress-bar"),n.value=r=t[8].length,y(n,"max",i=t[2].length),y(n,"class","svelte-877se2"),y(o,"class","progress-message svelte-877se2"),y(e,"class","progress svelte-877se2")},m(h,d){oe(h,e,d),g(e,n),g(e,s),g(e,o),g(o,a),g(o,u),g(o,f)},p(h,d){d&256&&r!==(r=h[8].length)&&(n.value=r),d&4&&i!==(i=h[2].length)&&y(n,"max",i),d&256&&l!==(l=h[8].length+"")&&Ae(a,l),d&4&&c!==(c=h[2].length+"")&&Ae(f,c)},d(h){h&&ae(e)}}}function wa(t){let e,n,r,i,s,o=t[11].text+"",l,a,u,c,f=t[11].score+"",h;return{c(){e=S("div"),n=fe(`Best prompt:
        `),r=S("br"),i=q(),s=S("span"),l=fe(o),a=q(),u=S("br"),c=fe(`
        Score: `),h=fe(f),je(s,"font-family","Courier New, Courier, monospace"),je(s,"font-weight","normal"),y(e,"class","results svelte-877se2")},m(d,p){oe(d,e,p),g(e,n),g(e,r),g(e,i),g(e,s),g(s,l),g(e,a),g(e,u),g(e,c),g(e,h)},p(d,p){p&2048&&o!==(o=d[11].text+"")&&Ae(l,o),p&2048&&f!==(f=d[11].score+"")&&Ae(h,f)},d(d){d&&ae(e)}}}function Vh(t){let e,n,r,i,s,o,l,a,u,c,f,h,d,p,w,v,x,C,R,M,E,P,b,_,m,A,k,O,N,L,X,W,D,j,$,z,J;function F(I){t[13](I)}function ne(I){t[14](I)}let G={requireLabel:!0};t[1]!==void 0&&(G.fileName=t[1]),t[2]!==void 0&&(G.data=t[2]),n=new Ui({props:G}),we.push(()=>qe(n,"fileName",F)),we.push(()=>qe(n,"data",ne));function H(I){t[15](I)}function ee(I){t[16](I)}let K={};t[3]!==void 0&&(K.params=t[3]),t[4]!==void 0&&(K.valid=t[4]),o=new $o({props:K}),we.push(()=>qe(o,"params",H)),we.push(()=>qe(o,"valid",ee));function B(I){t[17](I)}function T(I){t[18](I)}let Y={};t[5]!==void 0&&(Y.params=t[5]),t[6]!==void 0&&(Y.valid=t[6]),c=new Hh({props:Y}),we.push(()=>qe(c,"params",B)),we.push(()=>qe(c,"valid",T));let Z=t[10]&&t[9]&&_a(),re=t[9]&&t[8]&&ga(t);function te(I){t[22](I)}let ue={};t[8]!==void 0&&(ue.results=t[8]),k=new Do({props:ue}),t[21](k),we.push(()=>qe(k,"results",te)),L=new jh({props:{population:t[0]}});let V=t[0].length>0&&wa(t);return{c(){e=S("main"),$e(n.$$.fragment),s=q(),$e(o.$$.fragment),u=q(),$e(c.$$.fragment),d=q(),p=S("section"),w=S("div"),w.textContent="Optimize",v=q(),x=S("button"),C=fe("Run"),M=q(),E=S("button"),P=fe("Stop"),_=q(),Z&&Z.c(),m=q(),re&&re.c(),A=q(),$e(k.$$.fragment),N=q(),$e(L.$$.fragment),X=q(),W=S("section"),D=S("div"),D.textContent="Results",j=q(),V&&V.c(),y(w,"class","section-title svelte-877se2"),y(x,"class","button svelte-877se2"),y(x,"id","process-run"),x.disabled=R=t[1]===""||!t[4]||!t[6]||t[9],y(E,"class","button svelte-877se2"),y(E,"id","process-stop"),E.disabled=b=!t[9]||t[10],y(p,"class","svelte-877se2"),y(D,"class","section-title svelte-877se2"),y(W,"class","svelte-877se2")},m(I,Q){oe(I,e,Q),Pe(n,e,null),g(e,s),Pe(o,e,null),g(e,u),Pe(c,e,null),g(e,d),g(e,p),g(p,w),g(p,v),g(p,x),g(x,C),g(p,M),g(p,E),g(E,P),g(p,_),Z&&Z.m(p,null),g(p,m),re&&re.m(p,null),g(e,A),Pe(k,e,null),g(e,N),Pe(L,e,null),g(e,X),g(e,W),g(W,D),g(W,j),V&&V.m(W,null),$=!0,z||(J=[le(x,"click",t[19]),le(E,"click",t[20])],z=!0)},p(I,[Q]){const ge={};!r&&Q&2&&(r=!0,ge.fileName=I[1],Be(()=>r=!1)),!i&&Q&4&&(i=!0,ge.data=I[2],Be(()=>i=!1)),n.$set(ge);const Oe={};!l&&Q&8&&(l=!0,Oe.params=I[3],Be(()=>l=!1)),!a&&Q&16&&(a=!0,Oe.valid=I[4],Be(()=>a=!1)),o.$set(Oe);const Fe={};!f&&Q&32&&(f=!0,Fe.params=I[5],Be(()=>f=!1)),!h&&Q&64&&(h=!0,Fe.valid=I[6],Be(()=>h=!1)),c.$set(Fe),(!$||Q&594&&R!==(R=I[1]===""||!I[4]||!I[6]||I[9]))&&(x.disabled=R),(!$||Q&1536&&b!==(b=!I[9]||I[10]))&&(E.disabled=b),I[10]&&I[9]?Z||(Z=_a(),Z.c(),Z.m(p,m)):Z&&(Z.d(1),Z=null),I[9]&&I[8]?re?re.p(I,Q):(re=ga(I),re.c(),re.m(p,null)):re&&(re.d(1),re=null);const Ee={};!O&&Q&256&&(O=!0,Ee.results=I[8],Be(()=>O=!1)),k.$set(Ee);const me={};Q&1&&(me.population=I[0]),L.$set(me),I[0].length>0?V?V.p(I,Q):(V=wa(I),V.c(),V.m(W,null)):V&&(V.d(1),V=null)},i(I){$||(Re(n.$$.fragment,I),Re(o.$$.fragment,I),Re(c.$$.fragment,I),Re(k.$$.fragment,I),Re(L.$$.fragment,I),$=!0)},o(I){Ne(n.$$.fragment,I),Ne(o.$$.fragment,I),Ne(c.$$.fragment,I),Ne(k.$$.fragment,I),Ne(L.$$.fragment,I),$=!1},d(I){I&&ae(e),Ie(n),Ie(o),Ie(c),Z&&Z.d(),re&&re.d(),t[21](null),Ie(k),Ie(L),V&&V.d(),z=!1,Xe(J)}}}function Jh(t,e,n){let r,i="",s,o=[],l,a,u,c,f,h;const d=async({metaprompt:k,model:O,max_prompt_tokens:N,temperature:L},X)=>(await Br.chat.completions.create({messages:[{role:"user",content:k.replace("{prompt}",X)}],model:O,max_tokens:N,temperature:L})).choices[0].message.content||"";let p=!1,w=!1;const v=async(k,{metaprompt:O,model:N,max_prompt_tokens:L,pop_size:X,gen_multiplier:W,generations:D,temperature:j},$)=>{if(p||!await Oo())return;n(9,p=!0),n(0,o=[]);const z=k.prompt;let J={...k};delete J.prompt;const F=new Map,ne=async H=>{if(F.has(H))return F.get(H);let ee={...J,prompt:H};return await f.process($,ee),f.accuracy(h)};n(0,o=[{id:0,text:z,score:await ne(z),parent:null,generation:0,level:0}]);let G=[o[0]];for(let H=1;H<=D;H++){let ee=G.slice();for(let K of G)for(let B=0;B<W;B++){let T=await d({metaprompt:O,model:N,max_prompt_tokens:L,temperature:j},K.text),Y={id:o.length+1,text:T,score:await ne(T),parent:K.id,generation:H,level:H};if(ee.push(Y),n(0,o=[...o,Y]),w){n(10,w=!1),n(9,p=!1);return}}G=ee,G.sort((K,B)=>K.score-B.score),G=G.slice(-X)}};function x(k){i=k,n(1,i)}function C(k){s=k,n(2,s)}function R(k){l=k,n(3,l)}function M(k){a=k,n(4,a)}function E(k){u=k,n(5,u)}function P(k){c=k,n(6,c)}const b=()=>v(l,u,s),_=()=>{n(10,w=!0)};function m(k){we[k?"unshift":"push"](()=>{f=k,n(7,f)})}function A(k){h=k,n(8,h)}return t.$$.update=()=>{t.$$.dirty&1&&n(11,r=o.reduce((k,O)=>k.score>O.score?k:O,{score:-1/0}))},[o,i,s,l,a,u,c,f,h,p,w,r,v,x,C,R,M,E,P,b,_,m,A]}class Kh extends ut{constructor(e){super(),lt(this,e,Jh,Vh,et,{})}}var os={exports:{}};os.exports;(function(t){(function(e,n,r){function i(a){var u=this,c=l();u.next=function(){var f=2091639*u.s0+u.c*23283064365386963e-26;return u.s0=u.s1,u.s1=u.s2,u.s2=f-(u.c=f|0)},u.c=1,u.s0=c(" "),u.s1=c(" "),u.s2=c(" "),u.s0-=c(a),u.s0<0&&(u.s0+=1),u.s1-=c(a),u.s1<0&&(u.s1+=1),u.s2-=c(a),u.s2<0&&(u.s2+=1),c=null}function s(a,u){return u.c=a.c,u.s0=a.s0,u.s1=a.s1,u.s2=a.s2,u}function o(a,u){var c=new i(a),f=u&&u.state,h=c.next;return h.int32=function(){return c.next()*4294967296|0},h.double=function(){return h()+(h()*2097152|0)*11102230246251565e-32},h.quick=h,f&&(typeof f=="object"&&s(f,c),h.state=function(){return s(c,{})}),h}function l(){var a=4022871197,u=function(c){c=String(c);for(var f=0;f<c.length;f++){a+=c.charCodeAt(f);var h=.02519603282416938*a;a=h>>>0,h-=a,h*=a,a=h>>>0,h-=a,a+=h*4294967296}return(a>>>0)*23283064365386963e-26};return u}n&&n.exports?n.exports=o:this.alea=o})(xt,t)})(os);var Gh=os.exports,ls={exports:{}};ls.exports;(function(t){(function(e,n,r){function i(l){var a=this,u="";a.x=0,a.y=0,a.z=0,a.w=0,a.next=function(){var f=a.x^a.x<<11;return a.x=a.y,a.y=a.z,a.z=a.w,a.w^=a.w>>>19^f^f>>>8},l===(l|0)?a.x=l:u+=l;for(var c=0;c<u.length+64;c++)a.x^=u.charCodeAt(c)|0,a.next()}function s(l,a){return a.x=l.x,a.y=l.y,a.z=l.z,a.w=l.w,a}function o(l,a){var u=new i(l),c=a&&a.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var h=u.next()>>>11,d=(u.next()>>>0)/4294967296,p=(h+d)/(1<<21);while(p===0);return p},f.int32=u.next,f.quick=f,c&&(typeof c=="object"&&s(c,u),f.state=function(){return s(u,{})}),f}n&&n.exports?n.exports=o:this.xor128=o})(xt,t)})(ls);var Qh=ls.exports,us={exports:{}};us.exports;(function(t){(function(e,n,r){function i(l){var a=this,u="";a.next=function(){var f=a.x^a.x>>>2;return a.x=a.y,a.y=a.z,a.z=a.w,a.w=a.v,(a.d=a.d+362437|0)+(a.v=a.v^a.v<<4^(f^f<<1))|0},a.x=0,a.y=0,a.z=0,a.w=0,a.v=0,l===(l|0)?a.x=l:u+=l;for(var c=0;c<u.length+64;c++)a.x^=u.charCodeAt(c)|0,c==u.length&&(a.d=a.x<<10^a.x>>>4),a.next()}function s(l,a){return a.x=l.x,a.y=l.y,a.z=l.z,a.w=l.w,a.v=l.v,a.d=l.d,a}function o(l,a){var u=new i(l),c=a&&a.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var h=u.next()>>>11,d=(u.next()>>>0)/4294967296,p=(h+d)/(1<<21);while(p===0);return p},f.int32=u.next,f.quick=f,c&&(typeof c=="object"&&s(c,u),f.state=function(){return s(u,{})}),f}n&&n.exports?n.exports=o:this.xorwow=o})(xt,t)})(us);var Yh=us.exports,cs={exports:{}};cs.exports;(function(t){(function(e,n,r){function i(l){var a=this;a.next=function(){var c=a.x,f=a.i,h,d;return h=c[f],h^=h>>>7,d=h^h<<24,h=c[f+1&7],d^=h^h>>>10,h=c[f+3&7],d^=h^h>>>3,h=c[f+4&7],d^=h^h<<7,h=c[f+7&7],h=h^h<<13,d^=h^h<<9,c[f]=d,a.i=f+1&7,d};function u(c,f){var h,d=[];if(f===(f|0))d[0]=f;else for(f=""+f,h=0;h<f.length;++h)d[h&7]=d[h&7]<<15^f.charCodeAt(h)+d[h+1&7]<<13;for(;d.length<8;)d.push(0);for(h=0;h<8&&d[h]===0;++h);for(h==8?d[7]=-1:d[h],c.x=d,c.i=0,h=256;h>0;--h)c.next()}u(a,l)}function s(l,a){return a.x=l.x.slice(),a.i=l.i,a}function o(l,a){l==null&&(l=+new Date);var u=new i(l),c=a&&a.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var h=u.next()>>>11,d=(u.next()>>>0)/4294967296,p=(h+d)/(1<<21);while(p===0);return p},f.int32=u.next,f.quick=f,c&&(c.x&&s(c,u),f.state=function(){return s(u,{})}),f}n&&n.exports?n.exports=o:this.xorshift7=o})(xt,t)})(cs);var Zh=cs.exports,fs={exports:{}};fs.exports;(function(t){(function(e,n,r){function i(l){var a=this;a.next=function(){var c=a.w,f=a.X,h=a.i,d,p;return a.w=c=c+1640531527|0,p=f[h+34&127],d=f[h=h+1&127],p^=p<<13,d^=d<<17,p^=p>>>15,d^=d>>>12,p=f[h]=p^d,a.i=h,p+(c^c>>>16)|0};function u(c,f){var h,d,p,w,v,x=[],C=128;for(f===(f|0)?(d=f,f=null):(f=f+"\0",d=0,C=Math.max(C,f.length)),p=0,w=-32;w<C;++w)f&&(d^=f.charCodeAt((w+32)%f.length)),w===0&&(v=d),d^=d<<10,d^=d>>>15,d^=d<<4,d^=d>>>13,w>=0&&(v=v+1640531527|0,h=x[w&127]^=d+v,p=h==0?p+1:0);for(p>=128&&(x[(f&&f.length||0)&127]=-1),p=127,w=4*128;w>0;--w)d=x[p+34&127],h=x[p=p+1&127],d^=d<<13,h^=h<<17,d^=d>>>15,h^=h>>>12,x[p]=d^h;c.w=v,c.X=x,c.i=p}u(a,l)}function s(l,a){return a.i=l.i,a.w=l.w,a.X=l.X.slice(),a}function o(l,a){l==null&&(l=+new Date);var u=new i(l),c=a&&a.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var h=u.next()>>>11,d=(u.next()>>>0)/4294967296,p=(h+d)/(1<<21);while(p===0);return p},f.int32=u.next,f.quick=f,c&&(c.X&&s(c,u),f.state=function(){return s(u,{})}),f}n&&n.exports?n.exports=o:this.xor4096=o})(xt,t)})(fs);var ed=fs.exports,hs={exports:{}};hs.exports;(function(t){(function(e,n,r){function i(l){var a=this,u="";a.next=function(){var f=a.b,h=a.c,d=a.d,p=a.a;return f=f<<25^f>>>7^h,h=h-d|0,d=d<<24^d>>>8^p,p=p-f|0,a.b=f=f<<20^f>>>12^h,a.c=h=h-d|0,a.d=d<<16^h>>>16^p,a.a=p-f|0},a.a=0,a.b=0,a.c=-1640531527,a.d=1367130551,l===Math.floor(l)?(a.a=l/4294967296|0,a.b=l|0):u+=l;for(var c=0;c<u.length+20;c++)a.b^=u.charCodeAt(c)|0,a.next()}function s(l,a){return a.a=l.a,a.b=l.b,a.c=l.c,a.d=l.d,a}function o(l,a){var u=new i(l),c=a&&a.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var h=u.next()>>>11,d=(u.next()>>>0)/4294967296,p=(h+d)/(1<<21);while(p===0);return p},f.int32=u.next,f.quick=f,c&&(typeof c=="object"&&s(c,u),f.state=function(){return s(u,{})}),f}n&&n.exports?n.exports=o:this.tychei=o})(xt,t)})(hs);var td=hs.exports,Bo={exports:{}};const nd={},rd=Object.freeze(Object.defineProperty({__proto__:null,default:nd},Symbol.toStringTag,{value:"Module"})),id=Mf(rd);(function(t){(function(e,n,r){var i=256,s=6,o=52,l="random",a=r.pow(i,s),u=r.pow(2,o),c=u*2,f=i-1,h;function d(M,E,P){var b=[];E=E==!0?{entropy:!0}:E||{};var _=x(v(E.entropy?[M,R(n)]:M??C(),3),b),m=new p(b),A=function(){for(var k=m.g(s),O=a,N=0;k<u;)k=(k+N)*i,O*=i,N=m.g(1);for(;k>=c;)k/=2,O/=2,N>>>=1;return(k+N)/O};return A.int32=function(){return m.g(4)|0},A.quick=function(){return m.g(4)/4294967296},A.double=A,x(R(m.S),n),(E.pass||P||function(k,O,N,L){return L&&(L.S&&w(L,m),k.state=function(){return w(m,{})}),N?(r[l]=k,O):k})(A,_,"global"in E?E.global:this==r,E.state)}function p(M){var E,P=M.length,b=this,_=0,m=b.i=b.j=0,A=b.S=[];for(P||(M=[P++]);_<i;)A[_]=_++;for(_=0;_<i;_++)A[_]=A[m=f&m+M[_%P]+(E=A[_])],A[m]=E;(b.g=function(k){for(var O,N=0,L=b.i,X=b.j,W=b.S;k--;)O=W[L=f&L+1],N=N*i+W[f&(W[L]=W[X=f&X+O])+(W[X]=O)];return b.i=L,b.j=X,N})(i)}function w(M,E){return E.i=M.i,E.j=M.j,E.S=M.S.slice(),E}function v(M,E){var P=[],b=typeof M,_;if(E&&b=="object")for(_ in M)try{P.push(v(M[_],E-1))}catch{}return P.length?P:b=="string"?M:M+"\0"}function x(M,E){for(var P=M+"",b,_=0;_<P.length;)E[f&_]=f&(b^=E[f&_]*19)+P.charCodeAt(_++);return R(E)}function C(){try{var M;return h&&(M=h.randomBytes)?M=M(i):(M=new Uint8Array(i),(e.crypto||e.msCrypto).getRandomValues(M)),R(M)}catch{var E=e.navigator,P=E&&E.plugins;return[+new Date,e,P,e.screen,R(n)]}}function R(M){return String.fromCharCode.apply(0,M)}if(x(r.random(),n),t.exports){t.exports=d;try{h=id}catch{}}else r["seed"+l]=d})(typeof self<"u"?self:xt,[],Math)})(Bo);var sd=Bo.exports,ad=Gh,od=Qh,ld=Yh,ud=Zh,cd=ed,fd=td,Tt=sd;Tt.alea=ad;Tt.xor128=od;Tt.xorwow=ld;Tt.xorshift7=ud;Tt.xor4096=cd;Tt.tychei=fd;var hd=Tt;const dd=eo(hd);function pd(t){let e,n,r,i,s,o,l,a,u,c,f,h,d,p,w,v,x,C,R,M,E,P,b,_,m,A,k,O,N,L,X;function W(j){t[10](j)}let D={};return t[0]!==void 0&&(D.fileName=t[0]),n=new Ui({props:D}),t[9](n),we.push(()=>qe(n,"fileName",W)),A=new Si({props:{fileName:`${t[6]}-split1.jsonl`,data:t[4]}}),O=new Si({props:{fileName:`${t[6]}-split2.jsonl`,data:t[5]}}),{c(){e=S("main"),$e(n.$$.fragment),i=q(),s=S("section"),o=S("div"),o.textContent="Parameters",l=q(),a=S("div"),u=S("label"),u.textContent="Seed",c=S("input"),f=q(),h=S("div"),d=S("label"),d.textContent="Number of samples",p=S("input"),w=q(),v=S("section"),x=S("div"),x.textContent="Split",C=q(),R=S("button"),M=fe("Run"),P=q(),b=S("section"),_=S("div"),_.textContent="Results",m=q(),$e(A.$$.fragment),k=q(),$e(O.$$.fragment),y(o,"class","section-title svelte-1ae2ewh"),y(u,"for","seed"),y(u,"class","svelte-1ae2ewh"),y(c,"type","text"),y(c,"id","seed"),y(c,"class","svelte-1ae2ewh"),y(a,"class","input"),y(d,"for","k"),y(d,"class","svelte-1ae2ewh"),y(p,"type","number"),y(p,"id","k"),y(p,"class","svelte-1ae2ewh"),he(p,"invalid",t[7]),y(h,"class","input"),y(s,"class","svelte-1ae2ewh"),y(x,"class","section-title svelte-1ae2ewh"),y(R,"class","button svelte-1ae2ewh"),R.disabled=E=t[0]===""||t[7],y(v,"class","svelte-1ae2ewh"),y(_,"class","section-title svelte-1ae2ewh"),y(b,"class","svelte-1ae2ewh")},m(j,$){oe(j,e,$),Pe(n,e,null),g(e,i),g(e,s),g(s,o),g(s,l),g(s,a),g(a,u),g(a,c),ie(c,t[3]),g(s,f),g(s,h),g(h,d),g(h,p),ie(p,t[1]),g(e,w),g(e,v),g(v,x),g(v,C),g(v,R),g(R,M),g(e,P),g(e,b),g(b,_),g(b,m),Pe(A,b,null),g(b,k),Pe(O,b,null),N=!0,L||(X=[le(c,"input",t[11]),le(p,"input",t[12]),le(R,"click",t[13])],L=!0)},p(j,[$]){const z={};!r&&$&1&&(r=!0,z.fileName=j[0],Be(()=>r=!1)),n.$set(z),$&8&&c.value!==j[3]&&ie(c,j[3]),$&2&&be(p.value)!==j[1]&&ie(p,j[1]),(!N||$&128)&&he(p,"invalid",j[7]),(!N||$&129&&E!==(E=j[0]===""||j[7]))&&(R.disabled=E);const J={};$&64&&(J.fileName=`${j[6]}-split1.jsonl`),$&16&&(J.data=j[4]),A.$set(J);const F={};$&64&&(F.fileName=`${j[6]}-split2.jsonl`),$&32&&(F.data=j[5]),O.$set(F)},i(j){N||(Re(n.$$.fragment,j),Re(A.$$.fragment,j),Re(O.$$.fragment,j),N=!0)},o(j){Ne(n.$$.fragment,j),Ne(A.$$.fragment,j),Ne(O.$$.fragment,j),N=!1},d(j){j&&ae(e),t[9](null),Ie(n),Ie(A),Ie(O),L=!1,Xe(X)}}}function md(t,e,n){let r,i;const s=(x,C,R="")=>{C>x&&(C=x);let M=dd(R),E=new Set(Array.from({length:x},(b,_)=>_)),P=new Set;for(let b=0;b<C;b++){let _=Math.floor(M()*E.size),m=Array.from(E)[_];E.delete(m),P.add(m)}return[Array.from(P).sort(),Array.from(E).sort()]};let o,l="",a="",u=0,c=[],f=[];function h(x){we[x?"unshift":"push"](()=>{o=x,n(2,o)})}function d(x){l=x,n(0,l)}function p(){a=this.value,n(3,a)}function w(){u=be(this.value),n(1,u)}const v=()=>{let[x,C]=s(o.data.length,u,a);n(4,c=x.map(R=>o.data[R])),n(5,f=C.map(R=>o.data[R]))};return t.$$.update=()=>{t.$$.dirty&2&&n(7,r=!Number.isInteger(u)||u<0),t.$$.dirty&1&&n(6,i=l.split(".")[0])},[l,u,o,a,c,f,i,r,s,h,d,p,w,v]}class _d extends ut{constructor(e){super(),lt(this,e,md,pd,et,{})}}function ya(t,e,n){const r=t.slice();return r[7]=e[n],r[9]=n,r}function va(t){let e,n=t[7].name+"",r,i,s,o,l,a;function u(){return t[4](t[9])}return{c(){e=S("button"),r=fe(n),i=S("br"),s=S("span"),s.textContent=`${t[7].phon}`,y(s,"class","phonetics svelte-pa7h6w"),y(e,"class",o="tab "+(t[0]==t[9]?"selected":"")+" svelte-pa7h6w")},m(c,f){oe(c,e,f),g(e,r),g(e,i),g(e,s),l||(a=le(e,"click",u),l=!0)},p(c,f){t=c,f&1&&o!==(o="tab "+(t[0]==t[9]?"selected":"")+" svelte-pa7h6w")&&y(e,"class",o)},d(c){c&&ae(e),l=!1,a()}}}function ba(t){let e,n,r;return{c(){e=S("button"),e.textContent="d.skönnect",je(e,"flex","0.25"),je(e,"font-size","16px"),je(e,"white-space","nowrap"),y(e,"class","tab svelte-pa7h6w")},m(i,s){oe(i,e,s),n||(r=le(e,"click",t[6]),n=!0)},p:ye,d(i){i&&ae(e),n=!1,r()}}}function gd(t){let e,n,r,i,s,o,l,a,u,c,f=bt(t[3]),h=[];for(let v=0;v<f.length;v+=1)h[v]=va(ya(t,f,v));let d=t[1]&&ba(t);var p=t[3][t[0]].component;function w(v,x){return{}}return p&&(l=_s(p,w())),{c(){e=S("header");for(let v=0;v<h.length;v+=1)h[v].c();n=q(),r=S("button"),r.textContent="klear cäche",i=q(),d&&d.c(),s=q(),o=S("main"),l&&$e(l.$$.fragment),je(r,"flex","0.2"),je(r,"font-size","16px"),y(r,"class","tab svelte-pa7h6w"),y(e,"class","tabs svelte-pa7h6w")},m(v,x){oe(v,e,x);for(let C=0;C<h.length;C+=1)h[C]&&h[C].m(e,null);g(e,n),g(e,r),g(e,i),d&&d.m(e,null),oe(v,s,x),oe(v,o,x),l&&Pe(l,o,null),a=!0,u||(c=le(r,"click",t[5]),u=!0)},p(v,[x]){if(x&13){f=bt(v[3]);let C;for(C=0;C<f.length;C+=1){const R=ya(v,f,C);h[C]?h[C].p(R,x):(h[C]=va(R),h[C].c(),h[C].m(e,n))}for(;C<h.length;C+=1)h[C].d(1);h.length=f.length}if(v[1]?d?d.p(v,x):(d=ba(v),d.c(),d.m(e,null)):d&&(d.d(1),d=null),x&1&&p!==(p=v[3][v[0]].component)){if(l){Zo();const C=l;Ne(C.$$.fragment,1,0,()=>{Ie(C,1)}),el()}p?(l=_s(p,w()),$e(l.$$.fragment),Re(l.$$.fragment,1),Pe(l,o,null)):l=null}},i(v){a||(l&&Re(l.$$.fragment,v),a=!0)},o(v){l&&Ne(l.$$.fragment,v),a=!1},d(v){v&&(ae(e),ae(s),ae(o)),Pn(h,v),d&&d.d(),l&&Ie(l),u=!1,c()}}}function wd(t,e,n){let r;Wo(t,Mt,c=>n(1,r=c));let i=0;function s(c){n(0,i=c)}return[i,r,s,[{name:"evål",phon:"/ɪˈvæl/",component:Dh},{name:"øptim",phon:"/ˈɒptɪm/",component:Kh},{name:"splët",phon:"/splɪt/",component:_d}],c=>s(c),async()=>{const c=r;localStorage.clear(),localStorage.setItem("apiKey",c)},()=>{Xo(Mt,r="",r)}]}class yd extends ut{constructor(e){super(),lt(this,e,wd,gd,et,{})}}new yd({target:document.getElementById("app")});
